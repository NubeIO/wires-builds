{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./nodes/container.ts","webpack:///./nodes/node-io.ts","webpack:///./nodes/node.ts","webpack:///./nodes/utils.ts","webpack:///./utils/helper.ts","webpack:///./nodes/utils/time-utils.ts","webpack:///./nodes/flexible-node.ts","webpack:///external \"logplease\"","webpack:///./config.ts","webpack:///./nodes/constants.ts","webpack:///external \"axios\"","webpack:///./nodes/registry.ts","webpack:///external \"moment-timezone\"","webpack:///external \"lodash\"","webpack:///./nodes/container-node.ts","webpack:///external \"express\"","webpack:///./nodes/nodes/dashboard/ui-node.ts","webpack:///./nodes/utils/crypto-utils.ts","webpack:///external \"node-bacnet\"","webpack:///external \"child_process\"","webpack:///./nodes/nodes/statistics/statistics.ts","webpack:///./app.ts","webpack:///./nodes/node-icons.ts","webpack:///external \"nedb\"","webpack:///external \"moment\"","webpack:///./promise-actor.ts","webpack:///external \"fs\"","webpack:///./nodes/utils/file-utils.ts","webpack:///./nodes/nodes/protocols/edge-28/edge-constant.ts","webpack:///./backend/models/point-model.ts","webpack:///./nodes/nodes/IoT/shared/mixin.ts","webpack:///./nodes/nodes/history/HistoryBase.ts","webpack:///./nodes/nodes/protocols/edge-28/edge-utils.ts","webpack:///./nodes/nodes/protocols/bacnet/bacnet-constant.ts","webpack:///./nodes/nodes/protocols/model/point-node.ts","webpack:///./utils/pattern.ts","webpack:///./nodes/nodes/protocols/connection-node-mixin.ts","webpack:///./nodes/utils/os-utils.ts","webpack:///external \"path\"","webpack:///./events.ts","webpack:///./backend/entry.ts","webpack:///./nodes/nodes/bsa/bsa-client-config.ts","webpack:///./nodes/nodes/system/system-utils.ts","webpack:///./nodes/nodes/protocols/modbus/modbus-fc/modbus-point-byte-order.ts","webpack:///external \"influx\"","webpack:///./nodes/lib/psychrolib.ts","webpack:///./nodes/utils/string-json-compare-utils.ts","webpack:///./nodes/utils/help/protocols/edge-28.ts","webpack:///./nodes/utils/points/BACnet-enums-units.ts","webpack:///./nodes/nodes/protocols/bacnet/bacnet-utils.ts","webpack:///./utils/decorators.ts","webpack:///external \"enumify\"","webpack:///./nodes/nodes/protocols/bacnet-server/core/util.js","webpack:///external \"mqtt\"","webpack:///./nodes/nodes/protocols/mqtt/mqtt-client-node.ts","webpack:///external \"cron\"","webpack:///external \"jsonata\"","webpack:///external \"cronstrue\"","webpack:///./nodes/container-utils.ts","webpack:///./backend/api.ts","webpack:///./nodes/nodes/IoT/shared/api-container-node.ts","webpack:///./nodes/nodes/IoT/shared/top-level-api-container-node.ts","webpack:///external \"lodash-decorators/debounce\"","webpack:///external \"socket.io\"","webpack:///./server/middleware.ts","webpack:///./nodes/nodes/container/folder.ts","webpack:///./nodes/nodes/container/abstract-folder-io.ts","webpack:///./nodes/utils/setting-utils.ts","webpack:///./nodes/utils/points/point-ref-utils.ts","webpack:///./nodes/nodes/nube/base-point.ts","webpack:///./nodes/utils/node-utils.ts","webpack:///./nodes/nodes/protocols/edge-28/edge-gpio-utils.ts","webpack:///./nodes/utils/MathUtils.ts","webpack:///./nodes/nodes/protocols/bacnet-server/bacnet-server-node.ts","webpack:///./nodes/nodes/protocols/model/container-node-store.ts","webpack:///./nodes/nodes/protocols/ProtocolDeviceNode.ts","webpack:///./utils/enums.ts","webpack:///./nodes/nodes/node-mixin.ts","webpack:///./nodes/nodes/protocols/bacnet-server/core/bacnet-object-property.js","webpack:///./nodes/nodes/protocols/bacnet-server/core/bacnet-model.ts","webpack:///./nodes/nodes/protocols/lora-raw/lora-two-way-in.ts","webpack:///external \"modbus-serial\"","webpack:///external \"net\"","webpack:///external \"mqtt-match\"","webpack:///./nodes/nodes/protocols/mqtt/mqtt-client-node-store.ts","webpack:///external \"serialport\"","webpack:///./nodes/utils/uuid-utils.ts","webpack:///external \"os\"","webpack:///./nodes/utils/ip-address-utils.ts","webpack:///external \"ip\"","webpack:///./nodes/utils/nodes/node-colour-change.ts","webpack:///external \"source-map-support\"","webpack:///external \"process\"","webpack:///external \"minimist\"","webpack:///external \"dotenv\"","webpack:///./backend/backend.ts","webpack:///./nodes/node-link.ts","webpack:///./nodes/nodes/IoT/datapoint-node.ts","webpack:///./backend/datapoint.ts","webpack:///./nodes/nodes/IoT/installer-node.ts","webpack:///./backend/installer.ts","webpack:///./nodes/nodes/IoT/shared/api-node.ts","webpack:///./server/dashboard.ts","webpack:///./server/server.ts","webpack:///external \"body-parser\"","webpack:///external \"cookie-parser\"","webpack:///external \"http\"","webpack:///external \"morgan\"","webpack:///./server/dashboard-server-socket.ts","webpack:///./server/editor-server-socket.ts","webpack:///./nodes/node-utils.ts","webpack:///./server/ping-pong-server-socket.ts","webpack:///./server/wire-name-server-socket.ts","webpack:///external \"express-validator\"","webpack:///./server/routes/dashboard.ts","webpack:///./server/routes/api-dashboard.ts","webpack:///./server/routes/editor.ts","webpack:///./server/routes/api-editor.ts","webpack:///./server/routes/api-wire-name.ts","webpack:///./database/datasource/WireNameDataSource.ts","webpack:///./server/routes/auth.ts","webpack:///external \"@hapi/joi\"","webpack:///./server/routes/api-help.ts","webpack:///./database/datasource/HelpDataSource.ts","webpack:///./server/routes/api-platform.ts","webpack:///./database/datasource/PlatformDataSource.ts","webpack:///./nodes/nodes/index.ts","webpack:///./nodes/nodes/bsa/bsa-cumulocity-device.ts","webpack:///./nodes/nodes/bsa/bsa-cumulocity-point.ts","webpack:///./nodes/nodes/bsa/bsa-cumulocity-alarm.ts","webpack:///./nodes/nodes/boolean/and.ts","webpack:///./nodes/nodes/boolean/or.ts","webpack:///./nodes/nodes/boolean/xor.ts","webpack:///./nodes/nodes/boolean/not.ts","webpack:///./nodes/nodes/boolean/toggle.ts","webpack:///./nodes/nodes/boolean/one-shot.ts","webpack:///./nodes/nodes/boolean/min-on-off.ts","webpack:///./nodes/nodes/boolean/on-delay.ts","webpack:///./nodes/nodes/boolean/off-delay.ts","webpack:///./nodes/nodes/boolean/ticker.ts","webpack:///./nodes/nodes/compare/equal.ts","webpack:///./nodes/nodes/compare/greater-than.ts","webpack:///./nodes/nodes/compare/less-than.ts","webpack:///./nodes/nodes/compare/between.ts","webpack:///./nodes/nodes/compare/hysteresis.ts","webpack:///./nodes/nodes/compare/type-check.ts","webpack:///./nodes/nodes/connection/local-transmitter-single.ts","webpack:///./nodes/nodes/connection/local-receiver-single.ts","webpack:///./nodes/nodes/connection/local-transmitter.ts","webpack:///./nodes/nodes/connection/local-receiver.ts","webpack:///./nodes/nodes/connection/hub.ts","webpack:///./nodes/nodes/container/folder-input.ts","webpack:///./nodes/nodes/container/folder-output.ts","webpack:///./nodes/nodes/conversion/bool-to-int.ts","webpack:///./nodes/nodes/conversion/bit-mask.ts","webpack:///./nodes/nodes/conversion/bit-split.ts","webpack:///./nodes/nodes/conversion/byte-array-to-int.ts","webpack:///./nodes/nodes/conversion/data-conversion.ts","webpack:///external \"convert-units\"","webpack:///./nodes/nodes/conversion/int-to-byte-four-array.ts","webpack:///./nodes/nodes/count/any-event-counter.ts","webpack:///./nodes/nodes/count/counter.ts","webpack:///./nodes/nodes/count/triggered-ramp.ts","webpack:///./nodes/nodes/count/interval-ramp.ts","webpack:///./nodes/nodes/count/waveform.ts","webpack:///./nodes/nodes/csv/csv-merge-rows.ts","webpack:///./nodes/nodes/csv/csv-merge-columns.ts","webpack:///./nodes/nodes/custom-function/function.ts","webpack:///./nodes/nodes/custom-function/base-function-node.ts","webpack:///external \"vm2\"","webpack:///./nodes/nodes/dashboard/label.ts","webpack:///./nodes/nodes/dashboard/button.ts","webpack:///./nodes/nodes/dashboard/switch.ts","webpack:///./nodes/nodes/dashboard/progress.ts","webpack:///./nodes/nodes/dashboard/slider.ts","webpack:///./nodes/nodes/dashboard/text-box.ts","webpack:///./nodes/nodes/dashboard/log.ts","webpack:///./nodes/nodes/dashboard/chart.ts","webpack:///./nodes/nodes/debug/console.ts","webpack:///./nodes/nodes/debug/notes.ts","webpack:///./nodes/nodes/debug/watch.ts","webpack:///./nodes/nodes/filter/only-true.ts","webpack:///./nodes/nodes/filter/only-false.ts","webpack:///./nodes/nodes/filter/only-between.ts","webpack:///./nodes/nodes/filter/only-greater.ts","webpack:///./nodes/nodes/filter/only-lower.ts","webpack:///./nodes/nodes/filter/only-equal.ts","webpack:///./nodes/nodes/filter/prevent-null.ts","webpack:///./nodes/nodes/filter/prevent-equal.ts","webpack:///./nodes/nodes/filter/prevent-duplicates.ts","webpack:///./nodes/nodes/history/data-store.ts","webpack:///./nodes/nodes/history/influx-db.ts","webpack:///./nodes/nodes/history/history.ts","webpack:///./nodes/nodes/history/point-persistence.ts","webpack:///./nodes/nodes/history/point-tag.ts","webpack:///./nodes/nodes/hvac/deadband.ts","webpack:///./nodes/nodes/hvac/thermostat.ts","webpack:///./nodes/nodes/hvac/PID.ts","webpack:///./nodes/lib/pid-controller.ts","webpack:///./nodes/nodes/hvac/toggle-duration.ts","webpack:///./nodes/nodes/hvac/psychometrics.ts","webpack:///./nodes/nodes/hvac/energy-conversion.ts","webpack:///./nodes/nodes/hvac/power-conversion.ts","webpack:///./nodes/nodes/hvac/volume-conversion.ts","webpack:///./nodes/nodes/hvac/temperature-conversion.ts","webpack:///./nodes/nodes/hvac/atm-pressure-conversion.ts","webpack:///./nodes/nodes/hvac/pressure-conversion.ts","webpack:///./nodes/nodes/json/array-builder.ts","webpack:///./nodes/nodes/json/json-builder.ts","webpack:///./nodes/nodes/json/json-enum-builder.ts","webpack:///./nodes/nodes/json/json-filter.ts","webpack:///./nodes/nodes/json/json-filter-compare.ts","webpack:///./nodes/nodes/json/json-filter-multiple.ts","webpack:///./nodes/nodes/json/json-checker.ts","webpack:///./nodes/nodes/json/json-parse.ts","webpack:///./nodes/nodes/latch/any-latch.ts","webpack:///./nodes/nodes/latch/bool-latch.ts","webpack:///./nodes/nodes/latch/num-latch.ts","webpack:///./nodes/nodes/latch/string-latch.ts","webpack:///./nodes/nodes/latch/set-reset.ts","webpack:///./nodes/nodes/math/add.ts","webpack:///./nodes/nodes/math/subtract.ts","webpack:///./nodes/nodes/math/multiply.ts","webpack:///./nodes/nodes/math/divide.ts","webpack:///./nodes/nodes/math/absolute.ts","webpack:///./nodes/nodes/math/modulus.ts","webpack:///./nodes/nodes/math/power.ts","webpack:///./nodes/nodes/math-advanced/acos.ts","webpack:///./nodes/nodes/math-advanced/asin.ts","webpack:///./nodes/nodes/math-advanced/atan.ts","webpack:///./nodes/nodes/math-advanced/cbrt.ts","webpack:///./nodes/nodes/math-advanced/cos.ts","webpack:///./nodes/nodes/math-advanced/exp.ts","webpack:///./nodes/nodes/math-advanced/log.ts","webpack:///./nodes/nodes/math-advanced/log10.ts","webpack:///./nodes/nodes/math-advanced/sin.ts","webpack:///./nodes/nodes/math-advanced/sqrt.ts","webpack:///./nodes/nodes/math-advanced/tan.ts","webpack:///./nodes/nodes/math-trigger/trigger-add.ts","webpack:///./nodes/nodes/math-trigger/trigger-subtract.ts","webpack:///./nodes/nodes/math-trigger/trigger-multiply.ts","webpack:///./nodes/nodes/math-trigger/trigger-divide.ts","webpack:///./nodes/nodes/math-trigger/trigger-modulus.ts","webpack:///./nodes/nodes/math-trigger/trigger-power.ts","webpack:///./nodes/nodes/miscellaneous/num-series-generator.ts","webpack:///./nodes/nodes/miscellaneous/append-to-strings.ts","webpack:///./nodes/nodes/nube/login.ts","webpack:///external \"crypto-js\"","webpack:///./nodes/nodes/nube/api-input.ts","webpack:///./nodes/nodes/nube/api-output.ts","webpack:///./nodes/nodes/nube/api-schedules.ts","webpack:///./nodes/nodes/nube/base-edge.ts","webpack:///./nodes/nodes/nube/get-schedules.ts","webpack:///external \"btoa\"","webpack:///./nodes/nodes/num-transform/round.ts","webpack:///./nodes/nodes/num-transform/floor.ts","webpack:///./nodes/nodes/num-transform/ceil.ts","webpack:///./nodes/nodes/num-transform/limit.ts","webpack:///./nodes/nodes/num-transform/scale.ts","webpack:///./nodes/nodes/num-transform/linear-shaper.ts","webpack:///./nodes/nodes/num-transform/fade.ts","webpack:///./nodes/nodes/num-transform/rate-limit.ts","webpack:///./nodes/nodes/point/bool-constant.ts","webpack:///./nodes/nodes/point/num-constant.ts","webpack:///./nodes/nodes/point/string-constant.ts","webpack:///./nodes/nodes/point/json-constant.ts","webpack:///./nodes/nodes/point/bool-writable.ts","webpack:///./nodes/nodes/point/num-writable.ts","webpack:///./nodes/nodes/point/string-writable.ts","webpack:///./nodes/nodes/point/generic-point.ts","webpack:///./nodes/utils/points/history-config.ts","webpack:///./nodes/utils/points/priority-config.ts","webpack:///./nodes/nodes/protocols/email/email.ts","webpack:///external \"nodemailer\"","webpack:///./nodes/nodes/protocols/edge-28/edge-28-network.ts","webpack:///./nodes/nodes/protocols/edge-28/edge-28-input.ts","webpack:///./nodes/nodes/protocols/edge-28/edge-10k-sensor-calc.ts","webpack:///./nodes/nodes/protocols/edge-28/edge-28-output.ts","webpack:///./nodes/nodes/protocols/edge-28/edge-28-lora-reset.ts","webpack:///./nodes/nodes/protocols/bacnet/bacnet-network.ts","webpack:///./nodes/nodes/protocols/bacnet/bacnet-device.ts","webpack:///./nodes/nodes/protocols/bacnet/bacnet-point.ts","webpack:///./nodes/nodes/protocols/model/point-node-utils.ts","webpack:///./nodes/nodes/protocols/bacnet-server/core/bacnet-device.js","webpack:///external \"assert\"","webpack:///./nodes/nodes/protocols/bacnet-server/core/bacnet-object.js","webpack:///external \"util\"","webpack:///./nodes/nodes/protocols/bacnet-server/core/typemap-property.js","webpack:///./nodes/nodes/protocols/bacnet-server/core/mandatory-properties.js","webpack:///./nodes/nodes/protocols/bacnet-server/bacnet-server-point.ts","webpack:///./nodes/nodes/protocols/lora-raw/lora.ts","webpack:///./nodes/nodes/protocols/lora-raw/lora-two-way-out.ts","webpack:///./nodes/nodes/protocols/lora-raw/lora-two-way-test.ts","webpack:///./nodes/nodes/protocols/modbus/modbus-server.ts","webpack:///./nodes/nodes/protocols/modbus/modbus-rtu-device.ts","webpack:///./nodes/nodes/protocols/modbus/modbus-rtu-point.ts","webpack:///./nodes/nodes/protocols/modbus/modbus-rtu-network.ts","webpack:///./nodes/nodes/protocols/modbus/modbus-functions.ts","webpack:///./nodes/nodes/protocols/modbus/modbus-fc/modbus-point-methods.ts","webpack:///./nodes/nodes/protocols/mqtt/mqtt-client.ts","webpack:///./nodes/nodes/protocols/mqtt/mqtt-client-single.ts","webpack:///./nodes/nodes/protocols/mqtt/core/mqtt-device.ts","webpack:///./nodes/nodes/protocols/mqtt/mqtt-point-node.ts","webpack:///./nodes/nodes/protocols/mqtt/core/mqtt-model.ts","webpack:///./nodes/nodes/protocols/mqtt/mqtt-generic-node.ts","webpack:///./nodes/nodes/protocols/mqtt-broker/mqtt-broker.ts","webpack:///./nodes/nodes/protocols/mqtt/topic-parts.ts","webpack:///./nodes/nodes/protocols/mqtt/topic-builder.ts","webpack:///./nodes/nodes/protocols/serial-connector/serial-connector.ts","webpack:///./nodes/utils/serial-utils.ts","webpack:///./nodes/nodes/schedule/weekly-schedule.ts","webpack:///./nodes/nodes/schedule/schedule-merge.ts","webpack:///./nodes/nodes/schedule/schedule-checker.ts","webpack:///./nodes/nodes/schedule/schedule-utils.ts","webpack:///./nodes/nodes/statistics/min-max-avg.ts","webpack:///./nodes/nodes/statistics/avg.ts","webpack:///./nodes/nodes/statistics/min.ts","webpack:///./nodes/nodes/statistics/max.ts","webpack:///./nodes/nodes/statistics/sum.ts","webpack:///./nodes/nodes/statistics/median.ts","webpack:///./nodes/nodes/statistics/range.ts","webpack:///./nodes/nodes/statistics/rank.ts","webpack:///./nodes/nodes/statistics/stats-all.ts","webpack:///./nodes/nodes/streams/stream-average.ts","webpack:///./nodes/nodes/streams/stream-highest.ts","webpack:///./nodes/nodes/streams/stream-lowest.ts","webpack:///./nodes/nodes/streams/stream-sum.ts","webpack:///./nodes/nodes/streams/stream-merge.ts","webpack:///./nodes/nodes/streams/gate.ts","webpack:///./nodes/nodes/streams/stack.ts","webpack:///./nodes/nodes/streams/queue.ts","webpack:///./nodes/nodes/streams/stream-delay.ts","webpack:///./nodes/nodes/streams/stream-delay-meter.ts","webpack:///./nodes/nodes/streams/frequency-meter.ts","webpack:///./nodes/nodes/string/string-acronyms.ts","webpack:///./nodes/nodes/string/string-compare.ts","webpack:///./nodes/nodes/string/substring-cut.ts","webpack:///./nodes/nodes/string/string-join.ts","webpack:///./nodes/nodes/string/string-length.ts","webpack:///./nodes/nodes/string/string-index-of.ts","webpack:///./nodes/nodes/string/char-at-index.ts","webpack:///./nodes/nodes/string/string-split.ts","webpack:///./nodes/nodes/string/string-case.ts","webpack:///./nodes/nodes/string/char-to-ascii.ts","webpack:///./nodes/nodes/string/ascii-to-char.ts","webpack:///./nodes/nodes/string/string-buffer.ts","webpack:///./nodes/nodes/switch/bool-switch.ts","webpack:///./nodes/nodes/switch/num-switch.ts","webpack:///./nodes/nodes/switch/string-switch.ts","webpack:///./nodes/nodes/switch/bool-select.ts","webpack:///./nodes/nodes/switch/num-select.ts","webpack:///./nodes/nodes/switch/string-select.ts","webpack:///./nodes/nodes/switch/bool-output-select.ts","webpack:///./nodes/nodes/switch/num-output-select.ts","webpack:///./nodes/nodes/switch/string-output-select.ts","webpack:///./nodes/nodes/system/host-info.ts","webpack:///external \"systeminformation\"","webpack:///./nodes/nodes/system/platform.ts","webpack:///./nodes/nodes/system/system-info.ts","webpack:///./nodes/nodes/system/beep.ts","webpack:///./nodes/nodes/system/execute-cmd.ts","webpack:///./nodes/nodes/system/flow-export.ts","webpack:///./nodes/nodes/system/ip/network-interfaces-bbb.ts","webpack:///external \"network\"","webpack:///./nodes/nodes/system/ip/network-interfaces.ts","webpack:///external \"set-ip-address\"","webpack:///./nodes/nodes/system/wires-version.ts","webpack:///./nodes/nodes/time/time-conversion.ts","webpack:///./nodes/nodes/time/time-conversion-plus.ts","webpack:///./nodes/nodes/time/timezone-conversion.ts","webpack:///./nodes/utils/timezone-utils.ts","webpack:///./nodes/nodes/time/clock.ts","webpack:///./nodes/nodes/time/date.ts","webpack:///./nodes/nodes/time/time-diff.ts","webpack:///./nodes/nodes/time/stopwatch.ts","webpack:///./nodes/nodes/time/cron-interval.ts","webpack:///./nodes/nodes/time/cron-weekly.ts","webpack:///./nodes/nodes/time/cron-expression.ts","webpack:///external \"cron-validator\"","webpack:///./nodes/nodes/time/timestamp-generator.ts","webpack:///./nodes/nodes/trigger/change-of-value.ts","webpack:///./nodes/nodes/trigger/random.ts","webpack:///./nodes/nodes/trigger/inject.ts","webpack:///./nodes/nodes/trigger/interval-inject.ts","webpack:///./nodes/nodes/trigger/iterator.ts","webpack:///./nodes/nodes/widget/schedule-afterhours-off.ts","webpack:///./nodes/nodes/widget/schedule-prestart-fixed.ts","webpack:///./nodes/nodes/unknown/unknown-export.ts","webpack:///./nodes/nodes/unknown/unknown.ts","webpack:///./database/neDbDatabase.ts","webpack:///./database/datasource/AppDataSource.ts","webpack:///./database/datasource/DashboardDataSource.ts","webpack:///./database/datasource/NodeDataSource.ts","webpack:///./database/datasource/ScheduleDataSource.ts","webpack:///./database/datasource/HistorianDataSource.ts","webpack:///./database/datasource/UserDataSource.ts","webpack:///./database/datasource/AuthUserDataSource.ts","webpack:///external \"jsonwebtoken\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","log","color","doNothing","Side","Container","side","id","properties","_nodes","this","renderers","last_container_id","containers","clear","debug","rootContainer","server_dashboard_socket","server_editor_socket","client_socket","db","dashboard","type","node_class","parentContainerNodeType","show_in_menu","recursive","alwaysInsideContainer","Node","node","category","substr","lastIndexOf","node_name","length","icon","iconImageUrl","headerColor","title","onlyInsideContainer","nodes_types","container","position","pos","size","computeSize","values","filter","uniq","map","concat","stop","isRunning","last_node_id","iteration","config","globaltime","runningtime","fixedtime","fixedtime_lapse","elapsed_time","starttime","sendActionToRenderer","onStopEvent","execution_timer_id","clearInterval","renderer","deselectAllNodes","detachRenderer","push","boxcolor","theme","NODE_DEFAULT_BOXCOLOR","setDirtyCanvas","indexOf","splice","interval","onPlayEvent","getTime","that","setInterval","runStep","steps","start","transferDataBetweenNodes","now","Date","EXECUTE_INTERVAL","executeLastTime","isUpdated","UPDATE_INPUTS_INTERVAL","updateInputsLastTime","inputs","updated","onExecuteStep","onAfterExecute","elapsed","outputs","output","links","link","target_node","target_node_id","debugErr","getReadableId","target_id","target_input_id","target_slot","target_input","data","parseValue","action","params","apply","includeSubcontainers","nodes","addNodes","sub_container","addSettingsProperties","serializedNode","force","callback","container_node","shouldRejectNodeType","isNew","getNodeId","cid","settings","configure","keys","forEach","validation","setProperties","ContainerNode","setSettings","createNewNode","then","callNodeMethodOnAdded","updateLastRootNodeId","updateNode","$set","setTimeout","getId","lastNodeId","Math","max","x","Number","updateSubContainerLastNodeId","Promise","resolve","addNode","server","remove","emit","ignore_remove","afterOnRemoved","catch","err","error","disconnectInputLink","disconnectOutputLinks","selected_nodes","node_dragged","removeNode","includeSubContainers","toLowerCase","getNodesByType","nodeClass","getNodesByClass","parent","parentId","list","getAllNodes","isContainer","sort","a","b","foreground","backgroud","f","editor","only_dashboard_nodes","ser_nodes","isDashboardNode","serialize","serializedNodes","keep_old","createNode","message","warn","Type","convertStringToType","STRING","NUMBER","BOOLEAN","JSON","ANY","convertType","SettingType","DROPDOWN","BROADCAST","NodeState","convertSettingType","MIN_WIDTH","settingConfigs","linkHandler","createLinkHandler","contextMenu","clonable","flags","showIcon","convertInput","input","dataType","decimals","inputDataType","isNaN","toFixed","stringify","oldSettings","oldName","ser_node","cloneObject","setting","label","locked","round","isOptional","subNodeId","onSerialize","v","val","getInputData","setOutputData","saveSettings","saveProperties","saveInputs","saveOutputs","props","output_id","only_if_new","undefined","isRecentlyActive","slotId","exist","hasValidInput","nullable","settingName","match","items","includes","slot","extra_info","getFreeOutputId","disconnectOutput","hidden","getFreeInputId","defaultValue","description","addInput","inputsCount","getInputsCount","myID","outputNode","linksArray","replaceLinkIndex","findIndex","updateNodeOutput","immediateDirtyCanvas","ids","redrawNode","disconnectInput","target_count","diff","removeInput","getOutputsCount","addOutput","removeOutput","getLastInputIndex","getLastOutputIndex","changeWidth","computeHeight","title_width","compute_text_size","maxLabelWidth","maxNameWidth","labelWidth","nameWidth","text","width","target_input_slot","make","origin_id","origin_slot","input_slot","input_id","dirty_foreground","dirty_background","collapsed","info","onlyConnectedUsers","socket","in","inputs_values","outputs_values","nodeId","inputId","outputId","slots_values","sendMessageToEditorSide","UPDATE_SETTINGS","payload","UPDATE_PROPERTIES","UPDATE_OUTPUTS","UPDATE_STATE","nodeState","UPDATE_TITLE","UPDATE_NAME","UPDATE_VALUE","moment","format","state","broadcastNodeStateToClients","parent_container_id","parent_id","inputSettings","outputSettings","tempNode","e","ERROR","extractErrorMessage","NOTIFICATION","Utils","getFullYear","getMonth","getDate","getHours","getMinutes","parse","obj","target","sqrt","y","left","top","height","aLeft","aBottom","aRight","aTop","bLeft","bBottom","bRight","bTop","typeofVal","parseFloat","isNull","test","originalVal","formatAsPerValueType","toString","performance","digits","pow","textarea","document","createElement","textContent","style","body","appendChild","select","execCommand","ex","removeChild","filename","element","setAttribute","encodeURIComponent","display","click","day","WEEKDAYS","operatorsBoolName","operatorsMathName","operatorsBool","eq","neq","lt","lte","gt","gte","btwn","contains","regex","RegExp","true","false","null","notNull","empty","Array","isArray","Buffer","isBuffer","notEmpty","operatorsStatName","stat","array","min","range","midRange","sum","num","mean","median","mid","modes","modeMap","maxCount","variance","standardDeviation","meanAbsoluteDeviation","abs","zScores","buildUrl","host","port","schema","reduce","cv","pv","clamp","remap","inMin","inMax","outMin","outMax","renameKey","old_key","new_key","instance","cloned","pSBC","percentageChange","fromColor","toColor","useLinear","g","P","h","parseInt","isToColorString","pSBCr","split","slice","sleep","ms","isNotNull","isJSON","isString","String","isEmpty","trim","toLowerSnakeCase","replace","isFunction","func","isNumeric","isFinite","convertToNumber","strict","inString","Error","Generator","generator","mapper","args","from","to","step","union","collections","Set","unionToArray","TIME_TYPE","TimeUtils","timeOut","timeType","DAYS","HOURS","MINUTES","SECONDS","MILLISECONDS","momentValue","roundedMinutes","ceil","minute","clone","second","millisecond","timeInMs","duration","timeConvert","mm","days","hours","minutes","seconds","milliseconds","padStart","monthNames","dayNames","dts","toDateString","mnu","pad","mn","dy","getDay","dt","yr","hr","mi","ny","getSeconds","mil","getMilliseconds","thr","amp","date","yearMonthDay","year","month","monthAsNumber","dayAsNumber","dayOfYearNumber","pmOrAm","hourAsAmPm","hour","timeHourMin","time","minutesSeconds","epoch","rawDate","console","FlexibleNode","super","nullableInputs","dynamicInputsExist","dynamicOutputsExist","dynamicSettingsExist","dynamicInputsField","dynamicOutputsField","dynamicInputStartPosition","dynamicInputsStartName","dynamicOutputsStartName","dynamicInputsType","dynamicOutputsType","dynamicMinInputs","dynamicMaxInputs","dynamicMinOutputs","dynamicMaxOutputs","dynamicDefaultInputs","dynamicDefaultOutputs","addDynamicInputsOnRange","save","count","dynamicInputsCount","addedInputsCount","addInputWithName","inputCount","updateNodeInput","addDynamicOutputsOnRange","dynamicOutputsCount","addedOutputsCount","addOutputWithName","settingWiseDynamicInputsAndSettingsUpdate","startingCount","targetCount","addDynamicSettings","settingWiseDynamicInputsAndSettingsUpdateForBoolean","dynamicIndex","getInputSetting","changeDynamicInputsAndSettings","require","env","process","rubix","version","buildNb","secretKey","SECRET_KEY","PORT","dataDir","DATA_DIR","loopInterval","LOOP_INTERVAL","backendSync","enabled","BACKEND_ENABLED","baseUrl","BACKEND_API","nodeRefreshIntervalSeconds","NODE_DISTANCE","pointRefreshIntervalSeconds","NODE_REFRESH_INTERVAL_SEC","nodeDistance","POINT_REFRESH_INTERVAL_SEC","bsa","baseURL","BSA_BASEURL","username","BSA_USERNAME","password","BSA_PASSWORD","paths","measurement","path","BSA_PATHS_MEASUREMENT_PATH","accept","BSA_PATHS_MEASUREMENT_ACCEPT","alarm","BSA_PATHS_ALARM_PATH","BSA_PATHS_ALARM_ACCEPT","contentType","BSA_PATHS_ALARM_CONTENTTYPE","device","BSA_PATHS_DEVICE_PATH","ditto","DITTO_BASEURL","DITTO_USERNAME","DITTO_PASSWORD","pg","PG_BASEURL","influxDb","protocol","INFLUX_DB_PROTOCOL","INFLUX_DB_HOST","INFLUX_DB_PORT","databaseName","INFLUX_DB_DB_NAME","INFLUX_DB_USERNAME","INFLUX_DB_PASSWORD","edge28","EDGE_28_BASEURL","EDGE_28_PORT","apiVer","EDGE_28_API_VER","mqtt","MQTT_PROTOCOL","MQTT_HOST","MQTT_PORT","MQTT_USERNAME","MQTT_PASSWORD","RUBIX_VERSION","EDGES_PARENT_CONTAINER_TYPE","MODULES_PARENT_CONTAINER_TYPE","SERVICES_PARENT_CONTAINER_TYPE","EDGE_CONTAINER_TYPE","NETWORK_CONTAINER_TYPE","DEVICE_CONTAINER_TYPE","GROUP_CONTAINER_TYPE","POINT_NODE_TYPE","SERVICE_NODE_TYPE","MODULE_NODE_TYPE","IOT_TYPES","MODBUS_RTU_NETWORK","MODBUS_RTU_DEVICE","MODBUS_RTU_POINT","BACNET_NETWORK","BACNET_DEVICE","BACNET_POINT","EDGE_28_NETWORK","EDGE_28_INPUT","EDGE_28_OUTPUT","MQTT_NETWORK","MQTT_POINT_WRITE","MQTT_POINT_READ","UNKNOWN_NODE","Registry","containerId","setupSubContainer","initializeNameValue","applyTitle","from_db","configure_sub_cont","content","openContainer","updateLastContainerId","getInitialTitle","UiNode","defaultTitle","uiElementType","titlePrefix","uiPanelValue","onNodeChangePanelOrTitle","changeTitle","newSettings","newName","onNodeRemoved","sendToDashboard","panelName","storeInDatabase","mess","CryptoJS","CryptoUtils","encrypt","AES","decrypt","cipherText","enc","Utf8","Statistics","onInputUpdated","install","logger","argv","envFile","envFileAbsPath","isAbsolute","cwd","global","__rootdirname","__dirname","App","createServer","registerNodes","createRootContainer","Dashboard","dashboardSocket","dataBase","enable","connectDatabase","loadDatabase","run","Server","types","editorSocket","io","useInternalDb","importNodes","asyncLoadDatabase","res","onDbLoadSuccess","Backend","getLastContainerId","getLastRootNodeId","app","getNodes","nodesCount","cont","loadFromDatabase","contCount","startBackend","Icons","frog","aiIcon","aiColour","uiMainIcon","uiMainColour","logicMainColour","logicAndIcon","logicOrIcon","logicNotIcon","compareGreaterIcon","mathMainColour","mathMainIcon","mathAddIcon","mathSubIcon","mathDivideIcon","mathTimesIcon","edgeNetwork","PromiseActor","stack","singleton","FileUtils","dirname","__filename","dirPath","reject","fs","readdir","files","file","fileName","existsSync","open","fd","writeFile","directoryPath","directory","normalize","code","mkdir","mkdirSync","filePath","readFile","buff","fileContent","Boolean","line","index","arr","objStringify","json","msg","appendFile","edgeApi","SEND_PAYLOAD_TO_CHILD","ADD_POINT","REMOVE_POINT","edgeIp","edgePort","edgeApiVer","PointValueCreator","init","presentValue","priority","priorityArray","DefaultPointValue","normalizePriorityArray","by","pa","highestValue","entries","find","isResetState","_","createPriorityArray","k","len","prev","Mixin","entry","entryId","assign","entryFactory","namePrefix","merge","createSettingForm","broadcastSettingsToClients","broadcastTitleToClients","settingFields","applyEntry","createEntry","displayError","deactivate","removeBroadcasted","update","current","READONLY","isEqual","updateEntry","deleteEntry","getTakenIdentifiers","takenIdentifiers","identifier","makeIdentifier","globalSiblings","constructor","toUpperCase","Influx","HistoryMode","DataBaseType","HistoryBase","alarmCount","tagCount","lastTrigger","GROUP","POSTGRES","InfluxDB","addInputWithSettings","COV","PERIODIC","TRIGGER_ONLY","addHistoryConfiguration","historyFunctionsForAfterSettingsChange","assignInputsOutputs","tableNameInput","pointNameInput","resetOutputs","doPeriodicHistoryFunctions","clearStoredHisInput","updateHistoryCountOutput","doNonPeriodicHistoryFunctions","timeoutFunc","histTriggerInput","histErrorOutput","storedHistCountOutput","lastHistExportOutput","valueInput","takeValueFromInput","setSettingsConfig","groups","conditions","period","weight","periodUnits","checkTriggered","storeLogEntry","checkCOV","trySendStoredData","points","tagList","fields","timestamp","valueOf","tags","errorFlag","clientIdFromPlat","deviceIdFromPlat","getClientID","getDeviceID","multiPointPost","point","deviceid","clientid","ts","toISOString","pgUrl","method","url","writeOptions","client","database","writePoints","configSettings","changeInputDynamically","changeAlarmsCount","renameAlarmInputs","changeTagsCount","persistProperties","storageLimit","minuteRound","nearestFutureMinutes","alarmNum","j","shift","trigger","result","threshold","isPeriodic","debugInfo","changeInputsCount","alarmsToAdd","insertIntoObjectAtPosition","tagsToAdd","Logger","Colors","Grey","childNode","createMessage","parentNode","pointType","pointId","GET_BACNET_CLIENT","GET_NETWORK_SETTINGS","GET_POINTS","GET_PRESENT_VALUE","SEND_POINT_VALUE","ADD_DEVICE","REMOVE_DEVICE","WRITE_PRESENT_VALUE","Yellow","MockHasPointOutputObservers","MOCK","PointOutputObserver","outputSlots","connStatus","status","pointValue","outputSlot","convert","Base","PointNodeMixinBase","_iPresentValue","_iPriority","_iPriorityArrayLot","_iPriorityArrayJson","_sInputGroup","_sInputMethod","_sDecimal","_oOut","_oPriority","_oPriorityArray","flowHandler","initializePointBySettingObject","notifyOutput","handleOnUpdate","pointObservers","updateTitle","handleDynamicInput","initializePointBySettingInput","reEvaluateSettingByInput","inputMethod","InputMethod","enumValueOf","VALUE_PRIORITY","valueInputIdx","priorityInputIdx","PRIORITY_ARRAY_LOT","startIdx","priorityArrayInputIdx","PRIORITY_ARRAY_JSON","valueOutputIdx","priorityOutputIdx","priorityArrayOutputIdx","modelSettingKey","enumKey","presentValueType","cfg","computeTitle","st","cur","oldInputMethod","newInputMethod","hideInput","showInput","show","idx","recomputeInputLinks","ErrorHandler","MockCentralizedListener","LISTENER","eventSourceId","observers","observer","ConnectionOutput","ConnectionOutputObserver","ConnectionStatus","lookupByLabel","itselfConnected","isError","ExternalConnectionNodeMixin","ExternalConnectionNodeMixinBase","AbleEnableNode","connectionStatus","UNCONNECTED","statusOutputIdx","errorOutputIdx","isEnabled","isConnConnected","CONNECTED","DISCONNECTED","getConnectionStatus","DependantConnectionNodeMixinBase","executeFunction","getParentNode","isParentConnected","parentConnectionNode","isConnected","statusObserver","handleError","os","si","pkg","command","options","exec","stdout","stderr","hostname","cpuTemperature","fsSize","valueObject","cpu","osInfo","system","mem","CLONE","IMPORT","MOVE_TO_CONTAINER","NormalEntry","_nodeType","service_id","service_name","bsaClientConfig","auth","headers","self","getNodeType","docs","deviceID","ModbusByteOrder","TYPES","INT16","UINT16","INT32","UINT32","FLOAT32","INT64","UINT64","DOUBLE64","ENDIAN","LEB_BEW","LEB_LEW","BEB_LEW","BEB_BEW","readByteOrder","buffer","offset","endian","buf","swap16","swap32","swap64","readInt16LE","readUInt16LE","readInt32LE","readUInt32LE","readFloatLE","readDoubleLE","writeValue","alloc","writeInt16LE","writeUInt16LE","writeInt32LE","writeUInt32LE","writeFloatLE","writeDoubleLE","exp","PSYCHROLIB_UNITS","PSYCHROLIB_TOLERANCE","IP","SI","SetUnitSystem","UnitSystem","GetUnitSystem","isIP","GetTRankineFromTFahrenheit","T_F","GetTFahrenheitFromTRankine","T_R","GetTKelvinFromTCelsius","T_C","GetTCelsiusFromTKelvin","T_K","GetTCelsiusFromTFahrenheit","GetTFahrenheitFromTCelsius","GetTRankineFromTCelsius","GetTKelvinFromTFahrenheit","GetTFahrenheitFromTKelvin","GetTRankineFromTKelvin","GetTCelsiusFromTRankine","GetTKelvinFromTRankine","GetTWetBulbFromTDewPoint","TDryBulb","TDewPoint","Pressure","HumRatio","GetHumRatioFromTDewPoint","GetTWetBulbFromHumRatio","GetTWetBulbFromRelHum","RelHum","GetHumRatioFromRelHum","GetRelHumFromTDewPoint","GetSatVapPres","GetRelHumFromTWetBulb","TWetBulb","GetHumRatioFromTWetBulb","GetRelHumFromHumRatio","GetTDewPointFromRelHum","VapPres","GetVapPresFromRelHum","GetTDewPointFromVapPres","GetTDewPointFromTWetBulb","GetTDewPointFromHumRatio","GetRelHumFromVapPres","dLnPws_","dLnPws","T","BOUNDS","TDewPoint_iter","lnVP_iter","lnVP","d_lnVP","GetVapPresFromTDewPoint","TWetBulbSup","TWetBulbInf","BoundedHumRatio","Wsstar","GetSatHumRatio","GetHumRatioFromVapPres","GetVapPresFromHumRatio","GetSpecificHumFromHumRatio","GetHumRatioFromSpecificHum","SpecificHum","GetDryAirEnthalpy","GetDryAirDensity","GetDryAirVolume","GetTDryBulbFromEnthalpyAndHumRatio","MoistAirEnthalpy","GetHumRatioFromEnthalpyAndTDryBulb","LnPws","SatVaporPres","GetSatAirEnthalpy","GetMoistAirEnthalpy","GetVaporPressureDeficit","GetDegreeOfSaturation","GetMoistAirVolume","GetTDryBulbFromMoistAirVolumeAndHumRatio","MoistAirVolume","GetMoistAirDensity","GetStandardAtmPressure","Altitude","GetStandardAtmTemperature","GetSeaLevelPressure","StnPressure","TColumn","H","GetStationPressure","SeaLevelPressure","CalcPsychrometricsFromTWetBulb","CalcPsychrometricsFromTDewPoint","CalcPsychrometricsFromRelHum","compareType","s1","s2","inputType","Equals","NotEquals","GreaterThanEqual","GreaterThan","LessThanEqual","LessThan","Includes","startsWith","endsWith","some","valueWithKey","findVal","EdgeHelp","NetworkDesc","inputsDesc","outputsDesc","BACnetEnumsUnits","COMMON_METRIC","COMMON_IMPERIAL","Electrical","Energy","Enthalpy","Entropy","Force","Frequency","Humidity","Length","Light","Mass","Flow","Temperature","Time","Torque","Velocity","Volume","VolumetricFlow","Other","unitCategory","NO_UNITS","PERCENT","PERCENT_RELATIVE_HUMIDITY","DEGREES_CELSIUS","KILOPASCALS","DEGREES_FAHRENHEIT","POUNDS_FORCE_PER_SQUARE_INCH","MILLIAMPERES","AMPERES","AMPERES_PER_METER","AMPERES_PER_SQUARE_METER","AMPERE_SQUARE_METERS","DECIBELS","DECIBELS_MILLIVOLT","DECIBELS_VOLT","FARADS","HENRYS","OHMS","OHM_METERS","MILLIOHMS","KILOHMS","MEGOHMS","MICROSIEMENS","MILLISIEMENS","SIEMENS","SIEMENS_PER_METER","TESLAS","VOLTS","MILLIVOLTS","KILOVOLTS","MEGAVOLTS","VOLT_AMPERES","KILOVOLT_AMPERES","MEGAVOLT_AMPERES","VOLT_AMPERES_REACTIVE","KILOVOLT_AMPERES_REACTIVE","MEGAVOLT_AMPERES_REACTIVE","VOLTS_PER_DEGREE_KELVIN","VOLTS_PER_METER","DEGREES_PHASE","POWER_FACTOR","WEBERS","JOULES","KILOJOULES","KILOJOULES_PER_KILOGRAM","MEGAJOULES","WATT_HOURS","KILOWATT_HOURS","MEGAWATT_HOURS","WATT_HOURS_REACTIVE","KILOWATT_HOURS_REACTIVE","MEGAWATT_HOURS_REACTIVE","BTUS","KILO_BTUS","MEGA_BTUS","THERMS","TON_HOURS","JOULES_PER_KILOGRAM_DRY_AIR","KILOJOULES_PER_KILOGRAM_DRY_AIR","MEGAJOULES_PER_KILOGRAM_DRY_AIR","BTUS_PER_POUND_DRY_AIR","BTUS_PER_POUND","JOULES_PER_DEGREE_KELVIN","KILOJOULES_PER_DEGREE_KELVIN","MEGAJOULES_PER_DEGREE_KELVIN","JOULES_PER_KILOGRAM_DEGREE_KELVIN","NEWTON","CYCLES_PER_HOUR","CYCLES_PER_MINUTE","HERTZ","KILOHERTZ","MEGAHERTZ","PER_HOUR","GRAMS_OF_WATER_PER_KILOGRAM_DRY_AIR","MICROMETERS","MILLIMETERS","CENTIMETERS","KILOMETERS","METERS","INCHES","FEET","CANDELAS","CANDELAS_PER_SQUARE_METER","WATTS_PER_SQUARE_FOOT","WATTS_PER_SQUARE_METER","LUMENS","LUXES","FOOT_CANDLES","MILLIGRAMS","GRAMS","KILOGRAMS","POUNDS_MASS","TONS","GRAMS_PER_SECOND","GRAMS_PER_MINUTE","KILOGRAMS_PER_SECOND","KILOGRAMS_PER_MINUTE","KILOGRAMS_PER_HOUR","POUNDS_MASS_PER_SECOND","POUNDS_MASS_PER_MINUTE","POUNDS_MASS_PER_HOUR","TONS_PER_HOUR","Power","MILLIWATTS","WATTS","KILOWATTS","MEGAWATTS","BTUS_PER_HOUR","KILO_BTUS_PER_HOUR","HORSEPOWER","TONS_REFRIGERATION","PASCALS","HECTOPASCALS","MILLIBARS","BARS","MILLIMETERS_OF_WATER","CENTIMETERS_OF_WATER","INCHES_OF_WATER","MILLIMETERS_OF_MERCURY","CENTIMETERS_OF_MERCURY","INCHES_OF_MERCURY","DEGREES_KELVIN","DEGREES_KELVIN_PER_HOUR","DEGREES_KELVIN_PER_MINUTE","DEGREE_DAYS_CELSIUS","DEGREE_DAYS_FAHRENHEIT","DELTA_DEGREES_FAHRENHEIT","DELTA_DEGREES_KELVIN","YEARS","MONTHS","WEEKS","HUNDREDTHS_SECONDS","NEWTON_METERS","MILLIMETERS_PER_SECOND","MILLIMETERS_PER_MINUTE","METERS_PER_SECOND","METERS_PER_MINUTE","METERS_PER_HOUR","KILOMETERS_PER_HOUR","FEET_PER_SECOND","FEET_PER_MINUTE","MILES_PER_HOUR","CUBIC_FEET","CUBIC_METERS","IMPERIAL_GALLONS","MILLILITERS","LITERS","US_GALLONS","CUBIC_FEET_PER_SECOND","CUBIC_FEET_PER_MINUTE","CUBIC_FEET_PER_HOUR","CUBIC_METERS_PER_SECOND","CUBIC_METERS_PER_MINUTE","CUBIC_METERS_PER_HOUR","IMPERIAL_GALLONS_PER_MINUTE","MILLILITERS_PER_SECOND","LITERS_PER_SECOND","LITERS_PER_MINUTE","LITERS_PER_HOUR","US_GALLONS_PER_MINUTE","US_GALLONS_PER_HOUR","DEGREES_ANGULAR","DEGREES_CELSIUS_PER_HOUR","DEGREES_CELSIUS_PER_MINUTE","DEGREES_FAHRENHEIT_PER_HOUR","DEGREES_FAHRENHEIT_PER_MINUTE","JOULE_SECONDS","KILOGRAMS_PER_CUBIC_METER","KW_HOURS_PER_SQUARE_METER","KW_HOURS_PER_SQUARE_FOOT","MEGAJOULES_PER_SQUARE_METER","MEGAJOULES_PER_SQUARE_FOOT","NEWTON_SECONDS","NEWTONS_PER_METER","PARTS_PER_MILLION","PARTS_PER_BILLION","PERCENT_OBSCURATION_PER_FOOT","PERCENT_OBSCURATION_PER_METER","PERCENT_PER_SECOND","PER_MINUTE","PER_SECOND","PSI_PER_DEGREE_FAHRENHEIT","RADIANS","RADIANS_PER_SECOND","REVOLUTIONS_PER_MINUTE","SQUARE_METERS_PER_NEWTON","WATTS_PER_METER_PER_DEGREE_KELVIN","WATTS_PER_SQUARE_METER_DEGREE_KELVIN","PER_MILLE","GRAMS_PER_GRAM","KILOGRAMS_PER_KILOGRAM","GRAMS_PER_KILOGRAM","MILLIGRAMS_PER_GRAM","MILLIGRAMS_PER_KILOGRAM","GRAMS_PER_MILLILITER","GRAMS_PER_LITER","MILLIGRAMS_PER_LITER","MICROGRAMS_PER_LITER","GRAMS_PER_CUBIC_METER","MILLIGRAMS_PER_CUBIC_METER","MICROGRAMS_PER_CUBIC_METER","NANOGRAMS_PER_CUBIC_METER","GRAMS_PER_CUBIC_CENTIMETER","BECQUERELS","MEGABECQUERELS","GRAY","MILLIGRAY","MICROGRAY","SIEVERTS","MILLISIEVERTS","MICROSIEVERTS","MICROSIEVERTS_PER_HOUR","DECIBELS_A","NEPHELOMETRIC_TURBIDITY_UNIT","PH","GRAMS_PER_SQUARE_METER","MINUTES_PER_DEGREE_KELVIN","networkNode","deviceNode","pointNode","logError","alert","propertyKey","descriptor","fn","ErrorCallbackHandler","errHandler","AsyncErrorHandler","bacnet","Util","group","propertyId","getEnumName","enum","PropertyIdentifier","MQTT_CLIENT_NODE","REGISTER_MQTT_PUBLISHER","UNREGISTER_MQTT_PUBLISHER","UPDATE_MQTT_PUBLISHER","PUBLISH_MQTT_DATA","REGISTER_MQTT_SUBSCRIBER","UPDATE_MQTT_SUBSCRIBER","UNREGISTER_MQTT_SUBSCRIBER","REGISTER_MQTT_POINT","UPDATE_MQTT_POINT","UNREGISTER_MQTT_POINT","MqttCentralizedPointOutputObserver","CentralizedPointOutputObserver","publisherTopic","publishedTopic","subscriberTopic","subscribedTopic","MqttClientNode","ProtocolDeviceNode","_oTopicsSlot","publishers","MqttPublisherStore","subscribers","MqttSubscriberStore","mqttClient","retriedItems","mixinEnableInputSetting","PASSWORD","authentication","registerMqttPoint","updateMqttPoint","unregisterMqttPoint","register","afterUnregister","unregister","registerMqttSubscriber","updateMqttSubscriber","unregisterMqttSubscriber","publishMqttData","debugWarn","listNodeIds","subscribersByTopic","lookup","topic","createMqttConnectionOptions","clientId","DefaultMqttClient","retryConnection","updateClientStatus","onReceiveMessage","errMsg","notifyConnStatusOutput","listen","lenient","converter","publish","subscribe","mqttClientDoUnsubscribe","has","unsubscribe","item","toPublisher","toSubscriber","registerNodeType","ContainerUtils","containersIds","subContainerIds","createdNodes","nodesWithLinks","updateInput","isChanged","nodeWithLink","connectedNode","updateOutputs","importedNodes","originalNodes","updateSettings","originalNode","getNodeById","nodesIdMap","paramsCid","firstCid","allNew","containersIdMap","lastContainerId","convertedParamsCid","containerNodes","isCloned","minImportXCoordinate","minImportYCoordinate","startingXCoordinate","startingYCoordinate","containerIds","resCid","getSortedAvailableContainers","selectedNodes","createContainersIfDoesNotExist","isFirstContainer","addInputsLinkNodes","addOutputsLinkNodes","addSettingsValues","respKey","extractData","assignAllTo","factoryEntry","response","factory","ApiContainerNode","extra_node_types","childNodeType","movable","findFreeIdentifier","api","initAPI","delete","onAdded","runWithEditor","old","onAfterSettingsChange","onCreated","nameSuffix","onRemoved","fetchChildren","children","childIds","childNodes","collectChildNodes","existingChildNodes","is_protected","processNextChildEntry","onGetMessageToEditorSide","remaining","pop","existingNode","syncWithBackend","persistConfiguration","nodeType","TopLevelApiContainerNode","removable","schemaMiddleware","req","next","validate","details","join","authMiddleware","token","isAuthenticated","CONTAINER_NODE_TYPE","AbstractFolderIONode","isUnderContainer","emitChange","correctParentIO","s_node","prop","containerNode","inputOrOutput","insert","after","before","newObj","insertAfter","matchBoth","foundFlag","TAGNAME","CHILLER","CHWP","PlantChilledWater","BuildingInfo","HeatExchanger","CoolingTower","CWP","PlantCoolingTower","Boiler","HWP","BoilerPlant","FloorControl","AHU_VAV","AHU_CAV","FCU","FTU","PAC_HotWaterReheat","PAC_ReverseCycle","PAC_ElectricReheat","PAC_Electric_Reheat_WaterCooled","OutsideAirFan","SupplyAirFan","ReturnAirFan","AHUReturnAirFan","CarParkSupplyAirFan","CarParkExhaustAirFan","ToiletExhaustAirFan","KitchenExhaustAirFan","ExhaustAirFan","GeneralExhaustAirFan","VAV","Power_SubMeter","PowerSiteMeter","Gas_SubMeter","Gas_SiteMeter","Water_subMeter","Water_SiteMeter","tagRefs","acronyms","BMS","RTD","AHU","CW","RTU","RH","EVP","CT","CTF","RT","RAT","SAT","ZT","CHL","BLR","AC","RAC","EVAP","HVAC","HLI","BTU","CMD","REM","SYS","RV","SOL","DX","BACnet","LoRa","KNX","LoRaWAN","Modbus","LON","N2","SP","SETP","LIQ","PMP","TEMP","TMP","PRESS","EEV","DISCH","tagCategory","kind","unit","equipType","BasePointNode","previousAdvancedSetting","advancedSetting","reload","jwt","Authorization","urls","getAsyncUsers","user","urlJson","findUrl","filterPoint","setProps","EdgeGPIOUtils","value_420","min_target","max_target","ui_value","min_range","max_range","scaleToGPIOValue","minOutput","maxOutput","minInput","maxInput","pinValue","scaleFromGPIOValue","uiAsDI","diInvert","MATH_FUNC_TYPE","MathUtils","out","mathFuncType","mathValue","NA","ADD","SUBTRACT","MULTIPLY","DIVIDE","REMAINDER","EXP","BOOL_INVERT","invert","ONE_TO_TRUE","oneToTrue","TRUE_TO_ONE","trueToOne","NUMBER_INVERT","numInvert","validateNumbers","every","BACNET_SERVER_NODE_TYPE","REGISTER_BACNET_POINT","UPDATE_BACNET_POINT","PUSH_BACNET_POINT_VALUE","UNREGISTER_BACNET_POINT","BACNetCentralizedPointOutputObserver","objectId","objectInstance","objectType","objectName","BacnetNodeServerStore","OneIdentifierOneNodeStore","errors","BACnetServerNode","_oPointsSlot","store","afterRegister","afterUpdate","pushValue","broadcastNameToClients","PointKind","lookupByValue","bp","BacnetPointCreator","deviceId","databaseRevision","address","broadcast","apduTimeout","addPoint","updatePoint","updateValue","delObject","DefaultContainerErrorNode","nodeIdErrors","add","AbstractContainerStore","cb","checkExistence","afterUnregisterIfExisted","addError","alreadyExistedMsg","removeError","listErrors","predicate","_title","mixinConnectionStatusOutput","startOrStop","DefaultObservable","kickoff","createThenStart","statusObservable","connObserverNodes","notify","handleErrorInKickOff","Enumify","enumValues","closeEnum","enableSettingKey","enableDescription","enableInputIdx","parentIsEnabled","nodeUtil","propertyTypeMap","pi","typeEnumMap","OBJECT_TYPE","ObjectType","typeId","readOnly","subscriptions","getPropName","callbacks","_value","newValue","onPropertyChanged","valueAsString","inspect","custom","enumKeys","pk","ANALOG_INPUT","ANALOG_OUTPUT","ANALOG_VALUE","BINARY_INPUT","BINARY_OUTPUT","BINARY_VALUE","MULTI_STATE_INPUT","MULTI_STATE_OUTPUT","MULTI_STATE_VALUE","DefaultBacnetPoint","LORA_DATA_TYPE_NAMES","LORA_DATA_TYPE_LENGTHS","LoRaRawTwoWayInput","payloadDefinition","stringToDataTypes","substring","senderId","parseError","pointParsed","fill","readUInt8","type_length","INT8","readInt8","UINT8","FLOAT","outputsCount","str","publisher","subscriber","ps","OneIdentifierManyNodeStore","UuidUtils","dataArray","isUUID","createDirectory","create8DigId","createUUID","random","create12DigId","ip","network","cp","get_interfaces_list","iface","upDown","newIP","netNetmask","newGateway","newNameserver","checkIP","isV4Format","checkNetMask","checkGateway","nameserver","execSync","setIpDHCP","ipAddress","subnetMask","gateway","setIP","setNodeState","ensureParentContainers","refreshPeriodically","findOrCreateNode","EdgesParentContainerNode","edgesContainer","ModulesParentContainerNode","modulesContainer","ServicesParentContainerNode","servicesContainer","type_name","root","newNode","refreshParentContainers","DefaultLinkHandler","actualSlot","targetNode","number","targetNodeId","targetInputId","targetSlot","EdgeContainerNode","EdgeAPI","customer_code","side_code","model","firmware_version","data_version","NetworkContainerNode","NetworkAPI","protocols","DeviceContainerNode","edge_node","errorMessage","DeviceAPI","manufacturer","GroupContainerNode","PointNode","network_node","edge_id","FolderAPI","device_node","folder","PointAPI","edge","measure_unit","precision","backend","Point","fetchPointData","updatePointData","device_id","Api","_objId","fetchMany","objId","fetchOne","patch","newEntry","Edge","post","Network","Device","Folder","put","ModuleNode","ModuleAPI","ServiceNode","ServiceAPI","BaseServiceNode","required_settings","service_type","published_by","deploy_id","deploy_location","created_at","modified_at","settingsHeaderComponent","template","areSettingsValid","displayMessage","broadcastPropertiesToClients","ApplicationAPI","Service","ApiNode","uiPanels","getUiPanels","removeElementForNode","removeEmptyPanels","sendUiPanel","newPanelName","newTitle","uiElemet","newPanel","getUiPanel","subPanels","uiElements","updateUiPanel","addUiPanel","getUiPanelsList","changed","panel","pan","removeUiPanel","oldPanel","subPanel","expressValidator","workingDir","express","locals","middleware","routes","handleErrors","start_io","webServer","use","morgan","skip","statusCode","bodyParser","limit","urlencoded","extended","cookieParser","publicFolder","static","send","normalizePort","set","http","on","syscall","exit","addr","io_root","EditorServerSocket","DashboardServerSocket","wireNameSocket","WireNameServerSocket","pingPongSocket","PingPongServerSocket","of","room","leave","checkContainerNodeValidity","sendSlotsValues","connectedSocket","connected","rooms","slotsValues","getNodesIOValues","formatAndTrimValue","httpServer","socketServer","SocketIO","handshake","router","Router","render","container_id","query","nodeEditor","redirect","sendNotFoundError","remapContainersId","fallbackNodeIfDoesNotExist","remapNodesId","adjustPosition","sortNodes","updateInputs","exportNodes","addSubContainerNodes","removeNodes","activeNodesIds","exportedNodes","newContainerNode","pushNewWrapperContainer","removeBrokenLinks","moveNodesToNewContainer","getInputInfo","connect","subcontainers","headersSent","wire","getWireName","changeWireName","createFile","encoding","wireName","Joi","authUserSchema","string","route","authUser","addAuthUser","getAuthUser","deleteAuthUsers","getAuthToken","stringHtml","getHelpComment","changeHelpComment","platform","getPlatform","updatePlatform","BSACumulocityDeviceNode","createDevice","checkDeviceExists","deviceName","getDeviceName","managedObjects","c8y_IsDevice","BSACumulocityNode","measurementName","measurementType","seriesName","source","measurements","ALARM_TYPE","alarmConfig","WARNING","MINOR","MAJOR","CRITICAL","BSACumulocityAlarmNode","postAlarm","alarmInput","alarmName","severity","alarmID","AndNode","allInputs","getDefinedInputValues","areAllInputsTrue","OrNode","anyTrue","XorNode","in1","in2","NotNode","emitTransformedInput","ToggleNode","lastVal","OneShotNode","lastFireValue","lastResetValue","timeUnits","reset","clearTimers","fire","delay","delayMilli","remainingFunc","remainingUpdateMillis","remainingUpdateSize","clearTimeout","MinOnOffNode","minOn","timeMinOn","minOff","timeMinOff","timeOn","timeOff","minOnEnabled","minOffEnabled","minOnTime","minOffTime","hasInput","lastValue","DelayOnNode","lastInput","lastReset","DelayOffNode","TickerNode","lastInterval","runState","EqualNode","GreaterNode","LessThanNode","BetweenNode","HysteresisNode","inMsg","risingEdge","fallingEdge","TypeCheckNode","ConnectionLocalTransmitterNode","receivers","getReceivers","updateTransmitterTopics","isEnable","channel","ifNew","receiver","blockNull","ConnectionLocalReceiverNode","topicList","transmitterTopic","updateChannel","broadcastOutputsToClients","transmitters","transmitter","pushSettings","changeTopicsCount","renameInputs","triggerTransmitterNodeUpdate","HubNode","inputValue","ContainerInputNode","findParentOutputById","ContainerOutputNode","recomputeOutputLinks","BoolToIntNode","IntToBoolNode","StringToBool","BitMaskSingle","BIT","BYTE","BitMaskMultiple","mask","updateMask","BIT_START","IntToBits","setNewOutputs","START","BYTES","outputIndex","outputsLen","ByteArrayToIntNode","dataEndian","UnitConversionNode","TREE_SELECT","ensureFromToConfig","createTreeSelectItems","toJSON","asItem","measures","unitType","possibilities","categoryName","units","IntToFourByteArrayNode","EventCounterNode","inputUpdated","inputData","CounterNode","lastUp","lastDown","up","down","setValue","TriggeredRamp","countUp","currentVal","IntervalRampNode","lastEnable","WaveformNode","intervalTime","periodTime","amplitude","startTime","lastTime","recalculate","signalType","sin","PI","sign","CSVMergeRowsNode","outputCSV","addCSV","CSVMergeColumnsNode","originalColumnsArray","mergeColumnsArray","originalColumnsCount","mergeColumnsCount","FunctionNode","BaseFunctionNode","mixinScriptSetting","executeConfiguredScript","getScriptInput","emitResult","emitError","variables","NodeVM","timeout","sandbox","defaultScript","CODE_AREA","UiLabelNode","formatValue","setState","UiButtonNode","buttonText","sendIOValuesToEditor","UiSwitchNode","getState","UiProgressNode","UiSliderNode","UiTextBoxNode","UiLogNode","messagesPerSec","updateMessPerSec","maxRecords","removeOldRecords","sendMessageToDashboardSide","rec","unshift","records","del","dropped","record","$push","$each","$slice","$unset","UiChartNode","ConsoleNode","MAX_MESS_PER_SEC","timer","NotesNode","nodeColour","INFO","WatchNode","dataUpdated","UPDATE_INTERVAL","startSending","lastData","showValueOnInput","FiltersOnlyTrueNode","FiltersOnlyFalseNode","FiltersOnlyFromRangeNode","FiltersOnlyGreaterNode","FiltersOnlyLowerNode","FiltersOnlyEqualNode","FiltersPreventNullNode","FiltersPreventEqualNode","FiltersPreventDuplicatesNode","AnyDataStoreNode","pointName","someMoment","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","dateTz","timeFormatedArray","reverse","tz","csvString","_d","formatOutputs","InfluxDBNode","createClient","nodeName","measurementHas","measurementTags","measurementFields","tagObj","HistoryNode","addHistorySettingsConfig","PointPersistence","PointTagNode","siteId","clientName","siteName","siteAddress","equipRef","tagSetting","tagType","pointArr","pointTags","DeadbandNode","setpoint","deadband","ThermostatNode","clgMode","htgMode","clgSP","PID","PIDFunctionNode","lastResetVal","pid","minOut","maxOut","inP","inI","inD","setSampleTime","setOutputLimits","setMode","setOutput","setBias","compute","getOutput","initialize","manual","processVariable","direction","bias","setPoint","setTunings","setControllerDirection","setInput","calculatePidOutput","Input","Setpoint","Kp","Ki","Kd","ControllerDirection","mySetpoint","inAuto","SampleTime","millis","myBias","ITerm","myOutput","current_value","setDirection","ki","dInput","kp","kd","dispKp","dispKi","dispKd","SampleTimeInSec","NewSampleTime","ratio","Min","Max","Mode","newAuto","getKp","getKd","getKi","getMode","getDirection","controllerDirection","getInput","getSetPoint","getBias","ToggleDurationNode","runtime","remainingMins","runtimeVal","onExecute","psychrolib","PsychrometricCalculationsNode","psychro","setConversionFunction","onInputOrSettingsChange","input1","input2","input3","clearOutputs","outputArray","conversionFunction","in3","EnergyUnitConversionNode","PowerUnitConversionNode","VolumeUnitConversionNode","TempConvertNode","conversion","AtmosphericPressureNode","updateTitleAndFunction","altitude","pressure","PressureConvertNode","ArrayBuilderNode","JSONBuilderNode","filterKeys","addInputs","getFilterKeys","dynamicOutputStartPosition","sortBy","JSONEnumBuilderNode","definition","JsonFilter","jsonCheck","JsonFilterCompare","string2","compare","JsonFilterMultiple","addOutputs","updateOutputsLabels","JsonCheckerNode","isJson","JsonParse","AnyLatchNode","latch","lastLatchValue","BoolLatchNode","NumLatchNode","StringLatchNode","SetResetNode","lock","AddNode","total","MathSubNode","MathMultiplyNode","MathDivideNode","div","MathAbsNode","MathModulusNode","MathPowNode","MathAcosNode","acos","MathAsinNode","asin","MathAtanNode","atan","MathCbrtNode","cbrt","MathCosNode","cos","MathExpNode","MathLogarithmNode","log10","MathSinNode","MathSqrtNode","MathTanNode","tan","TriggerAddNode","MathTriggerSubNode","MathTriggerMultiplyNode","MathTriggerDivideNode","MathTriggerModulusNode","MathTriggerPowNode","NumSeriesGenerator","factor","AddressHelperString","outputs_count","changeOutputsAndSettings","renameInputsOutputs","changeMyOutputsCount","changeOutputsCount","prepend","append","NubeLoginNode","setExecuteInterval","getJwtToken","removeUser","addOrUpdateUser","NubeAPIInputPoint","updateNodeOutputs","fetchConnection","fetchPoints","fetchPointValue","setOutputs","setErrorOutputs","formattedExecutionTime","scale","historySettings","NubeAPIOutputPoint","getConfigItems","writePointValue","configItems","getInputAsJsonString","priorityLevel","ApiSchedules","BaseEdge","suffixApi","fetchSchedules","btoa","GetSchedulesNode","getDittoSchedules","dittoUrl","MathDecimalPlaceNode","MathFloorNode","floor","MathCeilNode","LimitNode","ScaleNode","LinearShaperNode","inputCountBefore","renameInputsAndSettings","updateInputsLabels","pointFormatted","stepSize","stepIndex","valueAtPosition","positionInStep","startValueIndex","startValue","endValue","TimeFadeNode","updateInterval","timerFinished","RateLimitNode","BoolConstantNode","NumConstantNode","StringConstantNode","JsonConstantNode","passNull","BoolPriorityNode","NumWritableNode","StringPriorityNode","GenericNode","addPrioritySettings","addHistorySettings","addPrioritySettingsConfig","priorityOnCreated","historyOnCreated","doPriorityFunctions","doHistoryFunctions","priorityFunctionsForAfterSettingsChange","HistoryConfig","isOutput","history_group","databaseType","useInterval","clientIDfromPlat","deviceIDfromPlat","foundDeviceID","foundClientID","inputVal","typeOfVal","valAsNum","setPeriodicLogging","isNumber","findMainContainer","PriorityConfig","input_group","inputName","inputNumber","highestPriorityIndex","initializePriorityArray","removeInputAtPosition","updatePriorityInputsFromSettings","addInputAtPosition","removeAll","startPosition","settingsArray","inputsArray","inputArrayatY","inputArrayatX","EmailNode","services","service","pass","subject","nodemailer","createTransport","sendMail","Edge28ApiNode","pointNodes","inAlarmTrigger","inHistoryTrigger","inInput","outVal","outError","outMessageJson","outAlarm","_ui","_di","UI_timeoutFunc","DI_timeoutFunc","startInputPolling","pollUIs","sendPayloadToPointNodesFunc","pollDIs","edgeReadUI_Store","edgeReadDI_Store","sendPayloadToChild","pointsDI","pointsUI","pollInputsAndSend","POINT_TYPE","POINT_TYPE_TEXT","Edge28InputPointNode","DIGITAL","UI_DIGITAL","_0_10DC","_0_20MA","_4_20MA","_10K_THERMISTOR","isDigitalType","pointEnable","pointDebug","pointNumber","lowScale","highScale","mathFunc","unitsType","sendPointValue","removePoint","pointOffset","NORMAL","sendJson","pointTypeText","mathSwitch","pointCalcs","limitValDc","limitValMaZero","limitValMaFour","scaleUI420ma","scale420maToRange","calc10kThermistor","uiType","Edge10kSensorUtils","raw10K","temps10K","OUTPUT_POINT_TYPE","OUTPUT_POINT_TYPE_TEXT","Edge28OutputPointNode","uuid","deviceContainerID","newSetting","DO","UO_AS_DIGITAL","UO_AS_0_10DC","lastSendTime","inputChange","apiCall","nodeVal","Edge28LORAResetNode","resetLORAConnect","BACnetNetwork","bacnetClient","inputWhoIs","deviceNodes","outputOut","outputMsg","outputError","initializeBacnetClient","iAm","whoIs","networkNumber","networkNumberWhoIs","net","interface","closeBacnetClient","close","Bacnet","broadcastAddress","networkSettings","Poll","BACnetDevice","isFirst","isPolling","shouldPoll","delayBetweenDevice","delayBetweenPoint","setBacnetClient","setPayloadsToPointNodes","addDevice","updateNetworkSettings","requestPoll","removeDevice","getNetworkSettings","persistSettings","pntList","currentPollValue","polling","STOP","scanDeviceFunc","getBacnetClient","deviceAddress","tag","writeProperty","adr","requestArray","DEVICE","OBJECT_LIST","readPropertyMultiple","readObject","OBJECT_IDENTIFIER","OBJECT_NAME","DESCRIPTION","UNITS","PRESENT_VALUE","readProperty","errorClass","objectInfo","objectProperties","findValueById","readObjectList","objectArray","readObjectFull","deviceObjects","mapToDeviceObject","readPresentValue","writePresentValue","pollingFunc","selectPoint","manualPoint","BACnetPoint","pointsList","getPoints","setPointsListItems","getPresentValue","objectTag","pointWriteEnable","getNetworkNumber","setPointValue","bacnetPointName","assert","BE","BACnetObject","BACnetObjectProperty","deviceInfo","hostInfo","covListener","dev","APDU_TIMEOUT","_settings","getProperty","header","expectingReply","sender","forwardedFrom","enumType","confirmedService","ConfirmedServiceChoice","UnconfirmedServiceChoice","errorResponse","invokeId","ErrorClass","SERVICES","ErrorCode","REJECT_UNRECOGNIZED_SERVICE","ttl","bdt","resultResponse","BvlcResultFormat","SUCCESSFUL_COMPLETION","lowLimit","highLimit","SEGMENTATION_SUPPORTED","VENDOR_IDENTIFIER","iAmResponse","getObject","OBJECT","UNKNOWN_OBJECT","property3","PRIORITY_ARRAY","value2","encodePropValue","PROPERTY","UNKNOWN_PROPERTY","priorityValue","priorityNum","priorityArr","q","aa","pri","arrType","addProperty","ApplicationTags","REAL","simpleAckResponse","INVALID_ARRAY_INDEX","propertyName","objectIdName","READ_PROPERTY","readPropertyResponse","responseList","propGroup","propListFriendly","ASN1_MAX_PROPERTY_ID","ObjectTypesSupported","propList","ALL","getAllPropertyIds","PROPERTY_LIST","ASN1_ARRAY_ALL","errorCode","readPropertyMultipleResponse","monitoredObjectId","sub","subscriberAddress","subscriberProcessId","lifetime","issueConfirmedNotifications","sendPropertyCov","OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED","monitoredProperty","monitoredIndex","confirmedCOVNotification","encodedValue","BIT_STRING","createBitstring","NULL","UNSIGNED_INTEGER","SIGNED_INTEGER","DOUBLE","CHARACTER_STRING","ENUMERATED","OBJECTIDENTIFIER","typeName","SYSTEM_STATUS","DeviceStatus","OPERATIONAL","VENDOR_NAME","MODEL_NAME","FIRMWARE_REVISION","APPLICATION_SOFTWARE_VERSION","PROTOCOL_VERSION","PROTOCOL_REVISION","PROTOCOL_SERVICES_SUPPORTED","ServicesSupported","CONFIRMED_COV_NOTIFICATION","SUBSCRIBE_COV","READ_PROPERTY_MULTIPLE","WRITE_PROPERTY","I_AM","WHO_IS","SUBSCRIBE_COV_PROPERTY","MAX_APDU_LENGTH_ACCEPTED","Segmentation","SEGMENTED_BOTH","NUMBER_OF_APDU_RETRIES","DEVICE_ADDRESS_BINDING","DATABASE_REVISION","dynamicProperties","objects","adpuTimeout","onUnhandledEvent","onRegisterForeignDevice","onWhoIs","onWriteProperty","onReadProperty","onReadPropertyMultiple","onSubscribeCov","onSubscribeProperty","reinitializeDevice","ReinitializedState","COLDSTART","bacnetPoint","isInteger","PRIORITY","objectTypeId","MandatoryProperties","PROTOCOL_OBJECT_TYPES_SUPPORTED","STATUS_FLAGS","EVENT_STATE","EventState","OUT_OF_SERVICE","EngineeringUnits","ignoreProps","propertyList","selfTypeId","missingProperties","selfName","missingPropertyNames","objectList","objType","objectsOfType","typeList","onObjectPropertyChanged","fullPropList","keyName","typeGroup","DEVICE_TYPE","OCTET_STRING","RELIABILITY","RELINQUISH_DEFAULT","BACnetServerPointNode","DependantConnectionNodeMixin","PointNodeMixin","mixinPointValueInputOutput","cast","listener","event","createPayload","mightOnlyValueChanged","equals","cov","changedOfValue","createPointValue","SensorType","LoraSensorDecoderNode","watchdogDelay","nodeID","Droplet","MicroEdge","watchdog","microEdgeA1","microEdgeA2","microEdgeA3","sensorType","resetWatchdog","writeOutputs","dropletDecode","microEdgeDecode","watchdogTime","microEdgeOutputs","MicroEdgeAnalogs","analogInputs","Vref","V","R0","R","temp","topicsBuilder","pulses","voltage","a1","a2","a3","rssi","snr","lastMessage","lastMessageTimeStamp","humidity","lux","movement","b1Sensor","b2_sensor","currentSensorType","LoRaRawTwoWayOutput","inputsUpdated","checkInputAndType","isOk","data_lengths","writeUInt8","writeInt8","LoRaRawTwoWayTest","ModbusRTU","ModbusServerNode","tcpServer","createModbusServer","closeTcpServer","coils","registers","unitId","minAddress","maxInputAddress","maxAddress","bufferFactor","vector","getCoil","unitID","getInputRegister","readUInt16BE","getHoldingRegister","setCoil","setRegister","writeUInt16BE","readDeviceIdentification","0","salveAddress","once","ServerTCP","ModbusSerialDeviceNode","outStatus","ipPort","ping","transport","sock","Socket","destroy","ModbusPointNode","outModbusMessage","outArray","pointTimeout","pointLimitEnable","limitLow","limitHigh","valOffset","valPrecision","lastInputState","Transport","ModbusSerialNetworkNode","rs485DeviceName","isPortOk","isPortInUse","serialPortStatus","pollEnableSetting","tcpClients","outPortStatus","outPortMsg","TCP","baudRate","parity","dataBits","stopBits","devicePolling","registerDelay","container_db","devicesPoints","devices","getDevice","nodeDetailsMessage","sub_id","setupForPolling","poll","connectRTUBuffered","FIRST_START","pollDevicesPoints","getDevicesPoints","errorOnModbusDevicesExec","deviceCID","deviceAddressOffset","deviceObj","existingTcpClients","getTcpKey","isOpen","connectTCP","sendDeviceError","errorOnModbusPointsExec","pntAddr","pntType","pntOffset","pntVal","pntCid","pntId","pntDataType","pntDataEndian","modbusMethods","sendPointMessage","sendDeviceMessage","sendPointError","networkEnable","DO_NOT_INIT","typeDevice","cidDevice","getNodeByQuery","doc","deviceSubCID","deviceTimeout","pntMathFunc","pntMathValue","pntTimeout","pointVal","ModbusMethods","regAddr","regLength","nodeInputValue","funcType","methodType","dataTypeCase","thisInstance","pointAddress","ft","pntSwitch","setID","readBool","nubeType","nubeAnalogueRead","matchMQTT","topicsCount","messageQueue","rateLimitMS","useEnv","topics_count","connectToBroker","end","disconnectFromBroker","topics","processQueue","mqttMessage","outputNum","msgAsNum","toFixedNumber","outInd","setMQTTOutput","MqttClientSingleNode","inName","inEnable","inData","inTopic","enableDebug","qos","processMessage","retain","callbackWhenConnected","callbackWhenOffline","callbackIncomingMessage","connack","packet","cmd","onConnect","onClose","onDisconnect","onEnd","onError","onOffline","onPacketReceive","onPacketSend","onMessage","MqttPointNode","_iTopic","_sReqRes","mqttPoint","createMqttPointStoreItem","topicInputIdx","mqttTopic","isReqRes","SillyMqttPoint","MqttPointCreator","MqttPointValue","incomingMessage","MqttPointStoreItem","onConvertMessage","DefaultMqttPoint","MqttGenericNode","MqttGenericNodeMixinBase","unregisterAction","shouldRegister","registerAction","updateAction","doAfterUpdate","MqttGenericNodeMixin","mixinMqttTopicInputSetting","MqttBroker","stopBroker","decryptPass","statusBroker","startBroker","checkAuthentication","passwordFile","allowAnonymousIndex","allowAnonymous","allowAnonymousArray","passwordRefIndex","passwordRef","passwordRefArray","unlink","MqttTopicPartsNode","MQTTTopicBuilderNode","SerialPort","SerialConnectorNode","baudRates","closePort","connectToSerialPort","writePortData","listPorts","portName","autoOpen","Readline","parsers","pipe","delimiter","readPortData","write","portList","ports","WeeklyScheduleNode","daysArray","guess","makeHoursDropdown","makeMinsDropdown","startHour","startMin","endHour","endMin","scheduleOutput","weekly","events","schedID","tzOffset","utcOffset","offsetHours","offsetMins","rolloverFlag","startHourUTC","startMinsUTC","endHourUTC","endMinsUTC","sundayIndex","saturdayIndex","daysOutput","colour","hoursArray","minsArray","ScheduleMergeNode","inputString","inputObject","weeklyOutput","eventOutput","weeklySched","eventSched","ScheduleChecker","nextStart","nextStop","schedulePayload","zone","weeklyScheduleOutput","sched","ScheduleUtils","checkWeeklySchedule","scheduleStatus","isBefore","eventsOutput","eventScheduleOutput","checkEventsSchedule","eventSchedule","nextOn","nextOff","scheduleValue","dates","dtUTC","startMoment","endMoment","isAfter","weeklySchedule","getISOday","startArray","part","endArray","startMomentArray","isoWeekday","endMomentArray","subtract","MinMaxAvgNode","getDefinedInputsOrSettingsValues","avg","AvgNode","MinNode","MaxNode","SumNode","MedianNode","RangeNode","RankNode","outputCount","AnyStatAllNode","NumbersAverageNode","resetToNull","NumbersHighestNode","NumbersLowestNode","NumbersSumNode","StreamMergeNode","GateNode","StackNode","QueueNode","DelayNode","delayedValues","DelayMeterNode","TimeFrequencyMeterNode","countWas","StringCaseAcronymsNode","StringCompareNode","string1","TextCutSubstringNode","StringJoinNode","TextStringLengthNode","StringIndexOfNode","searchFor","TextCharAtIndexNode","TextSplitStringsNode","currentIndex","lastStart","lastNext","splitNext","separator","splittedText","StringCaseChangeNode","toTitleCase","phrase","word","charAt","setTitleAndConversionFunction","TextASCIICodeNode","charCodeAt","TextASCIICharNode","fromCharCode","StringBufferNode","useTrigger","bufferData","lastSend","lastClear","lastAdd","addTrigger","triggerInput","BoolSwitchNode","inA","inB","NumSwitchNode","StringSwitchNode","BoolSelectNode","NumSelectNode","StringSelectNode","BoolOutputSelectNode","active","NumOutputSelectNode","StringOutputSelectNode","HostInfo","systemInfo","systemTime","systemMem","callSystemInfo","callInfo","PlatNode","haystackSite","haystackAbout","serverName","hostName","productVersion","getCurrentWiresVersion","globalSettings","vendorName","deviceIDFixed","deviceIDcustom","doUUIDSteps","clientID","siteID","checkForOldDirectory","isUUIDFile","makeUUIDFile","getDeviceUUID","SystemInfo","settingsConfig","settingsText","filteredNodeSettings","settingValue","outType","totalmem","freemem","networkInterfaces","uptime","homedir","arch","loadavg","getSysInfo","SystemBeepNode","SystemExecuteNode","FlowExport","UpdateIPEdge28","timeStamp","getTimeStamp","interfaceEth0","eth0Ip","messageOutput","errorOutput","msgOut","newIpEth0","netNetmaskEth0","newGatewayEth0","newNameServerEth0","getInterfaces","enableInterfaceEth0","enableNetwork","disableNetwork","interfaceTypeEth0","writeChanges","reboot","checkIpSettingsEth0","checkIpValid","bbbGetInterfaceDetails","bbbSetIPDHCP","bbbSetIPFixed","nodeColourChange","getActiveNetworks","getInterfaceEth0","ip_address","networkUpDown","set_ip_address","UpdateIP","interfaceEth1","eth1Ip","newIpEth1","netNetmaskEth1","newGatewayEth1","newNameServerEth1","enableInterfaceEth1","interfaceTypeEth1","checkIpSettingsEth1","interfacesArray","eth0","dhcp","subnetMaskLength","subnet","prefix","nameservers","eth1","getInterfaceEth1","WiresVersion","getNodeJsVersion","getNPMVersion","TimeConvertNode","TimeConvertPlusNode","TIME","EPOCH","NEW_TS","timeSelection","timeConvertPlus","TimezoneConvertNode","tsCategory","local","region","tsType","TimezoneUtils","africaZones","americaZones","antarcticaZones","asiaZones","atlanticZones","australiaZones","europeZones","indianZones","pacificZones","ClockNode","advanced","DateNode","dayString","toLocaleDateString","TimeDiffNode","date1","date2","diffTime","diffTotals","years","months","StopwatchNode","lastRunVal","CronJob","jsonata","construe","CronIntervalNode","job","jobCronExp","dayBetweenStart","dayBetweenEnd","cronSetting","nextJobs","evaluate","cronType","cronExp","nextDates","jsonataQuery","CronWeeklyNode","cronValidator","CronExpressionNode","valid","isValidCron","TimestampGeneratorNode","unix","COVNode","RandomNode","TriggeredInjectNode","InjectNode","TimeIteratorNode","complete","lastStop","reqInterval","reqIterations","iterations","ScheduleAfterhoursOffWidgetNode","currentMode","remainingRuntime","AHRuntime","modeInput","startSchedule","startAfterhours","schedInput","AHDuration","SchedulePrestartFixedNode","condition1_range1","condition1_range2","condition1_time","condition2_range1","condition2_range2","condition2_time","condition3_range1","condition3_range2","condition3_time","condition4_range1","condition4_range2","condition4_time","condition5_range1","condition5_range2","condition5_time","condition6_range1","condition6_range2","condition6_time","condition7_range1","condition7_range2","condition7_time","condition8_range1","condition8_range2","condition8_time","condition9_range1","condition9_range2","condition9_time","condition10_range1","condition10_range2","condition10_time","fromRange","toRange","UnknownNode","NeDbDatabase","authUserDatabase","userDatabase","nodeDatabase","dashboardDatabase","appDatabase","scheduleDatabase","historianDatabase","cleanUpInterval","CLEANUP_INTERVAL","addUser","getUsers","getUser","updateUser","getUsersCount","dropUsers","getNode","dropNodes","dropUiPanels","dropApp","schedule","addSchedule","updateSchedule","removeSchedule","history","addHistory","updateHistory","removeHistory","NeDBDataStore","persistence","setAutocompactionInterval","loadApp","findOne","_id","last","upsert","multi","loadDashboard","removed","load","loadSchedule","updatedCallback","removedCallback","loadHistory","users","loadUsers","usr","loadAuth","expiresIn","verify","decoded"],"mappings":"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OACM7iE,EAAM,EAAQ,GAAaV,OAAO,gBAAiB,CAAEW,MAAO,IAClE,QAEM+wB,EAAO,GAAG,UAAO9L,sBACvB,gBAEI,qBACI,OAAO,IAAI9b,QAAQ,CAACC,EAASunB,KACzB,UAAU+zC,WAAW3zC,GAAMzoB,KAAK,KAC5BsoB,EAAGgB,SAASb,EAAM,CAAE4zC,SAAU,SAAW,CAAC/6D,EAAKjD,KAC3C,GAAIiD,EACA+mB,EAAO/mB,GACP7J,EAAI8J,MAAMD,OACP,CACH,MAAMsL,EAAMvO,EAAOuF,KAAK+I,MAAMtO,GAAQ,GACtCyC,EAAQ8L,UAO5B,sBAAsBvO,GAClB,OAAO,IAAIwC,QAAQ,CAACC,EAASunB,KACzB,UAAU+zC,WAAW3zC,GAAMzoB,KAAK,KAC5B,IAAI8pB,EAAOlmB,KAAKuB,UAAU9G,GAC1BiqB,EAAGQ,UAAUL,EAAMqB,EAAM,QAASxoB,IAC1BA,GACA+mB,EAAO/mB,GACP7J,EAAI8J,MAAMD,IAEVR,EAAQgpB,Y,8EC7BhC,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,MACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OAIA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OAGA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OAKA,OACA,OACA,OACA,OACA,OACA,OACA,OAGC,OAED,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OAGA,OACA,OACA,OAEA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OAGA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,MACA,OACA,OAEA,MACA,OACA,OAEA,OACA,OACA,OACA,OACA,OACA,OACA,MACA,OACA,OACA,OACA,OACA,OAIA,OAGA,OACA,OACA,OAGA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OAEA,OAEA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,Q,8YC3QA,cACA,OACA,OACA,OACA,QACA,QAEA,MAAMwzC,UAAgC,EAAAlkE,KACpC,cACEwgB,QACA1hB,KAAK4B,MAAQ,+BACb5B,KAAKyP,YAAc,GACnBzP,KAAK0P,SAAS,eAAgB,EAAArE,KAAKI,SACnCzL,KAAK2Q,UAAU,KAAM,EAAAtF,KAAKG,QAC1BxL,KAAK2Q,UAAU,UAAW,EAAAtF,KAAKE,QAE/BvL,KAAKqH,SAA+B,qBAAI,CACtCoI,YAAa,yBACbjR,MAAO,GACPoC,KAAM,EAAAiL,YAAYN,QAIhB,U,+CACEvL,KAAKkkD,2BAGP,iB,yCACAlkD,KAAKJ,OAAS,EAAAF,KAAKoJ,QACnB9I,KAAK+N,aAAa,IAAM/N,KAAKkF,OAAO,GAAGC,UACrCnF,KAAKuF,QAAQ,GAAGY,MAAuC,GAA/BnG,KAAKuF,QAAQ,GAAGY,KAAK3E,eAAmBxB,KAAKqlE,sBACnErlE,KAAKslE,wBAIT,wB,yCACAtlE,KAAKJ,OAAS,EAAAF,KAAKoJ,eACjB9I,KAAKslE,wBAGb,gBACE,IAAIC,EAAavlE,KAAKqH,SAA+B,qBAAE7I,OAAS,gBAEhE,OADK+mE,EAAWr5B,WAAW,U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ASroF,KAAKqH,SAAsB,YAAE7I,OAAOsP,IAChE2/C,EAAY3/C,EAAIu6E,SAAS,eAAeroF,KAAKqH,SAAsB,YAAE7I,OACrEkvD,EAAY5/C,EAAIu6E,SAAS,eAAeroF,KAAKqH,SAAsB,YAAE7I,OAEvEwB,KAAKsqF,OAAOrvD,EAAWqzB,EAAKb,EAAWC,GACvC,MAAOtkD,GACPpJ,KAAK6F,SAASuD,IAGlB,MACF,QACEpJ,KAAKm/C,UAAU,kCAKvB,EAAAx/C,UAAUghD,iBAAiB,EAAAl3B,cAAeg/D,EAAsB,EAAAj/D,kB,8ECrYhE,MAAqB+gE,GAArB,YAIS,EAAAF,kBAAqBv8E,IAC1B,MAAM08E,EAAS,CACb,YACA,YACA,YACA,YACA,YACA,WACA,WACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,UACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,UACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,WACA,YACA,YACA,YACA,YACA,YACA,YACA,WACA,YACA,YACA,YACA,YACA,YACA,WACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,WACA,WACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,WACA,YACA,YACA,WACA,YACA,YACA,aACA,aACA,UACA,aACA,YACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,WACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,WACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,cAEIC,EAAW,EACd,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,EACD,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,KAEF,IAAIjsF,EAAQsP,EACZ,IAAK,IAAIvQ,EAAI,EAAGA,EAAI,IAAKA,IACvB,GAAIiB,GAASgsF,EAAOjtF,IAAMiB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1B1C,YACW,EAAAb,WAAa,CAACt9F,EAAU29F,YAAa39F,EAAU49F,aAAc59F,EAAU69F,gBAAiB79F,EAAU89F,UAAW99F,EAAU+9F,cAAe/9F,EAAUg+F,eAAgBh+F,EAAUi+F,YAAaj+F,EAAUk+F,YAAal+F,EAAUm+F,cAAcx5G,IACzOm2B,IACW,CAAEl6B,MAAOk6B,EAAOnnB,KAAMmnB,KA2B9B,EAAAmjF,YAAc,CACjB,mBACA,iBACA,mBACA,gBACA,kBACA,gBACA,kBACA,mBACA,kBACA,kBACA,oBACA,gBACA,mBACA,kBACA,kBACA,qBACA,cACA,eACA,gBACA,gBACA,oBACA,gBACA,eACA,eACA,gBACA,gBACA,cACA,eACA,gBACA,cACA,cACA,gBACA,iBACA,oBACA,eACA,mBACA,iBACA,gBACA,mBACA,kBACA,gBACA,iBACA,mBACA,gBACA,oBACA,iBAGG,EAAAN,YAAc,CACjB,iBACA,eACA,iBACA,gBACA,eACA,oBACA,eACA,kBACA,sBACA,cACA,kBACA,eACA,gBACA,kBACA,iBACA,kBACA,kBACA,iBACA,eACA,mBAGG,EAAAG,UAAY,CACf,cACA,aACA,cACA,aACA,cACA,gBACA,cACA,eACA,YACA,eACA,eACA,cACA,eACA,cACA,aACA,kBACA,eACA,gBACA,aACA,YACA,aACA,gBACA,iBACA,YACA,cACA,mBACA,iBACA,YACA,eACA,eACA,gBACA,iBACA,aACA,iBACA,eACA,iBACA,gBACA,eACA,mBACA,oBACA,eACA,aACA,eACA,gBACA,cACA,eACA,oBACA,mBACA,YACA,YACA,iBACA,iBACA,aACA,gBACA,iBACA,cACA,gBACA,iBACA,aACA,gBACA,iBACA,qBACA,cACA,gBACA,eACA,cACA,eACA,aACA,aACA,mBACA,cACA,gBACA,mBACA,eACA,cACA,qBACA,gBAGG,EAAAD,gBAAkB,CACrB,mBACA,mBACA,4BACA,uBACA,oBACA,oBACA,qBACA,mBACA,mBACA,qBAGG,EAAAD,aAAe,CAClB,eACA,oBACA,oBACA,iCACA,8BACA,4BACA,0BACA,6BACA,4BACA,iCACA,0BACA,6BACA,6BACA,4BACA,4BACA,mBACA,mBACA,gBACA,yBACA,mBACA,gBACA,iBACA,uBACA,oBACA,iBACA,gBACA,wBACA,uBACA,iBACA,kBACA,kBACA,kBACA,oBACA,qBACA,kBACA,iBACA,kBACA,uBACA,iBACA,uBACA,iBACA,kBACA,mBACA,mBACA,sBACA,sBACA,oBACA,oBACA,kBACA,oBACA,qBACA,oBACA,oBACA,iBACA,kBACA,iBACA,qBACA,+BACA,uBACA,0BACA,6BACA,4BACA,wBACA,4BACA,0BACA,iBACA,kBACA,kBACA,iBACA,8BACA,8BACA,iBACA,eACA,sBACA,iBACA,kBACA,iBACA,qBACA,oBACA,mBACA,oBACA,iBACA,qBACA,sBACA,mBACA,kBACA,oBACA,qBACA,iBACA,mBACA,kBACA,eACA,kBACA,8BACA,8BACA,iCACA,kBACA,iBACA,sBACA,qBACA,kBACA,yBACA,wBACA,sBACA,sBACA,uBACA,sBACA,uBACA,iBACA,iBACA,mBACA,qBACA,mBACA,mBACA,wBACA,oBACA,uBACA,gBACA,mBACA,wBACA,sBACA,gBACA,sBACA,kBACA,kBACA,oBACA,qBACA,mBACA,kBACA,uBAGG,EAAAO,aAAe,CAClB,eACA,mBACA,uBACA,kBACA,gBACA,iBACA,gBACA,oBACA,kBACA,eACA,mBACA,oBACA,kBACA,sBACA,eACA,mBACA,qBACA,iBACA,oBACA,iBACA,oBACA,gBACA,eACA,kBACA,iBACA,oBACA,gBACA,mBACA,kBACA,uBACA,oBACA,iBACA,iBACA,oBACA,eACA,kBAGG,EAAAH,eAAiB,CACpB,qBACA,qBACA,wBACA,mBACA,mBACA,kBACA,mBACA,qBACA,sBACA,sBACA,kBACA,oBAGG,EAAAD,cAAgB,CACnB,kBACA,mBACA,kBACA,sBACA,iBACA,mBACA,qBACA,yBACA,oBAGG,EAAAG,YAAc,CACjB,gBACA,mBACA,eACA,mBACA,cACA,kBACA,mBACA,mB,8EC9ZR,aACA,OACA,OACA,OAEMxoG,EAAS,EAAQ,IAEvB,MAAa0oG,UAAkB,EAAA96G,KAI7B,cACEwgB,QAJF,KAAA+nD,aAAe,IAKbzpE,KAAK4B,MAAQ,QACb5B,KAAKyP,YACH,ufAEFzP,KAAK2Q,UAAU,aAAc,EAAAtF,KAAKE,QAClCvL,KAAK2Q,UAAU,OAAQ,EAAAtF,KAAKG,QAC5BxL,KAAK2Q,UAAU,MAAO,EAAAtF,KAAKG,QAC3BxL,KAAK2Q,UAAU,MAAO,EAAAtF,KAAKG,QAC3BxL,KAAK+1B,qBAAqB,WAAY,EAAA1qB,KAAKG,OAAQ,EAAG,YAEtDxL,KAAKqH,SAAe,KAAI,CACtBoI,YAAa,OACb7O,KAAM,EAAAiL,YAAYC,SAClBjJ,OAAQ,CACNmM,MAAO,CACL,CAAExQ,MAAO,eAAgB+S,KAAM,gBAC/B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,QAAS+S,KAAM,WAG5B/S,MAAO,WAETwB,KAAKo3B,kBAAkB,CACrBC,OAAQ,CAAC,CAAEjW,KAAM,GAAIld,SAAU,CAAEszB,OAAQ,OAG3Cx3B,KAAKqH,SAAmB,SAAI,CAC1BoI,YAAa,wBACbjR,OAAO,EACPoC,KAAM,EAAAiL,YAAYJ,SAGpBzL,KAAKF,WAA4B,iBAAI,EAGvC,OACME,KAAKqH,SAAmB,SAAE7I,OAC5BwB,KAAK+8E,aAIT,UACE/8E,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,SAC9D+E,cAAcvD,KAAK62B,aACnB,IAAI3yB,EAAWlE,KAAK+N,aAAa,GACjC7J,EAAW,UAAU4a,YAAY5a,EAAUlE,KAAKqH,SAAe,KAAE7I,OACjEwB,KAAK62B,YAAcvyB,YAAY,KAC7BtE,KAAKgvE,eACJ9qE,GACHlE,KAAKypE,aAAevlE,EACpBlE,KAAKgvE,cAGP,iBACE,IAAI9qE,EAAWlE,KAAK+N,aAAa,GACjC7J,EAAW,UAAU4a,YAAY5a,EAAUlE,KAAKqH,SAAe,KAAE7I,OAC7D0F,GAAYlE,KAAKypE,eACnBzpE,KAAKypE,aAAevlE,EACpBX,cAAcvD,KAAK62B,aACnB72B,KAAK62B,YAAcvyB,YAAY,KAC7BtE,KAAKgvE,eACJ9qE,IAIP,cACE,GAAIlE,KAAKJ,OAAS,EAAAF,KAAKoJ,OAAQ,OAC/B,MAAMmzG,EAAWj8G,KAAKqH,SAAmB,SAAE7I,MACrCmG,EAAM2O,IACZtT,KAAKgO,cAAc,EAAGrJ,EAAI4O,OAAO,aAAa,GAC9CvT,KAAKgO,cAAc,EAAGrJ,EAAIsa,SAAS,GACnCjf,KAAKgO,cAAc,EAAGrJ,EAAIua,WAAW,GACrClf,KAAKgO,cAAc,EAAGrJ,EAAIwa,WAAW,GACjC88F,IACFj8G,KAAKgO,cAAc,EAAGrJ,EAAIya,gBAAgB,GAC1Cpf,KAAKgO,cAAc,EAAGrJ,EAAIoR,YAAY,GACtC/V,KAAKgO,cAAc,EAAGrJ,EAAIqoG,YAAc,IAAI,GAC5ChtG,KAAKgO,cAAc,EAAGrJ,EAAIuzB,WAAW,IAIzC,wBACE,MAAM+jF,EAAWj8G,KAAKqH,SAAmB,SAAE7I,MAC3CwB,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,SAC1Dy9G,IAAaj8G,KAAKF,WAA4B,iBAChDE,KAAK+8E,aACL/8E,KAAKF,WAA4B,iBAAI,EACrCE,KAAK25B,mBAAkB,GAAO,KACpBsiF,GAAYj8G,KAAKF,WAA4B,kBACvDE,KAAK4Q,aAAa,GAClB5Q,KAAK4Q,aAAa,GAClB5Q,KAAK4Q,aAAa,GAClB5Q,KAAK4Q,aAAa,GAClB5Q,KAAKF,WAA4B,iBAAI,EACrCE,KAAK25B,mBAAkB,GAAO,IAEhC35B,KAAKkQ,mBACLlQ,KAAKisB,iBAGC,aACNjsB,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKG,QAC9BxL,KAAK2Q,UAAU,aAAc,EAAAtF,KAAKE,QAClCvL,KAAK2Q,UAAU,WAAY,EAAAtF,KAAKG,QAChCxL,KAAK2Q,UAAU,QAAS,EAAAtF,KAAKG,SA/GjC,cAkHA,EAAA7L,UAAUghD,iBAAiB,aAAcq7D,I,8ECzHzC,aACA,OACA,OAEA,MAAaE,UAAiB,EAAAh7G,KAG5B,cACEwgB,QAHF,KAAAxd,SAAW,IAITlE,KAAK4B,MAAQ,OACb5B,KAAKyP,YACH,0aACFzP,KAAK2Q,UAAU,aAAc,EAAAtF,KAAKE,QAClCvL,KAAK2Q,UAAU,YAAa,EAAAtF,KAAKE,QACjCvL,KAAK2Q,UAAU,YAAa,EAAAtF,KAAKG,QACjCxL,KAAK2Q,UAAU,OAAQ,EAAAtF,KAAKG,QAC5BxL,KAAK2Q,UAAU,QAAS,EAAAtF,KAAKG,QAC7BxL,KAAK2Q,UAAU,OAAQ,EAAAtF,KAAKG,QAG9B,UACEjI,cAAcvD,KAAK62B,aACnB72B,KAAK62B,YAAcvyB,YAAY,KAC7BtE,KAAKgvE,eACJhvE,KAAKkE,UACRlE,KAAKgvE,cAGP,cACE,IAAIrqE,EAAM,IAAIC,KACd,MAAMwS,EAAMzS,EAAImb,SAChB,IAAIq8F,EAAoB,KACxB,OAAQ/kG,GACN,KAAK,EACH+kG,EAAY,SACZ,MACF,KAAK,EACHA,EAAY,SACZ,MACF,KAAK,EACHA,EAAY,UACZ,MACF,KAAK,EACHA,EAAY,YACZ,MACF,KAAK,EACHA,EAAY,WACZ,MACF,KAAK,EACHA,EAAY,SACZ,MACF,KAAK,EACHA,EAAY,WAGhBn8G,KAAKgO,cAAc,EAAGrJ,EAAIy3G,sBAAsB,GAChDp8G,KAAKgO,cAAc,EAAGmuG,GAAW,GACjCn8G,KAAKgO,cAAc,EAAGoJ,GAAK,GAC3BpX,KAAKgO,cAAc,EAAGrJ,EAAI2P,WAAW,GACrCtU,KAAKgO,cAAc,EAAGrJ,EAAI0P,WAAa,GAAG,GAC1CrU,KAAKgO,cAAc,EAAGrJ,EAAIyP,eAAe,IAxD7C,aA2DA,EAAAzU,UAAUghD,iBAAiB,YAAau7D,I,8EC/DxC,aACA,OACA,QACA,OAEA,IAAKt+F,GAAL,SAAKA,GACH,yCACA,8CAFF,CAAKA,MAAS,KAKd,MAAay+F,UAAqB,EAAAn7G,KAEhC,cACEwgB,QACA1hB,KAAK4B,MAAQ,kBACb5B,KAAKyP,YACH,2eAQFzP,KAAK0P,SAAS,iBAAkB,EAAArE,KAAKM,KACrC3L,KAAK0P,SAAS,iBAAkB,EAAArE,KAAKM,KACrC3L,KAAK2Q,UAAU,sBAAuB,EAAAtF,KAAKM,KAC3C3L,KAAK2Q,UAAU,wBAAyB,EAAAtF,KAAKM,KAC7C3L,KAAKqH,SAAe,KAAI,CACtBoI,YAAa,kBACb7O,KAAM,EAAAiL,YAAYC,SAClBjJ,OAAQ,CACNmM,MAAO,CAEL,CAAExQ,MAAOof,EAAUi9F,MAAOtpG,KAAMqM,EAAUi9F,SAG9Cr8G,MAAOof,EAAUg9F,MAKrB,UACE56G,KAAKkkD,wBAGP,iBACE,MAAMo4D,EAAQt8G,KAAK+N,aAAa,GAC1BwuG,EAAQv8G,KAAK+N,aAAa,GAC1BgQ,EAAW/d,KAAKqH,SAAe,KAAE7I,MACvC,IACMuf,IAAaH,EAAUg9F,MACzB56G,KAAKgO,cAAc,EAAGhO,KAAKw8G,SAASlpG,EAAOgpG,GAAQC,IACnDv8G,KAAKgO,cAAc,EAAGhO,KAAKy8G,WAAWnpG,EAAOgpG,GAAQC,KAC5Cx+F,IAAaH,EAAUi9F,QAChC76G,KAAKgO,cAAc,EAAGhO,KAAKw8G,SAASlpG,EAAOoI,SAAS4gG,IAAShpG,EAAOoI,SAAS6gG,MAC7Ev8G,KAAKgO,cAAc,EAAGhO,KAAKy8G,WAAWnpG,EAAOoI,SAAS4gG,IAAShpG,EAAOoI,SAAS6gG,OAEjF,MAAOxoG,GACP/T,KAAKm/C,UAAU,uCAAuCprC,MAI1D,wBACE/T,KAAKisB,iBAIP,SAASqwF,EAAYC,GACnB,IAAIG,EAAQJ,EAAM9rG,KAAK+rG,EAAO,QAC9BA,EAAM1qD,IAAI6qD,EAAO,SACjB,IAAIC,EAASL,EAAM9rG,KAAK+rG,EAAO,UAC/BA,EAAM1qD,IAAI8qD,EAAQ,UAClB,IAAI39F,EAAOs9F,EAAM9rG,KAAK+rG,EAAO,QAC7BA,EAAM1qD,IAAI7yC,EAAM,QAChB,IAAIC,EAAQq9F,EAAM9rG,KAAK+rG,EAAO,SAC9BA,EAAM1qD,IAAI5yC,EAAO,SACjB,IAAIC,EAAUo9F,EAAM9rG,KAAK+rG,EAAO,WAIhC,OAHAA,EAAM1qD,IAAI3yC,EAAS,WAGZ,CAAEw9F,QAAOC,SAAQ39F,OAAMC,QAAOC,UAASC,QAFhCm9F,EAAM9rG,KAAK+rG,EAAO,WAEuBvgG,GAD9CsgG,EAAM9rG,KAAK+rG,IAItB,WAAWD,EAAYC,GAQrB,MAAO,CAAEG,MAPGJ,EAAM9rG,KAAK+rG,EAAO,QAOdI,OANHL,EAAM9rG,KAAK+rG,EAAO,UAMPv9F,KALbs9F,EAAM9rG,KAAK+rG,EAAO,QAKCt9F,MAJlBq9F,EAAM9rG,KAAK+rG,EAAO,SAIOr9F,QAHvBo9F,EAAM9rG,KAAK+rG,EAAO,WAGcp9F,QAFhCm9F,EAAM9rG,KAAK+rG,EAAO,WAEuBvgG,GAD9CsgG,EAAM9rG,KAAK+rG,KAjFxB,iBAuFA,EAAA58G,UAAUghD,iBAAiB,uBAAwB07D,I,8ECjGnD,aACA,OACA,OACA,OACA,OAEA,MAAMO,UAAsB,EAAA17G,KAW1B,cACEwgB,QAXF,KAAAm7F,YAAa,EACb,KAAAtmC,cAAe,EACf,KAAA9M,aAAe,IACf,KAAAC,UAAW,EACX,KAAAoF,UAAY,KACZ,KAAAxpE,QAAU,EACV,KAAAooE,MAAQ,EACR,KAAAz3D,OAAS,EAKPjW,KAAK4B,MAAQ,YACb5B,KAAKyP,YACH,qZACFzP,KAAK+1B,qBAAqB,SAAU,EAAA1qB,KAAKI,QAAS,EAAG,UAAU,GAC/DzL,KAAK0P,SAAS,QAAS,EAAArE,KAAKI,SAE5BzL,KAAKqH,SAAgB,MAAI,CACvBoI,YAAa,eACb7O,KAAM,EAAAiL,YAAYC,SAClBjJ,OAAQ,CACNmM,MAAO,CACL,CAAExQ,MAAO,EAAG+S,KAAM,gBAClB,CAAE/S,MAAO,IAAM+S,KAAM,WACrB,CAAE/S,MAAO,IAAO+S,KAAM,WACtB,CAAE/S,MAAO,KAAO+S,KAAM,SACtB,CAAE/S,MAAO,MAAQ+S,KAAM,UAG3B/S,MAAO,GAETwB,KAAK+1B,qBAAqB,WAAY,EAAA1qB,KAAKG,OAAQ,IAAK,kBAAkB,GAC1ExL,KAAKqH,SAAe,KAAI,CACtBoI,YAAa,QACb7O,KAAM,EAAAiL,YAAYC,SAClBjJ,OAAQ,CACNmM,MAAO,CACL,CAAExQ,MAAO,eAAgB+S,KAAM,gBAC/B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,QAAS+S,KAAM,WAG5B/S,MAAO,gBAETwB,KAAKo3B,kBAAkB,CACrBC,OAAQ,CAAC,CAAEnzB,SAAU,CAAEszB,OAAQ,GAAKpW,KAAM,OAE5CphB,KAAK2Q,UAAU,UAAW,EAAAtF,KAAKG,QAE/BxL,KAAKgO,cAAc,EAAG,MACtBhO,KAAKsF,QAAU,EAGjB,UACEtF,KAAK0pE,UAAW,EAChB1pE,KAAKgO,cAAc,EAAGhO,KAAKsF,SAC3BtF,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,SAC9DwB,KAAKuF,QAAQ,GAAS,KAAI,2BAC1BvF,KAAKkkD,wBAGP,iBACE,IAAI52B,EAAMttB,KAAK+N,aAAa,GACxB+5D,EAAQ9nE,KAAK+N,aAAa,GAE1B+5D,IAAU9nE,KAAKu2E,eACjBv2E,KAAKsF,QAAU,EACftF,KAAK8uE,UAAYlqE,KAAKD,MACtB3E,KAAKgO,cAAc,EAAG,GAAG,IAE3BhO,KAAKu2E,aAAezO,EAEpB,IAAI5jE,EAAWlE,KAAK+N,aAAa,GACjC7J,EAAW,UAAU4a,YAAY5a,EAAUlE,KAAKqH,SAAe,KAAE7I,OAC7D0F,GAAYlE,KAAKypE,cAAgBzpE,KAAK0pE,WACxCnmE,cAAcvD,KAAK62B,aACnB72B,KAAKgO,cAAc,EAAGpJ,KAAKD,MAAQ3E,KAAK8uE,UAAY9uE,KAAKsF,SAAS,GAClEtF,KAAK62B,YAAcvyB,YAAY,KAC7B,MAAMkB,GAAUZ,KAAKD,MAAQ3E,KAAK8uE,UAAY9uE,KAAKsF,SAAWtF,KAAK0tE,MACnE1tE,KAAKgO,cAAc,EAAG,UAAM84F,cAActhG,EAAQxF,KAAKiW,SAAS,IAC/D/R,GACHlE,KAAKypE,aAAevlE,GAGlBopB,IAAQttB,KAAK68G,YACf78G,KAAKgO,cAAc,EAAGhO,KAAKsF,SAAS,GACpCtF,KAAK0pE,UAAW,EAChB1pE,KAAK8uE,UAAYlqE,KAAKD,MACtB3E,KAAK62B,YAAcvyB,YAAY,KAC7B,MAAMkB,GAAUZ,KAAKD,MAAQ3E,KAAK8uE,UAAY9uE,KAAKsF,SAAWtF,KAAK0tE,MACnE1tE,KAAKgO,cAAc,EAAG,UAAM84F,cAActhG,EAAQxF,KAAKiW,SAAS,IAC/D/R,GACHlE,KAAK68G,WAAavvF,IACRA,GAAOttB,KAAK68G,aACtBt5G,cAAcvD,KAAK62B,aACnB72B,KAAKsF,QAAUV,KAAKD,MAAQ3E,KAAK8uE,UAAY9uE,KAAKsF,QAClDtF,KAAK0pE,UAAW,EAChB1pE,KAAKgO,cAAc,EAAGhO,KAAKsF,SAAS,GACpCtF,KAAK68G,WAAavvF,GAsBtB,wBAGE,OAFAttB,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,SAC9DwB,KAAK0tE,MAAQjlE,OAAOzI,KAAKqH,SAAgB,MAAE7I,OACnCwB,KAAK0tE,OACX,KAAK,EACH1tE,KAAKuF,QAAQ,GAAS,KAAI,2BAC1B,MACF,KAAK,IACHvF,KAAKuF,QAAQ,GAAS,KAAI,sBAC1B,MACF,KAAK,IACHvF,KAAKuF,QAAQ,GAAS,KAAI,sBAC1B,MACF,KAAK,KACHvF,KAAKuF,QAAQ,GAAS,KAAI,oBAC1B,MACF,KAAK,MACHvF,KAAKuF,QAAQ,GAAS,KAAI,mBAC1B,MACF,QACEvF,KAAKuF,QAAQ,GAAS,KAAI,2BAG9B,MAAMC,EAASiD,OAAOzI,KAAKuF,QAAQ,GAAGY,MAAQnG,KAAK0tE,MACnD1tE,KAAKgO,cAAc,EAAG,UAAM84F,cAActhG,EAAQxF,KAAKiW,SAAS,GAChEjW,KAAKisB,kBAGT,EAAAtsB,UAAUghD,iBAAiB,iBAAkBi8D,I,8EC7J7C,aACA,OACA,OAEME,EAAU,EAAQ,IAAQA,QAG1BC,EAAU,EAAQ,IAClBC,EAAW,EAAQ,IAEzB,MAAaC,UAAyB,EAAA/7G,KAIpC,cACEwgB,QAJF,KAAAw7F,IAAM,KACN,KAAAC,WAAa,GAIXn9G,KAAK4B,MAAQ,gBACb5B,KAAKyP,YACH,+kBAEFzP,KAAK+1B,qBAAqB,SAAU,EAAA1qB,KAAKI,SAAS,EAAO,UAAU,GACnEzL,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKI,SAC9BzL,KAAK2Q,UAAU,OAAQ,EAAAtF,KAAKE,QAC5BvL,KAAK2Q,UAAU,iBAAkB,EAAAtF,KAAKE,QACtCvL,KAAK2Q,UAAU,kBAAmB,EAAAtF,KAAKE,QACvCvL,KAAK2Q,UAAU,gBAAiB,EAAAtF,KAAKE,QAErCvL,KAAKqH,SAAmB,SAAI,CAC1BoI,YAAa,2BACbjR,MAAO,mBACPoC,KAAM,EAAAiL,YAAYN,QAEpBvL,KAAKqH,SAAS,aAAe,CAC3BoI,YAAa,YACb7O,KAAM,EAAAiL,YAAYC,SAClBjJ,OAAQ,CACNmM,MAAO,CACL,CAAExQ,MAAO,EAAG+S,KAAM,uCAClB,CAAE/S,MAAO,EAAG+S,KAAM,kDAClB,CAAE/S,MAAO,EAAG+S,KAAM,qCAClB,CAAE/S,MAAO,EAAG+S,KAAM,4BAClB,CAAE/S,MAAO,EAAG+S,KAAM,sCAClB,CAAE/S,MAAO,EAAG+S,KAAM,qCAClB,CAAE/S,MAAO,EAAG+S,KAAM,oCAClB,CAAE/S,MAAO,EAAG+S,KAAM,4CAClB,CAAE/S,MAAO,EAAG+S,KAAM,6DAGtB/S,MAAO,GAETwB,KAAKqH,SAAc,IAAI,CACrBoI,YAAa,aACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAAe,KAAI,CACtBoI,YAAa,WACbjR,MAAO,GACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAAc,IAAI,CACrBoI,YAAa,UACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,kBACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAAwB,cAAI,CAC/BoI,YAAa,gBACbjR,MAAO,GACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAAgB,MAAI,CACvBoI,YAAa,YACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKo3B,kBAAkB,CACrBC,OAAQ,CAAC,CAAE+lF,gBAAiB,GAAIC,cAAe,KAC/C/lF,WAAY,CACVte,IAAK1L,IACH,MAAMgwG,EAAchwG,EAAQ,aAAa9O,MACzC,OACiB,GAAf8+G,GACe,GAAfA,GACe,GAAfA,GACe,GAAfA,GACe,GAAfA,GACe,GAAfA,GACe,GAAfA,GAGJp8F,KAAM5T,IACJ,MAAMgwG,EAAchwG,EAAQ,aAAa9O,MACzC,OACiB,GAAf8+G,GACe,GAAfA,GACe,GAAfA,GACe,GAAfA,GACe,GAAfA,GACe,GAAfA,GAGJlmG,IAAK9J,IACH,MAAMgwG,EAAchwG,EAAQ,aAAa9O,MACzC,OAAsB,GAAf8+G,GAAmC,GAAfA,GAAmC,GAAfA,GAAmC,GAAfA,GAErEF,gBAAiB9vG,GAEO,GADFA,EAAQ,aAAa9O,MAG3C6+G,cAAe/vG,GAES,GADFA,EAAQ,aAAa9O,MAG3CoiB,MAAOtT,GAEiB,GADFA,EAAQ,aAAa9O,SAOjD,UACE+E,cAAcvD,KAAK62B,aACnB72B,KAAKgO,cAAc,GAAG,GACtBhO,KAAKkkD,wBAGP,wBACElkD,KAAKisB,iBAGP,YAEMjsB,KAAKk9G,KAAKl9G,KAAKk9G,IAAIz6G,OAGzB,aAAa86G,GAGX,OADiBR,EAAQ,MACPS,SAASD,GAG7B,iBACE,MAAMpwF,EAASntB,KAAK+N,aAAa,GAC3ByQ,EAAS9C,SAAS1b,KAAKqH,SAAc,IAAE7I,OACvC0iB,EAAOxF,SAAS1b,KAAKqH,SAAe,KAAE7I,OACtC4Y,EAAMsE,SAAS1b,KAAKqH,SAAc,IAAE7I,OACpC4+G,EAAkB1hG,SAAS1b,KAAKqH,SAA0B,gBAAE7I,OAC5D6+G,EAAgB3hG,SAAS1b,KAAKqH,SAAwB,cAAE7I,OACxDoiB,EAAQlF,SAAS1b,KAAKqH,SAAgB,MAAE7I,OACxCs1E,EAAW9zE,KAAKqH,SAAmB,SAAE7I,MACrCi/G,EAAWz9G,KAAKqH,SAAS,aAAa7I,MAC5C,IAAIk/G,EAAU,KA+Dd,GA7DIvwF,IACFuwF,EAAU,UAEM,GAAZD,GAAiBj/F,GAAU,GAAKA,EAAS,GAG3Ck/F,EAAU,KAAOl/F,EAAS,WACL,GAAZi/F,GAAiBj/F,GAAU,GAAKA,EAAS,IAAM0C,GAAQ,GAAKA,EAAO,GAG5Ew8F,EAAUl/F,EAAS,MAAQ0C,EAAO,SACb,GAAZu8F,GAAiBj/F,GAAU,GAAKA,EAAS,IAAM0C,GAAQ,GAAKA,EAAO,IAAM9J,EAAM,GAAKA,GAAO,GAGpGsmG,EAAUl/F,EAAS,IAAM0C,EAAO,MAAQ9J,EAAM,OACzB,GAAZqmG,EAGTC,EAAU,YACW,GAAZD,GAAiBj/F,GAAU,GAAKA,EAAS,IAAM0C,GAAQ,GAAKA,EAAO,IAAM9J,EAAM,GAAKA,GAAO,GAGpGsmG,EAAUl/F,EAAS,IAAM0C,EAAO,IAAM9J,EAAM,OACvB,GAAZqmG,EAGTC,EAAU,YAEE,GAAZD,GACAj/F,GAAU,GACVA,EAAS,IACT0C,GAAQ,GACRA,EAAO,IACP9J,EAAM,GACNA,GAAO,IACPwJ,GAAS,GACTA,GAAS,GAIT88F,EAAUl/F,EAAS,IAAM0C,EAAO,IAAM9J,EAAM,IAAMwJ,EAAQ,KAE9C,GAAZ68F,GACAj/F,GAAU,GACVA,EAAS,IACT0C,GAAQ,GACRA,EAAO,IACPk8F,EAAkBC,GAClBD,GAAmB,GACnBA,GAAmB,IACnBC,GAAiB,GACjBA,GAAiB,GAIjBK,EAAUl/F,EAAS,IAAM0C,EAAO,IAAMk8F,EAAkB,IAAMC,EAAgB,OACzD,GAAZI,GAAiBj/F,GAAU,GAAKA,EAAS,IAAM0C,GAAQ,GAAKA,EAAO,KAE5Ew8F,EAAUl/F,EAAS,IAAM0C,EAAO,YAG/BiM,GAAqB,MAAXuwF,GAA+B,YAAZA,EAAuB,CACvC,YAAZA,EAAuB19G,KAAKgO,cAAc,EAAG,yBAC5ChO,KAAKgO,cAAc,EAAG,oBAC3B,IACMhO,KAAKk9G,KAAKl9G,KAAKk9G,IAAIz6G,OACvB,MAAO2G,GACPpJ,KAAKgO,cAAc,EAAG5E,GAQxB,OANApJ,KAAKk9G,IAAM,KACXl9G,KAAKm9G,WAAa,GAClBn9G,KAAKgO,cAAc,GAAG,GAAO,GAC7BhO,KAAKgO,cAAc,EAAG,MAAM,GAC5BhO,KAAKgO,cAAc,EAAG,MAAM,QAC5BhO,KAAKgO,cAAc,EAAG,MAAM,GAI1BhO,KAAKk9G,KAAOQ,IAAY19G,KAAKm9G,aAC/Bn9G,KAAKgO,cAAc,EAAG,oBACtBhO,KAAKk9G,IAAIz6G,OACTzC,KAAKk9G,IAAM,KACXl9G,KAAKm9G,WAAa,IAEpB,IACEn9G,KAAKm9G,WAAaO,EAClB19G,KAAKgO,cAAc,EAAG0vG,GACtB19G,KAAKgO,cAAc,EAAGgvG,EAASjnG,SAAS2nG,IACxC19G,KAAKk9G,IAAM,IAAIJ,EACbY,EACA,KACE19G,KAAKgO,cAAc,GAAG,GACtBhO,KAAK62B,YAAc1uB,WAAW,KAC5BnI,KAAKgO,cAAc,GAAG,IACrB,KAEH,IAAIuvG,EAAWv9G,KAAKk9G,IAAIS,UAAU,GAClC39G,KAAKgO,cAAc,EAAGhO,KAAK49G,aAAaL,KAE1C,KACA,KACAzpC,GAEF3rE,YAAW,cAAe,KAC1BnI,KAAKgO,cAAc,EAAG,oBACtBhO,KAAKk9G,IAAIz4G,QACT,IAAI84G,EAAWv9G,KAAKk9G,IAAIS,UAAU,GAClC39G,KAAKgO,cAAc,EAAGhO,KAAK49G,aAAaL,IACxC,MAAOn0G,GACPpJ,KAAKgO,cAAc,EAAG5E,KAnQ5B,qBAuQA,EAAAzJ,UAAUghD,iBAAiB,qBAAsBs8D,I,8ECjRjD,aACA,OACA,OAEMH,EAAU,EAAQ,IAAQA,QAG1BC,EAAU,EAAQ,IAClBC,EAAW,EAAQ,IAEzB,MAAaa,UAAuB,EAAA38G,KAIlC,cACEwgB,QAJF,KAAAw7F,IAAM,KACN,KAAAC,WAAa,GAIXn9G,KAAK4B,MAAQ,cACb5B,KAAKyP,YACH,smBAEFzP,KAAK+1B,qBAAqB,SAAU,EAAA1qB,KAAKI,SAAS,EAAO,UAAU,GACnEzL,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKI,SAC9BzL,KAAK2Q,UAAU,OAAQ,EAAAtF,KAAKE,QAC5BvL,KAAK2Q,UAAU,iBAAkB,EAAAtF,KAAKE,QACtCvL,KAAK2Q,UAAU,kBAAmB,EAAAtF,KAAKE,QACvCvL,KAAK2Q,UAAU,gBAAiB,EAAAtF,KAAKE,QACrCvL,KAAKqH,SAAmB,SAAI,CAC1BoI,YAAa,2BACbjR,MAAO,mBACPoC,KAAM,EAAAiL,YAAYN,QAGpBvL,KAAKqH,SAAc,IAAI,CACrBoI,YAAa,aACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAAe,KAAI,CACtBoI,YAAa,WACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAAiB,OAAI,CACxBoI,YAAa,SACbjR,OAAO,EACPoC,KAAM,EAAAiL,YAAYJ,SAEpBzL,KAAKqH,SAAiB,OAAI,CACxBoI,YAAa,SACbjR,OAAO,EACPoC,KAAM,EAAAiL,YAAYJ,SAEpBzL,KAAKqH,SAAkB,QAAI,CACzBoI,YAAa,UACbjR,OAAO,EACPoC,KAAM,EAAAiL,YAAYJ,SAEpBzL,KAAKqH,SAAoB,UAAI,CAC3BoI,YAAa,YACbjR,OAAO,EACPoC,KAAM,EAAAiL,YAAYJ,SAEpBzL,KAAKqH,SAAmB,SAAI,CAC1BoI,YAAa,WACbjR,OAAO,EACPoC,KAAM,EAAAiL,YAAYJ,SAEpBzL,KAAKqH,SAAiB,OAAI,CACxBoI,YAAa,SACbjR,OAAO,EACPoC,KAAM,EAAAiL,YAAYJ,SAEpBzL,KAAKqH,SAAmB,SAAI,CAC1BoI,YAAa,WACbjR,OAAO,EACPoC,KAAM,EAAAiL,YAAYJ,SAItB,UACElI,cAAcvD,KAAK62B,aACnB72B,KAAKgO,cAAc,GAAG,GACtBhO,KAAKkkD,wBAGP,wBACElkD,KAAKisB,iBAGP,YAEMjsB,KAAKk9G,KAAKl9G,KAAKk9G,IAAIz6G,OAGzB,aAAa86G,GAGX,OADiBR,EAAQ,MACPS,SAASD,GAG7B,iBACE,MAAMpwF,EAASntB,KAAK+N,aAAa,GACjC,IAAI2vG,EAAU,KAEd,GAAIvwF,EAAQ,CACVuwF,EAAU,UACV,MAAMl/F,EAASxe,KAAKqH,SAAc,IAAE7I,MAC9B0iB,EAAOlhB,KAAKqH,SAAe,KAAE7I,MACnC,GAAIggB,GAAU,GAAKA,GAAU,IAAM0C,GAAQ,GAAKA,EAAO,GAAI,CACzDw8F,EAAUl/F,EAAS,IAAM0C,EAAO,QAChC,IAAIirF,EAAY,GACZnsG,KAAKqH,SAAiB,OAAE7I,OAAO2tG,EAAUxoG,KAAK,KAC9C3D,KAAKqH,SAAiB,OAAE7I,OAAO2tG,EAAUxoG,KAAK,KAC9C3D,KAAKqH,SAAkB,QAAE7I,OAAO2tG,EAAUxoG,KAAK,KAC/C3D,KAAKqH,SAAoB,UAAE7I,OAAO2tG,EAAUxoG,KAAK,KACjD3D,KAAKqH,SAAmB,SAAE7I,OAAO2tG,EAAUxoG,KAAK,KAChD3D,KAAKqH,SAAiB,OAAE7I,OAAO2tG,EAAUxoG,KAAK,KAC9C3D,KAAKqH,SAAmB,SAAE7I,OAAO2tG,EAAUxoG,KAAK,KACpD+5G,GAAWvR,EAAUvmD,KAAK,MAG9B,IAAKz4B,GAAqB,MAAXuwF,GAA+B,YAAZA,EAAuB,CACvC,YAAZA,EAAuB19G,KAAKgO,cAAc,EAAG,yBAC5ChO,KAAKgO,cAAc,EAAG,oBAC3B,IACMhO,KAAKk9G,KAAKl9G,KAAKk9G,IAAIz6G,OACvB,MAAO2G,GACPpJ,KAAKgO,cAAc,EAAG5E,GAQxB,OANApJ,KAAKk9G,IAAM,KACXl9G,KAAKm9G,WAAa,GAClBn9G,KAAKgO,cAAc,GAAG,GAAO,GAC7BhO,KAAKgO,cAAc,EAAG,MAAM,GAC5BhO,KAAKgO,cAAc,EAAG,MAAM,QAC5BhO,KAAKgO,cAAc,EAAG,MAAM,GAG9B,MAAM8lE,EAAW9zE,KAAKqH,SAAmB,SAAE7I,MACvCwB,KAAKk9G,KAAOQ,IAAY19G,KAAKm9G,aAC/Bn9G,KAAKgO,cAAc,EAAG,oBACtBhO,KAAKk9G,IAAIz6G,OACTzC,KAAKk9G,IAAM,KACXl9G,KAAKm9G,WAAa,IAEpB,IACEn9G,KAAKm9G,WAAaO,EAClB19G,KAAKgO,cAAc,EAAG0vG,GACtB19G,KAAKgO,cAAc,EAAGgvG,EAASjnG,SAAS2nG,IACxC19G,KAAKk9G,IAAM,IAAIJ,EACbY,EACA,KACE19G,KAAKgO,cAAc,GAAG,GACtBhO,KAAK62B,YAAc1uB,WAAW,KAC5BnI,KAAKgO,cAAc,GAAG,IACrB,KAEH,IAAIuvG,EAAWv9G,KAAKk9G,IAAIS,UAAU,GAClC39G,KAAKgO,cAAc,EAAGhO,KAAK49G,aAAaL,KAE1C,KACA,KACAzpC,GAEF3rE,YAAW,cAAe,KAC1BnI,KAAKgO,cAAc,EAAG,oBACtBhO,KAAKk9G,IAAIz4G,QACT,IAAI84G,EAAWv9G,KAAKk9G,IAAIS,UAAU,GAClC39G,KAAKgO,cAAc,EAAGhO,KAAK49G,aAAaL,IACxC,MAAOn0G,GACPpJ,KAAKgO,cAAc,EAAG5E,KAhK5B,mBAoKA,EAAAzJ,UAAUghD,iBAAiB,mBAAoBk9D,I,8EC9K/C,aACA,OACA,OACA,OACMf,EAAU,EAAQ,IAAQA,QAC1BC,EAAU,EAAQ,IAClBC,EAAW,EAAQ,IACnBc,EAAgB,EAAQ,KAE9B,MAAaC,UAA2B,EAAA78G,KAItC,cACEwgB,QAJF,KAAAw7F,IAAM,KACN,KAAAC,WAAa,GAIXn9G,KAAK4B,MAAQ,kBACb5B,KAAKyP,YACH,2fAEFzP,KAAK+1B,qBAAqB,SAAU,EAAA1qB,KAAKI,SAAS,EAAM,UAAU,GAClEzL,KAAK+1B,qBAAqB,iBAAkB,EAAA1qB,KAAKE,OAAQ,GAAI,mBAC7DvL,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKI,SAC9BzL,KAAK2Q,UAAU,OAAQ,EAAAtF,KAAKE,QAC5BvL,KAAK2Q,UAAU,kBAAmB,EAAAtF,KAAKE,QACvCvL,KAAK2Q,UAAU,gBAAiB,EAAAtF,KAAKE,QACrCvL,KAAKqH,SAAmB,SAAI,CAC1BoI,YAAa,2BACbjR,MAAO,mBACPoC,KAAM,EAAAiL,YAAYN,QAItB,UACEhI,cAAcvD,KAAK62B,aACnB72B,KAAKgO,cAAc,GAAG,GACtBhO,KAAKkkD,wBAGP,wBACElkD,KAAKisB,iBAGP,YAEMjsB,KAAKk9G,KAAKl9G,KAAKk9G,IAAIz6G,OAGzB,aAAa86G,GAGX,OADiBR,EAAQ,MACPS,SAASD,GAG7B,iBACE,MAAMpwF,EAASntB,KAAK+N,aAAa,GAC3B2vG,EAAU19G,KAAK+N,aAAa,GAC5BiwG,EAAQF,EAAcG,YAAYP,GAExC,IAAKvwF,IAAW6wF,EAAO,CAChBA,EAIAh+G,KAAKgO,cAAc,EAAG,oBAHzBhO,KAAKgO,cAAc,EAAG,2BAIxB,IACMhO,KAAKk9G,KAAKl9G,KAAKk9G,IAAIz6G,OACvB,MAAO2G,GAEPpJ,KAAKgO,cAAc,EAAG5E,GAOxB,OALApJ,KAAKk9G,IAAM,KACXl9G,KAAKm9G,WAAa,GAClBn9G,KAAKgO,cAAc,GAAG,GAAO,GAC7BhO,KAAKgO,cAAc,EAAG,MAAM,QAC5BhO,KAAKgO,cAAc,EAAG,MAAM,GAI9B,MAAM8lE,EAAW9zE,KAAKqH,SAAmB,SAAE7I,MACvCwB,KAAKk9G,KAAOQ,IAAY19G,KAAKm9G,aAC/Bn9G,KAAKgO,cAAc,EAAG,oBACtBhO,KAAKk9G,IAAIz6G,OACTzC,KAAKk9G,IAAM,KACXl9G,KAAKm9G,WAAa,IAEpB,IACEn9G,KAAKm9G,WAAaO,EAClB19G,KAAKgO,cAAc,EAAGgvG,EAASjnG,SAAS2nG,IACxC19G,KAAKk9G,IAAM,IAAIJ,EACbY,EACA,KAME,GALA19G,KAAKgO,cAAc,GAAG,GACtBhO,KAAK62B,YAAc1uB,WAAW,KAC5BnI,KAAKgO,cAAc,GAAG,IACrB,KAEC,EAAA2H,OAAO3V,KAAKk9G,KAAM,OACtB,IAAIK,EAAWv9G,KAAKk9G,IAAIS,UAAU,GAClC39G,KAAKgO,cAAc,EAAGhO,KAAK49G,aAAaL,KAE1C,KACA,KACAzpC,GAEF3rE,YAAW,cAAiB,KAC5BnI,KAAKgO,cAAc,EAAG,oBACtBhO,KAAKk9G,IAAIz4G,QACT,IAAI84G,EAAWv9G,KAAKk9G,IAAIS,UAAU,GAClC39G,KAAKgO,cAAc,EAAGhO,KAAK49G,aAAaL,IACxC,MAAOn0G,GACPpJ,KAAKgO,cAAc,EAAG5E,KArG5B,uBAyGA,EAAAzJ,UAAUghD,iBAAiB,uBAAwBo9D,I,cClHnDzgH,EAAOD,QAAU2mB,QAAQ,mB,8ECAzB,aACA,OACA,QACA,OACA,MAAak6F,UAA+B,EAAAh9G,KAE1C,cACEwgB,QACA1hB,KAAK4B,MAAQ,sBACb5B,KAAKyP,YACL,wsBAYAzP,KAAK0P,SAAS,QAAS,EAAArE,KAAKM,KAC5B3L,KAAK2Q,UAAU,cAAe,EAAAtF,KAAKE,QACnCvL,KAAK2Q,UAAU,YAAa,EAAAtF,KAAKE,QACjCvL,KAAK2Q,UAAU,cAAe,EAAAtF,KAAKE,QACnCvL,KAAKqH,SAAiB,OAAI,CACxBoI,YAAa,qBACbjR,MAAO,IACPoC,KAAM,EAAAiL,YAAYN,QAItB,yBAIA,iBACE,MAAMgI,EAASvT,KAAKqH,SAAiB,OAAE7I,MACvC,IAAIiiB,EAAOnN,IACXtT,KAAKgO,cAAc,EAAGyS,EAAKlN,UAC3BvT,KAAKgO,cAAc,EAAGyS,EAAK09F,QAC3Bn+G,KAAKgO,cAAc,EAAGyS,EAAKlN,OAAOA,KAtCtC,2BA4CA,EAAA5T,UAAUghD,iBAAiB,2BAA4Bu9D,I,8EChDvD,aACA,OACA,OACA,OAEA,MAAME,UAAgB,EAAAl9G,KAIpB,cACEwgB,QAEA1hB,KAAK4B,MAAQ,kBACb5B,KAAKyP,YACH,uOAEFzP,KAAK0P,SAAS,QAAS,EAAArE,KAAKM,KAC5B3L,KAAK+1B,qBAAqB,WAAY,EAAA1qB,KAAKG,OAAQ,EAAG,YACtDxL,KAAK+1B,qBAAqB,YAAa,EAAA1qB,KAAKG,OAAQ,EAAG,iBACvDxL,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKI,SAC9BzL,KAAKqH,SAAe,KAAI,CACtBoI,YAAa,QACb7O,KAAM,EAAAiL,YAAYC,SAClBjJ,OAAQ,CACNmM,MAAO,CACL,CAAExQ,MAAO,eAAgB+S,KAAM,gBAC/B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,QAAS+S,KAAM,WAG5B/S,MAAO,WAETwB,KAAKo3B,kBAAkB,CACrBC,OAAQ,CAAC,CAAEnzB,SAAU,CAAEszB,OAAQ,GAAKpW,KAAM,OAI9C,UAEEphB,KAAKgO,cAAc,GAAG,GACtBhO,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,SAGhE,aAIA,iBACE,MAAMmO,EAAQ3M,KAAK+N,aAAa,GAC1Bw3E,EAA4B,iBAAV54E,EACxB,GAAI3M,KAAKkF,OAAO,GAAGC,SAAWwH,IAAU3M,KAAKmpE,YAEf,iBAAnBnpE,KAAKmpE,YACXoc,GACAA,GAAYj9E,KAAKwR,IAAInN,EAAQ3M,KAAKmpE,YAAcnpE,KAAK+N,aAAa,IACnE,CACA/N,KAAKmpE,UAAYx8D,EACjB3M,KAAKgO,cAAc,GAAG,GACtB,MAAM9J,EAAW,UAAU4a,YAAY9e,KAAK+N,aAAa,GAAI/N,KAAKqH,SAAe,KAAE7I,OAC/EwB,KAAK62B,aAAayxC,aAAatoE,KAAK62B,aACxC72B,KAAK62B,YAAc1uB,WAAW,KAC5BnI,KAAKgO,cAAc,GAAG,IACrB9J,IAKT,wBACElE,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,UAGlE,EAAAmB,UAAUghD,iBAAiB,0BAA2By9D,I,8ECxEtD,aACA,OACA,OACA,OAEA,MAAMC,UAAmB,EAAAn9G,KAIvB,cACEwgB,QAJF,KAAAlO,OAAQ,EAKNxT,KAAK4B,MAAQ,SACb5B,KAAKyP,YACH,+MAEFzP,KAAKqH,SAAiB,OAAI,CACxBoI,YAAa,2BACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAK0P,SAAS,UAAW,EAAArE,KAAKI,SAC9BzL,KAAK+1B,qBAAqB,MAAO,EAAA1qB,KAAKG,OAAQ,EAAG,iBACjDxL,KAAK+1B,qBAAqB,MAAO,EAAA1qB,KAAKG,OAAQ,EAAG,iBACjDxL,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKG,QAC9BxL,KAAKgO,cAAc,EAAG,MAGxB,UACEhO,KAAKisB,iBAGP,iBACE,IAAIiO,EAAUl6B,KAAK+N,aAAa,GAChC,GAAe,MAAXmsB,EACFl6B,KAAKynE,SAAU,EACfznE,KAAKgO,cAAc,EAAG,MACtBhO,KAAKwT,OAAQ,OACR,GAAI0mB,GAAWl6B,KAAKynE,QAAS,OACpC,GAAe,GAAXvtC,EAAiB,CACnB,MAAM3xB,EAAMvI,KAAK+N,aAAa,GACxBiL,EAAMhZ,KAAK+N,aAAa,GAC9B/N,KAAKqH,SAAiB,OAAE7I,MACxB,IAAIyX,EAASjW,KAAKqH,SAAiB,OAAE7I,MACjC27B,EAAS7xB,KAAK2uD,UAAY1uD,EAAMyQ,GAAOA,EAC3CmhB,EAAS,UAAM2sE,cAAc3sE,EAAQlkB,GACrCjW,KAAKgO,cAAc,EAAGmsB,GAExBn6B,KAAKynE,QAAUvtC,GAGnB,EAAAv6B,UAAUghD,iBAAiB,iBAAkB09D,I,8EClD7C,aACA,OACA,OAGA,MAAaC,UAA4B,EAAAp9G,KAGvC,cACEwgB,QACA1hB,KAAK4B,MAAQ,SACb5B,KAAKyP,YACH,gHAEFzP,KAAK+1B,qBAAqB,SAAU,EAAA1qB,KAAKI,SAAS,EAAM,UACxDzL,KAAK+1B,qBAAqB,UAAW,EAAA1qB,KAAKE,OAAQ,OAAQ,WAC1DvL,KAAK0P,SAAS,UAAW,EAAArE,KAAKI,SAC9BzL,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKI,SAGhC,YACEzL,KAAK21B,aAAc,EAGrB,UACiB31B,KAAK+N,aAAa,IAE/B/N,KAAKgO,cAAc,EAAG,MAK1B,iBAEE,IADehO,KAAK+N,aAAa,GAG/B,YADA/N,KAAKgO,cAAc,EAAG,MAAM,GAG9B,IAAIksB,EAAUl6B,KAAK+N,aAAa,GAChC,GAAImsB,IAAYl6B,KAAK21B,YAAa,CAChC,MAAMxqB,EAAUnL,KAAK+N,aAAa,GAClC/N,KAAKgO,cAAc,EAAG7C,GAAS,GAEjCnL,KAAK21B,YAAcuE,EAGrB,0BAzCF,wBA2CA,EAAAv6B,UAAUghD,iBAAiB,iBAAkB29D,I,8EChD7C,aACA,OACA,OACA,OAEA,MAAaC,UAAmB,EAAAr9G,KAK9B,cACEwgB,QALF,KAAA+nD,aAAe,IACf,KAAAC,UAAoB,EAKlB1pE,KAAK4B,MAAQ,kBACb5B,KAAKyP,YACH,0OAEFzP,KAAK+1B,qBAAqB,SAAU,EAAA1qB,KAAKI,SAAS,EAAM,UACxDzL,KAAK+1B,qBAAqB,UAAW,EAAA1qB,KAAKM,IAAK,OAAQ,WACvD3L,KAAK+1B,qBAAqB,WAAY,EAAA1qB,KAAKG,OAAQ,EAAG,YACtDxL,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKI,SAC9BzL,KAAKqH,SAAe,KAAI,CACtBoI,YAAa,QACb7O,KAAM,EAAAiL,YAAYC,SAClBjJ,OAAQ,CACNmM,MAAO,CACL,CAAExQ,MAAO,eAAgB+S,KAAM,gBAC/B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,QAAS+S,KAAM,WAG5B/S,MAAO,WAETwB,KAAKo3B,kBAAkB,CACrBC,OAAQ,CAAC,CAAEnzB,SAAU,CAAEszB,OAAQ,GAAKpW,KAAM,OAI9C,UAIE,GAHA7d,cAAcvD,KAAK62B,aACnB72B,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,UAC/CwB,KAAK+N,aAAa,GAI/B,OAFA/N,KAAKgO,cAAc,EAAG,WACtBhO,KAAK0pE,UAAW,GAGlB,IAAIxlE,EAAWlE,KAAK+N,aAAa,GACjC7J,EAAW,UAAU4a,YAAY5a,EAAUlE,KAAKqH,SAAe,KAAE7I,OACjEwB,KAAK62B,YAAcvyB,YAAY,KAC7B,MAAM6G,EAAUnL,KAAK+N,aAAa,GAClC/N,KAAKgO,cAAc,EAAG7C,IACrBjH,GACHlE,KAAKisB,iBAGP,iBACE,MAAMkB,EAASntB,KAAK+N,aAAa,GACjC,IAAKof,GAAUntB,KAAK0pE,SAIlB,OAHAnmE,cAAcvD,KAAK62B,aACnB72B,KAAKgO,cAAc,EAAG,MAAM,QAC5BhO,KAAK0pE,UAAW,GAEX,IAAKv8C,IAAWntB,KAAK0pE,SAG1B,OAFA1pE,KAAKgO,cAAc,EAAG,MAAM,QAC5BhO,KAAK0pE,UAAW,GAEX,GAAIv8C,EAAQ,CACjB,IAAIjpB,EAAWlE,KAAK+N,aAAa,GAEjC,GADA7J,EAAW,UAAU4a,YAAY5a,EAAUlE,KAAKqH,SAAe,KAAE7I,OAC7DwB,KAAK0pE,SASP,YARIxlE,GAAYlE,KAAKypE,eACnBzpE,KAAKypE,aAAevlE,EACpBX,cAAcvD,KAAK62B,aACnB72B,KAAK62B,YAAcvyB,YAAY,KAC7B,MAAM6G,EAAUnL,KAAK+N,aAAa,GAClC/N,KAAKgO,cAAc,EAAG7C,IACrBjH,KAGKlE,KAAK0pE,WACf1pE,KAAK0pE,UAAW,EAChB1pE,KAAK62B,YAAcvyB,YAAY,KAC7B,MAAM6G,EAAUnL,KAAK+N,aAAa,GAClC/N,KAAKgO,cAAc,EAAG7C,IACrBjH,KAKT,wBACElE,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,SAC9DwB,KAAKisB,kBAvFT,eA0FA,EAAAtsB,UAAUghD,iBAAiB,0BAA2B49D,I,8EC/FtD,aACA,OACA,OACA,OAEA,MAAaC,UAAyB,EAAAt9G,KAWpC,cACEwgB,QAXF,KAAAlO,OAAiB,EACjB,KAAAk2D,UAAoB,EACpB,KAAA+0C,UAAoB,EACpB,KAAA/L,WAAqB,EACrB,KAAAgM,UAAoB,EAEpB,KAAA57F,MAAQ,EACR,KAAA67F,YAAc,KACd,KAAAC,cAAgB,KAId5+G,KAAK4B,MAAQ,WACb5B,KAAKyP,YACH,yrBAEFzP,KAAK+1B,qBAAqB,WAAY,EAAA1qB,KAAKG,OAAQ,GAAI,YAAY,GACnExL,KAAK+1B,qBAAqB,aAAc,EAAA1qB,KAAKG,OAAQ,EAAG,cAAc,GACtExL,KAAK0P,SAAS,QAAS,EAAArE,KAAKI,SAC5BzL,KAAK0P,SAAS,OAAQ,EAAArE,KAAKI,SAC3BzL,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKI,SAC9BzL,KAAK2Q,UAAU,WAAY,EAAAtF,KAAKI,SAChCzL,KAAK2Q,UAAU,QAAS,EAAAtF,KAAKG,QAC7BxL,KAAKqH,SAAe,KAAI,CACtBoI,YAAa,QACb7O,KAAM,EAAAiL,YAAYC,SAClBjJ,OAAQ,CACNmM,MAAO,CACL,CAAExQ,MAAO,eAAgB+S,KAAM,gBAC/B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,UAAW+S,KAAM,WAC1B,CAAE/S,MAAO,QAAS+S,KAAM,WAG5B/S,MAAO,WAETwB,KAAKo3B,kBAAkB,CACrBC,OAAQ,CAAC,CAAEnzB,SAAU,CAAEszB,OAAQ,GAAKpW,KAAM,OAE5CphB,KAAKqH,SAAgB,MAAI,CACvBoI,YAAa,iBACbjR,OAAO,EACPoC,KAAM,EAAAiL,YAAYJ,SAItB,UACElI,cAAcvD,KAAK62B,aACnB72B,KAAKgO,cAAc,GAAG,GACtBhO,KAAKgO,cAAc,GAAG,GACtBhO,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,SAC9DwB,KAAK0yG,WAAY,EACjB1yG,KAAK0+G,UAAW,EAChB1+G,KAAKy+G,UAAW,EAChBz+G,KAAK8iB,MAAQ,EACb9iB,KAAKisB,iBAGP,QACEjsB,KAAK0pE,UAAW,EACZ1pE,KAAKqH,SAAgB,MAAE7I,MACzBwB,KAAK62B,YAAcvyB,YAAY,KACX,GAAdtE,KAAKwT,OACPxT,KAAKwT,OAAQ,EACbxT,KAAKgO,cAAc,GAAG,GAClBhO,KAAK8iB,OAAS9iB,KAAK4+G,gBACrBr7G,cAAcvD,KAAK62B,aACnB72B,KAAKgO,cAAc,GAAG,GACtBhO,KAAKy+G,UAAW,EAChBz+G,KAAK0pE,UAAW,KAGlB1pE,KAAKwT,OAAQ,EACbxT,KAAKgO,cAAc,GAAG,GACtBhO,KAAK8iB,QACL9iB,KAAKgO,cAAc,EAAGhO,KAAK8iB,SAE5B9iB,KAAK2+G,aAAoC,EAArB3+G,KAAK4+G,cAAoB,IAEhD5+G,KAAK62B,YAAcvyB,YAAY,KAC7BtE,KAAKwT,OAAQ,EACbxT,KAAKgO,cAAc,GAAG,GACtBhO,KAAK8iB,QACL9iB,KAAKgO,cAAc,EAAGhO,KAAK8iB,OACvB9iB,KAAK8iB,OAAS9iB,KAAK4+G,gBACrBr7G,cAAcvD,KAAK62B,aACnB72B,KAAKy+G,UAAW,EAChBz+G,KAAK0pE,UAAW,IAEjB1pE,KAAK2+G,aAAe3+G,KAAK4+G,cAAgB,IAIhD,iBACE,IAAIn8G,EAAOzC,KAAK+N,aAAa,GAC7B,GAAItL,IAASzC,KAAK0+G,WAAa1+G,KAAKy+G,SAQlC,OAPAz+G,KAAK0+G,SAAWj8G,EACZzC,KAAKqH,SAAgB,MAAE7I,QACzBwB,KAAKwT,OAAQ,EACbxT,KAAKgO,cAAc,GAAG,IAExBzK,cAAcvD,KAAK62B,kBACnB72B,KAAK0pE,UAAW,GAIlB,IAAKjnE,GAAQzC,KAAK0+G,WAAa1+G,KAAKy+G,SAGlC,OAFAz+G,KAAK0+G,SAAWj8G,OAChBzC,KAAKyE,QAGPzE,KAAK0+G,SAAWj8G,EAEhB,IAAIgC,EAAQzE,KAAK+N,aAAa,GAC9B,GAAItJ,IAAUzE,KAAK0yG,UAAW,CAC5B1yG,KAAK0yG,UAAYjuG,EACjBlB,cAAcvD,KAAK62B,aACnB72B,KAAK8iB,MAAQ,EACT9iB,KAAKqH,SAAgB,MAAE7I,QACzBwB,KAAKwT,OAAQ,EACbxT,KAAKgO,cAAc,GAAG,IAExB,IAAI9J,EAAWlE,KAAK+N,aAAa,GACjC7J,EAAW,UAAU4a,YAAY5a,EAAUlE,KAAKqH,SAAe,KAAE7I,OACjE,MAAMqgH,EAAa7+G,KAAK+N,aAAa,GACrC,GAAI8wG,GAAc,GAAK36G,GAAY,EAEjC,YADAlE,KAAK0pE,UAAW,GAUlB,GAPA1pE,KAAK2+G,YAAcz6G,EACnBlE,KAAK4+G,cAAgBC,EACrB7+G,KAAKgO,cAAc,GAAG,GACtBhO,KAAKwT,OAAQ,EACbxT,KAAKy+G,UAAW,EAChBz+G,KAAK8iB,QACL9iB,KAAKgO,cAAc,EAAGhO,KAAK8iB,OACvBrgB,EACF,OAAIzC,KAAKqH,SAAgB,MAAE7I,WACzB2J,WAAW,KACTnI,KAAK0pE,UAAW,EAChB1pE,KAAKwT,OAAQ,EACbxT,KAAKgO,cAAc,GAAG,IACrB9J,GAAyB,EAAb26G,EAAiB,SAGlC7+G,KAAK0pE,UAAW,GAEX1pE,KAAKyE,QAEdzE,KAAK0yG,UAAYjuG,EAGnB,wBACEzE,KAAKkF,OAAO,GAAS,KAAI,eAAelF,KAAKqH,SAAe,KAAE7I,SAC9DwB,KAAKisB,kBA3JT,qBA8JA,EAAAtsB,UAAUghD,iBAAiB,mBAAoB69D,I,8ECnK/C,aACA,OACA,OACA,OAEA,MAAMM,UAAwC,EAAA59G,KAO5C,cACEwgB,QAPF,KAAAq9F,YAAsB,WACtB,KAAAC,iBAA2B,EAG3B,KAAA17B,eAAyB,IAIvBtjF,KAAK4B,MAAQ,iCACb5B,KAAKyP,YACH,iJACA,u7CACFzP,KAAK0P,SAAS,YAAa,EAAArE,KAAKE,QAChCvL,KAAK0P,SAAS,gBAAiB,EAAArE,KAAKI,SACpCzL,KAAK0P,SAAS,mBAAoB,EAAArE,KAAKG,QACvCxL,KAAK+1B,qBAAqB,qBAAsB,EAAA1qB,KAAKG,OAAQ,IAAK,iCAClExL,KAAK2Q,UAAU,aAAc,EAAAtF,KAAKE,QAClCvL,KAAK2Q,UAAU,eAAgB,EAAAtF,KAAKI,SACpCzL,KAAK2Q,UAAU,wBAAyB,EAAAtF,KAAKG,QAC7CxL,KAAKi/G,UAAY,UAAUngG,YAAY,IAAK,WAG9C,YACE9e,KAAK++G,YAAc,MACnB/+G,KAAKisB,iBAGP,UACEjsB,KAAK++G,YAAc,MACnB/+G,KAAKisB,iBAGP,iBACE,MAAMizF,EAAYl/G,KAAK+N,aAAa,GACpC,GAAiB,MAAbmxG,EAOF,OANAl/G,KAAK++G,YAAc,KACnB/+G,KAAKgO,cAAc,EAAG,IACtBhO,KAAKgO,cAAc,EAAG,MAClBhO,KAAK62B,aAAatzB,cAAcvD,KAAK62B,aACzC72B,KAAKg/G,iBAAmB,OACxBh/G,KAAKgO,cAAc,EAAG,MAEjB,GAAiB,OAAbkxG,EAOT,OANAl/G,KAAK++G,YAAc,MACnB/+G,KAAKgO,cAAc,EAAG,OACtBhO,KAAKgO,cAAc,GAAG,GAClBhO,KAAK62B,aAAatzB,cAAcvD,KAAK62B,aACzC72B,KAAKg/G,iBAAmB,OACxBh/G,KAAKgO,cAAc,EAAG,GAcxB,GAZwB,YAAbkxG,GAA2Bl/G,KAAK++G,cAAgBG,GACzDl/G,KAAK++G,YAAc,WACnB/+G,KAAKgO,cAAc,EAAG,YAClBhO,KAAK+N,aAAa,GAAI/N,KAAKm/G,iBAEzBn/G,KAAK62B,aAAatzB,cAAcvD,KAAK62B,aACzC72B,KAAKgO,cAAc,GAAG,GACtBhO,KAAKgO,cAAc,EAAG,KAEF,cAAbkxG,GAA6Bl/G,KAAK++G,cAAgBG,GAC3Dl/G,KAAKo/G,kBAEkB,aAArBp/G,KAAK++G,YAA4B,CACnC,MAAMM,EAAar/G,KAAK+N,aAAa,GAYrC,GAXIsxG,GAAYr/G,KAAKgO,cAAc,EAAG,GAClChO,KAAKkF,OAAO,GAAGC,UACbk6G,GACFr/G,KAAKgO,cAAc,GAAG,GACtBhO,KAAKm/G,kBAELn/G,KAAKgO,cAAc,GAAG,GAClBhO,KAAK62B,aAAatzB,cAAcvD,KAAK62B,aACzC72B,KAAKgO,cAAc,EAAG,KAGE,MAAxBhO,KAAK+N,aAAa,GAAY/N,KAAKgO,cAAc,EAAG,WACnD,GAAIhO,KAAKkF,OAAO,GAAGC,QAAS,CAC/B,MAAMopG,EAAWvuG,KAAK+N,aAAa,GAC/BwgG,GAAUvuG,KAAKgO,cAAc,EAAGugG,EAAW3pG,KAAKD,aAGtD,UAAUma,YAAY9e,KAAK+N,aAAa,GAAI,aAAe/N,KAAKi/G,WAC3C,eAArBj/G,KAAK++G,aAEL/+G,KAAKo/G,kBAIT,gBACMp/G,KAAK62B,aAAatzB,cAAcvD,KAAK62B,aACzC,MAAM03E,EAAWvuG,KAAK+N,aAAa,GAC/BwgG,GACFvuG,KAAKg/G,iBAAmBzQ,EAAW3pG,KAAKD,MACxC3E,KAAKgO,cAAc,EAAGhO,KAAKg/G,kBAC3Bh/G,KAAK62B,YAAcvyB,YAAY,KAC7BtE,KAAKg/G,kBAAoBh/G,KAAKsjF,eAC9BtjF,KAAKgO,cAAc,EAAGhO,KAAKg/G,mBAC1Bh/G,KAAKsjF,iBACHtjF,KAAKgO,cAAc,EAAG,MAC7BhO,KAAKgO,cAAc,GAAG,GAGxB,kBACEhO,KAAK++G,YAAc,aACnB/+G,KAAKgO,cAAc,EAAG,cACtBhO,KAAKgO,cAAc,GAAG,GACtBzK,cAAcvD,KAAK62B,aACnB,MAAMyoF,EAAa,UAAUxgG,YAAY9e,KAAK+N,aAAa,IAAM,IAAK,WACtE/N,KAAKi/G,UAAYK,EACjBt/G,KAAKg/G,iBAAmBM,EACxBt/G,KAAKgO,cAAc,EAAGsxG,GACtBt/G,KAAK62B,YAAcvyB,YAAY,KAE7B,GADAtE,KAAKg/G,kBAAoBh/G,KAAKsjF,eAC1BtjF,KAAKg/G,kBAAoB,EAO3B,OANAh/G,KAAKgO,cAAc,GAAG,GACtBhO,KAAKgO,cAAc,EAAG,GACtBhO,KAAK++G,YAAc,WACnB/+G,KAAKgO,cAAc,EAAG,YACtBzK,cAAcvD,KAAK62B,kBACf72B,KAAK+N,aAAa,IAAI/N,KAAKm/G,iBAGjCn/G,KAAKgO,cAAc,EAAGhO,KAAKg/G,mBAC1Bh/G,KAAKsjF,gBAGV,wBACEtjF,KAAKisB,kBAGT,EAAAtsB,UAAUghD,iBAAiB,iCAAkCm+D,I,8ECxI7D,aACA,OACA,OACA,OAEA,MAAMS,UAAkC,EAAAr+G,KAItC,cACEwgB,QACA1hB,KAAK4B,MAAQ,0BACb5B,KAAKyP,YACH,+GACFzP,KAAK+1B,qBAAqB,SAAU,EAAA1qB,KAAKI,SAAS,EAAM,UACxDzL,KAAK0P,SAAS,OAAQ,EAAArE,KAAKG,QAC3BxL,KAAK0P,SAAS,KAAM,EAAArE,KAAKG,QACzBxL,KAAK0P,SAAS,oBAAqB,EAAArE,KAAKG,QACxCxL,KAAK0P,SAAS,QAAS,EAAArE,KAAKG,QAC5BxL,KAAK2Q,UAAU,SAAU,EAAAtF,KAAKE,QAE9BvL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,IACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,uBACbjR,MAAO,GACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,IACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,uBACbjR,MAAO,GACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,EACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,IACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,uBACbjR,MAAO,GACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,uBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,uBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,OAAQ,EACRoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,OAAQ,IACRoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,uBACbjR,MAAO,GACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,OAAQ,IACRoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,OAAQ,EACRoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,uBACbjR,MAAO,GACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,OAAQ,EACRoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,OAAQ,IACRoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,uBACbjR,MAAO,GACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA4B,kBAAI,CACnCoI,YAAa,mBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA0B,gBAAI,CACjCoI,YAAa,uBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKqH,SAA6B,mBAAI,CACpCoI,YAAa,mBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA6B,mBAAI,CACpCoI,YAAa,mBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAEpBxL,KAAKqH,SAA2B,iBAAI,CAClCoI,YAAa,uBACbjR,MAAO,KACPoC,KAAM,EAAAiL,YAAYL,QAGpBxL,KAAKo3B,kBAAkB,CACrBC,OAAQ,CACN,CAAEmoF,kBAAmB,GAAIC,kBAAmB,GAAIC,gBAAiB,IACjE,CAAEC,kBAAmB,GAAIC,kBAAmB,GAAIC,gBAAiB,IACjE,CAAEC,kBAAmB,GAAIC,kBAAmB,GAAIC,gBAAiB,IACjE,CAAEC,kBAAmB,GAAIC,kBAAmB,GAAIC,gBAAiB,IACjE,CAAEC,kBAAmB,GAAIC,kBAAmB,GAAIC,gBAAiB,IACjE,CAAEC,kBAAmB,GAAIC,kBAAmB,GAAIC,gBAAiB,IACjE,CAAEC,kBAAmB,GAAIC,kBAAmB,GAAIC,gBAAiB,IACjE,CAAEC,kBAAmB,GAAIC,kBAAmB,GAAIC,gBAAiB,IACjE,CAAEC,kBAAmB,GAAIC,kBAAmB,GAAIC,gBAAiB,IACjE,CAAEC,mBAAoB,GAAIC,mBAAoB,GAAIC,iBAAkB,OAK1E,YACErhH,KAAK8kB,SAAU,EACf9kB,KAAK6E,iBAAmB,IAG1B,UACE7E,KAAK6E,iBAAmB,IACxB7E,KAAKisB,iBAGP,wBACEjsB,KAAKisB,iBACLjsB,KAAKy6E,YAGP,YACE,MAAM91E,GAAM,IAAIC,MAAOszB,UAEvB,IADel4B,KAAK+N,aAAa,IACA,MAAlB/N,KAAKsuG,WAAqBtuG,KAAKsuG,UAAY3pG,EAAM,EAG9D,OAFA3E,KAAKgO,cAAc,GAAG,QACtBhO,KAAK8kB,SAAU,GAGjB,GAAI9kB,KAAK8kB,QAAS,OAClB,MAAM+3E,EAAO78F,KAAK+N,aAAa,GACzBgoE,EAAW/1E,KAAK+N,aAAa,GACnC,GAAY,MAAR8uF,GAA4B,MAAZ9mB,EACpB,IAAK,IAAIx4E,EAAI,EAAGA,GAAK,GAAIA,IAAK,CAC5B,IAAI+jH,EAAYthH,KAAKqH,SAAS,YAAY9J,YAAYiB,MAClD+iH,EAAUvhH,KAAKqH,SAAS,YAAY9J,YAAYiB,MAChD4iB,EAAOphB,KAAKqH,SAAS,YAAY9J,UAAUiB,MAC/C,GAAiB,MAAb8iH,GAAgC,MAAXC,GAA2B,MAARngG,IAC5CA,EAAO,UAAUtC,YAAYsC,EAAM,WAC/BphB,KAAKsuG,UAAY3pG,GAAOyc,GAAM,CAChC,GAAI7jB,GAAK,GAAKs/F,EAAO9mB,EAAWurC,GAAazkB,GAAQ9mB,EAAWwrC,EAG9D,OAFAvhH,KAAK8kB,SAAU,OACf9kB,KAAKgO,cAAc,GAAG,GAGxB,GAAIzQ,EAAI,GAAKs/F,EAAO9mB,EAAWurC,GAAazkB,GAAQ9mB,EAAWwrC,EAG7D,OAFAvhH,KAAK8kB,SAAU,OACf9kB,KAAKgO,cAAc,GAAG,KAO9B,iBAEE,IADehO,KAAK+N,aAAa,GAI/B,OAFA/N,KAAKgO,cAAc,GAAG,QACtBhO,KAAK8kB,SAAU,GAGH9kB,KAAK+N,aAAa,IACnB/N,KAAKkF,OAAO,GAAGC,UAC1BnF,KAAK8kB,SAAU,EACf9kB,KAAKgO,cAAc,GAAG,IAExB,MAAMsgG,EAAYtuG,KAAK+N,aAAa,GACnB,MAAbugG,GAAqBA,IAActuG,KAAKsuG,YAC1CtuG,KAAKsuG,UAAYA,EACjBtuG,KAAKgO,cAAc,GAAG,GACtBhO,KAAK8kB,SAAU,IAIrB,EAAAnlB,UAAUghD,iBAAiB,iCAAkC4+D,I,8ECzQ7D,aACA,OACA,SAEA,EAAA5/G,UAAUghD,iBAAiB,EAAA72B,aAAc,EAAA03F,YAAa,MAAM,I,8ECJ5D,aAEA,MAAaA,UAAoB,EAAAtgH,KAC/B,cACEwgB,QACA1hB,KAAK4B,MAAQ,UACb5B,KAAKyP,YAAc,+DAJvB,iB,8YCYA,eACA,SACA,SACA,SACA,SACA,SAUA,SAEA,MAAMgyG,EAUJ,cACEzhH,KAAK0hH,iBAAmB,IAAI,UAC5B1hH,KAAK2hH,aAAe,IAAI,UACxB3hH,KAAK4hH,aAAe,IAAI,UACxB5hH,KAAK6hH,kBAAoB,IAAI,UAC7B7hH,KAAK8hH,YAAc,IAAI,UACvB9hH,KAAK+hH,iBAAmB,IAAI,UAC5B/hH,KAAKgiH,kBAAoB,IAAI,UAGzB,kBAAkBC,EAAkBR,EAAaS,kB,yCACrD,UACQliH,KAAK0hH,iBAAiB7zF,kBAAkBo0F,SACxCjiH,KAAK2hH,aAAa9zF,kBAAkBo0F,SACpCjiH,KAAK4hH,aAAa/zF,kBAAkBo0F,SACpCjiH,KAAK6hH,kBAAkBh0F,kBAAkBo0F,SACzCjiH,KAAK8hH,YAAYj0F,kBAAkBo0F,SACnCjiH,KAAK+hH,iBAAiBl0F,kBAAkBo0F,SACxCjiH,KAAKgiH,kBAAkBn0F,kBAAkBo0F,GAC/C,MAAOluG,GACP,MAAMA,EAER,OAAO,QAGT,QAAQg5C,EAAYhmD,GAClB/G,KAAK2hH,aAAaQ,QAAQp1D,EAAMhmD,GAGlC,gBAAgBy7D,EAAezV,GAC7B,OAAO/sD,KAAK2hH,aAAajhC,gBAAgBle,EAAOzV,GAGlD,SAAShmD,GACP/G,KAAK2hH,aAAaS,SAASr7G,GAG7B,QAAQy7D,EAAez7D,GACrB/G,KAAK2hH,aAAaU,QAAQ7/C,EAAOz7D,GAGnC,gBACE,OAAO/G,KAAK2hH,aAAa70D,gBAG3B,WAAW0V,EAAezV,EAAYhmD,GACpC/G,KAAK2hH,aAAaW,WAAW9/C,EAAOzV,GAGtC,cAAchmD,GACZ/G,KAAK2hH,aAAaY,cAAcx7G,GAGlC,WAAWy7D,EAAez7D,GACxB/G,KAAK2hH,aAAalhC,WAAWje,EAAOz7D,GAGtC,UAAUA,GACR/G,KAAK2hH,aAAaa,YAGpB,QAAQrhH,EAAY4F,GAClB/G,KAAK4hH,aAAa/4G,QAAQ1H,EAAM4F,GAGlC,SAASA,GACP/G,KAAK4hH,aAAaxzF,SAASrnB,GAG7B,YAAYnG,EAAcmG,GACxB/G,KAAK4hH,aAAa5+E,YAAYpiC,EAAMmG,GAGtC,eAAey7D,EAAOz7D,GACpB/G,KAAK4hH,aAAand,eAAejiC,EAAOz7D,GAG1C,QAAQlH,EAAYuH,EAAaL,GAC/B/G,KAAK4hH,aAAaa,QAAQ5iH,EAAIuH,EAAKL,GAGrC,WAAWlH,EAAYuH,EAAaotB,EAAaztB,GAC/C/G,KAAK4hH,aAAa35G,WAAWpI,EAAIuH,EAAKotB,EAAQztB,GAGhD,WAAWlH,EAAYuH,EAAaL,GAClC/G,KAAK4hH,aAAal4G,WAAW7J,EAAIuH,EAAKL,GAGxC,UAAUA,GACR/G,KAAK4hH,aAAac,UAAU37G,GAG9B,WAAW83D,EAAgB93D,GACzB/G,KAAK6hH,kBAAkBnjD,WAAWG,EAAO93D,GAG3C,YAAYA,GACV/G,KAAK6hH,kBAAkB/jD,YAAY/2D,GAGrC,WAAWjJ,EAAciJ,GACvB/G,KAAK6hH,kBAAkBvjD,WAAWxgE,EAAMiJ,GAG1C,cAAcjJ,EAAc02B,EAAaztB,GACvC/G,KAAK6hH,kBAAkBpjD,cAAc3gE,EAAM02B,EAAQztB,GAGrD,aAAaA,GACX/G,KAAK6hH,kBAAkBc,aAAa57G,GAGtC,cAAcjJ,EAAciJ,GAC1B/G,KAAK6hH,kBAAkB9iD,cAAcjhE,EAAMiJ,GAG7C,mBAAmBA,GACjB/G,KAAK8hH,YAAY7zF,mBAAmBlnB,GAGtC,sBAAsBlH,EAAYkH,GAChC/G,KAAK8hH,YAAYt3F,sBAAsB3qB,EAAIkH,GAG7C,kBAAkBA,GAChB/G,KAAK8hH,YAAY5zF,kBAAkBnnB,GAGrC,qBAAqBlH,EAAYkH,GAC/B/G,KAAK8hH,YAAY95G,qBAAqBnI,EAAIkH,GAG5C,QAAQA,GACN/G,KAAK8hH,YAAYc,QAAQ77G,GAG3B,YAAY87G,EAAoB97G,GAC9B/G,KAAK+hH,iBAAiBe,YAAYD,EAAU97G,GAG9C,eAAey7D,EAAeqgD,EAAoB97G,GAChD/G,KAAK+hH,iBAAiBgB,eAAevgD,EAAOqgD,EAAU97G,GAGxD,eAAey7D,EAAez7D,GAC5B/G,KAAK+hH,iBAAiBiB,eAAexgD,EAAOz7D,GAK9C,WAAWk8G,EAAkBl8G,GAC3B/G,KAAKgiH,kBAAkBkB,WAAWD,EAASl8G,GAG7C,cAAcy7D,EAAeygD,EAAkBl8G,GAC7C/G,KAAKgiH,kBAAkBmB,cAAc3gD,EAAOygD,EAASl8G,GAGvD,cAAcy7D,EAAez7D,GAC3B/G,KAAKgiH,kBAAkBoB,cAAc5gD,EAAOz7D,GAG9C,YAAY09D,GACV,OAAOzkE,KAAK0hH,iBAAiBh9C,YAAYD,GAG3C,cACE,OAAOzkE,KAAK0hH,iBAAiB/8C,cAG/B,kBACE,OAAO3kE,KAAK0hH,iBAAiB98C,kBAG/B,aAAaH,GACX,OAAOzkE,KAAK0hH,iBAAiB78C,aAAaJ,GAG5C,gBAAgB3e,GACd,OAAO9lD,KAAK0hH,iBAAiB37D,gBAAgBD,IA7LhC,EAAAo8D,iBAAmB,IAmMpC,MAAMxhH,EAAK,IAAI+gH,EACN,EAAA/gH,M,8YCpOT,cAGA,OAEMnB,EAAM,EAAQ,GAAaV,OAAO,WAAY,CAAEW,MAAO,IAE7D,gBAGQ,kBAAkByiH,G,yCACtB,MAAMh8F,EAAO,UAAOxB,QAGpB,OAFAzkB,KAAKmuB,IAAM,IAAIk1F,EAAc,GAAGp9F,YAChCjmB,KAAKmuB,IAAIm1F,YAAYC,0BAA0BtB,GACxCjiH,KAAKwjH,aAGN,UACN,OAAO,IAAI76G,QAAa,CAACC,EAASunB,KAChCnwB,KAAKmuB,IAAId,aAAajkB,IAChBA,IACF7J,EAAI8J,MAAMD,GACV+mB,EAAO/mB,IAEFR,QAKb,mBAAmB7B,GACjB/G,KAAKmuB,IAAIs1F,QAAQ,CAAEC,IAAK,oBAAqB,SAASt6G,EAAKs7F,GACrDt7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GACOA,EAASqC,EAAds7F,EAAmBA,EAAIif,KACR,SAKzB,sBAAsB9jH,EAAYkH,GAChC/G,KAAKmuB,IAAIqG,OAAO,CAAEkvF,IAAK,mBAAqB,CAAEx7G,KAAM,CAAEy7G,KAAM9jH,IAAQ,CAAE+jH,QAAQ,IAAQ,SACpFx6G,EACAjE,GAEIiE,GAAK7J,EAAI8J,MAAMD,GACJ,GAAXjE,GAAc5F,EAAI8J,MAAM,qCACxBtC,GAAUA,EAASqC,MAI3B,kBAAkBrC,GAChB/G,KAAKmuB,IAAIs1F,QAAQ,CAAEC,IAAK,mBAAoB,SAASt6G,EAAKs7F,GACpDt7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GACOA,EAASqC,EAAds7F,EAAmBA,EAAIif,KACR,SAKzB,qBAAqB9jH,EAAYkH,GAC/B/G,KAAKmuB,IAAIqG,OAAO,CAAEkvF,IAAK,kBAAoB,CAAEx7G,KAAM,CAAEy7G,KAAM9jH,IAAQ,CAAE+jH,QAAQ,IAAQ,SACnFx6G,EACAjE,GAEIiE,GAAK7J,EAAI8J,MAAMD,GACJ,GAAXjE,GAAc5F,EAAI8J,MAAM,qCACxBtC,GAAUA,EAASqC,MAI3B,QAAQrC,GACN/G,KAAKmuB,IAAIplB,OAAO,GAAI,CAAE86G,OAAO,IAAQ,SAASz6G,GACxCA,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,S,8YC1E7B,cAGA,OAGM7J,EAAM,EAAQ,GAAaV,OAAO,WAAY,CAAEW,MAAO,IAE7D,gBAGQ,kBAAkByiH,G,yCACtB,MAAMh8F,EAAO,UAAOxB,QAGpB,OAFAzkB,KAAKW,UAAY,IAAI0iH,EAAc,GAAGp9F,kBACtCjmB,KAAKW,UAAU2iH,YAAYC,0BAA0BtB,GAC9CjiH,KAAK8jH,mBAGN,gBACN,OAAO,IAAIn7G,QAAa,CAACC,EAASunB,KAChCnwB,KAAKW,UAAU0sB,aAAajkB,IACtBA,IACF7J,EAAI8J,MAAMD,GACV+mB,EAAO/mB,IAEFR,QAKb,WAAWi2D,EAAgB93D,GACzB/G,KAAKW,UAAU8lD,OAAOoY,GAAO,SAASz1D,EAAKs7F,GACrCt7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAKs7F,MAIhC,YAAY39F,GACV/G,KAAKW,UAAUsyB,KAAK,IAAI,SAAS7pB,EAAK65B,GAChC75B,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAK65B,MAIhC,WAAWnlC,EAAciJ,GACvB/G,KAAKW,UAAU8iH,QAAQ,CAAE3lH,KAAMA,IAAQ,SAASsL,EAAKs7F,GAC/Ct7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAKs7F,MAIhC,cAAc5mG,EAAc02B,EAAaztB,GACvC/G,KAAKW,UAAU6zB,OAAO,CAAE12B,KAAMA,GAAQ02B,EAAQ,IAAI,SAASprB,EAAKjE,GAC1DiE,GAAK7J,EAAI8J,MAAMD,GACJ,GAAXjE,GAAc5F,EAAI8J,MAAM,iCAAiCvL,2BACzDiJ,GAAUA,EAASqC,MAI3B,cAActL,EAAciJ,GAC1B/G,KAAKW,UAAUoI,OAAO,CAAEjL,KAAMA,GAAQ,IAAI,SAASsL,EAAK26G,GAClD36G,GAAK7J,EAAI8J,MAAMD,GACJ,GAAX26G,GAAcxkH,EAAI8J,MAAM,qCACxBtC,GAAUA,EAASqC,MAI3B,aAAarC,GACX/G,KAAKW,UAAUoI,OAAO,GAAI,CAAE86G,OAAO,IAAQ,SAASz6G,GAC9CA,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,S,8YCtE7B,cAGA,OAGM7J,EAAM,EAAQ,GAAaV,OAAO,WAAY,CAAEW,MAAO,IAE7D,gBAGQ,kBAAkByiH,G,yCACtB,MAAMh8F,EAAO,UAAOxB,QAGpB,OAFAzkB,KAAKyG,MAAQ,IAAI48G,EAAc,GAAGp9F,cAClCjmB,KAAKyG,MAAM68G,YAAYC,0BAA0BtB,GAC1CjiH,KAAKgkH,UAGN,OACN,OAAO,IAAIr7G,QAAa,CAACC,EAASunB,KAChCnwB,KAAKyG,MAAM4mB,aAAajkB,IAClBA,IACF7J,EAAI8J,MAAMD,GACV+mB,EAAO/mB,IAEFR,QAKb,QAAQzH,EAAY4F,GAClB,IAAIqG,EAAWjM,EAAK4J,YACdqC,EAAUs2G,IAAM,IAAMt2G,EAAShG,IAAM,IAAMgG,EAASvN,GAE1DG,KAAKyG,MAAMggD,OAAOr5C,GAAU,SAAShE,EAAKs7F,GACpCt7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAKs7F,MAIhC,SAAS39F,GACP/G,KAAKyG,MAAMwsB,KAAK,IAAI,SAAS7pB,EAAK65B,GAC5B75B,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAK65B,MAIhC,QAAQpjC,EAAYuH,EAAaL,GAC/B,IAAI28G,EAAM,IAAMt8G,EAAM,IAAMvH,EAC5BG,KAAKyG,MAAMg9G,QAAQ,CAAEC,IAAKA,IAAO,SAASt6G,EAAKs7F,GACzCt7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAKs7F,MAIhC,YAAY9jG,EAAcmG,GACxB/G,KAAKyG,MAAMwsB,KAAK,CAAEryB,KAAMA,IAAQ,SAASwI,EAAK65B,GACxC75B,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAK65B,MAIhC,eAAeu/B,EAAOz7D,GACpB/G,KAAKyG,MAAMwsB,KAAKuvC,GAAO,SAASp5D,EAAK65B,GAC/B75B,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAK65B,MAIhC,WAAWpjC,EAAYuH,EAAaotB,EAAaztB,GAC/C,IAAI28G,EAAM,IAAMt8G,EAAM,IAAMvH,EAC5BG,KAAKyG,MAAM+tB,OAAO,CAAEkvF,IAAKA,GAAOlvF,EAAQ,IAAI,SAASprB,EAAKjE,GACpDiE,GAAK7J,EAAI8J,MAAMD,GACJ,GAAXjE,GAAc5F,EAAI8J,MAAM,sBAAsBjC,KAAOvH,2BACrDkH,GAAUA,EAASqC,MAI3B,WAAWvJ,EAAYuH,EAAaL,GAClC,IAAI28G,EAAM,IAAMt8G,EAAM,IAAMvH,EAC5BG,KAAKyG,MAAMsC,OAAO,CAAE26G,IAAKA,GAAO,IAAI,SAASt6G,EAAK26G,GAC5C36G,GAAK7J,EAAI8J,MAAMD,GACJ,GAAX26G,GAAcxkH,EAAI8J,MAAM,qCACxBtC,GAAUA,EAASqC,MAI3B,UAAUrC,GACR/G,KAAKyG,MAAMsC,OAAO,GAAI,CAAE86G,OAAO,IAAQ,SAASz6G,GAC1CA,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,S,8YC1F7B,cAIA,OAEM7J,EAAM,EAAQ,GAAaV,OAAO,WAAY,CAAEW,MAAO,IAE7D,gBAGQ,kBAAkByiH,G,yCACtB,MAAMh8F,EAAO,UAAOxB,QAGpB,OAFAzkB,KAAK6iH,SAAW,IAAIQ,EAAc,GAAGp9F,iBACrCjmB,KAAK6iH,SAASS,YAAYC,0BAA0BtB,GAC7CjiH,KAAKikH,kBAGN,eACN,OAAO,IAAIt7G,QAAa,CAACC,EAASunB,KAChCnwB,KAAK6iH,SAASx1F,aAAajkB,IACrBA,IACF7J,EAAI8J,MAAMD,GACV+mB,EAAO/mB,IAEFR,QAKb,YAAYi6G,EAAoB97G,GAC9B/G,KAAK6iH,SAASp8D,OAAOo8D,GAAU,SAASz5G,EAAKs7F,GACvCt7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAKs7F,MAIhC,eACEliC,EACAqgD,EACA97G,EACAm9G,GAEAlkH,KAAK6iH,SAASruF,OAAOguC,EAAOqgD,EAAU,IAAI,SAASz5G,EAAKjE,GAClDiE,EAAK7J,EAAI8J,MAAMD,GAEjB86G,EAAgB/+G,GAEH,GAAXA,GAAc5F,EAAI8J,MAAM,0BAA0BvL,8BAClDiJ,GAAUA,EAASqC,MAK3B,eACEo5D,EACAz7D,EACAo9G,GAEAnkH,KAAK6iH,SAAS95G,OAAOy5D,EAAO,IAAI,SAASp5D,EAAK26G,GACxC36G,EACF7J,EAAI8J,MAAMD,GAEV+6G,EAAgBJ,GAEH,GAAXA,GAAcxkH,EAAIc,MAAM,8CACxB0G,GAAUA,EAASqC,S,8YClE7B,cAIA,OAEM7J,EAAM,EAAQ,GAAaV,OAAO,WAAY,CAAEW,MAAO,IAE7D,gBAGQ,kBAAkByiH,G,yCACtB,MAAMh8F,EAAO,UAAOxB,QAGpB,OAFAzkB,KAAKijH,QAAU,IAAII,EAAc,GAAGp9F,gBACpCjmB,KAAKijH,QAAQK,YAAYC,0BAA0BtB,GAC5CjiH,KAAKokH,iBAGN,cACN,OAAO,IAAIz7G,QAAa,CAACC,EAASunB,KAChCnwB,KAAKijH,QAAQ51F,aAAajkB,IACpBA,IACF7J,EAAI8J,MAAMD,GACV+mB,EAAO/mB,IAEFR,QAKb,WAAWq6G,EAAkBl8G,GAC3B/G,KAAKijH,QAAQx8D,OAAOw8D,GAAS,SAAS75G,EAAKs7F,GACrCt7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAKs7F,MAIhC,cACEliC,EACAygD,EACAl8G,EACAm9G,GAEAlkH,KAAKijH,QAAQzuF,OAAOguC,EAAOygD,EAAS,IAAI,SAAS75G,EAAKjE,GAChDiE,EAAK7J,EAAI8J,MAAMD,GAEjB86G,EAAgB/+G,GAEH,GAAXA,GAAc5F,EAAI8J,MAAM,yBAAyBvL,8BACjDiJ,GAAUA,EAASqC,MAK3B,cACEo5D,EACAz7D,EACAo9G,GAEAnkH,KAAKijH,QAAQl6G,OAAOy5D,EAAO,IAAI,SAASp5D,EAAK26G,GACvC36G,EACF7J,EAAI8J,MAAMD,GAEV+6G,EAAgBJ,GAEH,GAAXA,GAAcxkH,EAAIc,MAAM,6CACxB0G,GAAUA,EAASqC,S,8YClE7B,cAIA,OAEM7J,EAAM,EAAQ,GAAaV,OAAO,WAAY,CAAEW,MAAO,IAE7D,gBAGQ,kBAAkByiH,G,yCACtB,MAAMh8F,EAAO,UAAOxB,QAGpB,OAFAzkB,KAAKqkH,MAAQ,IAAIhB,EAAc,GAAGp9F,cAClCjmB,KAAKqkH,MAAMf,YAAYC,0BAA0BtB,GAC1CjiH,KAAKskH,eAGN,YACN,OAAO,IAAI37G,QAAa,CAACC,EAASunB,KAChCnwB,KAAKqkH,MAAMh3F,aAAajkB,IAClBA,IACF7J,EAAI8J,MAAMD,GACV+mB,EAAO/mB,IAEFR,QAKb,QAAQmkD,EAAYhmD,GAClB/G,KAAKqkH,MAAM59D,OAAOsG,GAAM,SAAS3jD,EAAKs7F,GAChCt7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAKs7F,MAIhC,QAAQliC,EAAez7D,GACrB/G,KAAKqkH,MAAMZ,QAAQjhD,GAAO,SAASp5D,EAAKs7F,GAClCt7F,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAKs7F,MAIhC,SAAS39F,GACP/G,KAAKqkH,MAAMpxF,KAAK,IAAI,SAAS7pB,EAAK65B,GAC5B75B,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAK65B,MAIhC,gBACE,OAAO,IAAIt6B,QAAQ,CAACC,EAASunB,KAC3BnwB,KAAKqkH,MAAMpxF,KAAK,IAAI,SAAS7pB,EAAKs7F,GAC5Bt7F,GACF7J,EAAI8J,MAAMD,GACV+mB,EAAO/mB,IACFR,EAAQ87F,QAKrB,WAAWliC,EAAezV,EAAYhmD,GACpC/G,KAAKqkH,MAAM7vF,OAAOguC,EAAOzV,EAAM,IAAI,SAAS3jD,EAAKjE,GAC3CiE,GAAK7J,EAAI8J,MAAMD,GACJ,GAAXjE,GAAc5F,EAAI8J,MAAM,sBAAsBvL,8BAC9CiJ,GAAUA,EAASqC,MAI3B,cAAcrC,GACZ/G,KAAKqkH,MAAMvhG,MAAM,IAAI,SAAS1Z,EAAKgQ,GAC7BhQ,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,EAAKgQ,MAIhC,gBAAgBopD,EAAezV,GAC7B,OAAO,IAAIpkD,QAAQ,CAACC,EAASunB,KAC3BnwB,KAAKqiH,QAAQ7/C,EAAO,CAACp5D,EAAKm7G,KACpBA,EACFvkH,KAAKsiH,WAAW9/C,EAAOzV,EAAM3jD,IACvBA,EAAK+mB,EAAO/mB,GACXR,MAGP5I,KAAKmiH,QAAQp1D,EAAM3jD,IACbA,EAAK+mB,EAAO/mB,GACXR,UAOf,WAAW45D,EAAez7D,GACxB/G,KAAKqkH,MAAMt7G,OAAOy5D,EAAO,IAAI,SAASp5D,EAAK26G,GACrC36G,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,MAI3B,UAAUrC,GACR/G,KAAKqkH,MAAMt7G,OAAO,GAAI,CAAE86G,OAAO,IAAQ,SAASz6G,GAC1CA,GAAK7J,EAAI8J,MAAMD,GACfrC,GAAUA,EAASqC,S,8YCzG7B,cACA,OAGA,QAEMujD,EAAM,EAAQ,KACdptD,EAAM,EAAQ,GAAaV,OAAO,gBAAiB,CAAEW,MAAO,IAElE,gBAGQ,kBAAkByiH,G,yCACtB,MAAMh8F,EAAO,UAAOxB,QAGpB,OAFAzkB,KAAK6iC,KAAO,IAAIwgF,EAAc,GAAGp9F,aACjCjmB,KAAK6iC,KAAKygF,YAAYC,0BAA0BtB,GACzCjiH,KAAKwkH,cAGN,WACN,OAAO,IAAI77G,QAAa,CAACC,EAASunB,KAChCnwB,KAAK6iC,KAAKxV,aAAajkB,IACjBA,IACF7J,EAAI8J,MAAMD,GACV+mB,EAAO/mB,IAEFR,QAKb,YAAY67D,GACV,OAAO,IAAI97D,QAAQ,CAACC,EAASunB,KAC3BnwB,KAAK6iC,KAAK5P,KAAK,GAAI,CAAC7pB,EAAKs7F,KACvB,GAAIA,EAAIljG,OAGN,OAFAjC,EAAI6L,KAAK,iCACT+kB,EAAO,4BAGTs0C,EAAS5+C,SAAW,UAAY6F,QAAQ+4C,EAAS5+C,UACjD7lB,KAAK6iC,KAAK4jB,OAAOge,EAAU,CAACr7D,EAAKs7F,KAC3Bt7F,GACF+mB,EAAO/mB,GACP7J,EAAI8J,MAAMD,IAEVR,EAAQ87F,SAOlB,cACE,OAAO,IAAI/7F,QAAQ,CAACC,EAASunB,KAC3BnwB,KAAK6iC,KAAK4gF,QAAQ,GAAI,CAACr6G,EAAKs7F,KACtBt7F,GACF+mB,EAAO/mB,GACP7J,EAAI8J,MAAMD,IAEVR,EAAQ87F,OAMhB,kBACE,OAAO,IAAI/7F,QAAQ,CAACC,EAASunB,KAC3BnwB,KAAK6iC,KAAK95B,OAAO,GAAI,CAAE86G,OAAO,GAAQz6G,IAChCA,GACF+mB,EAAO/mB,GACP7J,EAAI8J,MAAMD,IAEVR,EAAQ,4BAMhB,aAAa67D,GACX,OAAO,IAAI97D,QAAQ,CAACC,EAASunB,KAC3BnwB,KAAK6iC,KAAK4gF,QAAQ,CAAE99F,SAAU8+C,EAAS9+C,UAAY,CAACvc,EAAKs7F,KACvD,GAAIt7F,EACF+mB,EAAO/mB,GACP7J,EAAI8J,MAAMD,QACL,GAAIs7F,GAAO,UAAY94E,QAAQ84E,EAAI7+E,YAAc4+C,EAAS5+C,SAAU,CACzE,MAAMigC,EAAQ6G,EAAIyiB,KAAK,CAAEzpD,SAAU++E,EAAI/+E,UAAY,UAAOrB,UAAW,CAAEmgG,UAAW,OAClF77G,EAAQ,GAAGk9C,UAEXvmD,EAAI6L,KAAK,uBACT+kB,EAAO,2BAMf,gBAAgB21B,GACd,OAAO,IAAIn9C,QAAQ,CAACC,EAASunB,KAC3Bw8B,EAAI+3D,OAAO5+D,EAAO,UAAOxhC,UAAW,CAAClb,EAAKu7G,KACpCv7G,GACF7J,EAAI8J,MAAMD,GACV+mB,EAAO/mB,IAEPR,EAAQ+7G,U,cCtGlBrnH,EAAOD,QAAU2mB,QAAQ","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 93);\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 04.07.2016.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Node, SerializedNode } from './node';\nimport { Renderer } from '../client/editor/renderer';\nimport { ContainerNode } from './container-node';\nimport { Database } from '../database/database';\nimport Utils from './utils';\nimport { Dashboard } from '../server/dashboard';\nimport ContainerUtils from './container-utils';\nimport Registry from './registry';\nimport Namespace = SocketIO.Namespace;\nimport { get, uniq } from 'lodash';\n\nconst log = require('logplease').create('container', { color: 5 });\nconst doNothing = () => {};\n\nexport interface SerializedContainer {\n  id: number;\n  last_node_id: number;\n  config?: any;\n  name: string;\n  serializedNodes?: Array<SerializedNode>;\n}\n\nexport enum Side {\n  server,\n  editor,\n  dashboard,\n}\n\nexport class Container {\n  static nodes_types: { [type: string]: any } = {};\n  static containers: { [id: number]: Container } = {};\n  static last_container_id: number = -1;\n\n  static rootContainer(): Container {\n    return this.containers[0];\n  }\n\n  parent_container_id?: number;\n  parent_id?: number;\n  container_node: ContainerNode;\n\n  client_socket: SocketIOClient.Socket; //SocketIOClient.Socket|SocketIO.Server;\n  server_dashboard_socket: Namespace;\n  server_editor_socket: Namespace;\n\n  db: Database;\n  dashboard: Dashboard;\n\n  _nodes: { [id: number]: Node } = {};\n\n  id: number;\n  name: string;\n  side: Side;\n  renderers: Array<Renderer>;\n  isRunning: boolean;\n  last_node_id: number;\n  iteration: number;\n  tag?: string;\n  config: {\n    links_ontop?: boolean;\n  };\n\n  globaltime: number;\n  runningtime: number;\n  fixedtime: number;\n  fixedtime_lapse: number;\n  elapsed_time: number;\n  starttime: number;\n  execution_timer_id: number | any;\n\n  onStopEvent: Function;\n  onExecuteStep: Function;\n  onAfterExecute: Function;\n  onPlayEvent: Function;\n  frame: number;\n\n  constructor(side: Side, id?: number, properties?: any) {\n    if (typeof side !== 'number') throw 'Container side is not defined';\n\n    this.renderers = null;\n\n    this.id = id || ++Container.last_container_id;\n\n    if (this.id === 0) this.name = 'Main';\n\n    this.side = side;\n\n    Container.containers[this.id] = this;\n    this.clear();\n    this.debug('Container created');\n\n    let rootContainer = Container.containers[0];\n    if (rootContainer) {\n      if (rootContainer.server_dashboard_socket) this.server_dashboard_socket = rootContainer.server_dashboard_socket;\n\n      if (rootContainer.server_editor_socket) this.server_editor_socket = rootContainer.server_editor_socket;\n\n      if (rootContainer.client_socket) this.client_socket = rootContainer.client_socket;\n\n      if (rootContainer.db) this.db = rootContainer.db;\n\n      if (rootContainer.dashboard) this.dashboard = rootContainer.dashboard;\n    }\n  }\n\n  static clear() {\n    Container.containers = {};\n    Container.last_container_id = -1;\n  }\n\n  /**\n   * Register a node class so it can be listed when the user wants to create a new one\n   * @param type name of the node and path\n   * @param node_class class containing the structure of a node\n   * @param parentContainerNodeType some menus should be shown only if parentContainerNodeType is there\n   * @param show_in_menu\n   * @param recursive same container node inside the parent container node\n   * @param alwaysInsideContainer\n   */\n  static registerNodeType(\n    type: string,\n    node_class: any,\n    parentContainerNodeType: string = null,\n    show_in_menu: boolean = true,\n    recursive: boolean = false,\n    alwaysInsideContainer: boolean = false,\n  ): void {\n    if (!(node_class.prototype instanceof Node))\n      throw `Can't register node of type [${type}]. Class must inherit Node base class!`;\n    let node: Node = new node_class(this);\n\n    node_class.type = type;\n    node_class.category = type.substr(0, type.lastIndexOf('/'));\n    node_class.node_name = type.substr(type.lastIndexOf('/') + 1, type.length);\n    node_class.show_in_menu = show_in_menu;\n    node_class.icon = node.iconImageUrl;\n    node_class.color = node.headerColor;\n    node_class.title = node.title || node.type;\n    node_class.parentContainerNodeType = parentContainerNodeType;\n    node_class.recursive = recursive;\n    node_class.onlyInsideContainer = alwaysInsideContainer;\n\n    this.nodes_types[type] = node_class;\n  }\n\n  static createNode(type: string, container: Container, position: [number, number]): Node {\n    const node_class = this.nodes_types[type];\n    if (node_class) {\n      const node: Node = new node_class(this, container, -1000);\n      node.type = type;\n      node.pos = position;\n      node.size = node.computeSize(true);\n      return node;\n    } else {\n      throw `Can't create node of type [${type}]. Make sure it is registered through registerNodeType`;\n    }\n  }\n\n  /**\n   * Returns a list of node types matching one category\n   * @param category category name\n   * @returns {Array} array with all the node classes\n   */\n  static getNodeTypesInCategory(category: string): Array<any> {\n    return Object.values(this.nodes_types).filter(n => n.category == (category || null));\n  }\n\n  static getNodeTypes(): Array<any> {\n    return Object.values(this.nodes_types);\n  }\n\n  static nodeIsInCategory(category: string) {\n    return n => n.category == (category || null);\n  }\n\n  /**\n   * Returns a list with all the node type categories\n   * @returns {Array} array with all the names of the categories\n   */\n  static getNodeTypesCategories(): Array<any> {\n    return uniq(\n      Object.values(this.nodes_types)\n        .filter(n => !!n.category && n.show_in_menu)\n        .map(n => n.category)\n        .concat(['']),\n    );\n  }\n\n  /**\n   * Removes all nodes from this container\n   */\n  clear(): void {\n    this.stop();\n    this.isRunning = false;\n    this.last_node_id = 0;\n\n    //nodes\n    this._nodes = {};\n\n    //iterations\n    this.iteration = 0;\n\n    this.config = {};\n\n    //timing\n    this.globaltime = 0;\n    this.runningtime = 0;\n    this.fixedtime = 0;\n    this.fixedtime_lapse = 0.01;\n    this.elapsed_time = 0.01;\n    this.starttime = 0;\n\n    this.sendActionToRenderer('clear');\n  }\n\n  /**\n   * Stops the execution loop of the container\n   */\n  stop(): void {\n    if (!this.isRunning) return;\n\n    this.isRunning = false;\n\n    if (this.onStopEvent) this.onStopEvent();\n\n    if (this.execution_timer_id != null) clearInterval(this.execution_timer_id);\n    this.execution_timer_id = null;\n\n    for (let id in this._nodes) {\n      let node = this._nodes[id];\n      if (node['onStopContainer']) node['onStopContainer']();\n    }\n  }\n\n  /**\n   * Attach renderer to this container\n   * @param renderer\n   */\n  attachRenderer(renderer: Renderer): void {\n    if (renderer.container && renderer.container != this) {\n      renderer.deselectAllNodes();\n      renderer.container.detachRenderer(renderer);\n    }\n\n    renderer.container = this;\n    if (!this.renderers) this.renderers = [];\n    this.renderers.push(renderer);\n\n    //reset active nodes\n    for (let i in renderer.container._nodes) {\n      let node = renderer.container._nodes[i];\n      node.boxcolor = renderer.theme.NODE_DEFAULT_BOXCOLOR;\n      node.setDirtyCanvas(true, true);\n    }\n  }\n\n  /**\n   * Detach renderer from this container\n   * @param renderer\n   */\n  detachRenderer(renderer: Renderer): void {\n    if (!this.renderers) return;\n\n    let pos = this.renderers.indexOf(renderer);\n    if (pos == -1) return;\n\n    renderer.container = null;\n\n    this.renderers.splice(pos, 1);\n    if (this.renderers.length == 0) delete this.renderers;\n  }\n\n  /**\n   * Starts running this container every interval milliseconds.\n   * @param interval amount of milliseconds between executions\n   */\n  //STARTS from here \n  run(interval: number = 1): void {\n    if (this.isRunning) return;\n\n    this.isRunning = true;\n\n    if (this.onPlayEvent) this.onPlayEvent();\n\n    for (let id in this._nodes) {\n      let node = this._nodes[id];\n      if (node['onRunContainer']) node['onRunContainer']();\n    }\n\n    //launch\n    this.starttime = Utils.getTime();\n    let that = this;\n\n    this.execution_timer_id = setInterval(function() {\n      //execute\n      that.runStep(1);\n    }, interval);//on each loop interval this runStep gets calls for 1 time, currently the inter == 100ms\n  }\n\n  /**\n   * Run N steps (cycles) of the container\n   * @param steps number of steps to run, default is 1\n   */\n  // THIS block gets called on LOOP_INTERVAL, CURRENTLY this is 100ms on .env and whatever comes in this 100ms inside, those outputs gets ignored, coz we only read value on 100ms\n  runStep(steps: number = 1): void {\n    let start = Utils.getTime();\n    this.globaltime = 0.001 * (start - this.starttime);\n\n    for (let i = 0; i < steps; i++) {\n      this.transferDataBetweenNodes(); // this one is the main block where we are doing all operation to see whether our in/out got changed or not //main block to calculate whether our in/out got changed or not\n\n      let now = Date.now();\n\n      for (let id in this._nodes) {\n        let node = this._nodes[id];\n\n        // on each 100ms we are looping on this block, and we are seeing whether that interval is exceeded to EXECUTE_INTERVAL or not, if exceeded then call onExecute, so this block is only useful for the operation\n        // which should be greater than 100ms to perform some kind of action\n        if (\n          !node.EXECUTE_INTERVAL ||\n          (node.EXECUTE_INTERVAL && !node.executeLastTime) ||\n          (node.executeLastTime && now - node.executeLastTime >= node.EXECUTE_INTERVAL)\n        ) {\n          if (node['onExecute']) node['onExecute']();\n\n          if (node.EXECUTE_INTERVAL) node.executeLastTime = now;\n        }\n\n        // this updated is came from transferDataBetweenNodes\n        // these UPDATE_INPUTS_INTERVAL is also plays roles as Debounce, normally we don't have value on the node for this variable, so it directly enters into the block\n        if (node.isUpdated) {\n          if (\n            !node.UPDATE_INPUTS_INTERVAL ||\n            (node.UPDATE_INPUTS_INTERVAL && !node.updateInputsLastTime) ||\n            (node.updateInputsLastTime && now - node.updateInputsLastTime >= node.UPDATE_INPUTS_INTERVAL)\n          ) {\n            if (node['onInputUpdated']) node['onInputUpdated']();//here we get called our onInputUpdated\n\n            node.isUpdated = false;\n\n            for (let i in node.inputs) if (node.inputs[i].updated) node.inputs[i].updated = false;\n\n            if (node.UPDATE_INPUTS_INTERVAL) node.updateInputsLastTime = now; //this is for restricting multiple values on that interval and to act like Debounce\n          }\n        }\n      }\n\n      this.fixedtime += this.fixedtime_lapse;\n\n      if (this.onExecuteStep) this.onExecuteStep();\n    }\n\n    if (this.onAfterExecute) this.onAfterExecute();\n\n    let elapsed = Utils.getTime() - start;\n    if (elapsed == 0) elapsed = 1;\n    this.elapsed_time = 0.001 * elapsed;\n    this.globaltime += 0.001 * elapsed;\n    this.iteration += 1;\n  }\n\n  transferDataBetweenNodes() {\n    // it runs on each 100ms interval so\n    //all nodes\n    for (let id in this._nodes) {\n      let node = this._nodes[id];\n      if (!node.outputs) continue;\n\n      //all outputs\n      for (let o in node.outputs) {\n        let output = node.outputs[o];\n        if (!output.updated) continue;// when updated is true from output of each node we dont break the loop and it will go down\n\n        output.updated = false; // make update false, hence we will not get as updated=true on next loop\n\n        if (output.links == null) continue;//if links is not no need to do any operation\n\n        //all output links\n        for (let link of output.links) { //loop on all links \n          let target_node = this._nodes[link.target_node_id]; // this is where we had an issue, coz node was deleted but link wasn't\n          if (!target_node) {\n            this.debugErr(\"Can't transfer data from node \" + node.getReadableId() + '. Target node not found');\n            continue;\n          }\n\n          let target_id = link.target_input_id ?? link.target_slot;\n          let target_input = target_node.inputs[target_id];\n\n          if (!target_input) return;\n          target_input.data = Utils.parseValue(output.data, target_input.type); // Now change the input of target node, which is connected wit the output\n\n          target_node.isUpdated = true; //now we made the target node also updated as like on setOutputData, so that target node will perform same operation for it's targeted nodes\n          target_input.updated = true; // plays important role for onInputUpdated()\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns the amount of time the container has been running in milliseconds\n   * @method getTime\n   * @returns number of milliseconds the container has been running\n   */\n  getTime(): number {\n    return this.globaltime;\n  }\n\n  /**\n   * Sends action to renderer\n   * @param action\n   * @param params\n   */\n  sendActionToRenderer(action: string, params?: Array<any>): void {\n    if (!this.renderers) return;\n\n    for (let i = 0; i < this.renderers.length; ++i) {\n      let c = this.renderers[i];\n      if (c[action]) c[action].apply(c, params);\n    }\n  }\n\n  /**\n   * Get nodes\n   */\n  getNodes(includeSubcontainers = false): Array<Node> {\n    let nodes = [];\n\n    addNodes(this._nodes);\n\n    function addNodes(_nodes) {\n      for (let n in _nodes) {\n        nodes.push(_nodes[n]);\n\n        if (includeSubcontainers && _nodes[n].sub_container) {\n          addNodes(_nodes[n].sub_container._nodes);\n        }\n      }\n    }\n\n    return nodes;\n  }\n\n  private static setProperties(properties, node) {\n    if (properties) {\n      for (let i in properties) {\n        if (properties.hasOwnProperty(i)) {\n          switch (i) {\n            case 'inputs':\n              break;\n            case 'outputs':\n              break;\n            case 'settings':\n              ContainerUtils.addSettingsProperties(node, properties[i]);\n              break;\n            default:\n              node[i] = properties[i];\n          }\n        }\n      }\n    }\n  }\n\n  private static setSettings(properties, node) {\n    if (properties && properties['settings']) {\n      ContainerUtils.addSettingsProperties(node, properties['settings']);\n    }\n  }\n\n  /**\n   * Create node and add to container\n   * You can define any additional node properties or/and serialized node info.\n   * If properties.id && serializedNode.id is not defined, container will create a new instance of node,\n   * generate new id, call node.onCreated? store it node in db, and call node.onAdded.\n   * If properties.id || serializedNode.id is defined, it will create node, add and call node.onAdded\n   * (will not store node in db).\n   * @param type type of node\n   * @param properties set any additional node properties (pos, size, etc...)\n   * @param serializedNode configure node from serialized info\n   * @param force forcefully add node on DB, true for operation like import\n   * @param callback called when node creation and related database operations have completed\n   * @returns {Node}\n   */\n  createNode(\n    type: string,\n    properties?: any,\n    serializedNode?: SerializedNode,\n    force = false,\n    callback: (err?: Error) => void = doNothing,\n  ): Node {\n    if (this.container_node && this.container_node.shouldRejectNodeType(type)) {\n      this.debugErr('Trying to create non-compatible child node in container...');\n      return null;\n    }\n    // check class exist\n    let node_class = Container.nodes_types[type];\n    if (!node_class) {\n      this.debugErr(\"Can't create node. Node class of type [\" + type + '] not registered.');\n      return null;\n    }\n\n    let { id, isNew } = this.getNodeId(properties, serializedNode, type);\n\n    let node: Node = new node_class(this, id, properties);\n\n    //set node properties\n    node.id = id;\n    node.cid = this.id;\n    node.container = this;\n    node.side = this.side;\n    node.type = type;\n    node.category = node_class.category;\n\n    const settings = { ...node.settings };\n\n    // deserialize\n    if (serializedNode) node.configure(serializedNode);\n    if (isNew || force) {\n      if (node['setup']) node['setup']();\n    }\n\n    // repopulate validation\n    if (!isNew) {\n      Object.keys(node.settings).forEach(key => {\n        node.settings[key].validation = settings[key] ? settings[key].validation : null;\n      });\n    }\n\n    // set additional properties\n    Container.setProperties(properties, node);\n    if (node instanceof ContainerNode && properties && properties.sub_container) {\n      node.sub_container = Container.containers[properties.sub_container.id];\n      node.settings.name.value =\n        (node.settings && node.settings.name && node.settings.name.value) || 'Folder ' + properties.sub_container.id;\n    }\n\n    if (!node.title) node.title = node.type;\n    if (\n      (!properties || !properties.properties || !properties.properties.size) &&\n      (!serializedNode || !serializedNode.size) &&\n      !force\n    ) {\n      node.size = node.computeSize(true);\n    }\n    // overwrite id\n    node.id = id;\n\n    if (isNew || force) {\n      if (node['init']) node['init'](properties);\n      // set settings values after dynamic initialization completion; on above only static settings got filled\n      Container.setSettings(properties, node);\n      this.createNewNode(node).then(() => {\n        callNodeMethodOnAdded();\n      });\n    } else {\n      callNodeMethodOnAdded();\n    }\n\n    if (isNew && this.db) {\n      if (this.id == 0) this.db.updateLastRootNodeId(this.last_node_id, callback);\n      else\n        this.db.updateNode(\n          this.container_node.id,\n          this.container_node.container.id,\n          {\n            $set: {\n              'sub_container.last_node_id': this.container_node.sub_container.last_node_id,\n            },\n          },\n          callback,\n        );\n    } else setTimeout(callback, 0);\n\n    this.setDirtyCanvas(true, true);\n    // add node\n    this._nodes[id] = node;\n    Registry._nodes[Registry.getId(this.id, id)] = node;\n    return node;\n\n    function callNodeMethodOnAdded() {\n      if (node['onAdded']) node['onAdded']();\n    }\n  }\n\n  private getNodeId(properties: any, serializedNode: SerializedNode, type: string) {\n    let id;\n    let isNew = false;\n    if (properties && properties.id != null) id = properties.id;\n    else if (serializedNode && serializedNode.id != null) id = serializedNode.id;\n    else {\n      id = ++this.last_node_id;\n      isNew = true;\n    }\n\n    // check node id not exist\n    if (this._nodes[id]) {\n      this.debugErr(` Node id [ ${id} ] already exist.`);\n      const lastNodeId = Math.max(...Object.keys(this._nodes).map(x => Number(x)));\n      this.last_node_id = lastNodeId + 1;\n      id = this.last_node_id;\n      this.debugErr(`Forcefully creating node of type [ ${type} ] with id [ ${id} ].`);\n      if (this.container_node.cid === 0) {\n        this.db.updateLastRootNodeId(this.last_node_id);\n      } else {\n        ContainerUtils.updateSubContainerLastNodeId(this, this.last_node_id);\n      }\n    }\n\n    return { id, isNew };\n  }\n\n  private createNewNode(node: any): Promise<void> {\n    this.debug('New node created: ' + node.getReadableId());\n    if (node['onCreated']) node['onCreated']();\n    return new Promise<void>(resolve => {\n      if (this.db) {\n        // Executes only on server side\n        this.db.addNode(node, () => {\n          resolve();\n        });\n      } else {\n        resolve();\n      }\n    });\n  }\n\n  removeBroadcasted(node: Node) {\n    if (this.side === Side.server) {\n      this.remove(node);\n      // remove from user interface\n      this.server_editor_socket.emit('nodes-delete', { nodes: [node.id], cid: node.cid });\n    }\n  }\n\n  /**\n   * Removes a node from the container\n   * @param node the instance of the node or node id\n   */\n  remove(node: Node | number): void {\n    // if id provided, get node\n    if (typeof node == 'number') {\n      node = this._nodes[node];\n      if (!node) this.debugErr(\"Can't remove node. Node id [\" + node + ' not exist.');\n      return null;\n    }\n    if (node.ignore_remove) return;\n    const callback = get(node, 'onRemoved', () => {});\n    Promise.resolve(callback.call(node))\n      .then(() => this.afterOnRemoved(<Node>node))\n      .catch(err => log.error(err));\n  }\n\n  private afterOnRemoved(node: Node) {\n    // disconnect inputs\n    if (node.inputs)\n      for (let i in node.inputs) {\n        let input = node.inputs[i];\n        if (input.link != null) node.disconnectInputLink(+i);\n      }\n\n    // disconnect outputs\n    if (node.outputs)\n      for (let o in node.outputs) {\n        let output = node.outputs[o];\n        if (output.links != null && output.links.length > 0) node.disconnectOutputLinks(+o);\n      }\n\n    // remove from renderer\n    if (this.renderers) {\n      for (let i = 0; i < this.renderers.length; ++i) {\n        let renderer = this.renderers[i];\n        if (renderer.selected_nodes[node.id]) delete renderer.selected_nodes[node.id];\n        if (renderer.node_dragged == node) renderer.node_dragged = null;\n      }\n    }\n\n    // remove from container\n    delete this._nodes[node.id];\n    delete Registry._nodes[Registry.getId(this.id, node.id)];\n\n    this.debug('Node deleted: ' + node.getReadableId());\n    node.container = null;\n\n    if (this.db) this.db.removeNode(node.id, this.id);\n\n    this.setDirtyCanvas(true, true);\n  }\n\n  /**\n   * Returns a node by its id.\n   * @param id\n   */\n  getNodeById(id: number): Node {\n    if (id == null) return null;\n    return this._nodes[id];\n  }\n\n  /**\n   * Returns a list of nodes that matches a type\n   * @param type the name of the node type\n   * @param includeSubContainers\n   * @returns a list with all the nodes of this type\n   */\n  getNodesByType(type: string, includeSubContainers = false): Array<Node> {\n    type = type.toLowerCase();\n    let r = [];\n\n    for (let id in this._nodes) {\n      let node = this._nodes[id];\n      if (node.type.toLowerCase() == type) r.push(node);\n    }\n\n    if (includeSubContainers) {\n      for (let id in this._nodes) {\n        let node = this._nodes[id];\n        if (node instanceof ContainerNode) {\n          let nodes = (<ContainerNode>node).sub_container.getNodesByType(type, true);\n          nodes.forEach(n => r.push(n));\n        }\n      }\n    }\n\n    return r;\n  }\n\n  /**\n   * Returns a list of nodes that are an instance of the provided node-class (or one of its subclasses)\n   * @returns a list with all the nodes of this type\n   * @param nodeClass\n   * @param includeSubcontainers\n   */\n  getNodesByClass(nodeClass: Function, includeSubcontainers = false): Array<Node> {\n    let r = [];\n\n    for (let id in this._nodes) {\n      let node = this._nodes[id];\n      if (node instanceof nodeClass) r.push(node);\n    }\n\n    if (includeSubcontainers) {\n      for (let id in this._nodes) {\n        let node = this._nodes[id];\n        if (node instanceof ContainerNode) {\n          let nodes = (<ContainerNode>node).sub_container.getNodesByClass(nodeClass, true);\n          nodes.forEach(n => r.push(n));\n        }\n      }\n    }\n\n    return r;\n  }\n\n  getAllNodes(\n    parent: { [id: number]: Node } = this._nodes,\n    parentId: number = 0,\n  ): Array<{\n    id: string;\n    name: string;\n    isContainer: boolean;\n    list?: Array<{ id: string; name: string }>;\n  }> {\n    let list = [];\n    Object.keys(parent).forEach(id => {\n      const node = parent[id];\n      if (node instanceof ContainerNode) {\n        list.push({\n          id: node.sub_container.id,\n          name: node.sub_container.name,\n          parentId,\n          list: this.getAllNodes(node.sub_container._nodes, node.sub_container.id),\n          isContainer: true,\n        });\n      } else {\n        list.push({\n          id: node.id,\n          parentId,\n          name: node.name ? `${node.name}: ${node.title}` : node.title,\n          isContainer: false,\n        });\n      }\n    });\n    return list.sort((a, b) => {\n      if (a.isContainer && b.isContainer) {\n        return a.id - b.id;\n      } else if (a.isContainer && !b.isContainer) {\n        return -1;\n      } else return 1;\n    });\n  }\n\n  /**\n   * Set canvas to dirty for update\n   * @param foreground\n   * @param backgroud\n   */\n  setDirtyCanvas(foreground?: boolean, backgroud?: boolean): void {\n    this.sendActionToRenderer('setDirty', [foreground, backgroud]);\n  }\n\n  /**\n   * Executes a callback with the editor instance if available\n   */\n  runWithEditor(f: (Editor) => void) {\n    const editor = get(this, 'renderers[0].editor');\n    if (editor) f(editor);\n  }\n\n  /**\n   * Creates a Object containing all the info about this container, it can be serialized\n   * @returns value of the node\n   */\n  serialize(only_dashboard_nodes = false): SerializedContainer {\n    let data: SerializedContainer = {\n      id: this.id,\n      last_node_id: this.last_node_id,\n      name: this.name,\n      config: this.config,\n    };\n    let ser_nodes: Array<SerializedNode> = [];\n    for (let id in this._nodes) {\n      const node = this._nodes[id];\n      if (only_dashboard_nodes && !node.isDashboardNode) continue;\n      ser_nodes.push(node.serialize());\n    }\n    data.serializedNodes = ser_nodes;\n    if (this.id == 0) (<any>data).last_container_id = Container.last_container_id;\n    return data;\n  }\n\n  /**\n   * Add nodes_list to container from a JSON string\n   * @param data JSON string\n   * @param keep_old\n   */\n  configure(data: SerializedContainer, keep_old = false): boolean {\n    if (!keep_old) this.clear();\n\n    //copy all fields to this container\n    for (let i in data) {\n      //skip nodes\n      if (i == 'serializedNodes') continue;\n\n      this[i] = data[i];\n    }\n\n    let error = false;\n\n    if (data.serializedNodes) {\n      for (let n of data.serializedNodes) {\n        let node = this.createNode(n.type, null, n);\n        if (!node) error = true;\n      }\n    }\n\n    if ((<any>data).last_container_id) Container.last_container_id = (<any>data).last_container_id;\n\n    this.setDirtyCanvas(true, true);\n    return error;\n  }\n  /**\n   * Print debug message to console\n   * @param message\n   */\n  debug(message: string): void {\n    log.debug('[' + this.id + '] ' + message);\n  }\n\n  /**\n   * Print error message to console\n   * @param message\n   * @param module\n   */\n  debugWarn(message: string, module?: string): void {\n    log.warn('[' + this.id + '] ' + message);\n  }\n\n  /**\n   * Print error message to console\n   * @param message\n   * @param module\n   */\n  debugErr(message: string, module?: string): void {\n    log.error('[' + this.id + '] ' + message);\n  }\n}\n","import { SettingType } from './node';\nimport { Link } from './node-link';\n\nexport enum Type {\n  STRING   = 'string',\n  NUMBER   = 'number',\n  BOOLEAN  = 'boolean',\n  ANY      = 'any',\n  JSON     = 'json',\n  DROPDOWN = 'dropdown', // it is same as `ANY`, but when it has setting as pair it checks for validity\n}\n\nexport interface NodeIO {\n  name: string;\n  type: Type;\n  label?: string;\n  locked?: boolean;\n  pos?: number;\n  round?: boolean;\n  data?: any;\n  updated?: boolean;\n  subNodeId?: number;\n}\n\nexport class NodeOutput implements NodeIO {\n  name: string;\n  type: Type;\n  links?: Array<Link>;\n  label?: string;\n  locked?: boolean;\n  pos?: number;\n  round?: boolean;\n  data?: any;\n  updated?: boolean;\n  subNodeId?: number;\n}\n\nexport interface InputSetting {\n  exist: boolean; // bind setting exist or not\n  nullable: boolean; // whether null value is acceptable or not\n  hidden: boolean;\n}\n\nexport class NodeInput implements NodeIO {\n  name: string;\n  type: Type;\n  link?: Link;\n  label?: string;\n  locked?: boolean;\n  pos?: number;\n  round?: boolean;\n  isOptional?: boolean;\n  data?: any;\n  updated?: boolean;\n  setting: InputSetting;\n  subNodeId?: number;\n}\n\nexport interface IInputInfo {\n  input: NodeInput;\n  slot: number;\n  link_pos: [number, number];\n  locked: boolean;\n}\n\nexport interface IOutputInfo {\n  output: NodeOutput;\n  slot: number;\n  link_pos: [number, number];\n  locked: boolean;\n}\n\n\nexport const convertStringToType = (type: string): Type => {\n  switch (type) {\n    case Type.STRING:\n      return Type.STRING;\n    case Type.NUMBER:\n      return Type.NUMBER;\n    case Type.BOOLEAN:\n      return Type.BOOLEAN;\n    case Type.JSON:\n      return Type.JSON;\n  }\n  return Type.ANY;\n};\n\nexport const convertType = (type: Type): SettingType => {\n  switch (type) {\n    case Type.STRING:\n      return SettingType.STRING;\n    case Type.NUMBER:\n      return SettingType.NUMBER;\n    case Type.BOOLEAN:\n      return SettingType.BOOLEAN;\n    case Type.DROPDOWN:\n      return SettingType.DROPDOWN;\n  }\n  return SettingType.STRING;\n};\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 04.07.2016.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\nimport { get } from 'lodash';\nimport * as moment from 'moment';\nimport { ERROR, NOTIFICATION } from '../events';\nimport { Container, SerializedContainer, Side } from './container';\nimport { convertType, InputSetting, NodeInput, NodeOutput, Type } from './node-io';\nimport { createLinkHandler, LinkHandler, LinkInfo } from './node-link';\nimport Registry from './registry';\nimport Utils from './utils';\nimport Validation from './validation/Validation';\n\nconst log = require('logplease').create('node', { color: 5 });\nconst doNothing = () => {};\n\nexport interface SerializedNode {\n  id: number;\n  name: string;\n  cid: number;\n  type: string;\n  pos: [number, number];\n  size?: [number, number];\n  data?: any;\n  inputs?: { [id: number]: NodeInput };\n  outputs?: { [id: number]: NodeOutput };\n  properties?: any;\n  settings?: { [name: string]: NodeSettings };\n  flags?: any;\n  sub_container?: SerializedContainer;\n}\n\nexport interface NodeSettings {\n  description: string;\n  type?: SettingType;\n  value?: any;\n  config?: any;\n  validation?: Validation;\n  toJSON?: Function; // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#toJSON_behavior\n}\n\nexport interface ContextMenuOption {\n  title: string;\n\n  onClick();\n}\n\nexport enum BROADCAST {\n  UPDATE_SETTINGS,\n  UPDATE_OUTPUTS,\n  UPDATE_TITLE,\n  UPDATE_VALUE,\n  UPDATE_STATE,\n  UPDATE_NAME,\n  UPDATE_PROPERTIES,\n}\n\nexport enum NodeState {\n  NORMAL = 'normal', // the node default colour\n  INFO = 'info',\n  WARNING = 'warning',\n  ERROR = 'error', // when user added something that they shouldn't have\n  DISABLED = 'disabled', // when a network is disabled\n  ONLINE = 'online', // when a device is online\n  OFFLINE = 'offline', // when a device is offline\n}\n\nexport enum SettingType {\n  STRING = 'string',\n  NUMBER = 'number',\n  BOOLEAN = 'boolean',\n  READONLY = 'readonly',\n  DROPDOWN = 'dropdown',\n  TREE_SELECT = 'treeselect',\n  CODE_AREA = 'codearea',\n  PASSWORD = 'password',\n  GROUP = 'group',\n}\n\nexport interface NodeSettingConfig {\n  groups?: Array<{\n    [name: string]: {\n      weight?: number;\n    };\n  }>;\n  conditions?: {\n    [name: string]: (setting: any) => boolean;\n  };\n}\n\nexport const convertSettingType = (type: SettingType): Type => {\n  switch (type) {\n    case SettingType.STRING:\n      return Type.STRING;\n    case SettingType.NUMBER:\n      return Type.NUMBER;\n    case SettingType.BOOLEAN:\n      return Type.BOOLEAN;\n  }\n  return Type.ANY;\n};\n\nexport class Node {\n  title: string;\n  name: string;\n  description: string;\n  pos: [number, number] = [100, 100];\n  size: [number, number];\n  MIN_WIDTH = 100;\n  container: Container;\n  id?: number;\n  cid?: number;\n  type: string;\n  category: string;\n  side: Side;\n  inputs: { [id: number]: NodeInput };\n  outputs: { [id: number]: NodeOutput };\n  properties?: any = {};\n  settings: { [name: string]: NodeSettings } = {};\n  settingConfigs: NodeSettingConfig = {};\n  readonly linkHandler: LinkHandler = createLinkHandler(this);\n  contextMenu: { [name: string]: ContextMenuOption } = {};\n  settingsHeaderComponent?: any; // vue.js component definition\n\n  ignore_remove: boolean;\n  removable: boolean;\n  movable: boolean;\n  clonable: boolean = true;\n  flags: {\n    skip_title_render?: true;\n    unsafe_execution?: false;\n    collapsed?: boolean;\n    clip_area?: boolean;\n  } = {};\n\n  mouseOver: boolean;\n  selected: boolean;\n\n  color: string;\n  bgcolor: string;\n  boxcolor: string;\n  headerColor: string;\n  shape: string;\n  onSerialize: Function;\n  bgImage: HTMLImageElement;\n  bgImageUrl: string;\n\n  isUpdated: boolean;\n  isRecentlyActive: boolean;\n\n  isDashboardNode?: boolean;\n\n  //you can set this setting for prevent input flooding!\n  UPDATE_INPUTS_INTERVAL?: number;\n  updateInputsLastTime?: number;\n\n  //you can set this setting for prevent execute flooding!\n  EXECUTE_INTERVAL?: number;\n  executeLastTime?: number;\n\n  showIcon: boolean = true;\n  iconImage: HTMLImageElement;\n  iconImageUrl: string;\n\n  nodeState: NodeState;\n\n  // Lifecycle Hooks: TODO write somewhere on README\n  // ===============================================\n  // setup()            : gets invoked when new node will be created, before setting up any settings and properties\n  //                      for writing your own custom logic for node creation\n  // init(properties)   : gets invoked when new node will be created after `setup` for doing modifying node dynamically,\n  //                      static settings and properties fields gets inserted before this method\n  // onCreated()        : gets invoked when new node will be created after `init(properties)`,\n  //                      after `init(properties)` we save the re-sets the settings values\n  // onAdded()          : gets invoked every time when node added to container (created or restored from the database)\n  // onRemoved()        : Invoked when node removed from container, it can be both Promise return or normal return\n  // onDbReaded()       : Invoked when db read and all nodes added to containers (after all nodes onAdded invoked)\n\n  // onDrawBackground\n  // onDrawForeground\n  //\n  // //if returns false the incoming connection will be canceled\n  // onConnectInput\n  // onInputAdded\n  // onOutputAdded\n  // onGetInputs\n  // onGetOutputs\n  // onInputRemoved\n  // onOutputRemoved\n  // getValueFromSettings(slot, labelFromData)\n  // getInputToSettingsMap\n  //\n  // onMouseDown\n  // onMouseUp\n  // onMouseEnter\n  // onMouseMove\n  // onMouseLeave\n  // onDblClick\n  // onDropFile\n  // onDropItem\n  // onKeyDown\n  // onKeyUp\n  //\n  // onSelected\n  // onDeselected\n  //\n  // onGetMessageToServerSide\n  // onGetMessageToEditorSide\n  //\n  // onRunContainer\n  // onStopContainer\n  // onExecute\n  // onInputUpdated\n  //\n  // onBeforeSettingsChange(newSettings, newName)\n  // onAfterSettingsChange(oldSettings, oldName)\n\n  // getMenuOptions\n  // getExtraMenuOptions\n\n  //onDashboardGetRequest\n  //onDashboardPostRequest\n  //onEditorApiGetRequest\n  //onEditorApiPostRequest\n\n  constructor(container?: Container, id?: number, properties?: any) {}\n\n  onAfterSettingsChange(oldSettings, oldName) {}\n\n  /**\n   * Configure a node from an object containing the serialized ser_node\n   * @param ser_node object with properties for configure\n   */\n  configure(ser_node: SerializedNode): void {\n    for (let key in ser_node) {\n      if (key == 'console') continue;\n      if (ser_node[key] == null) continue;\n      if (typeof ser_node[key] == 'object') {\n        //object\n        //if node (has configure function)\n        if (this[key] && this[key].configure) {\n          this[key].configure(ser_node[key]);\n        } else {\n          this[key] = Utils.cloneObject(ser_node[key], this[key]);\n        }\n      } //value\n      else {\n        this[key] = ser_node[key];\n      }\n    }\n  }\n\n  /**\n   * Serialize node\n   */\n  serialize(): SerializedNode {\n    let n: SerializedNode = {\n      cid: this.container.id,\n      id: this.id,\n      type: this.type,\n      pos: this.pos,\n      name: this.name,\n      size: this.size,\n    };\n\n    if (this.settings) n.settings = Utils.cloneObject(this.settings);\n\n    // Don't save validation to serialize\n    Object.keys(n.settings).forEach(key => {\n      delete n.settings[key].validation;\n    });\n\n    if (this.properties) n.properties = Utils.cloneObject(this.properties);\n\n    if (this.flags) n.flags = Utils.cloneObject(this.flags);\n\n    //remove data from links\n    if (this.inputs) {\n      n.inputs = {};\n\n      for (let id in this.inputs) {\n        let i = this.inputs[id];\n        n.inputs[id] = {\n          setting: i.setting,\n          name: i.name,\n          type: i.type,\n          link: i.link,\n          label: i.label,\n          locked: i.locked,\n          pos: i.pos,\n          round: i.round,\n          isOptional: i.isOptional,\n          subNodeId: i.subNodeId\n        };\n      }\n    }\n\n    if (this.outputs) {\n      n.outputs = {};\n\n      for (let id in this.outputs) {\n        let o = this.outputs[id];\n        n.outputs[id] = {\n          name: o.name,\n          type: o.type,\n          links: o.links,\n          label: o.label,\n          locked: o.locked,\n          pos: o.pos,\n          round: o.round,\n          subNodeId: o.subNodeId\n        };\n      }\n    }\n\n    if (this.onSerialize) this.onSerialize(n);\n\n    return n;\n  }\n\n  /**\n   * Serialize and stringify\n   * @returns {string} json\n   */\n  toString(): string {\n    return JSON.stringify(this.serialize());\n  }\n\n  /**\n   * Get the title string\n   */\n  getTitle(): string {\n    return this.title;\n  }\n\n  getName(): string {\n    return this.name;\n  }\n\n  /***\n   * Gets array of all input values, but omitting undefined/null values\n   */\n  getDefinedInputValues() {\n    return Object.keys(this.inputs)\n      .map(key => this.inputs[key].data)\n      .filter(v => v != null);\n  }\n\n  /**\n   * Sets the output data according to the transform function\n   * @param callback function\n   */\n  emitTransformedInput(callback) {\n    let val = this.getInputData(0);\n    if (val != null) {\n      this.setOutputData(0, callback(val));\n    } else {\n      this.setOutputData(0, null);\n    }\n  }\n\n  updateNodeInput() {\n    if (this.container.db) this.container.db.updateNode(this.id, this.container.id, { $set: { inputs: this.inputs } });\n  }\n\n  updateNodeOutput() {\n    if (this.container.db) {\n      this.container.db.updateNode(this.id, this.container.id, { $set: { outputs: this.outputs } });\n    }\n  }\n\n  persistProperties(saveSettings = false, saveProperties = false, saveInputs = false, saveOutputs = false) {\n    if (!this.container.db) return;\n    const props = {};\n    if (saveSettings) props['settings'] = this.settings;\n    if (saveProperties) props['properties'] = this.properties;\n    if (saveInputs) props['inputs'] = this.inputs;\n    if (saveOutputs) props['outputs'] = this.outputs;\n    this.container.db.updateNode(this.id, this.container.id, {\n      $set: props,\n    });\n  }\n\n  persistConfiguration(callback: () => void = doNothing) {\n    if (this.container.db) {\n      this.container.db.updateNode(\n        this.id,\n        this.container.id,\n        {\n          $set: { settings: this.settings, properties: this.properties },\n        },\n        callback,\n      );\n    }\n  }\n\n  updateNodeInputOutput() {\n    if (this.container.db) {\n      this.container.db.updateNode(this.id, this.container.id, {\n        $set: { inputs: this.inputs, outputs: this.outputs },\n      });\n    }\n  }\n\n  /**\n   * Sets the output data\n   * @param output_id slotId id\n   * @param data slotId data\n   * @param only_if_new\n   */\n  setOutputData(output_id: number, data: any, only_if_new = false): void {\n    if (!this.outputs[output_id]) return;\n\n    if (data === undefined) return;\n    if (only_if_new && this.outputs[output_id].data === data) return;\n\n    this.outputs[output_id].updated = true;// it makes our update flag  is true // so when we want to make onInputUpdated() to trigger, we need to set this one as true\n    //so there will be two cases when out onInputUpdated() doesn't get triggered:\n    // 1. Falls multiple values in between 100ms so we will get only the last on value\n    // 2. If only_if_new = true and we want to trigger onInputUpdated() even when we have no change value\n    if (!this.isRecentlyActive) this.isRecentlyActive = true;\n\n    this.outputs[output_id].data = data;\n  }\n\n  /**\n   * Retrieves the input data (data traveling through the connection) from one slotId\n   * @param slotId slot id for input\n   * @returns data or if it is not connected returns undefined\n   */\n  getInputData(slotId: number): any {\n    try {\n      const input = this.inputs[slotId];\n      let data = input.data;\n      if (\n        this.inputs[slotId] &&\n        this.inputs[slotId].setting &&\n        this.inputs[slotId].setting.exist &&\n        (!Utils.hasValidInput(data, this.inputs[slotId].setting.nullable) || input.type === Type.DROPDOWN)\n      ) {\n        // It removes extracts the ${name} from: `[${name$}] (${value})`;\n        const settingName: string = this.inputs[slotId].name.match(/\\[(.*?)\\]/)[1];\n        const setting: NodeSettings = this.settings[settingName];\n        if (input.type === Type.DROPDOWN) {\n          // input as default setting value if input doesn't match\n          if (!setting.config.items.map(x => x.value).includes(data)) data = setting.value;\n        } else data = Utils.parseValue(setting.value, input.type);\n      }\n      return data;\n    } catch (err) {\n      this.debugErr(`Get input data! ${err}`);\n    }\n  }\n\n  /**\n   * Returns info about an input connection (which node, type, etc)\n   * @param slot slot id\n   * @returns {Object} object or null\n   */\n  getInputInfo(slot: number): any {\n    if (!this.inputs) return null;\n\n    return this.inputs[slot];\n  }\n\n  /**\n   * Add a new output slot to use in this node\n   * @param name\n   * @param type string defining the output type (\"vec3\",\"number\",...)\n   * @param id {number} output id number if you want to enter manual id\n   * @param extra_info this can be used to have special properties of an output (label, special color, position, etc)\n   */\n\n  addOutput(name?: string, type?: Type, id: number = undefined, extra_info?: any): number {\n    id = this.getFreeOutputId(id);\n    name = name || 'out ' + (id + 1);\n\n    let output: NodeOutput = { name: name, type: type, links: null };\n    if (extra_info) for (let i in extra_info) output[i] = extra_info[i];\n\n    if (!this.outputs) this.outputs = {};\n\n    this.outputs[id] = output;\n    if (this['onOutputAdded']) this['onOutputAdded'](output);\n    this.size = this.computeSize();\n\n    return id;\n  }\n\n  getFreeOutputId(id = undefined): number {\n    if (!this.outputs) {\n      this.outputs = {};\n    }\n    if (id !== undefined && !this.outputs[id]) {\n      return id;\n    }\n\n    for (let i = 0; i < 1000; i++) {\n      if (!this.outputs[i]) return i;\n    }\n  }\n\n  /**\n   * Remove an existing output slot\n   * @param id slot id\n   */\n  removeOutput(id: number): void {\n    this.linkHandler.disconnectOutput(id);\n    delete this.outputs[id];\n    this.size = this.computeSize();\n    if (this['onOutputRemoved']) this['onOutputRemoved'](id);\n  }\n\n  /**\n   * Add a new input slot to use in this node\n   * @param name {string}\n   * @param type {Type} defining the input type (\"vec3\",\"number\",...), it its a generic one use 0\n   * @param setting {InputSetting} set setting exist or not and whether to ignore null data or not from the connected slot\n   * @param id {number} input id number if you want to enter manual id\n   * @param extra_info {any} this can be used to have special properties of an input (label, color, position, etc)\n   */\n  addInput(\n    name?: string,\n    type?: Type,\n    setting: InputSetting = { exist: false, nullable: false, hidden: false },\n    id: number = undefined,\n    extra_info?: any,\n  ): number {\n    id = this.getFreeInputId(id);\n    name = name || 'in ' + (id + 1);\n    let input: NodeInput = { name, type, setting };\n    if (extra_info) {\n      input = { ...input, ...extra_info };\n    }\n\n    if (!this.inputs) this.inputs = {};\n    this.inputs[id] = input;\n    this.size = this.computeSize();\n    if (this['onInputAdded']) this['onInputAdded'](input);\n    return id;\n  }\n\n  /**\n   * @param name {string} name of the input and setting which will be bind each other input: [name], setting: name\n   * @param type {InputType} type of input\n   * @param defaultValue {string} default value for the setting\n   * @param description {string} description for the setting\n   * @param nullable {boolean} whether we need to include null input or not?\n   * If nullable === false, and input === null: it will search value form setting\n   * @param config {object} when TYPE = DROPDOWN, it's needed\n   * @param extra_info {any} anything we want to add on input\n   */\n  addInputWithSettings(\n    name: string,\n    type: Type,\n    defaultValue: any,\n    description: string = name,\n    nullable: boolean = true,\n    config?: object,\n    extra_info?: any,\n  ): void {\n    const setting: InputSetting = { exist: true, nullable, hidden: false };\n    this.addInput(`[${name}]`, type, setting, extra_info);\n    this.settings[name] = {\n      description,\n      value: defaultValue,\n      type: convertType(type),\n    };\n    if (config) {\n      this.settings[name] = {\n        ...this.settings[name],\n        config: config,\n      };\n    }\n  }\n\n  addInputAtPosition(\n    position: number,\n    name?: string,\n    type?: Type,\n    setting: InputSetting = { exist: false, nullable: false, hidden: false },\n    extra_info: any = {},\n  ): number {\n    if (!this.inputs) this.inputs = {};\n    const inputsCount = this.getInputsCount();\n    if (position >= inputsCount) {\n      return this.addInput(name, type, setting, extra_info);\n    }\n    const myID = this.id;\n    for (let i = inputsCount; i > position; i--) {\n      this.inputs[i] = this.inputs[i - 1];\n      if (this.inputs[i].hasOwnProperty('link')) {\n        const outputNode: Node = this.container._nodes[`${this.inputs[i].link.target_node_id}`];\n        let linksArray = outputNode.outputs[`${this.inputs[i].link.target_slot}`].links;\n        const replaceLinkIndex = linksArray.findIndex(link => {\n          return link.target_node_id == myID && link.target_slot == i - 1;\n        });\n        if (replaceLinkIndex != -1) linksArray.splice(replaceLinkIndex, 1, { target_node_id: myID, target_slot: i });\n        outputNode.updateNodeOutput();\n      }\n    }\n    let input: NodeInput = { name, type, setting, ...extra_info };\n    this.inputs[position] = input;\n    this.size = this.computeSize();\n    if (this['onInputAdded']) this['onInputAdded'](input);\n    return position;\n  }\n\n  getFreeInputId(id = undefined): number {\n    if (!this.inputs) {\n      this.inputs = {};\n    }\n    if (id !== undefined && !this.inputs[id]) {\n      return id;\n    }\n\n    for (let i = 0; i < 1000; i++) {\n      if (!this.inputs[i]) return i;\n    }\n  }\n\n  hideInput(immediateDirtyCanvas: boolean = true, ...ids: number[]): void {\n    for (let id of ids) {\n      this.disconnectInputLink(null, id);\n      this.inputs[id].setting.hidden = true;\n    }\n    this.redrawNode(immediateDirtyCanvas);\n  }\n\n  showInput(immediateDirtyCanvas: boolean = true, ...ids: number[]): void {\n    for (let id of ids) {\n      this.inputs[id].setting.hidden = false;\n    }\n    this.redrawNode(immediateDirtyCanvas);\n  }\n\n  redrawNode(immediateDirtyCanvas: boolean = true) {\n    if (immediateDirtyCanvas) {\n      this.size = this.computeSize();\n      this.setDirtyCanvas(true, true);\n    }\n  }\n\n  /**\n   * Remove an existing input slot\n   * @method removeInput\n   * @param id\n   */\n  removeInput(id: number): void {\n    this.linkHandler.disconnectInput(id);\n    delete this.inputs[id];\n    this.size = this.computeSize();\n    if (this['onInputRemoved']) this['onInputRemoved'](id);\n  }\n\n  /**\n   * Remove an existing input slot and moves other inputs and links to maintain input numbering\n   * @method removeInput\n   * @param slot Input slot\n   */\n  removeInputAtPosition(slot: number): void {\n    this.disconnectInputLink(slot);\n    const inputsCount = this.getInputsCount();\n    //console.log('THIS.ID', this.id)\n    //console.log('THIS.INPUTS BEFORE', this.inputs)\n    const myID = this.id;\n    for (let i = slot; i < inputsCount - 1; i++) {\n      this.inputs[i] = this.inputs[i + 1];\n      //console.log('THIS.INPUTS MID', this.inputs)\n      if (this.inputs[i].hasOwnProperty('link')) {\n        const outputNode: Node = this.container._nodes[`${this.inputs[i].link.target_node_id}`];\n        let linksArray = outputNode.outputs[`${this.inputs[i].link.target_slot}`].links;\n        //console.log('linksArray', linksArray)\n        const replaceLinkIndex = linksArray.findIndex(link => {\n          return link.target_node_id == myID && link.target_slot == i + 1;\n        });\n        if (replaceLinkIndex != -1) linksArray.splice(replaceLinkIndex, 1, { target_node_id: myID, target_slot: i });\n        outputNode.updateNodeOutput();\n        //console.log('linksArray AFTER', linksArray)\n        //console.log('THIS.INPUTS AFTER', outputNode.outputs[`${this.inputs[i].link.target_slot}`].links)\n      }\n    }\n    delete this.inputs[inputsCount - 1];\n    this.size = this.computeSize();\n    if (this['onInputRemoved']) this['onInputRemoved'](slot);\n  }\n\n  /*\n  addInputAtPosition(\n    position: number,\n    name?: string,\n    type?: Type,\n    setting: InputSetting = { exist: false, nullable: false },\n    extra_info: any = {},\n  ): number {\n    if (!this.inputs) this.inputs = {};\n    const inputsCount = this.getInputsCount();\n    if (position >= inputsCount) return this.addInput(name, type, setting, extra_info);\n    else {\n      const myID = this.id;\n      for (let i = inputsCount; i > position; i--) {\n        this.inputs[i] = this.inputs[i - 1];\n        if (this.inputs[i].hasOwnProperty('link')) {\n          const outputNode: Node = this.container._nodes[`${this.inputs[i].link.target_node_id}`];\n          let linksArray = outputNode.outputs[`${this.inputs[i].link.target_slot}`].links;\n          const replaceLinkIndex = linksArray.findIndex(link => {\n            return link.target_node_id == myID && link.target_slot == i - 1;\n          });\n          if (replaceLinkIndex != -1) linksArray.splice(replaceLinkIndex, 1, { target_node_id: myID, target_slot: i });\n          outputNode.updateNodeOutput();\n        }\n      }\n      let input: NodeInput = { name, type, setting, ...extra_info };\n      this.inputs[position] = input;\n      this.size = this.computeSize();\n      if (this['onInputAdded']) this['onInputAdded'](input);\n      return position;\n    }\n    this.updateNodeInput();\n  }\n  */\n\n  getInputsCount(): number {\n    return this.inputs ? Object.keys(this.inputs).length : 0;\n  }\n\n  getOutputsCount(): number {\n    return this.outputs ? Object.keys(this.outputs).length : 0;\n  }\n\n  // TODO: Edit nodes which is using these functions\n  changeInputsCount(target_count: number, type?: Type) {\n    let current_count = this.getInputsCount();\n    let diff = target_count - current_count;\n\n    //add\n    if (diff > 0) for (let i = 0; i < diff; i++) this.addInput(null, type);\n\n    //remove\n    if (diff < 0) {\n      let ids = Object.keys(this.inputs);\n      for (let i = 0; i > diff; i--) {\n        let id = ids[ids.length + i - 1];\n        this.removeInput(+id);\n      }\n    }\n  }\n\n  changeOutputsCount(target_count: number, type?: Type) {\n    let current_count = this.getOutputsCount();\n    let diff = target_count - current_count;\n\n    //add\n    if (diff > 0) for (let i = 0; i < diff; i++) this.addOutput(null, type);\n\n    //remove\n    if (diff < 0) {\n      let ids = Object.keys(this.outputs);\n      for (let i = 0; i > diff; i--) {\n        let id = ids[ids.length + i - 1];\n        this.removeOutput(+id);\n      }\n    }\n  }\n\n  getLastInputIndex(): number {\n    return this.inputs ? Object.values(this.inputs).filter(value => !value.setting.hidden).length : 0;\n  }\n\n  getLastOutputIndex(): number {\n    return this.outputs ? Object.values(this.outputs).length : 0;\n  }\n\n  computeHeight(): number {\n    let rows = Math.max(this.getLastInputIndex() + this.getLastOutputIndex(), 1);\n    // MAGIC number `15` and `6`\n    return rows * 15 + 6;\n  }\n\n  /**\n   * Computes the size of a node according to its inputs and output slots\n   * @param changeWidth If true will compute width based on title, max width of names and max width of lables\n   * @returns {[number, number]} the total size\n   */\n  computeSize(changeWidth = false): [number, number] {\n    let size: [number, number] = [0, 0];\n    size[1] = this.computeHeight();\n\n    if (!changeWidth && this.size != undefined) {\n      size[0] = this.size[0];\n      return size;\n    }\n\n    let font_size = 14;\n    let title_width = compute_text_size(this.title);\n    let maxLabelWidth = 0;\n    let maxNameWidth = 0;\n\n    if (this.inputs) {\n      for (let i in this.inputs) {\n        let input = this.inputs[i];\n        let label = input.label ?? '';\n        let name = input.name ?? '';\n        let labelWidth = compute_text_size(label);\n        let nameWidth = compute_text_size(name);\n        if (maxLabelWidth < labelWidth) maxLabelWidth = labelWidth;\n        if (maxNameWidth < nameWidth) maxNameWidth = nameWidth;\n      }\n    }\n\n    if (this.outputs) {\n      for (let o in this.outputs) {\n        let output = this.outputs[o];\n        let label = output.label ?? '';\n        let name = output.name ?? '';\n        let labelWidth = compute_text_size(label);\n        let nameWidth = compute_text_size(name);\n        if (maxLabelWidth < labelWidth) maxLabelWidth = labelWidth;\n        if (maxNameWidth < nameWidth) maxNameWidth = nameWidth;\n      }\n    }\n\n    if (maxLabelWidth == 0) maxLabelWidth = maxNameWidth;\n    size[0] = Math.max(maxLabelWidth + maxNameWidth + 10, title_width);\n    size[0] = Math.max(size[0], this.MIN_WIDTH);\n\n    function compute_text_size(text) {\n      if (!text) return 0;\n      return font_size * text.length * 0.6;\n    }\n\n    return size;\n  }\n\n  calculateMinWidth(...width: Array<number>): number {\n    return Math.max(this.MIN_WIDTH, ...width);\n  }\n\n  /**\n   * Connect output to the input of another node\n   * @param {number} output_id output id\n   * @param {number} target_node_id target node id\n   * @param {number} target_input_slot current target input slot\n   * @param {number} target_input_id target input id\n   * @returns {boolean} true if connected successfully\n   */\n  connect(output_id: number, target_node_id: number, target_input_slot: number, target_input_id?: number): boolean {\n    return this.linkHandler.make({\n      origin_id: this.id,\n      origin_slot: output_id,\n      target_id: target_node_id,\n      target_slot: target_input_slot,\n      target_input_id: target_input_id,\n    } as LinkInfo);\n  }\n\n  /**\n   * Disconnect output slot connect nodes links\n   * @param {number} slot whose links should be disconnected\n   * @returns {boolean} true if disconnected successfully\n   */\n  disconnectOutputLinks(slot: number): boolean {\n    return this.linkHandler.disconnectOutput(slot);\n  }\n\n  /**\n   * Disconnect input slot connected node link\n   * @param {number} input_slot current input slot\n   * @param {number} input_id whose link should be disconnected\n   * @returns {boolean} true if disconnected successfully\n   */\n  disconnectInputLink(input_slot: number, input_id?: number): boolean {\n    return this.linkHandler.disconnectInput(input_slot, input_id);\n  }\n\n  /* Forces to redraw or the main renderer (Node) or the bg renderer (links) */\n  setDirtyCanvas(dirty_foreground: boolean, dirty_background?: boolean): void {\n    if (!this.container) return;\n    this.container.sendActionToRenderer('setDirty', [dirty_foreground, dirty_background]);\n  }\n\n  /**\n   * Collapse the node to make it smaller on the renderer\n   **/\n  collapse(): void {\n    this.flags.collapsed = !this.flags.collapsed;\n    this.setDirtyCanvas(true, true);\n  }\n\n  /**\n   * Print debug message to console\n   * @param message\n   */\n  debug(message: any): void {\n    log.debug(this.getReadableId() + ' ' + message);\n  }\n\n  /**\n   * Print debug message to console\n   * @param message\n   */\n  debugInfo(message: any): void {\n    log.info(this.getReadableId() + ' ' + message);\n  }\n\n  /**\n   * Print error message to console\n   * @param message\n   * @param module\n   */\n  debugWarn(message: any, module?: string): void {\n    log.warn(this.getReadableId() + ' ' + message);\n  }\n\n  /**\n   * Print error message to console\n   * @param message\n   * @param module\n   */\n  debugErr(message: any, module?: string): void {\n    log.error(this.getReadableId() + ' ' + message);\n  }\n\n  getReadableId(): string {\n    if (this.container) {\n      return `[${this.type}][${this.container.id}/${this.id}]`;\n    } else {\n      return `[${this.type}][-/${this.id}]`;\n    }\n  }\n\n  sendMessageToServerSide(message: any) {\n    if (this.side === Side.server) {\n      log.warn(`Node ${this.getReadableId()} is trying to send message from server side to server side`);\n    } else {\n      this.container.client_socket.emit('nodeMessageToServerSide', {\n        id: this.id,\n        cid: this.container.id,\n        message: message,\n      });\n    }\n  }\n\n  sendMessageToEditorSide(message: any, onlyConnectedUsers = true) {\n    let m = { id: this.id, cid: this.container.id, message };\n\n    if (this.side == Side.editor) {\n      log.warn(`Node ${this.getReadableId()} is trying to send message from editor side to editor side`);\n    } else if (this.side === Side.server) {\n      let socket = this.container.server_editor_socket;\n\n      if (onlyConnectedUsers) {\n        socket.in('' + this.container.id).emit('nodeMessageToEditorSide', m);\n      } else {\n        socket.emit('nodeMessageToEditorSide', m);\n      }\n    } else {\n      this.container.client_socket.emit('nodeMessageToEditorSide', m);\n    }\n  }\n\n  sendAddInputToEditorSide(name?: string, type?: string, extra_info?: any) {\n    let m = {\n      id: this.id,\n      cid: this.container.id,\n      input: {\n        name: name,\n        type: type,\n        extra_info: extra_info,\n      },\n    };\n\n    if (this.side === Side.editor) {\n      log.warn('Node ' + this.getReadableId() + ' is trying to send message from editor side to editor side');\n    } else if (this.side === Side.server) {\n      let socket = this.container.server_editor_socket;\n      socket.emit('node-add-input', m);\n    } else {\n      this.container.client_socket.emit('node-add-input', m);\n    }\n  }\n\n  sendAddOutputToEditorSide(name?: string, type?: string, extra_info?: any) {\n    let m = {\n      id: this.id,\n      cid: this.container.id,\n      output: {\n        name: name,\n        type: type,\n        extra_info: extra_info,\n      },\n    };\n\n    if (this.side === Side.editor) {\n      log.warn('Node ' + this.getReadableId() + ' is trying to send message from editor side to editor side');\n    } else if (this.side === Side.server) {\n      let socket = this.container.server_editor_socket;\n      socket.emit('node-add-output', m);\n    } else {\n      this.container.client_socket.emit('node-add-output', m);\n    }\n  }\n\n  sendRemoveInputToEditorSide(id: number) {\n    let m = {\n      id: this.id,\n      cid: this.container.id,\n      input: id,\n    };\n\n    if (this.side === Side.editor) {\n      log.warn('Node ' + this.getReadableId() + ' is trying to send message from editor side to editor side');\n    } else if (this.side === Side.server) {\n      let socket = this.container.server_editor_socket;\n      socket.emit('node-remove-input', m);\n    } else {\n      this.container.client_socket.emit('node-remove-input', m);\n    }\n  }\n\n  sendRemoveOutputToEditorSide(id: number) {\n    let m = {\n      id: this.id,\n      cid: this.container.id,\n      output: id,\n    };\n\n    if (this.side === Side.editor) {\n      log.warn('Node ' + this.getReadableId() + ' is trying to send message from editor side to editor side');\n    } else if (this.side === Side.server) {\n      let socket = this.container.server_editor_socket;\n      socket.emit('node-remove-output', m);\n    } else {\n      this.container.client_socket.emit('node-remove-output', m);\n    }\n  }\n\n  sendIOValuesToEditor() {\n    let inputs_values = [];\n    let outputs_values = [];\n\n    if (this.inputs) {\n      for (let i in this.inputs) {\n        const data = this.inputs[i].data;\n        inputs_values.push({\n          nodeId: this.id,\n          inputId: i,\n          data: data,\n        });\n      }\n    }\n\n    if (this.outputs) {\n      for (let o in this.outputs) {\n        const data = this.outputs[o].data;\n        outputs_values.push({\n          nodeId: this.id,\n          outputId: o,\n          data: data,\n        });\n      }\n    }\n\n    let slots_values = {\n      cid: this.container.id,\n      inputs: inputs_values,\n      outputs: outputs_values,\n    };\n\n    this.container.server_editor_socket.in('' + this.container.id).emit('nodes-io-values', slots_values);\n  }\n\n  updateInputsLabels() {\n    if (this.inputs) {\n      for (let i in this.inputs) {\n        let input = this.inputs[i];\n        input.label = '';\n      }\n      this.setDirtyCanvas(true, true);\n    }\n  }\n\n  updateOutputsLabels() {\n    if (this.outputs) {\n      for (let o in this.outputs) {\n        let output = this.outputs[o];\n        output.label = '';\n      }\n      this.setDirtyCanvas(true, true);\n    }\n  }\n\n  broadcastSettingsToClients(onlyConnectedUsers = true) {\n    this.sendMessageToEditorSide({ action: BROADCAST.UPDATE_SETTINGS, payload: this.settings }, onlyConnectedUsers);\n  }\n\n  broadcastPropertiesToClients(onlyConnectedUsers = true) {\n    this.sendMessageToEditorSide({ action: BROADCAST.UPDATE_PROPERTIES, payload: this.properties }, onlyConnectedUsers);\n  }\n\n  broadcastOutputsToClients(onlyConnectedUsers = true) {\n    this.sendMessageToEditorSide({ action: BROADCAST.UPDATE_OUTPUTS, payload: this.outputs }, onlyConnectedUsers);\n  }\n\n  broadcastNodeStateToClients(onlyConnectedUsers = true) {\n    this.sendMessageToEditorSide({ action: BROADCAST.UPDATE_STATE, payload: this.nodeState }, onlyConnectedUsers);\n  }\n\n  broadcastTitleToClients(onlyConnectedUsers = true) {\n    this.sendMessageToEditorSide({ action: BROADCAST.UPDATE_TITLE, payload: this.title }, onlyConnectedUsers);\n  }\n\n  broadcastNameToClients(onlyConnectedUsers = true) {\n    this.sendMessageToEditorSide({ action: BROADCAST.UPDATE_NAME, payload: this.name }, onlyConnectedUsers);\n  }\n\n  broadcastValToClients(key: string, val: any, onlyConnectedUsers = true) {\n    this.sendMessageToEditorSide({ action: BROADCAST.UPDATE_VALUE, key: key, payload: val }, onlyConnectedUsers);\n  }\n\n  onGetMessageToEditorSide({ action, payload, key }) {\n    switch (action) {\n      case BROADCAST.UPDATE_VALUE:\n        this.settings[key].value = payload;\n        return;\n      case BROADCAST.UPDATE_SETTINGS:\n        this.settings = payload;\n        return;\n      case BROADCAST.UPDATE_PROPERTIES:\n        this.properties = payload;\n        return;\n      case BROADCAST.UPDATE_OUTPUTS:\n        this.outputs = payload;\n        break;\n      case BROADCAST.UPDATE_TITLE:\n        this.title = payload;\n        this.size = this.computeSize();\n        break;\n      case BROADCAST.UPDATE_STATE:\n        this.nodeState = payload;\n        break;\n      case BROADCAST.UPDATE_NAME:\n        this.name = payload;\n        break;\n      default:\n        this.debugErr(`Received unknown editor action ${action} with payload ${JSON.stringify(payload)}`);\n        break;\n    }\n  }\n\n  setSettingsConfig(config: NodeSettingConfig) {\n    this.settingConfigs = config;\n  }\n\n  formattedExecutionTime(): string {\n    return moment(this.executeLastTime).format('YYYY-MM-DDTHH:MM:ss');\n  }\n\n  setNodeState(state: NodeState) {\n    this.nodeState = state;\n    if (this.side == Side.server) {\n      this.broadcastNodeStateToClients();\n    }\n  }\n\n  getParentNode(): Node {\n    return Registry._nodes[Registry.getId(this.container.parent_container_id, this.container.parent_id)];\n  }\n\n  /**\n   * Replaces setting with old setting and restores validations.\n   *\n   * @param inputSettings Updated settings that should replace existing\n   */\n  settingsWithValidation(inputSettings: { [name: string]: NodeSettings }) {\n    const outputSettings = inputSettings;\n\n    // repopulate validation\n    let node_class = Container.nodes_types[this.type];\n    let tempNode: Node = new node_class(this.container, this.id, this.properties);\n\n    const settings = { ...tempNode.settings };\n\n    Object.keys(outputSettings).forEach(key => {\n      outputSettings[key].validation = settings[key] ? settings[key].validation : null;\n    });\n    return outputSettings;\n  }\n\n  displayError(e: any, message: string = '') {\n    this.container.server_editor_socket.emit(ERROR, `${message} ${this.extractErrorMessage(e)}`);\n  }\n\n  displayMessage(message: string) {\n    this.container.server_editor_socket.emit(NOTIFICATION, message);\n  }\n\n  private extractErrorMessage(e: any) {\n    return get(e, 'response.data.message', get(e, 'message', e));\n  }\n\n  convertInput = (input: any, dataType: Type, decimals: number = 3) => {\n    const inputDataType = typeof input;\n    if (dataType === Type.NUMBER) {\n      input = Number((isNaN(input) ? 0 : Number(input)).toFixed(decimals));\n    } else if (dataType === Type.BOOLEAN) {\n      if (inputDataType === 'boolean') input = Number(input);\n      else input = input === 1 || input === 'true' ? 1 : 0;\n    } else if (dataType === Type.STRING && inputDataType !== 'string') {\n      input = JSON.stringify(input);\n    }\n    return input;\n  };\n}\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 04.07.2016.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\nimport { isNull } from '../utils/helper';\n\nexport default class Utils {\n  static operatorsBoolName = [\n    '==',\n    '!=',\n    '<',\n    '<=',\n    '>',\n    '>=',\n    // 'between',\n    // 'contains',\n    // 'is true',\n    // 'is false',\n    // 'null',\n    // 'not null',\n  ];\n\n  static operatorsMathName = ['+', '-', '/', '*', 'min', 'max'];\n\n  static operatorsBool = {\n    eq: function(a, b) {\n      return a == b;\n    },\n    neq: function(a, b) {\n      return a != b;\n    },\n    lt: function(a, b) {\n      return a < b;\n    },\n    lte: function(a, b) {\n      return a <= b;\n    },\n    gt: function(a, b) {\n      return a > b;\n    },\n    gte: function(a, b) {\n      return a >= b;\n    },\n    btwn: function(a, b, c) {\n      return (a >= b && a <= c) || (a <= b && a >= c);\n    },\n    contains: function(a, b) {\n      return (a + '').indexOf(b) != -1;\n    },\n    regex: function(a, b, c, d) {\n      return (a + '').match(new RegExp(b, d ? 'i' : ''));\n    },\n    true: function(a) {\n      return a === true;\n    },\n    false: function(a) {\n      return a === false;\n    },\n    null: function(a) {\n      return typeof a == 'undefined' || a === null;\n    },\n    notNull: function(a) {\n      return typeof a != 'undefined' && a !== null;\n    },\n    empty: function(a) {\n      if (typeof a === 'string' || Array.isArray(a) || Buffer.isBuffer(a)) {\n        return a.length === 0;\n      } else if (typeof a === 'object' && a !== null) {\n        return Object.keys(a).length === 0;\n      }\n      return false;\n    },\n    notEmpty: function(a) {\n      if (typeof a === 'string' || Array.isArray(a) || Buffer.isBuffer(a)) {\n        return a.length !== 0;\n      } else if (typeof a === 'object' && a !== null) {\n        return Object.keys(a).length !== 0;\n      }\n      return false;\n    },\n  };\n\n  static operatorsStatName = [\n    'max',\n    'min',\n    'range',\n    'midRange',\n    'sum',\n    'mean',\n    'median',\n    'variance',\n    'standardDeviation',\n    'meanAbsoluteDeviation',\n  ];\n\n  static stat = {\n    max: function(array) {\n      return Math.max.apply(null, array);\n    },\n\n    min: function(array) {\n      return Math.min.apply(null, array);\n    },\n\n    range: function(array) {\n      return Utils.stat.max(array) - Utils.stat.min(array);\n    },\n\n    midRange: function(array) {\n      return Utils.stat.range(array) / 2;\n    },\n\n    sum: function(array) {\n      let num = 0;\n      for (let i = 0, l = array.length; i < l; i++) num += array[i];\n      return num;\n    },\n\n    mean: function(array) {\n      return Utils.stat.sum(array) / array.length;\n    },\n\n    median: function(array) {\n      array.sort(function(a, b) {\n        return a - b;\n      });\n      const mid = array.length / 2;\n      return mid % 1 ? array[mid - 0.5] : (array[mid - 1] + array[mid]) / 2;\n    },\n\n    modes: function(array) {\n      if (!array.length) return [];\n      let modeMap = {},\n        maxCount = 0,\n        modes = [];\n\n      array.forEach(function(val) {\n        if (!modeMap[val]) modeMap[val] = 1;\n        else modeMap[val]++;\n\n        if (modeMap[val] > maxCount) {\n          modes = [val];\n          maxCount = modeMap[val];\n        } else if (modeMap[val] === maxCount) {\n          modes.push(val);\n          maxCount = modeMap[val];\n        }\n      });\n      return modes;\n    },\n\n    variance: function(array) {\n      const mean = Utils.stat.mean(array);\n      return Utils.stat.mean(\n        array.map(function(num) {\n          return Math.pow(num - mean, 2);\n        }),\n      );\n    },\n\n    standardDeviation: function(array) {\n      return Math.sqrt(Utils.stat.variance(array));\n    },\n\n    meanAbsoluteDeviation: function(array) {\n      const mean = Utils.stat.mean(array);\n      return Utils.stat.mean(\n        array.map(function(num) {\n          return Math.abs(num - mean);\n        }),\n      );\n    },\n\n    zScores: function(array) {\n      const mean = Utils.stat.mean(array);\n      const standardDeviation = Utils.stat.standardDeviation(array);\n      return array.map(function(num) {\n        return (num - mean) / standardDeviation;\n      });\n    },\n  };\n\n  /**\n   * @param schema {string} http or https\n   * @param host {string}\n   * @param port {number}\n   * @returns {string}\n   */\n  static buildUrl = (host: string, port: number, schema: string = 'http') => {\n    return `${schema}://${host}${port ? `:${port}` : ''}`;\n  };\n\n  //makes a timestamp\n  static getTimeStamp() {\n    const now = new Date();\n    return (\n      now.getFullYear() +\n      '-' +\n      (now.getMonth() + 1) +\n      '-' +\n      now.getDate() +\n      ' ' +\n      now.getHours() +\n      ':' +\n      (now.getMinutes() < 10 ? '0' + now.getMinutes() : now.getMinutes() + ':' + '00')\n    );\n  }\n\n  /***\n   * Builds node input data into an array\n   * @param array\n   */\n  static sum = array => array.reduce((cv, pv) => cv + pv, 0);\n\n  /**\n   * Creates a copy of the provided value, excluding non-serializable values\n   */\n  static onlySerializable(value: any): any {\n    return JSON.parse(JSON.stringify(value));\n  }\n\n  /***\n   * Clone object\n   * @param obj\n   * @param target\n   * @returns {any}\n   */\n  static cloneObject(obj: any, target?: any): any {\n    if (obj == null) return null;\n    let r = JSON.parse(JSON.stringify(obj));\n    if (!target) return r;\n\n    for (let i in r) target[i] = r[i];\n    return target;\n  }\n\n  /**\n   * Calculate distance\n   * @param a\n   * @param b\n   * @returns {number}\n   */\n  static distance(a: [number, number], b: [number, number]): number {\n    return Math.sqrt((b[0] - a[0]) * (b[0] - a[0]) + (b[1] - a[1]) * (b[1] - a[1]));\n  }\n\n  /**\n   * Compute is shape inside a rectangle\n   * @param x\n   * @param y\n   * @param left\n   * @param top\n   * @param width\n   * @param height\n   * @returns {boolean}\n   */\n  static isInsideRectangle(x: number, y: number, left: number, top: number, width: number, height: number): boolean {\n    return left < x && left + width > x && top < y && top + height > y;\n  }\n\n  /**\n   * Compute is bounings overlap\n   * @param a\n   * @param b\n   * @returns {boolean}\n   */\n  static overlapBounding(\n    [aLeft, aBottom, aRight, aTop]: [number, number, number, number],\n    [bLeft, bBottom, bRight, bTop]: [number, number, number, number],\n  ): boolean {\n    return !(aLeft > bRight || aBottom > bTop || aRight < bLeft || aTop < bBottom);\n  }\n\n  /**\n   * @param val {any} value to be parsed\n   * @param type {string} type need to parsed\n   * Three state:\n   * 1. undefined: when we don't value input connected\n   * 2. null: connected but have no value (for text-box '' is treated as null)\n   * 3. Real value\n   */\n  static parseValue(val: any, type: string): any {\n    const typeofVal: string = typeof val;\n\n    if (val === null && type === 'string' && typeofVal !== 'string') return '';\n    if (val == null) return val; // undefined or null\n\n    if (type === 'number' && typeofVal !== 'number') {\n      if (typeofVal === 'boolean') return val ? 1 : 0;\n      return isNaN(parseFloat(val)) ? null : parseFloat(val); // non-parsable val as null\n    } else if (type === 'string' && typeofVal !== 'string') {\n      return JSON.stringify(val);\n    } else if (type === 'boolean' && typeofVal !== 'boolean') {\n      return isNull(val) || val === '' ? null : /true|1/gi.test(val);\n    } else if (type === 'json') {\n      const originalVal = val;\n      val = {};\n      if (typeofVal === 'string') {\n        try {\n          val = JSON.parse(originalVal);\n        } catch (e) {}\n      } else if (typeofVal === 'object') {\n        try {\n          val = JSON.parse(JSON.stringify(originalVal));\n        } catch (e) {}\n      }\n    }\n    return val;\n  }\n\n  static formatValue(val: any): string {\n    if (val == null) return '';\n    return this.formatAsPerValueType(val);\n  }\n\n  static formatNodeInOut(val: any): string {\n    if (val === null) return 'null';\n    if (val === '') return 'null'; // display '' as 'null' since we are treating text-box '' as null\n    if (val === undefined) return undefined;\n    return this.formatAsPerValueType(val);\n  }\n\n  private static formatAsPerValueType(val: any): string {\n    if (typeof val === 'boolean') {\n      val = val ? 'true' : 'false';\n    } else if (typeof val === 'number') {\n      val = parseFloat(val.toFixed(3)).toString();\n    } else if (typeof val === 'object') {\n      try {\n        JSON.parse(JSON.stringify(val));\n      } catch (e) {\n        return '[object]';\n      }\n      val = JSON.stringify(val);\n    }\n    return val;\n  }\n\n  static hasInput(data): boolean {\n    return data !== undefined;\n  }\n\n  static hasValidInput(data, nullable): boolean {\n    if (nullable) {\n      return data !== undefined;\n    }\n    return data != null && data !== ''; // `null`, `undefined` and string null i.ie `''` are needed to be checked\n  }\n\n  /**\n   * Get current time\n   * @returns {number}\n   */\n  static getTime(): number {\n    return typeof performance != 'undefined' ? performance.now() : Date.now();\n  }\n\n  static toFixedNumber(value: number, digits: number) {\n    let pow = Math.pow(10, digits);\n    return +(Math.round(value * pow) / pow);\n  }\n\n  /**\n   * @Deprecated: Use MathUtils::clamp\n   */\n  static clamp = function(value: number, min: number, max: number): number {\n    return Math.min(Math.max(value, min), max);\n  };\n\n  static remap = function(value: number, inMin: number, inMax: number, outMin: number, outMax: number): number {\n    value = Number(value);\n    inMin = Number(inMin);\n    inMax = Number(inMax);\n    outMin = Number(outMin);\n    outMax = Number(outMax);\n    if (value > inMax) value = inMax;\n    else if (value < inMin) value = inMin;\n    return ((value - inMin) / (inMax - inMin)) * (outMax - outMin) + outMin;\n  };\n\n  static renameKey = (old_key: string, new_key: string) => (instance: object) => {\n    if (old_key === new_key) return instance;\n    const cloned = {\n      ...instance,\n      [new_key]: instance[old_key],\n    };\n    delete cloned[old_key];\n    return cloned;\n  };\n\n  // Shade, Blend and Convert a Web Color\n  static pSBC = (percentageChange, fromColor, toColor: string = undefined, useLinear = false) => {\n    let r,\n      g,\n      b,\n      a,\n      P,\n      f,\n      t,\n      h,\n      i = parseInt,\n      m = Math.round,\n      isToColorString = typeof toColor == 'string';\n    if (\n      typeof percentageChange != 'number' ||\n      percentageChange < -1 ||\n      percentageChange > 1 ||\n      typeof fromColor != 'string' ||\n      (fromColor[0] != 'r' && fromColor[0] != '#') ||\n      (toColor && !isToColorString)\n    )\n      return null;\n    const pSBCr = d => {\n      let n = d.length,\n        x = { r: 0, g: 0, b: 0, a: 0 };\n      if (n > 9) {\n        ([r, g, b, a] = d = d.split(',')), (n = d.length);\n        if (n < 3 || n > 4) return null;\n        (x.r = i(r[3] == 'a' ? r.slice(5) : r.slice(4))), (x.g = i(g)), (x.b = i(b)), (x.a = a ? parseFloat(a) : -1);\n      } else {\n        if (n == 8 || n == 6 || n < 4) return null;\n        if (n < 6) d = '#' + d[1] + d[1] + d[2] + d[2] + d[3] + d[3] + (n > 4 ? d[4] + d[4] : '');\n        d = i(d.slice(1), 16);\n        if (n == 9 || n == 5)\n          (x.r = (d >> 24) & 255), (x.g = (d >> 16) & 255), (x.b = (d >> 8) & 255), (x.a = m((d & 255) / 0.255) / 1000);\n        else (x.r = d >> 16), (x.g = (d >> 8) & 255), (x.b = d & 255), (x.a = -1);\n      }\n      return x;\n    };\n    (h = fromColor.length > 9),\n      (h = isToColorString ? (toColor.length > 9 ? true : toColor == 'c' ? !h : false) : h),\n      (f = pSBCr(fromColor)),\n      (P = percentageChange < 0),\n      (t =\n        toColor && toColor != 'c'\n          ? pSBCr(toColor)\n          : P\n          ? { r: 0, g: 0, b: 0, a: -1 }\n          : { r: 255, g: 255, b: 255, a: -1 }),\n      (percentageChange = P ? percentageChange * -1 : percentageChange),\n      (P = 1 - percentageChange);\n    if (!f || !t) return null;\n    if (useLinear)\n      (r = m(P * f.r + percentageChange * t.r)),\n        (g = m(P * f.g + percentageChange * t.g)),\n        (b = m(P * f.b + percentageChange * t.b));\n    else\n      (r = m((P * f.r ** 2 + percentageChange * t.r ** 2) ** 0.5)),\n        (g = m((P * f.g ** 2 + percentageChange * t.g ** 2) ** 0.5)),\n        (b = m((P * f.b ** 2 + percentageChange * t.b ** 2) ** 0.5));\n    (a = f.a), (t = t.a), (f = a >= 0 || t >= 0), (a = f ? (a < 0 ? t : t < 0 ? a : a * P + t * percentageChange) : 0);\n    if (h) return 'rgb' + (f ? 'a(' : '(') + r + ',' + g + ',' + b + (f ? ',' + m(a * 1000) / 1000 : '') + ')';\n    else\n      return (\n        '#' +\n        (4294967296 + r * 16777216 + g * 65536 + b * 256 + (f ? m(a * 255) : 0))\n          .toString(16)\n          .slice(1, f ? undefined : -2)\n      );\n  };\n\n  static formatAndTrimValue(val: any): string {\n    const typeofVal = typeof val;\n    if (val != null && (typeofVal === 'string' || typeofVal === 'object')) {\n      if (typeofVal === 'object') {\n        val = JSON.stringify(val);\n      }\n      if (val.length > 30) val = val.substr(0, 30) + '...';\n      return val;\n    }\n    return val;\n  }\n\n  static copyToClipboard(text): boolean {\n    const textarea = document.createElement('textarea');\n    textarea.textContent = text;\n    textarea.style.position = 'fixed'; // Prevent scrolling to bottom of page in Microsoft Edge.\n    document.body.appendChild(textarea);\n    textarea.select();\n    try {\n      return document.execCommand('copy'); // Security exception may be thrown by some browsers.\n    } catch (ex) {\n      return false;\n    } finally {\n      document.body.removeChild(textarea);\n    }\n  }\n\n  static download(filename, text) {\n    const element = document.createElement('a');\n    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\n    element.setAttribute('download', filename);\n\n    element.style.display = 'none';\n    document.body.appendChild(element);\n\n    element.click();\n\n    document.body.removeChild(element);\n  }\n\n  static WEEKDAYS = [null, 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];\n\n  static getISOday(day: string) {\n    return Utils.WEEKDAYS.indexOf(day.toLowerCase());\n  }\n\n  static sleep = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n}\n","export type Constructor<T = {}> = new (...args: any[]) => T;\n\n// export class EnumHelper {\n//   private constructor() {\n//   }\n//\n//   static toOpts = <E extends typeof Enumify>(enumType: E, convert: (e: E) => string): { text: string; value: any; }[] => {\n//     return enumType.enumKeys.map(k => {\n//       return { text: convert(enumType.enumValueOf(k) as E), value: k };\n//     });\n//   };\n//\n// }\n\nexport const isNull = (value: any): boolean => value == null; // undefined or null\n\nexport const isNotNull = (value: any): boolean => !isNull(value);\n\nexport const isJSON = (value: any): boolean => isNotNull(value) && (typeof value === 'object' || Array.isArray(value));\n\nexport const isString = (value: any): boolean => {\n  if (typeof value === 'string' || value instanceof String) {\n    return true\n  } else return false\n}\n\nexport const isEmpty = (value: any): boolean => {\n  if (isNull(value)) {\n    return true;\n  }\n  if (value instanceof Array) {\n    return value.length === 0;\n  }\n  if (value instanceof Object) {\n    return Object.keys(value).length === 0;\n  }\n  if (value instanceof String) {\n    return value.trim() === '';\n  }\n  return value.toString().trim() === '';\n};\n\nexport const toLowerSnakeCase = (label: string): string => {\n  return isNull(label)\n    ? null\n    : label\n      .toString()\n      .toLowerCase()\n      .replace(/-+\\s+/g, '_');\n};\n\nexport const isFunction = (func: any): boolean => func && {}.toString.call(func) === '[object Function]';\n\nexport const isNumeric = (n): boolean => !isNaN(parseFloat(n)) && isFinite(n);\n\nexport const convertToNumber = (value: any, strict: boolean = false): number => {\n  if (isNull(value)) {\n    return null;\n  }\n  let inString = value.toString();\n  let n = +inString;\n  if (isNumeric(n) && !/^\\s*$/.test(inString)) {\n    return n;\n  }\n  if (strict) {\n    throw new Error('Invalid number');\n  }\n  return null;\n};\n\nexport const Generator = {\n  map: (generator, mapper: Function) =>\n    function* (...args) {\n      for (const x of generator(...args)) yield mapper(x);\n    },\n  filter: (generator, filter: Function) =>\n    function* (...args) {\n      for (const x of generator(...args)) if (filter(x)) yield x;\n    },\n};\n\nexport const range = function* (from: number, to: number, step: number = 1) {\n  let i = 0,\n    length = ~~((to - from) / step) + 1;\n  while (i < length) yield from + i++ * step;\n};\n\nexport const union = (...collections): Set<any> => collections.reduce((c, l) => new Set([...c, ...l]), new Set());\n\nexport const unionToArray = (...collections): Array<any> => [...union(...collections)];\n","import * as moment from 'moment-timezone';\n\nexport enum TIME_TYPE {\n  DAYS = 'days',\n  HOURS = 'hours',\n  MINUTES = 'minutes',\n  SECONDS = 'seconds',\n  MILLISECONDS = 'milliseconds',\n}\n\nexport default class TimeUtils {\n  /**\n   * convert ms to days, hours, min, sec, ms\n   * @returns {number}\n   * @param timeType\n   * @param timeOut\n   */\n  static timeConvert(timeOut: number, timeType: string): number {\n    // calculate time in milliseconds\n    switch (timeType) {\n      case TIME_TYPE.DAYS:\n        return timeOut * 24 * 60 * 60 * 1000;\n      case TIME_TYPE.HOURS:\n        return timeOut * 60 * 60 * 1000;\n      case TIME_TYPE.MINUTES:\n        return timeOut * 60 * 1000;\n      case TIME_TYPE.SECONDS:\n        return timeOut * 1000;\n      case TIME_TYPE.MILLISECONDS:\n        return timeOut;\n      default:\n        return -1;\n    }\n  }\n\n  /**\n   * Round the time to the nearest min\n   * For example if interval is 15min then it will convert value on pattern 1:00, 1:15, 1:30\n   * @param interval\n   * @param momentValue\n   */\n  static nearestFutureMinutes(interval, momentValue: moment.Moment): moment.Moment {\n    const roundedMinutes = Math.ceil(momentValue.minute() / interval) * interval;\n    return momentValue\n      .clone()\n      .minute(roundedMinutes)\n      .second(0)\n      .millisecond(0);\n  }\n\n  /**\n   * Converts time duration into a human readable string formats\n   * @param timeInMs {number} a valid numeric number\n   * @param format {number} formats are as follows:\n   * Case 1: ${DD}:${HH}:${mm}:${ss}:${sss} with pad start 0\n   * Case 2: DD${DD}:HH${HH}:MM${mm}:SS${ss}:MS${sss} no pad start\n   * Case 3: DD${DD}:HH${HH}:MM${mm}:SS${ss}:MS${sss} with pad start 0\n   * Case 4: D${DD}:H${HH}:M${mm}:S${ss}:MS${sss} no pad start\n   * Case 5: D${DD}:H${HH}:M${mm}:S${ss}:MS${sss} with pad start 0\n   * Default: ${DD}:${HH}:${mm}:${s}:${sss}\n   * @param timeType {string} Options: days, hours, minutes, seconds, milliseconds\n   * @returns {string}\n   */\n\n  static timeDisplay(timeInMs: number, format: number = 5, timeType?: string) {\n    let duration = timeInMs;\n    if (timeType && timeType != 'milliseconds') duration = TimeUtils.timeConvert(duration, timeType);\n    const mm = moment.duration(duration);\n\n    switch (format) {\n      case 0:\n        return (\n          mm.days().toString() + ':' + mm.hours() + ':' + mm.minutes() + ':' + mm.seconds() + ':' + mm.milliseconds()\n        );\n      case 1:\n        return (\n          'DD:HH:MM:SS:MS ' +\n          mm.days() +\n          ':' +\n          mm.hours() +\n          ':' +\n          mm.minutes() +\n          ':' +\n          mm.seconds() +\n          ':' +\n          mm.milliseconds()\n        );\n      case 2:\n        return (\n          'DD' +\n          mm.days() +\n          ':' +\n          'HH' +\n          mm.hours() +\n          ':' +\n          'MM' +\n          mm.minutes() +\n          ':' +\n          'SS' +\n          mm.seconds() +\n          ':' +\n          'MS' +\n          mm.milliseconds()\n        );\n      case 3:\n        return (\n          'DD' +\n          mm\n            .days()\n            .toString()\n            .padStart(2, '0') +\n          ':' +\n          'HH' +\n          mm\n            .hours()\n            .toString()\n            .padStart(2, '0') +\n          ':' +\n          'MM' +\n          mm\n            .minutes()\n            .toString()\n            .padStart(2, '0') +\n          ':' +\n          'SS' +\n          mm\n            .seconds()\n            .toString()\n            .padStart(2, '0') +\n          ':' +\n          'MS' +\n          mm\n            .milliseconds()\n            .toString()\n            .padStart(3, '0')\n        );\n      case 4:\n        return (\n          'D' +\n          mm.days() +\n          ':' +\n          'H' +\n          mm.hours() +\n          ':' +\n          'M' +\n          mm.minutes() +\n          ':' +\n          'S' +\n          mm.seconds() +\n          ':' +\n          'MS' +\n          mm.milliseconds()\n        );\n      case 5:\n        return (\n          'D' +\n          mm\n            .days()\n            .toString()\n            .padStart(2, '0') +\n          ':' +\n          'H' +\n          mm\n            .hours()\n            .toString()\n            .padStart(2, '0') +\n          ':' +\n          'M' +\n          mm\n            .minutes()\n            .toString()\n            .padStart(2, '0') +\n          ':' +\n          'S' +\n          mm\n            .seconds()\n            .toString()\n            .padStart(2, '0') +\n          ':' +\n          'MS' +\n          mm\n            .milliseconds()\n            .toString()\n            .padStart(3, '0')\n        );\n      default:\n        return (\n          mm.days().toString() + ':' + mm.hours() + ':' + mm.minutes() + ':' + mm.seconds() + ':' + mm.milliseconds()\n        );\n    }\n  }\n  static timeConvertPlus(d?: any) {\n    try {\n      const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n      const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n\n      let dts = d.toDateString();\n      let e = d.getTime();\n      let mnu = this.pad(d.getMonth() + 1, 2);\n      let mnt = d.getMonth();\n      let mn = monthNames[mnt];\n      let dy = dayNames[d.getDay()];\n      let dt = this.pad(d.getDate(), 2);\n      let yr = d.getFullYear();\n      let hr = d.getHours();\n      let mi = d.getMinutes();\n      let ny = Math.ceil((d - <any>new Date(d.getFullYear(), 0, 1)) / 86400000);\n      let h = this.pad(hr, 2);\n      let m = this.pad(mi, 2);\n      let s = this.pad(d.getSeconds(), 2);\n      let mil = this.pad(d.getMilliseconds(), 3);\n\n      // Get hour in 12hr format\n      let thr = null;\n      if (hr === 0) {\n        thr = 12;\n      } else if (hr > 12) {\n        thr = hr - 12;\n      } else {\n        thr = hr;\n      }\n      thr = '' + thr;\n\n      // Calculate if AM or PM\n      let amp = hr * 60 + mi;\n      if (amp < 720) {\n        amp = 'AM';\n      } else {\n        amp = 'PM';\n      }\n      let hm = h + ':' + m;\n      let hms = h + ':' + m + ':' + s;\n      let ms = m + ':' + s;\n      let date = dts;\n      let yearMonthDay = '' + yr + '-' + mnu + '-' + dt;\n      let year = '' + yr;\n      let month = mn;\n      let monthAsNumber = mnu;\n      let dayAsNumber = dt;\n      let dayOfYearNumber = '' + ny;\n      let day = dy;\n      let hourAsAmPm = thr;\n      let hour = h;\n      let timeHourMin = hm;\n      let time = hms;\n      let minute = m;\n      let minutesSeconds = ms;\n      let seconds = s;\n      let milliseconds = mil;\n      let epoch = '' + e;\n      let rawDate = d;\n      let pmOrAm = amp;\n\n      return {\n        date: date,\n        yearMonthDay: yearMonthDay,\n        year: year,\n        month: month,\n        monthAsNumber: monthAsNumber,\n        dayAsNumber: dayAsNumber,\n        dayOfYearNumber: dayOfYearNumber,\n        day: day,\n        pmOrAm: pmOrAm,\n        hourAsAmPm: hourAsAmPm,\n        hour: hour,\n        timeHourMin: timeHourMin,\n        time: time,\n        minute: minute,\n        minutesSeconds: minutesSeconds,\n        seconds: seconds,\n        milliseconds: milliseconds,\n        epoch: epoch,\n        rawDate: rawDate,\n      };\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  private static pad(num: string, size: number) {\n    let s = num + '';\n    while (s.length < size) s = '0' + s;\n    return s;\n  }\n}\n","import { Node, SettingType} from './node';\nimport { convertType, InputSetting, NodeInput, NodeOutput, Type } from './node-io';\nimport Utils from './utils';\n\nexport class FlexibleNode extends Node {\n  nullableInputs: boolean = true;\n  dynamicInputsExist: boolean = true;\n  dynamicOutputsExist: boolean = false;\n  dynamicSettingsExist: boolean = true;\n  /**\n   * You can override this field if you have different setting name than `inputs` for reading inputs counts\n   * @returns {string} field name\n   */\n  dynamicInputsField: string = 'inputs';\n  /**\n   * You can override this field if you have different setting name than `outputs` for reading inputs counts\n   * @returns {string} field name\n   */\n  dynamicOutputsField: string = 'outputs';\n  /**\n   * For name convention on output\n   * Example:\n   * 0 for in1, in2, ...\n   * 1 for select, in1, in2, ...\n   * 2 for select, enable, in1, in2, ...\n   */\n  dynamicInputStartPosition: number = 0;\n  /**\n   * Dynamic input start name\n   * Example (for in):\n   * `[in 1]`, `[in 2]` will be inputs name\n   * `in1`, `in2` will be settings keys and `in 1` and `in 2` will be settings description\n   */\n  dynamicInputsStartName: string = 'in';\n  dynamicOutputsStartName: string = 'out';\n  dynamicInputsType: Type = Type.ANY;\n  dynamicOutputsType: Type = Type.ANY;\n  dynamicMinInputs: number = 2;\n  dynamicMaxInputs: number = 100;\n  dynamicMinOutputs: number = 2;\n  dynamicMaxOutputs: number = 100;\n  dynamicDefaultInputs: number = 2;\n  dynamicDefaultOutputs: number = 2;\n\n  constructor() {\n    super();\n  }\n\n  setup() {\n    if (this.dynamicInputsExist) {\n      this.settings['inputs'] = {\n        description: 'Inputs count',\n        value: this.dynamicDefaultInputs,\n        type: SettingType.NUMBER,\n      };\n    }\n    if (this.dynamicOutputsExist) {\n      this.settings['outputs'] = {\n        description: 'Outputs count',\n        value: this.dynamicDefaultOutputs,\n        type: SettingType.NUMBER,\n      };\n    }\n  }\n\n  /**\n   * It invokes right after finishing the constructor call\n   */\n  init() {\n    if (this.dynamicInputsExist) {\n      this.changeDynamicInputsAndSettings(false);\n    }\n    if (this.dynamicOutputsExist) {\n      this.addDynamicOutputsOnRange(false);\n    }\n  }\n\n  onAfterSettingsChange() {\n    if (this.dynamicInputsExist) {\n      this.changeDynamicInputsAndSettings();\n    }\n    if (this.dynamicOutputsExist) {\n      this.addDynamicOutputsOnRange();\n    }\n  }\n\n  /**\n   * Adds inputs dynamically as per the settings['inputs'] value\n   */\n  addDynamicInputsOnRange = (save: boolean = true): void => {\n    const count = this.dynamicInputsCount();\n    const targetCount = Utils.clamp(count, this.dynamicMinInputs, this.dynamicMaxInputs);\n    const currentCount = this.getInputsCount() - this.dynamicInputStartPosition;\n    const addedInputsCount = targetCount - currentCount;\n\n    if (addedInputsCount > 0) {\n      // add\n      for (let i = 0; i < addedInputsCount; i++) this.addInputWithName();\n    } else if (addedInputsCount < 0) {\n      // remove\n      const inputCount = this.getInputsCount();\n      for (let i = inputCount; i > inputCount + addedInputsCount; i--) {\n        this.removeInput(i - 1);\n      }\n    }\n    save && this.updateNodeInput();\n  };\n\n  /**\n   * Adds outputs dynamically as per the settings['outputs'] value\n   */\n  addDynamicOutputsOnRange = (save: boolean = true): void => {\n    const count = this.dynamicOutputsCount();\n    const targetCount = Utils.clamp(count, this.dynamicMinOutputs, this.dynamicMaxOutputs);\n    const currentCount = this.getOutputsCount();\n    const addedOutputsCount = targetCount - currentCount;\n\n    if (addedOutputsCount > 0) {\n      // add\n      for (let i = 0; i < addedOutputsCount; i++) this.addOutputWithName();\n    } else if (addedOutputsCount < 0) {\n      // remove\n      const inputCount = this.getOutputsCount();\n      for (let i = inputCount; i > inputCount + addedOutputsCount; i--) {\n        this.removeOutput(i - 1);\n      }\n    }\n    save && this.updateNodeOutput();\n  };\n\n  settingWiseDynamicInputsAndSettingsUpdate = (save: boolean = true) => {\n    const startingCount = this.getInputsCount();\n    this.addDynamicInputsOnRange(save);\n    const targetCount = this.getInputsCount();\n    this.addDynamicSettings(startingCount, targetCount);\n  };\n\n  settingWiseDynamicInputsAndSettingsUpdateForBoolean = (save: boolean = true) => {\n    this.dynamicInputsType = Type.BOOLEAN; // if not assigned\n    const startingCount = this.getInputsCount();\n    this.addDynamicInputsOnRange(save);\n    const targetCount = this.getInputsCount();\n    const name = this.dynamicInputsStartName;\n    for (let i = startingCount; i < targetCount; i++) {\n      if (!this.settings[`${name} ${this.dynamicIndex(i)}`]) {\n        this.settings[`${name} ${this.dynamicIndex(i)}`] = {\n          description: `${name} ${this.dynamicIndex(i)}`,\n          type: SettingType.DROPDOWN,\n          config: {\n            items: [\n              { value: false, text: 'false' },\n              { value: true, text: 'true' },\n              { value: null, text: 'null' },\n            ],\n          },\n          value: null,\n        };\n      }\n    }\n    for (let i = targetCount; i < startingCount; i++) {\n      delete this.settings[`${name} ${this.dynamicIndex(i)}`];\n    }\n  };\n\n  private changeDynamicInputsAndSettings(save: boolean = true) {\n    if (this.dynamicSettingsExist) {\n      if (this.dynamicInputsType === Type.BOOLEAN) {\n        this.settingWiseDynamicInputsAndSettingsUpdateForBoolean(save);\n      } else {\n        this.settingWiseDynamicInputsAndSettingsUpdate(save);\n      }\n    } else {\n      this.addDynamicInputsOnRange(save);\n    }\n  }\n\n  /**\n   * To read total number of inputs for dynamic input update\n   * @returns {number} total dynamic input count\n   */\n  public dynamicInputsCount = (): number => this.settings[this.dynamicInputsField].value;\n\n  public dynamicOutputsCount = (): number => this.settings[this.dynamicOutputsField].value;\n\n  private getInputSetting() {\n    return {\n      exist: this.dynamicSettingsExist,\n      nullable: this.nullableInputs,\n      hidden: false,\n    };\n  }\n\n  private addInputWithName = (): void => {\n    let id = this.getFreeInputId();\n    let setting: InputSetting = this.getInputSetting();\n    let name = `${this.dynamicInputsStartName} ${id + 1 - this.dynamicInputStartPosition}`;\n    if (this.dynamicSettingsExist) {\n      name = `[${name}]`;\n    }\n    let input: NodeInput = { name, type: this.dynamicInputsType, setting };\n    if (!this.inputs) this.inputs = {};\n    this.inputs[id] = input;\n    if (this['onInputAdded']) this['onInputAdded'](input);\n  };\n\n  private addOutputWithName = (): void => {\n    let id = this.getFreeOutputId();\n    let name = `${this.dynamicOutputsStartName} ${id + 1}`;\n    let output: NodeOutput = { name: name, type: this.dynamicOutputsType };\n    if (!this.outputs) this.outputs = {};\n    this.outputs[id] = output;\n    if (this['onOutputAdded']) this['onOutputAdded'](output);\n  };\n\n  /**\n   * Adds settings text fields dynamically as per starting count\n   */\n  private addDynamicSettings = (startingCount, targetCount) => {\n    // We are treating '' as null, if we store null value on string type it will create issue on everywhere.\n    // For example: null + 'ability' = 'ability'\n    const value = SettingType.STRING ? '' : null;\n    const name: string = this.dynamicInputsStartName;\n    const type: SettingType = convertType(this.dynamicInputsType);\n    for (let i = startingCount; i < targetCount; i++) {\n      if (!this.settings[`${name} ${this.dynamicIndex(i)}`]) {\n        this.settings[`${name} ${this.dynamicIndex(i)}`] = {\n          description: `${name} ${this.dynamicIndex(i)}`,\n          value,\n          type: type,\n        };\n      }\n    }\n    for (let i = targetCount; i < startingCount; i++) {\n      delete this.settings[`${name} ${this.dynamicIndex(i)}`];\n    }\n  };\n\n  private dynamicIndex = (id): number => id + 1 - this.dynamicInputStartPosition;\n}\n","module.exports = require(\"logplease\");","const env = process?.env;\n\nconst config = {\n  rubix       : {\n    version: '1.5.1-9c28cf9',\n    buildNb: '',\n  },\n  secretKey   : env?.SECRET_KEY || '',\n  port        : parseInt(env?.PORT ?? '1313'),\n  dataDir     : env?.DATA_DIR,\n  loopInterval: parseInt(env?.LOOP_INTERVAL ?? '100'),\n  backendSync : {\n    enabled                    : /true|1/i.test(env?.BACKEND_ENABLED ?? 'false'),\n    baseUrl                    : env?.BACKEND_API ?? '',\n    nodeRefreshIntervalSeconds : parseInt(env?.NODE_DISTANCE ?? '60'),\n    pointRefreshIntervalSeconds: parseInt(env?.NODE_REFRESH_INTERVAL_SEC ?? '60'),\n    nodeDistance               : parseInt(env?.POINT_REFRESH_INTERVAL_SEC ?? '60'),\n  },\n  bsa         : {\n    baseURL : env?.BSA_BASEURL ?? '',\n    username: env?.BSA_USERNAME ?? '',\n    password: env?.BSA_PASSWORD ?? '',\n    paths   : {\n      measurement: {\n        path  : env?.BSA_PATHS_MEASUREMENT_PATH ?? '',\n        accept: env?.BSA_PATHS_MEASUREMENT_ACCEPT ?? '',\n      },\n      alarm      : {\n        path       : env?.BSA_PATHS_ALARM_PATH ?? '',\n        accept     : env?.BSA_PATHS_ALARM_ACCEPT ?? '',\n        contentType: env?.BSA_PATHS_ALARM_CONTENTTYPE ?? '',\n      },\n      device     : {\n        path: env?.BSA_PATHS_DEVICE_PATH ?? '',\n      },\n    },\n  },\n  ditto       : {\n    baseURL : env?.DITTO_BASEURL ?? '',\n    username: env?.DITTO_USERNAME ?? '',\n    password: env?.DITTO_PASSWORD ?? '',\n  },\n  pg          : {\n    baseURL: env?.PG_BASEURL ?? '',\n  },\n  influxDb    : {\n    protocol    : env?.INFLUX_DB_PROTOCOL ?? 'http',\n    host        : env?.INFLUX_DB_HOST ?? '',\n    port        : env?.INFLUX_DB_PORT ?? '',\n    databaseName: env?.INFLUX_DB_DB_NAME ?? '',\n    username    : env?.INFLUX_DB_USERNAME ?? '',\n    password    : env?.INFLUX_DB_PASSWORD ?? '',\n  },\n  edge28      : {\n    baseURL: env?.EDGE_28_BASEURL ?? '',\n    port   : parseInt(env?.EDGE_28_PORT ?? '5000'),\n    apiVer : env?.EDGE_28_API_VER ?? '',\n  },\n  mqtt        : {\n    protocol: env?.MQTT_PROTOCOL ?? 'mqtt',\n    host    : env?.MQTT_HOST ?? '',\n    port    : parseInt(env?.MQTT_PORT ?? '1883'),\n    username: env?.MQTT_USERNAME ?? '',\n    password: env?.MQTT_PASSWORD ?? '',\n  },\n};\n\nexport const RUBIX_VERSION: string = `v${config.rubix.version}${config.rubix.buildNb && `-${config.rubix.buildNb}`}`;\nexport default config;\n","export const EDGES_PARENT_CONTAINER_TYPE = 'IoT/edges-container';\nexport const MODULES_PARENT_CONTAINER_TYPE = 'IoT/modules-container';\nexport const SERVICES_PARENT_CONTAINER_TYPE = 'IoT/services-container';\nexport const EDGE_CONTAINER_TYPE = 'IoT/edge';\nexport const NETWORK_CONTAINER_TYPE = 'IoT/network';\nexport const DEVICE_CONTAINER_TYPE = 'IoT/device';\nexport const GROUP_CONTAINER_TYPE = 'IoT/group';\nexport const POINT_NODE_TYPE = 'IoT/point';\nexport const SERVICE_NODE_TYPE = 'IoT/service';\nexport const MODULE_NODE_TYPE = 'IoT/module';\n\nexport const IOT_TYPES = [\n  EDGES_PARENT_CONTAINER_TYPE,\n  MODULES_PARENT_CONTAINER_TYPE,\n  SERVICES_PARENT_CONTAINER_TYPE,\n  EDGE_CONTAINER_TYPE,\n  NETWORK_CONTAINER_TYPE,\n  DEVICE_CONTAINER_TYPE,\n  GROUP_CONTAINER_TYPE,\n  POINT_NODE_TYPE,\n  SERVICE_NODE_TYPE,\n  MODULE_NODE_TYPE,\n];\n\nexport const MODBUS_RTU_NETWORK = 'protocols/modbus/modbus-rtu-network';\nexport const MODBUS_RTU_DEVICE = 'protocols/modbus/modbus-rtu-device';\nexport const MODBUS_RTU_POINT = 'protocols/modbus/modbus-rtu-point';\nexport const BACNET_NETWORK = 'protocols/bacnet/bacnet-network';\nexport const BACNET_DEVICE = 'protocols/bacnet/bacnet-device';\nexport const BACNET_POINT = 'protocols/bacnet/bacnet-point';\nexport const EDGE_28_NETWORK = 'protocols/nube/edge-28-network';\nexport const EDGE_28_INPUT = 'protocols/nube/edge-28-input';\nexport const EDGE_28_OUTPUT = 'protocols/nube/edge-28-output';\n\nexport const MQTT_NETWORK = 'protocols/mqtt/mqtt-network';\nexport const MQTT_POINT_WRITE = 'protocols/mqtt/mqtt-point-write';\nexport const MQTT_POINT_READ = 'protocols/mqtt/mqtt-point-read';\nexport const UNKNOWN_NODE = 'unknown/unknown';\n","module.exports = require(\"axios\");","import { Node } from './node';\n\nexport default class Registry {\n  static _nodes: { [id: string]: Node } = {};\n\n  static getId(containerId: number, nodeId: number) {\n    return `c${containerId}n${nodeId}`;\n  }\n}\n","module.exports = require(\"moment-timezone\");","module.exports = require(\"lodash\");","import { Node, SettingType } from './node';\nimport { IOT_TYPES } from './constants';\nimport { Container } from './container';\n\n// This container node needs its own file to prevent a cyclic dependency with `Container` that the TS compiler cannot resolve\n\n//Container: special node that contains a container of other nodes\nexport class ContainerNode extends Node {\n  sub_container: Container;\n  /**\n   * List of node type identifiers that can be created in specifically in this container node, but are not normally\n   * listed in the menu\n   */\n  extra_node_types: string[];\n\n  constructor(container: Container) {\n    super(container);\n    this.description = 'Contains other nodes';\n    this.title = 'Folder';\n    this.settings['name'] = {\n      description: 'Folder name',\n      value: 'Folder',\n      type: SettingType.STRING,\n    };\n  }\n\n  shouldRejectNodeType(type: string): boolean {\n    return IOT_TYPES.includes(type); // IoT nodes can only be created in special container nodes\n  }\n\n  onCreated() {\n    this.setupSubContainer();\n    this.initializeNameValue();\n  }\n\n  onAdded() {\n    this.applyTitle();\n  }\n\n  onAfterSettingsChange(oldSettings, oldName?: any) {\n    this.applyTitle();\n  }\n\n  onRemoved() {\n    for (let id in this.sub_container._nodes) {\n      let node = this.sub_container._nodes[id];\n      node.container.remove(node);\n    }\n\n    delete Container.containers[this.sub_container.id];\n  }\n\n  configure(data, from_db = false, configure_sub_cont = true) {\n    super.configure(data);\n    try {\n      this.sub_container = Container.containers[data.sub_container.id];\n      if (!this.sub_container) this.sub_container = new Container(this.side, data.sub_container.id);\n\n      this.sub_container.container_node = this;\n      this.sub_container.parent_container_id = this.container.id;\n      this.sub_container.parent_id = this.id;\n\n      if (configure_sub_cont) this.sub_container.configure(data.sub_container, true);\n    } catch (err) {\n      this.debugErr(`ERROR: configure() container node: ${err}`);\n    }\n  }\n\n  serialize() {\n    try {\n      let data = super.serialize();\n      data.sub_container = this.sub_container.serialize();\n      return data;\n    } catch (err) {\n      this.debugErr(`ERROR: serialize() container node: ${err}`);\n    }\n  }\n\n  getExtraMenuOptions(renderer, editor) {\n    let that = this;\n    return [\n      {\n        content: 'Open',\n        callback: function() {\n          editor.openContainer(that.sub_container.id);\n        },\n      },\n      null, //null for horizontal line\n    ];\n  }\n\n  onExecute() {\n    if (this.isUpdated) this.isRecentlyActive = true;\n\n    this.sub_container.runStep();\n  }\n\n  applyTitle() {\n    this.title = this.settings['name'].value;\n    this.sub_container.name = this.title;\n    this.size = this.computeSize();\n  }\n\n  /**\n   * Overridable. Called once, after the sub_container has been set up.\n   */\n  protected getInitialTitle() {\n    return `${this.title} ${this.sub_container.id}`;\n  }\n\n  private setupSubContainer() {\n    if (this.sub_container) {\n      this.sub_container = Container.containers[this.sub_container.id];\n    } else {\n      this.sub_container = new Container(this.side);\n    }\n    this.sub_container.container_node = this;\n    this.sub_container.parent_container_id = this.container.id;\n    this.sub_container.parent_id = this.id;\n    if (this.container.db) this.container.db.updateLastContainerId(this.sub_container.id);\n  }\n\n  private initializeNameValue() {\n    this.settings['name'].value = this.getInitialTitle();\n  }\n}\n","module.exports = require(\"express\");","/**\n * Created by Derwish (derwish.pro@gmail.com) on 02.03.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Node, SettingType } from '../../node';\nimport { Side } from '../../container';\nimport Debounce from 'lodash-decorators/debounce';\n\nexport class UiNode extends Node {\n  titlePrefix: string; // title on ui panel\n  defaultTitle: string;\n  template: string;\n  uiElementType: string;\n  uiPanelValue;\n\n  // onGetMessageToDashboardSide\n  // onDashboardElementGetNodeState - this will override default logic in dashboard-server-socket\n  // onDashboardElementSetNodeState - this will override default logic in dashboard-server-socket\n\n  constructor(defaultTitle: string, uiElementType: string, properties: any) {\n    super();\n    this.name = properties && properties.name;\n    this.titlePrefix = defaultTitle;\n    this.defaultTitle = defaultTitle;\n    this.uiElementType = uiElementType;\n    this.isDashboardNode = true;\n    this.settings['title'] = {\n      description: 'Title',\n      value: this.titlePrefix,\n      type: SettingType.STRING,\n    };\n    this.settings['ui-panel'] = { description: 'Ui Panel Name', type: SettingType.STRING };\n  }\n\n  init() {\n    if (this.settings['ui-panel']) {\n      this.uiPanelValue = this.settings['ui-panel'] && this.settings['ui-panel'].value;\n    }\n  }\n\n  onCreated() {\n    this.settings['ui-panel'].value = this.uiPanelValue || this.container.name;\n    if (this.side == Side.server) {\n      this.container.dashboard.onNodeChangePanelOrTitle(\n        this,\n        this.settings['ui-panel'].value,\n        this.settings['title'].value,\n      );\n    }\n  }\n\n  onAdded() {\n    this.changeTitle(this.settings['title'].value);\n  }\n\n  onBeforeSettingsChange(newSettings, newName) {\n    if (this.side == Side.server) {\n      this.name = newName;\n      this.container.dashboard.onNodeChangePanelOrTitle(\n        this,\n        newSettings['ui-panel'].value,\n        newSettings['title'].value,\n      );\n    }\n    this.changeTitle(newSettings['title'].value);\n  }\n\n  changeTitle(title: string) {\n    if (this.defaultTitle === title) this.title = title;\n    else this.title = this.defaultTitle + ': ' + title;\n  }\n\n  onRemoved() {\n    if (this.side == Side.server) this.container.dashboard.onNodeRemoved(this);\n  }\n\n  setState(state: any, sendToDashboard = true) {\n    this.properties['state'] = state;\n\n    // if called from constructor\n    if (this.container == null) return;\n\n    if (sendToDashboard) {\n      let m = { id: this.id, cid: this.container.id, state: state };\n      if (this.side == Side.server) {\n        // send state to all clients in the room\n        let socket = this.container.server_dashboard_socket;\n        let panelName = this.settings['ui-panel'].value;\n        socket.in('' + panelName).emit('dashboardElementGetNodeState', m);\n      }\n    }\n\n    this.storeInDatabase();\n  }\n\n  @Debounce(1000)\n  storeInDatabase() {\n    if (this.container && this.container.db) {\n      this.container.db.updateNode(this.id, this.container.id, {\n        $set: { properties: this.properties },\n      });\n    }\n  }\n\n  sendMessageToDashboardSide(mess: any) {\n    let m = { id: this.id, cid: this.container.id, message: mess };\n    if (this.side == Side.server) {\n      let socket = this.container.server_dashboard_socket;\n      let panelName = this.settings['ui-panel'].value;\n      socket.in('' + panelName).emit('nodeMessageToDashboardSide', m);\n    } else {\n      this.container.client_socket.emit('nodeMessageToDashboardSide', m);\n    }\n  }\n\n  getState() {\n    return this.properties['state'];\n  }\n}\n","import config from '../../config';\n\nconst CryptoJS = require('crypto-js');\n\nexport default class CryptoUtils {\n  static encrypt = text => {\n    return CryptoJS.AES.encrypt(text, config.secretKey).toString();\n  };\n\n  static decrypt = cipherText => {\n    return CryptoJS.AES.decrypt(cipherText, config.secretKey).toString(CryptoJS.enc.Utf8);\n  };\n}\n","module.exports = require(\"node-bacnet\");","module.exports = require(\"child_process\");","import { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nexport default abstract class Statistics extends FlexibleNode {\n  protected constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n  }\n\n  onAdded() {\n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {}\n\n  /**\n   * Get array of all input values or setting values where values are defined\n   */\n  getDefinedInputsOrSettingsValues() {\n    const output = [];\n    for (let i = 0; i < this.getInputsCount(); i++) {\n      const input = this.getInputData(i);\n      if (input != null) {\n        output.push(input);\n      }\n    }\n    return output;\n  }\n}\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 04.07.2016.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\n// source map for node typescript debug\nrequire('source-map-support').install();\nconst logger = require('logplease').create('app', { color: 2 });\nconst path = require('path');\nconst process = require('process');\nconst argv = require('minimist')(process.argv.slice(2));\nconst dataDir = process.env['DATA_DIR'] || argv['datadir'];\nconst envFile = argv['envFile'] || '.env';\nconst envFileAbsPath = path.isAbsolute(envFile) ? envFile : path.resolve(process.cwd(), envFile);\nprocess.env['DATA_DIR'] = path.isAbsolute(dataDir) ? dataDir : path.resolve(process.cwd(), dataDir);\nrequire('dotenv').config({ path: envFileAbsPath });\n(<any>global).__rootdirname = path.resolve(__dirname);\n\nlogger.info('----------------------------- Rubix Wires -----------------------------');\nlogger.info(`Process Dir       : '${process.cwd()}'`);\nlogger.info(`Working Dir       : '${(<any>global).__rootdirname}'`);\nlogger.info(`Data Dir          : '${process.env.DATA_DIR}'`);\nlogger.info(`Environment file  : '${envFileAbsPath}'`);\n\nimport { Backend } from './backend/backend';\nimport conf from './config';\nimport * as config from './config.json';\nimport { Database } from './database/database';\nimport { Container, Side } from './nodes/container';\nimport { Dashboard } from './server/dashboard';\nimport { Server } from './server/server';\n\nexport class App {\n  db: Database;\n  dashboard: Dashboard;\n  rootContainer: Container;\n  server: Server;\n\n  constructor() {\n    this.createServer();\n    this.start();\n  }\n\n  start() {\n    if (!this.rootContainer) {\n      this.registerNodes();\n      this.createRootContainer();\n    }\n\n    this.dashboard = new Dashboard(this.server.dashboardSocket);\n\n    if (config.dataBase.enable) {\n      if (!this.db) this.connectDatabase();\n      if (this.db) this.loadDatabase(true);\n    }\n\n    if (this.rootContainer) {\n      if (this.db) this.rootContainer.db = this.db;\n      if (this.dashboard) this.rootContainer.dashboard = this.dashboard;\n    }\n    this.rootContainer.run(conf.loopInterval);\n  }\n\n  createServer() {\n    this.server = new Server((<any>global).__rootdirname);\n  }\n\n  registerNodes() {\n    require('./nodes/nodes/index');\n    const types = Container.nodes_types ? Object.keys(Container.nodes_types).length : 0;\n    logger.debug('Registered ' + types + ' nodes types');\n  }\n\n  createRootContainer() {\n    this.rootContainer = new Container(Side.server);\n    if (this.server.editorSocket) this.rootContainer.server_editor_socket = this.server.editorSocket.io;\n    if (this.server.dashboardSocket) this.rootContainer.server_dashboard_socket = this.server.dashboardSocket.io;\n  }\n\n  connectDatabase() {\n    let db;\n    if (config.dataBase.useInternalDb) {\n      db = require('./database/neDbDatabase').db;\n    } else {\n      throw 'External db not implementer yet';\n    }\n\n    this.db = db;\n  }\n\n  loadDatabase(importNodes: boolean) {\n    this.db.asyncLoadDatabase().then(res => {\n      this.onDbLoadSuccess(res, importNodes);\n    });\n  }\n\n  startBackend() {\n    new Backend(this.db).start();\n  }\n\n  private onDbLoadSuccess(res, importNodes: boolean) {\n    if (!importNodes) return;\n\n    // get last container id\n    this.db.getLastContainerId((err, id) => {\n      if (id) Container.last_container_id = id;\n    });\n\n    // get last node id for root container\n    this.db.getLastRootNodeId((err, id) => {\n      if (id) app.rootContainer.last_node_id = id;\n    });\n\n    // import nodes\n    this.db.getNodes((err, ser_nodes) => {\n      if (!ser_nodes) return;\n      let containers = Container.containers;\n      let nodesCount = 0;\n\n      for (let n of ser_nodes) {\n        let cont = containers[n.cid];\n        if (!cont) cont = new Container(Side.server, n.cid);\n\n        nodesCount++;\n        cont.createNode(n.type, null, n);\n      }\n\n      // call nodes events\n      for (let cid in Container.containers) {\n        let container = Container.containers[cid];\n        for (let id in container._nodes) {\n          let node = container._nodes[id];\n          if (node['onDbReaded']) node['onDbReaded']();\n        }\n      }\n\n      // load dashboard ui elements\n      this.dashboard.loadFromDatabase(this.db);\n      let contCount = Object.keys(containers).length;\n      if (containers[0]) contCount--;\n      logger.info('Imported ' + contCount + ' containers, ' + nodesCount + ' nodes from database');\n      setTimeout(() => this.startBackend(), 1); // run on next tick\n    });\n  }\n}\n\nlet app = new App();\nexport default app;\n","// colours\n// https://material.io/design/material-studies/rally.html#\n// https://storage.googleapis.com/spec-host/mio-staging%2Fmio-design%2F1576174064000%2Fassets%2F17gZmwIGdzlDr-Hl2jTu2SSgc_ATBGaPt%2Fcasestudies-rally-color-palettes.png\n\nlet purpleNum: string = '#262B2F';\nlet purpleLightNum: string = '#262B2F';\nlet greenLightBool: string = '#262B2F';\nlet greenBool: string = '#262B2F';\nlet greyString: string = '#262B2F';\nlet turquoiseFunction: string = '#262B2F';\nlet greyMath: string = '#262B2F';\nlet greyTime: string = '#262B2F';\n// let purpleNum :string = '#00B400'\n\nexport default class Icons {\n  //UI\n\n  //Point images/logos/nube-frog.png\n  static frog: string = '/images/logos/iot-lora-alliance-logo.png';\n  static aiIcon: string = '/images/node-editor/icons/points/ai.svg';\n  static aiColour: string = purpleNum;\n\n  // main\n  static uiMainIcon: string = '/images/node-editor/icons/logic-bool/and2.svg';\n  static uiMainColour: string = purpleNum;\n\n  // logic\n  static logicMainColour: string = greenLightBool;\n\n  static logicAndIcon: string = '/images/node-editor/icons/logic-bool/and2.svg';\n  static logicOrIcon: string = '/images/node-editor/icons/logic-bool/or.svg';\n  static logicNotIcon: string = '/images/node-editor/icons/logic-bool/not.svg';\n\n  static compareGreaterIcon: string = '/images/node-editor/icons/logic-compare/greater-than-equal-solid.svg';\n\n  // Numbers\n\n  // Math\n  static mathMainColour: string = purpleLightNum;\n  static mathMainIcon: string = '/images/node-editor/icons/math-arithmetic/plus-solid.svg';\n\n  static mathAddIcon: string = '/images/node-editor/icons/math-arithmetic/plus-solid.svg';\n  static mathSubIcon: string = '/images/node-editor/icons/math-arithmetic/minus-solid.svg';\n  static mathDivideIcon: string = '/images/node-editor/icons/math-arithmetic/divide-solid.svg';\n  static mathTimesIcon: string = '/images/node-editor/icons/math-arithmetic/times-solid.svg';\n\n  // Bool\n\n  // Time\n\n  // edge\n  // static logicNotIcon: string = '/images/node-editor/icons/logic-bool/not.svg';\n  static edgeNetwork: string = '/images/node-editor/icons/logic-bool/not.svg';\n\n}\n","module.exports = require(\"nedb\");","module.exports = require(\"moment\");","/**\n * Used to chain asynchronous executions and to coordinate them from various class instances while limiting parallelism.\n *\n * Example use case: Executing HTTP requests while limiting number of simultaneous request.\n */\nexport class PromiseActor {\n  private stack: Promise<any> = Promise.resolve(null);\n\n  /**\n   * Append an asynchronous computation to the stack. The computation function will be called when all previously chained\n   * computations have completed, and must this return a promise to indicate its completion. The next computation will\n   * only be executed once the promise completes.\n   *\n   * Returns a promise that will complete when the provided computation has been called and completed.\n   */\n  process<T>(f: () => Promise<T>): Promise<T> {\n    const callback = () => f(); // hide previous computation from f(x)\n    this.stack = this.stack.then(callback, error => {\n      console.log(error);\n      return callback(); // process next\n    });\n    return Promise.resolve(this.stack); // defensive copy of promise\n  }\n}\n\nexport const singleton = new PromiseActor();","module.exports = require(\"fs\");","import * as fs from 'fs';\nimport * as path from 'path';\n\nexport default class FileUtils {\n  /**\n   * Runs a current dir\n   * @returns {string}\n   */\n  static getDir(): string {\n    return path.dirname(__filename);\n  }\n\n  /**\n   * Runs all files under a dir\n   * @param dirPath\n   * @returns {string}\n   */\n  static getAllFiles(dirPath): any {\n    if (dirPath === null) return;\n    return new Promise((resolve, reject) => {\n      fs.readdir(dirPath, (err, files) => {\n        if (err) {\n          reject(err);\n        }\n        let obj = [];\n        files.forEach(file => {\n          obj.push(file);\n        });\n        resolve(obj);\n        return obj;\n      });\n    });\n  }\n\n  /**\n   * Checks if a file exists\n   * @param fileName\n   * @returns {boolean}\n   */\n  static checkFileExists(fileName): boolean {\n    return fs.existsSync(fileName);\n  }\n\n  /**\n   * create file if doesn't exist\n   * @param fileName\n   * @returns {any}\n   */\n\n  // create file if doesn't exist\n  static createFile(fileName) {\n    return new Promise((resolve, reject) => {\n      fs.open(fileName, 'r', (err, fd) => {\n        if (err) {\n          fs.writeFile(fileName, '', err => {\n            if (err) {\n              reject(err);\n            }\n            let msg = 'The file was created!';\n            resolve(msg);\n          });\n        } else {\n          let msg = 'The file exists!';\n          resolve(msg);\n        }\n      });\n    });\n  }\n\n  /**\n   * create directory if doesn't exist\n   * @param directoryPath\n   * @returns {string}\n   */\n  static createDirectory(directoryPath) {\n    const directory = path.normalize(directoryPath);\n\n    return new Promise((resolve, reject) => {\n      fs.stat(directory, error => {\n        if (error) {\n          if (error.code === 'ENOENT') {\n            fs.mkdir(directory, error => {\n              if (error) {\n                reject(error);\n              } else {\n                resolve(directory);\n              }\n            });\n          } else {\n            reject(error);\n          }\n        } else {\n          resolve(directory);\n        }\n      });\n    });\n  }\n\n  /**\n   * create folder if doesn't exist\n   * @param dirPath\n   * @returns {any}\n   */\n  static ensureDirSync(dirPath) {\n    try {\n      return fs.mkdirSync(dirPath);\n    } catch (err) {\n      if (err.code !== 'EEXIST') throw err;\n    }\n  }\n\n  /**\n   * Read content from the filePath\n   * @param filePath {string}\n   */\n  static readFile(filePath: string): Promise<any> {\n    return new Promise((resolve, reject) => {\n      fs.readFile(filePath, (err, buff) => {\n        if (err) {\n          reject(err);\n        }\n        resolve(buff);\n      });\n    });\n  }\n\n  static async checkForOldDirectory(filePath): Promise<boolean> {\n    try {\n      const fileContent = await FileUtils.readFile(filePath);\n      if (fileContent) Boolean(fileContent.toString());\n      else return false;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  /**\n   * read text and return json out\n   * @param fileName\n   * @returns {any}\n   */\n\n  static async readFileReturnJson(fileName: string) {\n    //if (!this.checkFileExists(fileName)) return;\n    return new Promise((resolve, reject) => {\n      fs.readFile(fileName, (err, data) => {\n        let obj = [];\n        if (err) {\n          reject(err);\n        }\n        data\n          .toString()\n          .split('\\n')\n          .forEach(function(line, index, arr) {\n            if (line.length === 0) {\n              return;\n            }\n            obj.push(line);\n          });\n        let objStringify = JSON.stringify(obj);\n        let json = JSON.parse(objStringify);\n        resolve(json);\n      });\n    });\n  }\n\n  /**\n   * append File\n   * @param fileName\n   * @param input\n   * @returns {any}\n   */\n  static async appendFile(fileName: string, input: string) {\n    //if (!this.checkFileExists(fileName)) return;\n    return new Promise((resolve, reject) => {\n      let msg = 'The file ' + fileName + ' was saved!';\n      let errorMsg = 'Cant read file. File name is not defined';\n      fs.appendFile(fileName, input, err => {\n        if (err) {\n          reject(err);\n        }\n        resolve(msg);\n      });\n    });\n  }\n\n  /**\n   * writeFile\n   * @param fileName\n   * @param input\n   * @returns {any}\n   */\n  static async writeFile(fileName: string, input: string) {\n    //if (!this.checkFileExists(fileName)) return false;\n    return new Promise((resolve, reject) => {\n      let msg = 'The file ' + fileName + ' was saved!';\n      let errorMsg = 'Cant read file. File name is not defined';\n      fs.writeFile(fileName, input, err => {\n        if (err) {\n          reject(err);\n        }\n        resolve(msg);\n      });\n    });\n  }\n}\n","import config from '../../../../config';\nconst edgeApi = config.edge28;\nexport const SEND_PAYLOAD_TO_CHILD = 'SEND_PAYLOAD_TO_CHILD';\nexport const ADD_POINT = 'ADD_POINT';\nexport const REMOVE_POINT = 'REMOVE_POINT';\n\nexport const edgeIp: string = edgeApi.baseURL;\nexport const edgePort: number = edgeApi.port;\nexport const edgeApiVer: string = edgeApi.apiVer;\n","import { ConnectionOutput } from '../../nodes/nodes/protocols/connection-node-mixin';\nimport { convertToNumber, isNotNull, isNull, range } from '../../utils/helper';\nimport { EventData } from '../../utils/pattern';\n\nexport interface Model {\n}\n\nexport interface HasIdentifier extends Model {\n  /**\n   * Gets model identifier\n   * @returns {string} identifier\n   */\n  identifier(): string;\n}\n\nexport interface PointValue {\n  presentValue: any;\n  priority: number;\n  priorityArray: { [k: number]: any };\n\n  /**\n   * Check point value is reset state\n   * @return {boolean} true if this instance has `present value` and `priority` are `null` at same time\n   */\n  isResetState(): boolean;\n\n  /**\n   * Compare this instance with another point value to identify a change\n   * @param {PointValue} prev another point value\n   * @return {PointValue} change of value. It might `null` if no change.\n   */\n  changedOfValue(prev: PointValue): PointValue;\n\n  /**\n   * Merge this instance from another point value within highest priority computation\n   * @param {PointValue} prev another point value\n   * @return {PointValue} new non-null point value\n   */\n  merge(prev: PointValue): PointValue;\n}\n\n/**\n * Define point model as input\n */\nexport interface PointModel extends HasIdentifier {\n\n  enabled: boolean;\n\n  pointValue: PointValue;\n\n  /**\n   * Compare another Point to detect might change only value\n   * @param point Another Point\n   */\n  mightOnlyValueChanged(point: PointModel): boolean;\n\n  /**\n   * Check another Point is same identifier or not\n   */\n  equals(point: PointModel): boolean;\n\n}\n\nexport interface PointOutput<T extends PointModel> extends Model, EventData {\n\n  connStatus: ConnectionOutput;\n  point: T;\n\n}\n\nexport class PointValueCreator {\n  private constructor() {\n  }\n\n  /**\n   * Init Point Value without auto correct highest value based on given inputs\n   * @param {number} presentValue Point present value\n   * @param {number} priority Point priority\n   * @param {object | []} priorityArray priority array in JSON or array\n   * @returns {PointValue}\n   */\n  static init = (presentValue: any, priority?: number, priorityArray?: { [k: number]: any } | []): PointValue => {\n    if (priority && (priority < 1 || priority > 16)) {\n      throw new Error('Priority must be in range [1, 16]');\n    }\n    let pv = new DefaultPointValue();\n    pv.presentValue = presentValue ?? null;\n    pv.priority = priority === undefined ? 16 : priority;\n    pv.priorityArray = PointValueCreator.normalizePriorityArray(priorityArray);\n    return pv;\n  };\n\n  /**\n   * Init Point Value without auto correct highest value based on priority array\n   * @param priorityArray priority array object or array with 16 item\n   * @return {PointValue}\n   */\n  static by = (priorityArray?: { [k: number]: any } | []): PointValue => {\n    let pa = PointValueCreator.normalizePriorityArray(priorityArray);\n    let highestValue = Object.entries(pa).find(pa => pa[1]) ?? [16, null];\n    return PointValueCreator.init(convertToNumber(highestValue[1]), convertToNumber(highestValue[0]), pa);\n  };\n\n  /**\n   * Create PointValue based on given inputs then auto correct `highest value`\n   * @param {any} presentValue\n   * @param {number} priority\n   * @param {object | []} priorityArray priority array in JSON or array\n   * @returns {PointValue}\n   */\n  static create = (presentValue: any, priority?: number,\n                   priorityArray?: { [k: number]: any } | []): PointValue => {\n    let pv = PointValueCreator.init(presentValue, priority, priorityArray);\n    if (pv.isResetState()) {\n      return pv;\n    }\n    let highestValue = Object.entries(pv.priorityArray).find(pa => pa[1]) ?? [16, null];\n    pv.priorityArray[pv.priority] = pv.presentValue;\n    if (highestValue && convertToNumber(highestValue[0]) === pv.priority && pv.presentValue === null) {\n      highestValue = Object.entries(pv.priorityArray).find(([_, v]) => isNotNull(v));\n    }\n    if (highestValue && (pv.priority > convertToNumber(highestValue[0]) || pv.presentValue === null)) {\n      pv.priority = convertToNumber(highestValue[0]);\n      pv.presentValue = highestValue[1];\n    }\n    return pv;\n  };\n\n  private static createPriorityArray = () => {\n    return Array.from(range(1, 16)).reduce((o, k) => ((o[k] = null), o), {});\n  };\n\n  private static normalizePriorityArray = (priorityArray: { [p: number]: any } | []): { [k: number]: any } => {\n    if (!priorityArray) {\n      return PointValueCreator.createPriorityArray();\n    }\n    if (priorityArray instanceof Array) {\n      let len = (priorityArray as Array<any>).length;\n      if (len === 0) {\n        return PointValueCreator.createPriorityArray();\n      }\n      if (len !== 16) {\n        throw new Error('Invalid priority array');\n      }\n      return priorityArray.reduce((o, k, i) => ((o[i + 1] = convertToNumber(k)), o), {});\n    }\n    if (typeof priorityArray !== 'object') {\n      throw new Error('Invalid priority array');\n    }\n    let pa = PointValueCreator.createPriorityArray();\n    for (let key in pa) {\n      if (priorityArray.hasOwnProperty(key)) {\n        pa[key] = convertToNumber(priorityArray[key]);\n      }\n    }\n    return pa;\n  };\n}\n\nclass DefaultPointValue implements PointValue {\n  presentValue: any;\n  priority: number;\n  priorityArray: { [p: number]: any };\n\n  isResetState(): boolean {\n    return isNull(this.presentValue) && isNull(this.priority);\n  }\n\n  changedOfValue(prev: PointValue): PointValue {\n    if (!prev) {\n      return this;\n    }\n    if (this.presentValue !== prev.presentValue || this.priority !== prev.priority) {\n      return this;\n    }\n    let pv = new DefaultPointValue();\n    for (const priority in this.priorityArray) {\n      if (this.priorityArray[priority] !== prev.priorityArray[priority]) {\n        pv.priority = convertToNumber(priority);\n        pv.presentValue = this.priorityArray[priority];\n        pv.priorityArray = this.priorityArray;\n        return pv;\n      }\n    }\n    return null;\n  }\n\n  merge(prev: PointValue): PointValue {\n    if (!prev || !prev.priorityArray) {\n      return PointValueCreator.create(this.presentValue, this.priority, this.priorityArray);\n    }\n    if (this.isResetState()) {\n      return PointValueCreator.create(null, 16);\n    }\n    let arr = {};\n    for (const priority in this.priorityArray) {\n      arr[priority] = isNull(this.priorityArray[priority]) && isNotNull(prev.priorityArray[priority])\n                      ? prev.priorityArray[priority] : this.priorityArray[priority];\n    }\n    return PointValueCreator.create(this.presentValue, this.priority, arr);\n  }\n}\n","import { isEqual, merge } from 'lodash';\nimport { Entry } from '../../../../backend/entry';\nimport { singleton as actor } from '../../../../promise-actor';\nimport { Container, Side } from '../../../container';\nimport { Node, NodeSettings, SettingType } from '../../../node';\nimport EntryNode from './entry-node';\n\nexport default abstract class Mixin<T extends Entry> extends Node implements EntryNode<T> {\n  properties: {\n    entry: T;\n    is_protected: boolean;\n  };\n  settingFields: {};\n\n  abstract namePrefix(): string;\n\n  abstract updateEntry(body: T): Promise<any>;\n\n  abstract deleteEntry(): Promise<any>;\n\n  abstract createEntry(): Promise<T>;\n\n  abstract syncWithBackend(): void;\n\n  abstract entryFactory(): T;\n\n  entry() {\n    return this.properties.entry;\n  }\n\n  entryId() {\n    return this.entry() && this.entry().entryId();\n  }\n\n  applyEntry(entry: T) {\n    this.properties.entry = Object.assign(this.entryFactory(), entry); // ensures correct inheritance\n    this.title = this.namePrefix() + ' ' + this.properties.entry.label();\n    this.size = this.computeSize();\n    if (this.settings['name']) {\n      this.settings['name'].value = this.entryId();\n    }\n    merge(this.settings, this.createSettingForm(entry));\n    this.broadcastSettingsToClients();\n    this.broadcastTitleToClients();\n  }\n\n  createSettingForm(entry: T): { [name: string]: NodeSettings } {\n    return Object.keys(this.settingFields)\n                 .map(key => ({\n                   [key]: {\n                     description: key,\n                     value      : entry ? entry[key] : null,\n                     type       : this.settingFields[key],\n                   },\n                 }))\n                 .reduce(merge);\n  }\n\n  deactivate() {\n    this.properties.entry = null;\n  }\n\n  onCreated() {\n    if (this.entry()) {\n      this.applyEntry(this.entry());\n    } else {\n      if (this.side !== Side.server) return;\n      actor.process(() =>\n                      this.createEntry()\n                          .then(entry => this.applyEntry(entry))\n                          .catch(e => {\n                            this.displayError(e, 'Entry not created.');\n                            console.log(e);\n                            // self-destruct\n                            this.deactivate();\n                            this.container.removeBroadcasted(this);\n                          }),\n      );\n    }\n  }\n\n  onAdded() {\n    if (this.entry()) {\n      this.applyEntry(this.entry());\n    }\n  }\n\n  onAfterSettingsChange() {\n    if (this.side !== Side.server) return;\n    const update: T = <any>{};\n    const current: T = <any>{};\n    Object.keys(this.settingFields)\n          .filter(key => this.settingFields[key] !== SettingType.READONLY)\n          .forEach(key => {\n            update[key] = this.settings[key].value;\n            current[key] = this.entry() && this.entry()[key];\n          });\n    // update remotely if there are any changes\n    if (!isEqual(current, update)) {\n      actor.process(() =>\n                      this.updateEntry(update).catch(e => this.displayError(e, 'Unable to update entry remotely.')),\n      );\n    }\n  }\n\n  onRemoved() {\n    if (this.side !== Side.server || !this.entry()) return Promise.resolve();\n    return actor.process(() =>\n                           this.deleteEntry().catch(e => {\n                             this.displayError(e, 'Failed to remove entry from backend.');\n                             console.log(e);\n                           }),\n    );\n  }\n\n  findFreeIdentifier(): Promise<string> {\n    return this.getTakenIdentifiers().then(takenIdentifiers => {\n      for (let i = 1; ; i += 1) {\n        const identifier = this.makeIdentifier(i);\n        if (!takenIdentifiers.includes(identifier)) return identifier;\n      }\n    });\n  }\n\n  getTakenIdentifiers(): Promise<string[]> {\n    const globalSiblings = <EntryNode<T>[]>Container.rootContainer().getNodesByClass(this.constructor, true);\n    return Promise.resolve(globalSiblings.filter(n => n.entry()).map(v => v.entry().identifier()));\n  }\n\n  makeIdentifier(n: number): string {\n    return `WIRES_${this.namePrefix().toUpperCase()}_${n}`;\n  }\n}\n","import * as moment from 'moment-timezone';\n\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport TimeUtils, { TIME_TYPE } from '../../utils/time-utils';\nimport SettingUtils from '../../utils/setting-utils';\nimport CryptoUtils from '../../utils/crypto-utils';\nimport axios from 'axios';\nimport { Side } from '../../container';\nimport SystemUtils from '../system/system-utils';\nimport { IPoint } from 'influx';\nimport config from '../../../config';\n\nconst Influx = require('influx');\n\nenum HistoryMode {\n  COV = 0,\n  PERIODIC = 1,\n  TRIGGER_ONLY = 2,\n}\n\nenum DataBaseType {\n  POSTGRES = 0,\n  InfluxDB = 1,\n}\n\nexport default class HistoryBase extends Node {\n  // dynamically calculate position when starting\n  histTriggerInput: number;\n  clearStoredHisInput: number;\n  tableNameInput: number;\n  pointNameInput: number;\n  histErrorOutput: number;\n  storedHistCountOutput: number;\n  lastHistExportOutput: number;\n  // configurable parameters from each extended node for extracting values to store on DB\n  valueInput: number;\n  takeValueFromInput: boolean;\n  // extra parameter for nodes\n  interval: number = -1;\n  timeoutFunc: any;\n  dynamicInputStartPosition: number = 2;\n  alarmCount: number = 0;\n  tagCount: number = 0;\n  lastTrigger: boolean = false;\n\n  addHistoryConfiguration() {\n    this.addInput('histTrigger', Type.BOOLEAN);\n    this.addInput('clearStoredHis', Type.BOOLEAN);\n    this.addOutput('histError', Type.ANY);\n    this.addOutput('storedHistCount', Type.NUMBER);\n    this.addOutput('lastHistExport', Type.STRING);\n\n    /**\n     * History settings\n     */\n    this.settings['history_group'] = {\n      description: 'History Settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['databaseType'] = {\n      description: 'Database Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: DataBaseType.POSTGRES, text: 'Postgres' },\n          { value: DataBaseType.InfluxDB, text: 'InfluxDB' },\n        ],\n      },\n      value: DataBaseType.POSTGRES,\n    };\n    this.settings['enable'] = {\n      description: 'History Enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n\n    // THESE SETTINGS FOR INFLUX HISTORY STORAGE -----------------\n    this.settings['tableName'] = {\n      description: 'Measurement Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n    // END OF INFLUX SPECIFIC SETTINGS ---------------------------\n\n    this.addInputWithSettings('pointName', Type.STRING, '', 'Point Name');\n    this.settings['historyMode'] = {\n      description: 'History Logging Mode',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: HistoryMode.COV, text: 'Change Of Value (COV)' },\n          { value: HistoryMode.PERIODIC, text: 'Periodic' },\n          { value: HistoryMode.TRIGGER_ONLY, text: 'Trigger Only' },\n        ],\n      },\n      value: HistoryMode.COV,\n    };\n    this.settings['dataType'] = {\n      description: 'Data type for storing',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: Type.NUMBER, text: 'Number' },\n          { value: Type.BOOLEAN, text: 'Boolean' },\n          { value: Type.STRING, text: 'String' },\n        ],\n      },\n      value: Type.NUMBER,\n    };\n    this.settings['threshold'] = {\n      description: 'COV Threshold',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.settings['period'] = {\n      description: 'Logging Interval',\n      value: 15,\n      type: SettingType.NUMBER,\n    };\n    this.settings['periodUnits'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: TIME_TYPE.MILLISECONDS, text: 'Milliseconds' },\n          { value: TIME_TYPE.SECONDS, text: 'Seconds' },\n          { value: TIME_TYPE.MINUTES, text: 'Minutes' },\n          { value: TIME_TYPE.HOURS, text: 'Hours' },\n        ],\n      },\n      value: TIME_TYPE.MINUTES,\n    };\n    this.settings['storage-limit'] = {\n      description: 'Local Storage Limit (Max 50)',\n      value: 25,\n      type: SettingType.NUMBER,\n    };\n    this.settings['minuteRoundValue'] = {\n      description: 'Round minutes up in increments of',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.settings['decimals'] = {\n      description: 'Decimal Places (Limit 5)',\n      value: 3,\n      type: SettingType.NUMBER,\n    };\n    this.settings['timeAsString'] = {\n      description: 'Display Timestamp as',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: false, text: 'Numeric' },\n          { value: true, text: 'String' },\n        ],\n      },\n      value: true,\n    };\n\n    /**\n     * Alarm settings\n     */\n    this.settings['alarm_group'] = {\n      description: 'Alarm Settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['alarms_count'] = {\n      description: 'Alarms Count (Max 10)',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n\n    /**\n     * Tag settings\n     */\n    this.settings['tags_group'] = {\n      description: 'Tag Settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['tags_count'] = {\n      description: 'Tag Count (Max 10)',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.properties['obj'] = [];\n  }\n\n  setup() {\n    this.addHistoryConfiguration();\n  }\n\n  init(properties) {\n    this.historyFunctionsForAfterSettingsChange(properties['settings'], false);\n    this.lastTrigger = false;\n  }\n\n  /**\n   * When databaseType is selected as POSTGRES it needs to have an extra input tableName\n   * @param settings {object} settings configuration\n   */\n  private changeInputDynamically(settings) {\n    this.assignInputsOutputs();\n    if (this.tableNameInput === -1 && settings['databaseType'].value === DataBaseType.InfluxDB) {\n      if (this.pointNameInput) this.removeInput(this.pointNameInput);\n      this.addInput('[tableName]', Type.STRING, { exist: true, nullable: false, hidden: false });\n      this.addInput('[pointName]', Type.STRING, { exist: true, nullable: false, hidden: false });\n    } else if (this.tableNameInput !== -1 && settings['databaseType'].value === DataBaseType.POSTGRES) {\n      if (this.pointNameInput) this.removeInput(this.pointNameInput);\n      this.removeInput(this.tableNameInput);\n      this.addInput('[pointName]', Type.STRING, { exist: true, nullable: false, hidden: false });\n    }\n  }\n\n  onAdded() {\n    this.assignInputsOutputs();\n    this.resetOutputs();\n    this.doPeriodicHistoryFunctions();\n  }\n\n  async onInputUpdated() {\n    if (this.getInputData(this.clearStoredHisInput)) {\n      this.properties['obj'] = [];\n      this.updateHistoryCountOutput();\n    }\n    await this.doNonPeriodicHistoryFunctions();\n  }\n\n  async onAfterSettingsChange() {\n    this.historyFunctionsForAfterSettingsChange();\n    await this.doNonPeriodicHistoryFunctions();\n    this.doPeriodicHistoryFunctions();\n  }\n\n  onRemoved() {\n    clearInterval(this.timeoutFunc);\n  }\n\n  assignInputsOutputs() {\n    this.tableNameInput = -1;\n    this.pointNameInput = -1;\n    for (let input in this.inputs) {\n      if (this.inputs.hasOwnProperty(input)) {\n        if (this.inputs[input].name == 'histTrigger') this.histTriggerInput = Number(input);\n        if (this.inputs[input].name == 'clearStoredHis') this.clearStoredHisInput = Number(input);\n        if (this.inputs[input].name == '[tableName]') this.tableNameInput = Number(input);\n        if (this.inputs[input].name == '[pointName]') this.pointNameInput = Number(input);\n      }\n    }\n\n    for (let output in this.outputs) {\n      if (this.outputs.hasOwnProperty(output)) {\n        if (this.outputs[output].name == 'histError') this.histErrorOutput = Number(output);\n        else if (this.outputs[output].name == 'storedHistCount') this.storedHistCountOutput = Number(output);\n        else if (this.outputs[output].name == 'lastHistExport') this.lastHistExportOutput = Number(output);\n      }\n    }\n  }\n\n  addHistorySettingsConfig(valueInput: number = 0, takeValueFromInput: boolean = true) {\n    if (!this.settingConfigs.hasOwnProperty('groups') || !this.settingConfigs.hasOwnProperty('conditions')) {\n      this.setSettingsConfig({\n        groups: this.settingConfigs['groups'] || [],\n        conditions: this.settingConfigs['conditions'] || {},\n      });\n    }\n    this.settingConfigs.groups.push({ period: { weight: 2 }, periodUnits: {} });\n    this.settingConfigs.conditions['tableName'] = setting => {\n      return setting['databaseType'].value === DataBaseType.InfluxDB;\n    };\n    this.settingConfigs.conditions['threshold'] = setting => {\n      return setting['historyMode'].value === HistoryMode.COV;\n    };\n    this.settingConfigs.conditions['period'] = setting => {\n      return setting['historyMode'].value === HistoryMode.PERIODIC;\n    };\n    this.settingConfigs.conditions['periodUnits'] = setting => {\n      return setting['historyMode'].value === HistoryMode.PERIODIC;\n    };\n    this.settingConfigs.conditions['alarms_count'] = setting => {\n      return setting['databaseType'].value === DataBaseType.InfluxDB;\n    };\n    this.settingConfigs.conditions['tags_count'] = setting => {\n      return setting['databaseType'].value === DataBaseType.InfluxDB;\n    };\n\n    this.valueInput = valueInput;\n    this.takeValueFromInput = takeValueFromInput;\n  }\n\n  resetOutputs() {\n    this.updateHistoryCountOutput();\n  }\n\n  async doNonPeriodicHistoryFunctions() {\n    if (this.side !== Side.server) return;\n    if (!this.settings['enable'].value) return;\n    let input = null;\n    if (this.takeValueFromInput) {\n      input = this.getInputData(this.valueInput);\n    } else {\n      input = this.outputs[this.valueInput].data;\n    }\n\n    if (this.checkTriggered()) {\n      await this.storeLogEntry(input);\n    } else if (this.checkCOV(input)) {\n      await this.storeLogEntry(input);\n    }\n\n    if (this.properties['obj'].length > 0) await this.trySendStoredData();\n  }\n\n  async trySendStoredData() {\n    let decimals = this.settings['decimals'].value;\n    decimals = Utils.clamp(decimals, 0, 5);\n\n    const points: IPoint[] = [];\n    this.properties['obj'].forEach(log => {\n      const dataType = this.settings['dataType'].value;\n      log.payload = this.convertInput(log.payload, dataType, decimals);\n\n      const tagList = {};\n      tagList['point'] = this.getInputData(this.pointNameInput) || 'undefined';\n      Object.keys(log).map(key => {\n        if (key !== 'payload' && key !== 'timestamp' && key !== 'tags') {\n          tagList[key] = log[key];\n        }\n      });\n      for (let i = 0; i < 10; i++) {\n        tagList['tag' + (i + 1)] = log['tags'][i] || null;\n      }\n      points.push({\n        measurement: this.getInputData(this.tableNameInput),\n        fields: { val: log.payload },\n        timestamp: moment(log.timestamp).valueOf() * 1000000, // it only supports unix nano seconds dates\n        tags: tagList,\n      });\n    });\n\n    //////////////////////////////////////////////////////////////////////////\n    // This section should be replaced with the history storage mode of choice.\n    let errorFlag = false;\n    if (this.settings['databaseType'].value === DataBaseType.POSTGRES) {\n      // For Multiple points in 1 push\n      let clientIdFromPlat;\n      let deviceIdFromPlat;\n      try {\n        clientIdFromPlat = await SystemUtils.getClientID(this);\n      } catch (e) {\n        clientIdFromPlat = 'unknownClientID';\n      }\n      try {\n        deviceIdFromPlat = await SystemUtils.getDeviceID(this);\n      } catch (e) {\n        deviceIdFromPlat = 'unknownDeviceID';\n      }\n      const multiPointPost = points.map(point => ({\n        deviceid: deviceIdFromPlat,\n        clientid: clientIdFromPlat,\n        val: point.fields.val,\n        point: point.tags.point,\n        ts: moment(Number(point.timestamp) / 1000000).toISOString(), // we can do better than this\n      }));\n\n      const that = this;\n      const pgUrl = config.pg.baseURL;\n      try {\n        await axios({\n          method: 'post',\n          url: pgUrl,\n          data: multiPointPost,\n        });\n      } catch (error) {\n        this.setOutputData(that.histErrorOutput, String(error));\n        errorFlag = true;\n      }\n    } else if (DataBaseType.InfluxDB === DataBaseType.InfluxDB) {\n      const writeOptions = {};\n\n      const { protocol, host, port, databaseName, username, password } = config.influxDb;\n      const client = new Influx.InfluxDB({\n        host,\n        port,\n        protocol: protocol === 'https' ? 'https' : 'http',\n        database: databaseName,\n        username,\n        password,\n      });\n      try {\n        await client.writePoints(points, writeOptions);\n      } catch (err) {\n        this.setOutputData(this.histErrorOutput, String(err));\n        this.debugErr(err);\n        errorFlag = true;\n      }\n    }\n    /////////////////////////////////////////////////////////////\n\n    if (!errorFlag) {\n      this.properties['obj'] = [];\n      this.setOutputData(this.histErrorOutput, '');\n      this.settings['timeAsString'].value\n        ? this.setOutputData(this.lastHistExportOutput, moment().format(), true)\n        : this.setOutputData(this.lastHistExportOutput, moment().valueOf(), true);\n      this.updateHistoryCountOutput();\n    }\n  }\n\n  /**\n   * After settings changes this method needs to call\n   * @param configSettings {object}, if we want to set different settings name in input\n   * @param save {boolean}, need to persist the changes or not; when save = false, it needs to save later\n   */\n  historyFunctionsForAfterSettingsChange(configSettings = null, save: boolean = true) {\n    this.changeInputDynamically(configSettings || this.settings);\n    this.assignInputsOutputs();\n    if (this.settings['databaseType'].value === DataBaseType.POSTGRES) {\n      this.settings['alarms_count'].value = 0;\n      this.settings['tags_count'].value = 0;\n    }\n    this.dynamicInputStartPosition = this.pointNameInput + 1;\n    this.changeAlarmsCount(this.settings['alarms_count'].value);\n    this.renameAlarmInputs(configSettings);\n    this.changeTagsCount(this.settings['tags_count'].value);\n    if (save) {\n      this.persistProperties(true, false, true, false);\n    }\n  }\n\n  async storeLogEntry(input) {\n    if (input == null) return;\n    // cap the amount of data that can be stored\n    const storageLimit = Utils.clamp(this.settings['storage-limit'].value, 0, 50);\n    const minuteRound = Utils.clamp(this.settings['minuteRoundValue'].value, 0, 60);\n    const now = minuteRound ? TimeUtils.nearestFutureMinutes(minuteRound, moment()) : moment();\n    // object data\n    const msg = {\n      payload: input,\n      timestamp: now.toISOString(),\n    };\n    // add alarm values\n    for (let i = this.dynamicInputStartPosition; i < this.dynamicInputStartPosition + this.alarmCount; i++) {\n      let alarmNum = i - this.dynamicInputStartPosition + 1;\n      let alarmName = this.settings['alarm' + alarmNum].value || 'alarm' + alarmNum;\n      msg[alarmName] = this.getInputData(i) || 'null';\n    }\n    // add tags\n    const tags = [];\n    let j = 1;\n    while (j <= this.tagCount) {\n      if (this.settings['tag' + j].value) tags.push(this.settings['tag' + j].value);\n      j++;\n    }\n    msg['tags'] = tags;\n\n    // build an object\n    this.properties['obj'].push(msg);\n    while (this.properties['obj'].length > storageLimit) {\n      this.properties['obj'].shift();\n    }\n    this.properties['lastHistoryValue'] = input;\n    this.persistProperties(false, true, false, false);\n    this.updateHistoryCountOutput();\n  }\n\n  checkTriggered() {\n    const trigger = this.getInputData(this.histTriggerInput) || false;\n    const result = this.inputs[this.histTriggerInput].updated && trigger && !this.lastTrigger;\n    this.lastTrigger = trigger;\n    return result;\n  }\n\n  checkCOV(input) {\n    if (this.settings['historyMode'].value === HistoryMode.COV) {\n      const threshold = this.settings['threshold'].value;\n      if (!isNaN(input) && !isNaN(this.properties['lastHistoryValue'])) {\n        return Math.abs(Number(input) - Number(this.properties['lastHistoryValue'])) >= threshold;\n      } else {\n        return input !== this.properties['lastHistoryValue'];\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Sets values in periodic period when HistoryMode is `PERIODIC`\n   */\n  doPeriodicHistoryFunctions() {\n    if (this.side !== Side.server) return;\n    const enable = this.settings['enable'].value;\n    const isPeriodic = this.settings['historyMode'].value === HistoryMode.PERIODIC;\n    if (!enable || !isPeriodic) {\n      if (this.timeoutFunc) {\n        this.interval = -1;\n        clearInterval(this.timeoutFunc);\n        this.debugInfo('Clearing Periodic interval data insertion...');\n      }\n    }\n    if (enable && isPeriodic) {\n      const interval = TimeUtils.timeConvert(this.settings['period'].value, this.settings['periodUnits'].value);\n      if (this.interval !== interval) {\n        clearInterval(this.timeoutFunc);\n        this.timeoutFunc = setInterval(async () => {\n          let input = null;\n          if (this.takeValueFromInput) input = this.getInputData(this.valueInput);\n          else input = this.outputs[this.valueInput].data;\n          await this.storeLogEntry(input);\n          if (this.properties['obj'].length > 0) await this.trySendStoredData();\n        }, interval);\n        this.interval = interval;\n        this.debugInfo(`Setting Periodic Period of: ${interval} ms`);\n      }\n    }\n  }\n\n  changeAlarmsCount(targetCount) {\n    targetCount = Utils.clamp(targetCount, 0, 10);\n    this.settings['alarms_count'].value = targetCount;\n    let diff = targetCount - this.alarmCount;\n    if (diff == 0) return;\n\n    // add inputs\n    this.changeInputsCount(targetCount + this.dynamicInputStartPosition, Type.STRING);\n\n    // change settings for topics\n    const alarmsToAdd = {};\n    if (diff > 0) {\n      for (let i = this.alarmCount + 1; i <= targetCount; i++) {\n        alarmsToAdd['alarm' + i] = {\n          description: 'Alarm ' + i,\n          value: '',\n          type: SettingType.STRING,\n        };\n      }\n      // for making things consistent on UI settings side\n      this.settings = SettingUtils.insertIntoObjectAtPosition(\n        this.settings,\n        alarmsToAdd,\n        this.alarmCount == 0 ? 'alarms_count' : 'alarm' + this.alarmCount,\n      );\n    } else if (diff < 0) {\n      for (let i = this.alarmCount; i > targetCount; i--) {\n        delete this.settings['alarm' + i];\n      }\n    }\n    this.alarmCount = targetCount;\n  }\n\n  renameAlarmInputs(configSettings) {\n    for (let i = 1; i <= this.alarmCount; i++) {\n      let alarm = this.settings['alarm' + i].value;\n      if (!alarm && configSettings) {\n        alarm = (configSettings['alarm' + i] && configSettings['alarm' + i].value) || '';\n      }\n      if (alarm.length > 20) alarm = '...' + alarm.substr(alarm.length - 20, 20);\n      this.inputs[this.dynamicInputStartPosition + i - 1].name = 'alarm' + i + ' | ' + alarm;\n    }\n  }\n\n  changeTagsCount(targetCount) {\n    targetCount = Utils.clamp(targetCount, 0, 10);\n    this.settings['tags_count'].value = targetCount;\n    let diff = targetCount - this.tagCount;\n    if (diff == 0) return;\n\n    // change settings for topics\n    const tagsToAdd = {};\n    if (diff > 0) {\n      for (let i = this.tagCount + 1; i <= targetCount; i++) {\n        tagsToAdd['tag' + i] = {\n          description: 'Tag ' + i,\n          value: '',\n          type: SettingType.STRING,\n        };\n      }\n      // for making things consistent on UI settings side\n      this.settings = SettingUtils.insertIntoObjectAtPosition(\n        this.settings,\n        tagsToAdd,\n        this.tagCount === 0 ? 'tags_count' : 'tag' + this.tagCount,\n      );\n    } else if (diff < 0) {\n      for (let i = this.tagCount; i > targetCount; i--) {\n        delete this.settings['tag' + i];\n      }\n    }\n    this.tagCount = targetCount;\n  }\n\n  updateHistoryCountOutput() {\n    this.setOutputData(this.storedHistCountOutput, (this.properties['obj'] && this.properties['obj'].length) || 0);\n  }\n}\n","import { ADD_POINT, REMOVE_POINT, SEND_PAYLOAD_TO_CHILD } from './edge-constant';\nimport Utils from '../../../utils';\nimport axios from 'axios';\n\nconst Logger = require('logplease');\nconst logger = Logger.create('edge-utils', { color: Logger.Colors.Grey });\n\nexport default class Edge28Utils {\n  static sendPayloadToChild(childNode, payload) {\n    if (childNode && childNode['subscribe']) {\n      childNode['subscribe'](this.createMessage(SEND_PAYLOAD_TO_CHILD, payload));\n    } else {\n      logger.error('Child Node is not available on sendPayloadToChild');\n    }\n  }\n\n  static addPoint(parentNode, payload) {\n    if (parentNode && parentNode['subscribe']) {\n      parentNode['subscribe'](this.createMessage(ADD_POINT, payload));\n    } else {\n      logger.error('Parent Node is not available on addPoint');\n    }\n  }\n\n  static removePoint(parentNode, payload) {\n    if (parentNode && parentNode['subscribe']) {\n      parentNode['subscribe'](this.createMessage(REMOVE_POINT, payload));\n    } else {\n      logger.error('Parent Node is not available on removePoint');\n    }\n  }\n\n  private static createMessage(action, payload = null) {\n    return { action, payload };\n  }\n\n  static async writePointValue(\n    host: string,\n    port: number,\n    apiVer: string,\n    pointType: string,\n    pointId: string,\n    val: number,\n    priority: number,\n  ): Promise<any> {\n    const url = `${Utils.buildUrl(host, port)}/api/${apiVer}/write/${pointType}/${pointId}/${val}/${priority}`;\n    const pointValue = await axios.get(url);\n    return pointValue.data;\n  }\n}\n","export const GET_BACNET_CLIENT = 'GET_BACNET_CLIENT';\nexport const GET_NETWORK_SETTINGS = 'GET_NETWORK_SETTINGS';\nexport const GET_POINTS = 'GET_POINTS';\nexport const GET_PRESENT_VALUE = 'GET_PRESENT_VALUE';\nexport const SEND_PAYLOAD_TO_CHILD = 'SEND_PAYLOAD_TO_CHILD';\nexport const SEND_POINT_VALUE = 'SEND_POINT_VALUE';\nexport const ADD_POINT = 'ADD_POINT';\nexport const REMOVE_POINT = 'REMOVE_POINT';\nexport const ADD_DEVICE = 'ADD_DEVICE';\nexport const REMOVE_DEVICE = 'REMOVE_DEVICE'; \nexport const WRITE_PRESENT_VALUE = 'WRITE_PRESENT_VALUE'; \n","import { Colors, create } from 'logplease';\nimport { PointModel, PointOutput, PointValue, PointValueCreator } from '../../../../backend/models/point-model';\nimport { ErrorHandler } from '../../../../utils/decorators';\nimport { Constructor, isEmpty, isFunction, range } from '../../../../utils/helper';\nimport { IMessageSubscriber, Observer } from '../../../../utils/pattern';\nimport { Side } from '../../../container';\nimport { Node, NodeSettingConfig, NodeSettings, SettingType } from '../../../node';\nimport { InputSetting, NodeInput, Type } from '../../../node-io';\nimport { NodeInputEvaluation } from '../../node-mixin';\nimport { InputMethod } from './point-node-utils';\n\nconst logger = create('observer', { color: Colors.Yellow });\n\n/**\n * The logical handler manages data point state that can be changed by UI or external system.\n *\n * It is business logic that separated to UI component to easy extendable and testable\n */\nexport interface DataPointFlowHandler<T extends PointModel> extends IMessageSubscriber {\n\n  /**\n   * Init point data by setting object model\n   * @param settings Node Settings\n   * @return point data\n   */\n  initializePointBySettingObject(settings?: { [name: string]: NodeSettings }): T;\n\n  /**\n   * Init point data by each setting input\n   * @param settings Node Settings\n   * @return point data\n   */\n  initializePointBySettingInput(settings?: { [name: string]: NodeSettings }): T;\n\n  /**\n   * Compare previous point and current point then transfer COV to server/client\n   * @param current current point data\n   * @param prev previous point data\n   * @return the updated point with COV\n   */\n  handleOnUpdate(current: T, prev?: T): T;\n\n  /**\n   * Listen a changes from external system\n   * @param incomingMessage point data\n   * @return {any}\n   */\n  onReceiveMessage(incomingMessage: any): void;\n\n  /**\n   * Notify COV to observers\n   * @param point point data\n   * @param observers list of observer that watch an output change\n   */\n  notifyOutput(point: T, observers: Observer<PointOutput<T>>[]): void;\n\n}\n\n/**\n * Defines list observers that watch an output change on point\n */\nexport interface HasPointOutputObservers<T extends PointModel> {\n\n  pointObservers(): Observer<PointOutput<T>>[];\n\n}\n\nexport class MockHasPointOutputObservers<T extends PointModel> implements HasPointOutputObservers<T> {\n  private static readonly MOCK = new MockHasPointOutputObservers();\n\n  static cast(object: any) {\n    if (isEmpty(object)) {\n      return MockHasPointOutputObservers.MOCK;\n    }\n    if (isFunction(object['pointObservers'])) {\n      return object;\n    }\n    return MockHasPointOutputObservers.MOCK;\n  }\n\n  pointObservers(): Observer<PointOutput<T>>[] {\n    return [];\n  }\n\n  private MockHasPointOutputObservers() {\n  }\n}\n\n/**\n * Defines object must apply DataPointFlowHandler\n */\nexport interface HasDataPointFlowHandler<T extends PointModel> {\n\n  flowHandler(): DataPointFlowHandler<T>;\n\n}\n\n/**\n * Defines self observer to update Node Output by point data\n */\nexport class PointOutputObserver<T extends PointModel> implements Observer<PointOutput<T>> {\n\n  node: Node;\n  outputSlots: { output: number, priority: number, priorityArray: number };\n\n  constructor(node: Node, outputSlots: { output: number, priority: number, priorityArray: number }) {\n    this.node = node;\n    this.outputSlots = outputSlots;\n  }\n\n  update(data: PointOutput<T>): void {\n    logger.debug(\n      `Node ${this.node.getReadableId()} receives point: ${data.point.identifier()} - ${data.connStatus.status.label}`);\n    this.node.setOutputData(this.outputSlots.output, data.point?.pointValue?.presentValue);\n    this.node.setOutputData(this.outputSlots.priority, data.point?.pointValue?.priority);\n    this.node.setOutputData(this.outputSlots.priorityArray, data.point?.pointValue?.priorityArray);\n  }\n}\n\nexport abstract class CentralizedPointOutputObserver<T extends PointModel> implements Observer<PointOutput<T>> {\n\n  protected node: Node;\n  protected outputSlot: number;\n\n  constructor(node: Node, outputSlot: number) {\n    this.node = node;\n    this.outputSlot = outputSlot;\n  }\n\n  update(data: PointOutput<T>): void {\n    logger.debug(\n      `Node ${this.node.getReadableId()} receives point: ${data.point.identifier()} - ${data.connStatus.status.label}`);\n    this.node.setOutputData(this.outputSlot,\n                            { ...(this.node.outputs[this.outputSlot]?.data ?? {}), ...this.convert(data) });\n  }\n\n  protected abstract convert(data: PointOutput<T>): object;\n}\n\n/**\n * Define mixin to implement common point data workflow\n * @param {TBase} Base\n * @return {PointNodeMixinBase}\n * @constructor\n */\nexport function PointNodeMixin<TBase extends Constructor<Node>, T extends PointModel>(Base: TBase) {\n  abstract class PointNodeMixinBase extends Base\n    implements NodeInputEvaluation, HasPointOutputObservers<T>, HasDataPointFlowHandler<T> {\n    private readonly _iPresentValue = 'present-value';\n    private readonly _iPriority = 'point-priority';\n    private readonly _iPriorityArrayLot = 'inputPriorityArray';\n    private readonly _iPriorityArrayJson = 'priority-array';\n    private readonly _sInputGroup = 'inputGroup';\n    private readonly _sInputMethod = 'inputMethod';\n    private readonly _sDecimal = 'decimals';\n    private readonly _oOut = 'out';\n    private readonly _oPriority = 'priority';\n    private readonly _oPriorityArray = 'priority-array';\n\n    abstract flowHandler(): DataPointFlowHandler<T>;\n\n    onAdded(): void {\n      if (this.side !== Side.server) {\n        return;\n      }\n      let current = this.flowHandler().initializePointBySettingObject();\n      this.flowHandler().notifyOutput(this.flowHandler().handleOnUpdate(current), this.pointObservers());\n      this.updateTitle();\n    }\n\n    onAfterSettingsChange(oldSettings, oldName?): void {\n      this.handleDynamicInput(oldSettings);\n      if (this.side !== Side.server) {\n        return;\n      }\n      let prev = this.flowHandler().initializePointBySettingObject(oldSettings);\n      let current = this.flowHandler().initializePointBySettingInput();\n      this.flowHandler().notifyOutput(this.flowHandler().handleOnUpdate(current, prev), this.pointObservers());\n      this.updateTitle();\n    }\n\n    onInputUpdated(): void {\n      if (this.side !== Side.server) {\n        return;\n      }\n      let prev = this.flowHandler().initializePointBySettingObject();\n      this.reEvaluateSettingByInput(this.inputs, this.settings);\n      let current = this.flowHandler().initializePointBySettingInput();\n      this.flowHandler().notifyOutput(this.flowHandler().handleOnUpdate(current, prev), this.pointObservers());\n      this.updateTitle();\n    }\n\n    @ErrorHandler\n    reEvaluateSettingByInput(inputs: { [p: number]: NodeInput }, settings: { [p: string]: NodeSettings }): void {\n      if (isFunction(super['reEvaluateSettingByInput'])) {\n        super['reEvaluateSettingByInput'](inputs, settings);\n      }\n      let inputMethod = InputMethod.enumValueOf(this.settings[this._sInputMethod].value);\n      let pv: PointValue;\n      if (inputMethod === InputMethod.VALUE_PRIORITY) {\n        let presentValue = this.inputs[this.valueInputIdx()].updated\n                           ? this.inputs[this.valueInputIdx()].data\n                           : this.settings[this._iPresentValue].value;\n        let priority = this.inputs[this.priorityInputIdx()].updated\n                       ? this.inputs[this.priorityInputIdx()].data\n                       : this.settings[this._iPriority].value;\n        pv = PointValueCreator.init(presentValue, priority);\n        this.settings[this._iPresentValue].value = pv.presentValue;\n        this.settings[this._iPriority].value = pv.priority;\n      }\n      if (inputMethod === InputMethod.PRIORITY_ARRAY_LOT) {\n        let startIdx = this.priorityArrayInputIdx();\n        pv = PointValueCreator.by(Array.from(range(startIdx + 1, startIdx + 16)).map(i => this.inputs[i].data));\n        this.settings[this._iPriorityArrayLot].value = pv.priorityArray;\n      }\n      if (inputMethod === InputMethod.PRIORITY_ARRAY_JSON) {\n        pv = PointValueCreator.by(this.inputs[this.priorityArrayInputIdx()].data);\n        this.settings[this._iPriorityArrayJson].value = pv.priorityArray;\n      }\n    }\n\n    pointObservers(): Observer<PointOutput<T>>[] {\n      return [new PointOutputObserver<T>(this, {\n        output       : this.valueOutputIdx(),\n        priority     : this.priorityOutputIdx(),\n        priorityArray: this.priorityArrayOutputIdx(),\n      })];\n    }\n\n    protected abstract modelSettingKey(): string;\n\n    protected abstract valueInputIdx(): number;\n\n    protected abstract valueOutputIdx(): number;\n\n    protected abstract computeTitle(): string;\n\n    protected priorityInputIdx(): number {\n      return this.valueInputIdx() + 1;\n    }\n\n    protected priorityArrayInputIdx(): number {\n      return this.priorityInputIdx() + 1;\n    }\n\n    protected priorityOutputIdx(): number {\n      return this.valueOutputIdx() + 1;\n    }\n\n    protected priorityArrayOutputIdx(): number {\n      return this.priorityOutputIdx() + 1;\n    }\n\n    protected presentValueType(): Type {\n      return Type.NUMBER;\n    }\n\n    /**\n     * Add required properties in {@link NodeSettings}, {@link NodeInput} and {@link NodeOutput}\n     * @returns Setting configuration\n     */\n    protected mixinPointValueInputOutput(): NodeSettingConfig {\n      this.addOutput(this._oOut, Type.NUMBER);\n      this.addOutput(this._oPriority, Type.NUMBER);\n      this.addOutput(this._oPriorityArray, Type.JSON);\n\n      this.settings[this.modelSettingKey()] = { description: '', value: null };\n      this.settings[this._iPriorityArrayLot] = { description: '', value: null };\n      this.settings[this._sInputGroup] = { description: 'Input Settings', value: '', type: SettingType.GROUP };\n      this.settings[this._sDecimal] = { description: 'Decimal Places (Limit 5)', value: 3, type: SettingType.NUMBER };\n      this.settings[this._sInputMethod] = {\n        description: 'Input Method',\n        type       : SettingType.DROPDOWN,\n        config     : { items: InputMethod.items() },\n        value      : InputMethod.VALUE_PRIORITY.enumKey,\n      };\n      this.addInputWithSettings(this._iPresentValue, this.presentValueType(), null, 'Present Value');\n      this.addInputWithSettings(this._iPriority, Type.NUMBER, 16, 'Point Priority');\n      this.addInputWithSettings(this._iPriorityArrayJson, Type.JSON, null, 'Priority Array in JSON or Array');\n      this.inputs[this.priorityArrayInputIdx()].setting.hidden = true;\n      let cfg = {};\n      for (let value of range(1, 16)) {\n        this.settings[`in${value}`] = { description: `in${value}`, type: SettingType.BOOLEAN, value: false };\n        this.addInput(`[in${value}]`, Type.NUMBER, { exist: false, nullable: true, hidden: true } as InputSetting);\n        cfg[`in${value}`] = () => InputMethod.PRIORITY_ARRAY_LOT.enumKey === this.settings[this._sInputMethod].value;\n      }\n      cfg[this.modelSettingKey()] = () => false;\n      cfg[this._iPresentValue] = () => InputMethod.VALUE_PRIORITY.enumKey === this.settings[this._sInputMethod].value;\n      cfg[this._iPriority] = () => InputMethod.VALUE_PRIORITY.enumKey === this.settings[this._sInputMethod].value;\n      cfg[this._iPriorityArrayLot] = () => false;\n      cfg[this._iPriorityArrayJson] = () => false;\n      return { conditions: cfg };\n    }\n\n    protected updateTitle(): void {\n      this.title = this.computeTitle();\n      this.broadcastSettingsToClients();\n    }\n\n    protected createPointValue(st: { [name: string]: NodeSettings }): PointValue {\n      let inputMethod = InputMethod.enumValueOf(st['inputMethod'].value);\n      let pv: PointValue;\n      let cur: PointValue = this.settings[this.modelSettingKey()]?.value?.pointValue;\n      if (inputMethod === InputMethod.VALUE_PRIORITY) {\n        pv = PointValueCreator.create(st[this._iPresentValue].value, st[this._iPriority].value, cur?.priorityArray);\n      }\n      if (inputMethod === InputMethod.PRIORITY_ARRAY_LOT) {\n        pv = PointValueCreator.by(st[this._iPriorityArrayLot].value);\n      }\n      if (inputMethod === InputMethod.PRIORITY_ARRAY_JSON) {\n        pv = PointValueCreator.by(st[this._iPriorityArrayJson].value);\n      }\n      return pv.merge(cur);\n    }\n\n    private handleDynamicInput(oldSettings: { [name: string]: NodeSettings }) {\n      let oldInputMethod = InputMethod.enumValueOf(oldSettings ? oldSettings[this._sInputMethod]?.value : null);\n      let newInputMethod = InputMethod.enumValueOf(this.settings[this._sInputMethod].value);\n      if (oldInputMethod && oldInputMethod === newInputMethod && newInputMethod !== InputMethod.PRIORITY_ARRAY_LOT) {\n        return;\n      }\n      if (newInputMethod === InputMethod.VALUE_PRIORITY) {\n        this.hideInput(false, ...range(this.priorityArrayInputIdx(), this.priorityArrayInputIdx() + 16));\n        this.showInput(false, this.valueInputIdx(), this.priorityInputIdx());\n      }\n      if (newInputMethod === InputMethod.PRIORITY_ARRAY_LOT) {\n        let hidden = [this.valueInputIdx(), this.priorityInputIdx(), this.priorityArrayInputIdx()];\n        let show = [];\n        for (let idx of range(this.priorityArrayInputIdx() + 1, this.priorityArrayInputIdx() + 16)) {\n          this.settings[`in${idx - this.priorityArrayInputIdx()}`].value ? show.push(idx) : hidden.push(idx);\n        }\n        this.hideInput(false, ...hidden);\n        this.showInput(false, ...show);\n      }\n      if (newInputMethod === InputMethod.PRIORITY_ARRAY_JSON) {\n        this.hideInput(\n          false,\n          this.valueInputIdx(),\n          this.priorityInputIdx(),\n          ...range(this.priorityArrayInputIdx() + 1, this.priorityArrayInputIdx() + 16),\n        );\n        this.showInput(false, this.priorityArrayInputIdx());\n      }\n      this.linkHandler.recomputeInputLinks();\n    }\n  }\n\n  return PointNodeMixinBase;\n}\n","import { isEmpty, isFunction, isNull } from './helper';\n\nexport interface NodeStoreItem {\n  identifier: string;\n  nodeId: string;\n  enabled: boolean;\n  callback?: Function;\n  prev?: NodeStoreItem;\n  data?: any;\n  lenient?: boolean;\n}\n\nexport interface ICentralizedListener {\n\n  listen({ action, payload }: { action: string; payload: NodeStoreItem }): any;\n\n}\n\n/**\n * To guard some error import without parent\n */\nexport class MockCentralizedListener implements ICentralizedListener {\n\n  static readonly LISTENER = new MockCentralizedListener();\n\n  static cast(object: any) {\n    if (isEmpty(object)){\n      return MockCentralizedListener.LISTENER;\n    }\n    if (isFunction(object['listen'])){\n      return object;\n    }\n    return MockCentralizedListener.LISTENER;\n  }\n\n  listen({ action, payload }: { action: string; payload: NodeStoreItem }): any {\n    throw new Error(`Not found handler or parent to process action ${action}`);\n  }\n\n  private MockCentralizedListener() {\n  }\n}\n\nexport interface HasCentralizedListener {\n\n  listener(): ICentralizedListener;\n\n}\n\n/**\n * Represents for observer to listen change from {@link Observable}\n */\nexport interface Observer<D extends EventData> {\n\n  /**\n   * Do update from receive information\n   * @param {EventData} data Event data\n   * @param {string} eventSourceId? event source\n   */\n  update(data: D, eventSourceId?: string): void;\n\n}\n\nexport interface Observable<D extends EventData> {\n\n  /**\n   * Defines list of observer\n   * @return {Observer<D>[]} observers\n   * @see Observer\n   */\n  observers(): Observer<D>[];\n\n  /**\n   * Notify to observers the changed of data\n   * @param {D} data Event data\n   * @param {string} eventSourceId\n   * @see observers\n   */\n  notify(data: D, eventSourceId?: string): void;\n\n}\n\nexport interface EventData {\n\n}\n\nexport class DefaultObservable<D extends EventData> implements Observable<D> {\n\n  list: Observer<D>[];\n\n  constructor(list: Observer<D>[]) {\n    this.list = list;\n  }\n\n  observers(): Observer<D>[] {\n    return this.list;\n  }\n\n  notify(data: D, eventSourceId?: string): void {\n    this.observers()?.forEach(observer => observer.update(data, eventSourceId));\n  }\n}\n\nexport interface IMessageConverter {\n  /**\n   * Convert outcome data before using\n   * @param outcomeData\n   * @returns {string} message in string\n   */\n  onConvertMessage(outcomeData: any): string;\n}\n\nexport interface IMessageSubscriber {\n  /**\n   * Handles incoming message from external resource\n   * @param incomingMessage\n   */\n  onReceiveMessage(incomingMessage: any): void;\n}\n","import { Colors, create } from 'logplease';\nimport { ConnectionStatus } from '../../../utils/enums';\nimport { Constructor, isFunction } from '../../../utils/helper';\nimport { EventData, Observer } from '../../../utils/pattern';\nimport { Node, NodeSettingConfig} from '../../node';\nimport { Type } from '../../node-io';\nimport Registry from '../../registry';\nimport { AbleEnableNode, HasEnabled } from '../node-mixin';\n\nconst logger = create('observer', { color: Colors.Yellow });\n\nexport class ConnectionOutput implements EventData {\n\n  status: ConnectionStatus;\n  error?: string;\n\n  constructor(status: ConnectionStatus, error?: string) {\n    this.status = status;\n    this.error = error;\n  }\n\n}\n\nexport interface ExternalConnectionNode extends HasEnabled {\n\n  isConnConnected(): boolean;\n\n  getConnectionStatus(): ConnectionStatus;\n\n  statusObserver(): Observer<ConnectionOutput>;\n\n}\n\nexport interface DependantConnectionNode extends ExternalConnectionNode {\n\n  parentConnectionNode(): ExternalConnectionNode;\n\n}\n\nexport class ConnectionOutputObserver implements Observer<ConnectionOutput> {\n\n  node: Node;\n  outputSlots: { status: number, error: number };\n\n  constructor(node: Node, outputSlots: { status: number, error: number }) {\n    this.node = node;\n    this.outputSlots = outputSlots;\n  }\n\n  update(data: ConnectionOutput, eventSourceId?: string): void {\n    let current = ConnectionStatus.lookupByLabel(this.node.outputs[this.outputSlots.status].data);\n    let nodeId = Registry.getId(this.node.cid, this.node.id);\n    let itselfConnected = isFunction(this.node['isConnConnected']) ? this.node['isConnConnected']() : true;\n    if (eventSourceId && nodeId !== eventSourceId && (current?.isError() || !itselfConnected)) {\n      return;\n    }\n    logger.debug(`Node ${this.node.getReadableId()} receives connection status '${data.status.label}' ` +\n                 `from source id '${eventSourceId ?? nodeId}'`);\n    this.node.setOutputData(this.outputSlots.status, data.status.label);\n    this.node.setOutputData(this.outputSlots.error, data.error ?? '');\n  }\n\n}\n\nexport function ExternalConnectionNodeMixin<TBase extends Constructor<Node>>(Base: TBase) {\n  abstract class ExternalConnectionNodeMixinBase extends AbleEnableNode(Base) implements ExternalConnectionNode {\n\n    protected connectionStatus: ConnectionStatus = ConnectionStatus.UNCONNECTED;\n\n    statusObserver(): Observer<ConnectionOutput> {\n      return new ConnectionOutputObserver(this, { status: this.statusOutputIdx(), error: this.errorOutputIdx() });\n    }\n\n    getConnectionStatus(): ConnectionStatus {\n      if (!this.isEnabled()) {\n        return (this.connectionStatus = ConnectionStatus.UNCONNECTED);\n      }\n      if (this.connectionStatus?.isError()) {\n        return this.connectionStatus;\n      }\n      this.connectionStatus = this.isConnConnected() ? ConnectionStatus.CONNECTED : ConnectionStatus.DISCONNECTED;\n      return this.connectionStatus;\n    }\n\n    abstract isConnConnected(): boolean;\n\n    protected abstract statusOutputIdx(): number;\n\n    protected errorOutputIdx(): number {\n      return this.statusOutputIdx() + 1;\n    }\n\n    protected mixinConnectionStatusOutput(): NodeSettingConfig {\n      this.addOutput('status', Type.STRING);\n      this.addOutput('error', Type.STRING);\n      this.setOutputData(this.statusOutputIdx(), this.getConnectionStatus().label);\n      return {};\n    }\n\n  }\n\n  return ExternalConnectionNodeMixinBase;\n}\n\nexport function DependantConnectionNodeMixin<TBase extends Constructor<Node>>(Base: TBase) {\n  abstract class DependantConnectionNodeMixinBase extends ExternalConnectionNodeMixin(Base)\n    implements DependantConnectionNode {\n\n    onAdded(): void {\n      this.executeFunction('onAdded');\n    }\n\n    onAfterSettingsChange(oldSettings, oldName?): void {\n      this.executeFunction('onAfterSettingsChange', oldSettings, oldName);\n    }\n\n    onInputUpdated(): void {\n      this.executeFunction('onInputUpdated');\n    }\n\n    parentConnectionNode(): ExternalConnectionNode {\n      let parentNode = this.getParentNode();\n      if (parentNode && isFunction(parentNode['getConnectionStatus'])) {\n        return <ExternalConnectionNode><unknown>parentNode;\n      }\n      return null;\n    }\n\n    isConnConnected(): boolean {\n      let isParentConnected = this.parentConnectionNode()?.getConnectionStatus().isConnected() ?? false;\n      return this.isEnabled() && isParentConnected;\n    }\n\n    protected handleError(err: Error, func: string): void {\n      this.debug(`Error when executing function ${func} in node ${this.getReadableId()} - ${err.stack}`);\n      this.statusObserver().update(new ConnectionOutput(this.getConnectionStatus(), err.message));\n    }\n\n    protected executeFunction(func: string, ...args) {\n      try {\n        if (super[func] && isFunction(super[func])) {\n          super[func](...args);\n        }\n        this.connectionStatus = null;\n        this.statusObserver().update(new ConnectionOutput(this.getConnectionStatus()));\n      } catch (err) {\n        this.connectionStatus = ConnectionStatus.ERROR;\n        this.handleError(err, func);\n      }\n    }\n  }\n\n  return DependantConnectionNodeMixinBase;\n}\n","import { exec } from 'child_process';\nconst os = require('os');\nconst si = require('systeminformation');\nconst pkg = require('../../../package.json');\n\nexport default class OsUtils {\n  /**\n   * Runs a system command\n   * @param command {string} system command. Example 'sudo reboot'\n   * @param options {string} system command options\n   * @returns {Promise}\n   *\n   */\n\n  static execute(command, options) {\n    return new Promise((resolve, reject) => {\n      exec(command, options, (err, stdout, stderr) => {\n        if (err) {\n          reject(err);\n          return;\n        } else {\n          resolve({\n            stdout: stdout,\n            stderr: stderr,\n          });\n        }\n      });\n    });\n  }\n\n  /**\n   * Returns hostname\n   */\n  static hostName() {\n    return new Promise<any>((resolve, reject) => {\n      try {\n        resolve(os.hostname());\n      } catch (e) {\n        reject('Unknown');\n      }\n    });\n  }\n\n  /**\n   * Returns Current Wires Version\n   */\n  static getCurrentWiresVersion() {\n    return new Promise<any>((resolve, reject) => {\n      try {\n        resolve(pkg.version);\n      } catch (e) {\n        reject('Unknown');\n      }\n    });\n  }\n\n  /**\n   * Returns host cpu temp\n   * main: main temperature (avg)\n   * cores: array of temperatures\n   * max: max temperature\n   */\n  static cpuTemperature() {\n    return new Promise<any>((resolve, reject) => {\n      try {\n        resolve(si.cpuTemperature());\n      } catch (e) {\n        reject('Unknown');\n      }\n    });\n  }\n\n  /**\n    Returns File System and File System Stats\n    fs: name of file system\n    type: type of file system\n    size: sizes in bytes\n    used: used in bytes\n    use: used in %\n    mount: mount point\n   */\n  static fsSize() {\n    return new Promise<any>((resolve, reject) => {\n      try {\n        resolve(si.fsSize());\n      } catch (e) {\n        reject('Unknown');\n      }\n    });\n  }\n\n  /**\n    Returns host system info\n   */\n  static systemInfo() {\n    return new Promise<any>((resolve, reject) => {\n      try {\n        // define all values, you want to get back\n        const valueObject = {\n          cpu: '*',\n          osInfo: 'platform, release',\n          system: 'model, manufacturer',\n        };\n        resolve(si.get(valueObject));\n      } catch (e) {\n        reject('Unknown');\n      }\n    });\n  }\n\n  /**\n    Returns host time\n    current: local (server) time\n    uptime: uptime in number of seconds\n    timezone: e.g. GMT+0200\n    timezoneName: e.g. CEST\n   */\n  static systemTime() {\n    return new Promise<any>((resolve, reject) => {\n      try {\n        resolve(si.time());\n      } catch (e) {\n        reject('Unknown');\n      }\n    });\n  }\n\n  /**\n    Returns host memory\n    total: total memory in bytes\n    free: not used in bytes\n    used: used (incl. buffers/cache)\n    active: used actively (excl. buffers/cache)\n    available: potentially available (total - active)\n    buffers: used by buffers\n    cached: used by cache\n    slab: used by slab\n    buffcache: used by buffers+cache\n    swaptotal: swap total\n    swapused: swap used\n    swapfree: swap free\n   */\n  static systemMem() {\n    return new Promise<any>((resolve, reject) => {\n      try {\n        resolve(si.mem());\n      } catch (e) {\n        reject('Unknown');\n      }\n    });\n  }\n}\n","module.exports = require(\"path\");","export const CLONE = 'clone';\nexport const ERROR = 'error';\nexport const NOTIFICATION = 'notification';\nexport const IMPORT = 'import';\nexport const MOVE_TO_CONTAINER = 'move-to-container';\n","import {\n  DEVICE_CONTAINER_TYPE,\n  EDGE_CONTAINER_TYPE,\n  GROUP_CONTAINER_TYPE,\n  MODULE_NODE_TYPE,\n  NETWORK_CONTAINER_TYPE,\n  POINT_NODE_TYPE,\n} from '../nodes/constants';\n\nexport interface Entry {\n  entryId(): string;\n\n  identifier(): string;\n\n  nodeType(): string;\n\n  label(): string;\n}\n\nabstract class NormalEntry implements Entry {\n  id: string;\n  code: string;\n  readonly _nodeType: string;\n\n  entryId(): string {\n    return this.id;\n  }\n\n  identifier(): string {\n    return this.code;\n  }\n\n  nodeType(): string {\n    return this._nodeType;\n  }\n\n  label(): string {\n    return this.identifier() || this.entryId();\n  }\n}\n\nexport class Edge extends NormalEntry {\n  customer_code: string;\n  side_code: string;\n  model: string;\n  firmware_version: string;\n  data_version: string;\n  readonly _nodeType = EDGE_CONTAINER_TYPE;\n}\n\nexport class Network extends NormalEntry {\n  protocol: string;\n  state: string;\n  readonly _nodeType = NETWORK_CONTAINER_TYPE;\n}\n\nexport class Device extends NormalEntry {\n  manufacturer: string;\n  protocol: string;\n  state: string;\n  type: string;\n  readonly _nodeType = DEVICE_CONTAINER_TYPE;\n}\n\nexport class Folder extends NormalEntry {\n  name: string;\n  readonly _nodeType = GROUP_CONTAINER_TYPE;\n\n  label(): string {\n    return this.name || super.label();\n  }\n}\n\nexport class Point extends NormalEntry {\n  edge: string;\n  enabled: boolean;\n  kind: string;\n  measure_unit: string;\n  network: string;\n  offset: number;\n  precision: number;\n  protocol: string;\n  type: string;\n  readonly _nodeType = POINT_NODE_TYPE;\n}\n\nexport class Service implements Entry {\n  service_id: string;\n  service_name: string;\n  service_type: string;\n  version: string;\n  published_by: string;\n  state: string;\n  readonly created_at: string;\n  readonly modified_at: string;\n  readonly deploy_id: string;\n  readonly deploy_location: string;\n  readonly _nodeType = MODULE_NODE_TYPE;\n\n  entryId(): string {\n    return this.service_id;\n  }\n\n  identifier(): string {\n    return this.service_name;\n  }\n\n  nodeType(): string {\n    return this._nodeType;\n  }\n\n  label(): string {\n    return `${this.identifier()} ${this.version}` || this.entryId();\n  }\n}\n\nexport class PointData {\n  priority: number;\n  value: number;\n  point: string;\n  priority_values: number[];\n}\n","import config from '../../../config';\n\nexport const bsaClientConfig = path => {\n  let cfg = config.bsa.paths[path];\n  if (!cfg) {\n    return null;\n  }\n  return {\n    baseURL: config.bsa.baseURL,\n    auth: {\n      username: config.bsa.username,\n      password: config.bsa.password,\n    },\n    url: cfg.path,\n    headers: {\n      'Content-Type': cfg.contentType ?? 'application/json',\n      'Accept': cfg.accept ?? 'application/json',\n    },\n  };\n};\n","export default class SystemUtils {\n  static getDeviceID(self): Promise<string> {\n    return new Promise((resolve, reject) => {\n      if (self?.container?.db) {\n        self.container.db.getNodeType('system/platform', (err, docs) => {\n          if (!err) {\n            if (docs?.length && docs[0]?.properties?.deviceID) {\n              resolve(docs[0].properties.deviceID.trim());\n            } else {\n              reject('No deviceID');\n            }\n          } else {\n            console.log(err);\n            reject(err);\n          }\n        });\n      } else {\n        reject('No DB');\n      }\n    });\n  }\n\n  static getClientID(self): Promise<string> {\n    return new Promise((resolve, reject) => {\n      if (self?.container?.db) {\n        self.container.db.getNodeType('system/platform', (err, docs) => {\n          if (!err) {\n            if (docs?.length && docs[0]?.settings?.['client-id']?.value) {\n              resolve(docs[0].settings['client-id'].value.trim());\n            } else {\n              reject('No clientID');\n            }\n          } else {\n            console.log(err);\n            reject(err);\n          }\n        });\n      } else {\n        reject('No DB');\n      }\n    });\n  }\n}\n","export default class ModbusByteOrder {\n  private static TYPES = {\n    INT16: 1,\n    UINT16: 2,\n    INT32: 3,\n    UINT32: 4,\n    FLOAT32: 5,\n    INT64: 6,\n    UINT64: 7,\n    DOUBLE64: 8,\n  };\n  private static ENDIAN = {\n    LEB_BEW: 0, //                 // CD AB LE-Byte BE-Word\n    LEB_LEW: 1, //LE byte, LE word // AB CD LE-Byte LE-Word // default\n    BEB_LEW: 2, //BE byte, LE word // BA DC BE-Byte LE-Word // nube RIO device\n    BEB_BEW: 3, //BE byte, BE word // DC BA BE-Byte BE-Word\n  };\n  static readByteOrder = (buffer, offset: number, type: number, endian: number) => {\n    let TYPES = ModbusByteOrder.TYPES;\n    let ENDIAN = ModbusByteOrder.ENDIAN;\n    let buf;\n    let value;\n    try {\n      if (type <= TYPES.UINT16) {\n        buf = buffer.slice(offset, offset + 2);\n      } else if (type <= TYPES.FLOAT32) {\n        buf = buffer.slice(offset, offset + 4);\n      } else {\n        buf = buffer.slice(offset, offset + 8);\n      }\n      if (endian === ENDIAN.BEB_LEW || (type <= TYPES.UINT16 && endian === ENDIAN.BEB_BEW)) {\n        buf.swap16();\n      } else if (type > TYPES.UINT16 && type <= TYPES.FLOAT32 && endian === ENDIAN.BEB_BEW) {\n        buf.swap32();\n      } else if (type >= TYPES.INT64 && endian === ENDIAN.BEB_BEW) {\n        buf.swap64();\n      }\n    } catch (error) {\n      console.log(`buffer readValue issue in modbus-point-methods. Buffer.alloc ${error}`);\n    }\n    try {\n      switch (type) {\n        case TYPES.INT16:\n          value = buf.readInt16LE(value);\n          break;\n        case TYPES.UINT16:\n          value = buf.readUInt16LE(value);\n          break;\n        case TYPES.INT32:\n          value = buf.readInt32LE(value);\n          break;\n        case TYPES.UINT32:\n          value = buf.readUInt32LE(value);\n          break;\n        case TYPES.FLOAT32:\n          value = buf.readFloatLE(value);\n          break;\n        case TYPES.INT64:\n          // value = buf.readBigInt64LE(BigInt(value)); https://github.com/streamich/memfs/issues/275\n          break;\n        case TYPES.UINT64:\n          // value = buf.readBigUInt64LE(BigInt(value));\n          break;\n        case TYPES.DOUBLE64:\n          value = buf.readDoubleLE(value);\n          break;\n      }\n    } catch (error) {\n      console.log(`buffer readValue issue in modbus-point-methods. switch case ${error}`);\n    }\n\n    return value;\n  };\n\n  static writeValue = (value: number, type: number, endian: number) => {\n    let TYPES = ModbusByteOrder.TYPES;\n    let ENDIAN = ModbusByteOrder.ENDIAN;\n    let buf;\n    try {\n      if (type <= TYPES.UINT16) {\n        buf = Buffer.alloc(2);\n      } else if (type <= TYPES.FLOAT32) {\n        buf = Buffer.alloc(4);\n      } else {\n        buf = Buffer.alloc(8);\n      }\n    } catch (error) {\n      console.log(`buffer writeValue issue in modbus-point-methods. Buffer.alloc  ${error}`);\n    }\n    try {\n      switch (type) {\n        case TYPES.INT16:\n          buf.writeInt16LE(value);\n          break;\n        case TYPES.UINT16:\n          buf.writeUInt16LE(value);\n          break;\n        case TYPES.INT32:\n          buf.writeInt32LE(value);\n          break;\n        case TYPES.UINT32:\n          buf.writeUInt32LE(value);\n          break;\n        case TYPES.FLOAT32:\n          buf.writeFloatLE(value);\n          break;\n        case TYPES.INT64:\n          // buf.writeBigInt64LE(BigInt(value)); TODO https://github.com/streamich/memfs/issues/275\n          break;\n        case TYPES.UINT64:\n          // buf.writeBigUInt64LE(BigInt(value));\n          break;\n        case TYPES.DOUBLE64:\n          buf.writeDoubleLE(value);\n          break;\n      }\n    } catch (error) {\n      console.log(`buffer writeValue issue in modbus-point-methods :switch case ${error}`);\n    }\n    try {\n      if (endian === ENDIAN.BEB_LEW || (type <= TYPES.UINT16 && endian === ENDIAN.BEB_BEW)) {\n        buf.swap16();\n      } else if (type > TYPES.UINT16 && type <= TYPES.FLOAT32 && endian === ENDIAN.BEB_BEW) {\n        buf.swap32();\n      } else if (type >= TYPES.INT64 && endian === ENDIAN.BEB_BEW) {\n        buf.swap64();\n      }\n      return buf;\n    } catch (error) {\n      console.log(`buffer writeValue issue in modbus-point-methods :buf.swap() ${error}`);\n    }\n  };\n}\n","module.exports = require(\"influx\");","/*\n * PsychroLib (version 2.4.0) (https://github.com/psychrometrics/psychrolib).\n * Copyright (c) 2018-2020 The PsychroLib Contributors for the current library implementation.\n * Copyright (c) 2017 ASHRAE Handbook  Fundamentals for ASHRAE equations and coefficients.\n * Licensed under the MIT License.\n */\n\nvar psychrolib = function Psychrometrics() {\n  /**\n   * Module overview\n   *  Contains functions for calculating thermodynamic properties of gas-vapor mixtures\n   *  and standard atmosphere suitable for most engineering, physical and meteorological\n   *  applications.\n   *\n   *  Most of the functions are an implementation of the formulae found in the\n   *  2017 ASHRAE Handbook - Fundamentals, in both International System (SI),\n   *  and Imperial (IP) units. Please refer to the information included in\n   *  each function for their respective reference.\n   *\n   * Example (e.g. Node.JS)\n   *  // Import the PsychroLib\n   *  var psychrolib = require('psychrolib.js')\n   *  // Set unit system\n   *  psychrolib.SetUnitSystem(psychrolib.SI)\n   *  // Calculate the dew point temperature for a dry bulb temperature of 25 C and a relative humidity of 80%\n   *  var TDewPoint = psychrolib.GetTDewPointFromRelHum(25.0, 0.80);\n   *  console.log('TDewPoint: %d', TDewPoint);\n   * 21.3094\n   *\n   * Copyright\n   *  - For the current library implementation\n   *     Copyright (c) 2018-2020 The PsychroLib Contributors.\n   *  - For equations and coefficients published ASHRAE Handbook  Fundamentals, Chapter 1\n   *     Copyright (c) 2017 ASHRAE Handbook  Fundamentals (https://www.ashrae.org)\n   *\n   * License\n   *  MIT (https://github.com/psychrometrics/psychrolib/LICENSE.txt)\n   *\n   * Note from the Authors\n   *  We have made every effort to ensure that the code is adequate, however, we make no\n   *  representation with respect to its accuracy. Use at your own risk. Should you notice\n   *  an error, or if you have a suggestion, please notify us through GitHub at\n   *  https://github.com/psychrometrics/psychrolib/issues.\n   */\n\n  // Standard functions\n  var log = Math.log;\n  var exp = Math.exp;\n  var pow = Math.pow;\n  var min = Math.min;\n  var max = Math.max;\n  var abs = Math.abs;\n\n  /******************************************************************************************************\n   * Global constants\n   *****************************************************************************************************/\n\n  var ZERO_FAHRENHEIT_AS_RANKINE = 459.67; // Zero degree Fahrenheit (F) expressed as degree Rankine (R).\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 39.\n\n  var ZERO_CELSIUS_AS_KELVIN = 273.15; // Zero degree Celsius (C) expressed as Kelvin (K).\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 39.\n\n  var R_DA_IP = 53.35; // Universal gas constant for dry air (IP version) in ft lb_Force lb_DryAir R.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1.\n\n  var R_DA_SI = 287.042; // Universal gas constant for dry air (SI version) in J kg_DryAir K.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1.\n\n  var INVALID = -99999; // Invalid value (dimensionless).\n\n  var MAX_ITER_COUNT = 100; // Maximum number of iterations before exiting while loops.\n\n  var MIN_HUM_RATIO = 1e-7; // Minimum acceptable humidity ratio used/returned by any functions.\n  // Any value above 0 or below the MIN_HUM_RATIO will be reset to this value.\n\n  var FREEZING_POINT_WATER_IP = 32.0; // Freezing point of water in Fahrenheit.\n\n  var FREEZING_POINT_WATER_SI = 0.0; // Freezing point of water in Celsius.\n\n  var TRIPLE_POINT_WATER_IP = 32.018; // Triple point of water in Fahrenheit.\n\n  var TRIPLE_POINT_WATER_SI = 0.01; // Triple point of water in Celsius.\n\n  /******************************************************************************************************\n   * Helper functions\n   *****************************************************************************************************/\n\n  // Systems of units (IP or SI)\n  var PSYCHROLIB_UNITS = undefined;\n  var PSYCHROLIB_TOLERANCE = undefined;\n\n  this.IP = 1;\n  this.SI = 2;\n\n  // Function to set the system of units\n  // Note: this function *HAS TO BE CALLED* before the library can be used\n  this.SetUnitSystem = function(UnitSystem) {\n    if (UnitSystem != this.IP && UnitSystem != this.SI) {\n      throw new Error('UnitSystem must be IP or SI');\n    }\n    PSYCHROLIB_UNITS = UnitSystem;\n    // Define tolerance of temperature calculations\n    // The tolerance is the same in IP and SI\n    if (PSYCHROLIB_UNITS == this.IP) PSYCHROLIB_TOLERANCE = (0.001 * 9) / 5;\n    else PSYCHROLIB_TOLERANCE = 0.001;\n  };\n\n  // Return system of units in use.\n  this.GetUnitSystem = function() {\n    return PSYCHROLIB_UNITS;\n  };\n\n  // Function to check if the current system of units is SI or IP\n  // The function exits in error if the system of units is undefined\n  this.isIP = function() {\n    if (PSYCHROLIB_UNITS == this.IP) return true;\n    else if (PSYCHROLIB_UNITS == this.SI) return false;\n    else throw new Error('Unit system is not defined');\n  };\n\n  /******************************************************************************************************\n   * Conversion between temperature units\n   *****************************************************************************************************/\n\n  // Utility function to convert temperature to degree Rankine (R)\n  // given temperature in degree Fahrenheit (F).\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3\n  this.GetTRankineFromTFahrenheit = function(T_F) {\n    return T_F + ZERO_FAHRENHEIT_AS_RANKINE;\n  }; /* exact */\n\n  // Utility function to convert temperature to degree Fahrenheit (F)\n  // given temperature in degree Rankine (R).\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3\n  this.GetTFahrenheitFromTRankine = function(T_R) {\n    return T_R - ZERO_FAHRENHEIT_AS_RANKINE;\n  }; /* exact */\n\n  // Utility function to convert temperature to Kelvin (K)\n  // given temperature in degree Celsius (C).\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3\n  this.GetTKelvinFromTCelsius = function(T_C) {\n    return T_C + ZERO_CELSIUS_AS_KELVIN;\n  }; /* exact */\n\n  // Utility function to convert temperature to degree Celsius (C)\n  // given temperature in Kelvin (K).\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 section 3\n  this.GetTCelsiusFromTKelvin = function(T_K) {\n    return T_K - ZERO_CELSIUS_AS_KELVIN;\n  }; /* exact */\n\n  // Utility function to convert degree Fahrenheit (F) to degree Celsius (C)\n  this.GetTCelsiusFromTFahrenheit = function(T_F) {\n    return (T_F - 32) / 1.8;\n  };\n\n  // Utility function to convert degree Celsius (C) to degree Fahrenheit  (F)\n  this.GetTFahrenheitFromTCelsius = function(T_C) {\n    return T_C * 1.8 + 32;\n  };\n\n  this.GetTRankineFromTCelsius = function(T_C) {\n    var T_F = T_C * 1.8 + 32;\n    return T_F + ZERO_FAHRENHEIT_AS_RANKINE;\n  };\n\n  this.GetTKelvinFromTFahrenheit = function(T_F) {\n    var T_C = (T_F - 32) / 1.8;\n    return T_C + ZERO_CELSIUS_AS_KELVIN;\n  };\n\n  this.GetTFahrenheitFromTKelvin = function(T_K) {\n    var T_C = T_K - ZERO_CELSIUS_AS_KELVIN;\n    return T_C * 1.8 + 32;\n  };\n\n  this.GetTRankineFromTKelvin = function(T_K) {\n    var T_C = T_K - ZERO_CELSIUS_AS_KELVIN;\n    var T_F = T_C * 1.8 + 32;\n    return T_F + ZERO_FAHRENHEIT_AS_RANKINE;\n  };\n\n  this.GetTCelsiusFromTRankine = function(T_R) {\n    var T_F = T_R - ZERO_FAHRENHEIT_AS_RANKINE;\n    return (T_F - 32) / 1.8;\n  };\n\n  this.GetTKelvinFromTRankine = function(T_R) {\n    var T_F = T_R - ZERO_FAHRENHEIT_AS_RANKINE;\n    var T_C = (T_F - 32) / 1.8;\n    return T_C + ZERO_CELSIUS_AS_KELVIN;\n  };\n\n  /******************************************************************************************************\n   * Conversions between dew point, wet bulb, and relative humidity\n   *****************************************************************************************************/\n\n  // Return wet-bulb temperature given dry-bulb temperature, dew-point temperature, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetTWetBulbFromTDewPoint = function(\n    // (o) Wet bulb temperature in F [IP] or C [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    TDewPoint, // (i) Dew point temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var HumRatio;\n\n    if (!(TDewPoint <= TDryBulb))\n      throw new Error('Dew point temperature is above dry bulb temperature');\n\n    HumRatio = this.GetHumRatioFromTDewPoint(TDewPoint, Pressure);\n    return this.GetTWetBulbFromHumRatio(TDryBulb, HumRatio, Pressure);\n  };\n\n  // Return wet-bulb temperature given dry-bulb temperature, relative humidity, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetTWetBulbFromRelHum = function(\n    // (o) Wet bulb temperature in F [IP] or C [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    RelHum, // (i) Relative humidity [0-1]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var HumRatio;\n\n    if (!(RelHum >= 0 && RelHum <= 1)) throw new Error('Relative humidity is outside range [0,1]');\n\n    HumRatio = this.GetHumRatioFromRelHum(TDryBulb, RelHum, Pressure);\n    return this.GetTWetBulbFromHumRatio(TDryBulb, HumRatio, Pressure);\n  };\n\n  // Return relative humidity given dry-bulb temperature and dew-point temperature.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 22\n  this.GetRelHumFromTDewPoint = function(\n    // (o) Relative humidity [0-1]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    TDewPoint, // (i) Dew point temperature in F [IP] or C [SI]\n  ) {\n    var VapPres, SatVapPres;\n\n    if (!(TDewPoint <= TDryBulb))\n      throw new Error('Dew point temperature is above dry bulb temperature');\n\n    VapPres = this.GetSatVapPres(TDewPoint);\n    SatVapPres = this.GetSatVapPres(TDryBulb);\n    return VapPres / SatVapPres;\n  };\n\n  // Return relative humidity given dry-bulb temperature, wet bulb temperature and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetRelHumFromTWetBulb = function(\n    // (o) Relative humidity [0-1]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    TWetBulb, // (i) Wet bulb temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var HumRatio;\n\n    if (!(TWetBulb <= TDryBulb))\n      throw new Error('Wet bulb temperature is above dry bulb temperature');\n\n    HumRatio = this.GetHumRatioFromTWetBulb(TDryBulb, TWetBulb, Pressure);\n    return this.GetRelHumFromHumRatio(TDryBulb, HumRatio, Pressure);\n  };\n\n  // Return dew-point temperature given dry-bulb temperature and relative humidity.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetTDewPointFromRelHum = function(\n    // (o) Dew Point temperature in F [IP] or C [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    RelHum, // (i) Relative humidity [0-1]\n  ) {\n    var VapPres;\n\n    if (!(RelHum >= 0 && RelHum <= 1)) throw new Error('Relative humidity is outside range [0,1]');\n\n    VapPres = this.GetVapPresFromRelHum(TDryBulb, RelHum);\n    return this.GetTDewPointFromVapPres(TDryBulb, VapPres);\n  };\n\n  // Return dew-point temperature given dry-bulb temperature, wet-bulb temperature, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetTDewPointFromTWetBulb = function(\n    // (o) Dew Point temperature in F [IP] or C [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    TWetBulb, // (i) Wet bulb temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var HumRatio;\n\n    if (!(TWetBulb <= TDryBulb))\n      throw new Error('Wet bulb temperature is above dry bulb temperature');\n\n    HumRatio = this.GetHumRatioFromTWetBulb(TDryBulb, TWetBulb, Pressure);\n    return this.GetTDewPointFromHumRatio(TDryBulb, HumRatio, Pressure);\n  };\n\n  /******************************************************************************************************\n   * Conversions between dew point, or relative humidity and vapor pressure\n   *****************************************************************************************************/\n\n  // Return partial pressure of water vapor as a function of relative humidity and temperature.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 12, 22\n  this.GetVapPresFromRelHum = function(\n    // (o) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    RelHum, // (i) Relative humidity [0-1]\n  ) {\n    if (!(RelHum >= 0 && RelHum <= 1)) throw new Error('Relative humidity is outside range [0,1]');\n\n    return RelHum * this.GetSatVapPres(TDryBulb);\n  };\n\n  // Return relative humidity given dry-bulb temperature and vapor pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 12, 22\n  this.GetRelHumFromVapPres = function(\n    // (o) Relative humidity [0-1]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    VapPres, // (i) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]\n  ) {\n    if (!(VapPres >= 0))\n      throw new Error('Partial pressure of water vapor in moist air is negative');\n\n    return VapPres / this.GetSatVapPres(TDryBulb);\n  };\n\n  // Helper function returning the derivative of the natural log of the saturation vapor pressure\n  // as a function of dry-bulb temperature.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 5 & 6\n  this.dLnPws_ = function(\n    // (o)  Derivative of natural log of vapor pressure of saturated air in Psi [IP] or Pa [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n  ) {\n    var dLnPws, T;\n\n    if (this.isIP()) {\n      T = this.GetTRankineFromTFahrenheit(TDryBulb);\n\n      if (TDryBulb <= TRIPLE_POINT_WATER_IP)\n        dLnPws =\n          1.0214165e4 / pow(T, 2) -\n          5.3765794e-3 +\n          2 * 1.9202377e-7 * T +\n          3 * 3.5575832e-10 * pow(T, 2) -\n          4 * 9.0344688e-14 * pow(T, 3) +\n          4.1635019 / T;\n      else\n        dLnPws =\n          1.0440397e4 / pow(T, 2) -\n          2.7022355e-2 +\n          2 * 1.289036e-5 * T -\n          3 * 2.4780681e-9 * pow(T, 2) +\n          6.5459673 / T;\n    } else {\n      T = this.GetTKelvinFromTCelsius(TDryBulb);\n\n      if (TDryBulb <= TRIPLE_POINT_WATER_SI)\n        dLnPws =\n          5.6745359e3 / pow(T, 2) -\n          9.677843e-3 +\n          2 * 6.2215701e-7 * T +\n          3 * 2.0747825e-9 * pow(T, 2) -\n          4 * 9.484024e-13 * pow(T, 3) +\n          4.1635019 / T;\n      else\n        dLnPws =\n          5.8002206e3 / pow(T, 2) -\n          4.8640239e-2 +\n          2 * 4.1764768e-5 * T -\n          3 * 1.4452093e-8 * pow(T, 2) +\n          6.5459673 / T;\n    }\n\n    return dLnPws;\n  };\n\n  // Return dew-point temperature given dry-bulb temperature and vapor pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 5 and 6\n  // Notes: the dew point temperature is solved by inverting the equation giving water vapor pressure\n  // at saturation from temperature rather than using the regressions provided\n  // by ASHRAE (eqn. 37 and 38) which are much less accurate and have a\n  // narrower range of validity.\n  // The Newton-Raphson (NR) method is used on the logarithm of water vapour\n  // pressure as a function of temperature, which is a very smooth function\n  // Convergence is usually achieved in 3 to 5 iterations.\n  // TDryBulb is not really needed here, just used for convenience.\n  this.GetTDewPointFromVapPres = function(\n    // (o) Dew Point temperature in F [IP] or C [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    VapPres, // (i) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]\n  ) {\n    // Bounds function of the system of units\n    var BOUNDS; // Domain of validity of the equations\n\n    if (this.isIP()) {\n      BOUNDS = [-148, 392]; // Domain of validity of the equations\n    } else {\n      BOUNDS = [-100, 200]; // Domain of validity of the equations\n    }\n\n    // Bounds outside which a solution cannot be found\n    if (VapPres < this.GetSatVapPres(BOUNDS[0]) || VapPres > this.GetSatVapPres(BOUNDS[1]))\n      throw new Error('Partial pressure of water vapor is outside range of validity of equations');\n\n    // We use NR to approximate the solution.\n    // First guess\n    var TDewPoint = TDryBulb; // Calculated value of dew point temperatures, solved for iteratively in F [IP] or C [SI]\n    var lnVP = log(VapPres); // Natural logarithm of partial pressure of water vapor pressure in moist air\n\n    var TDewPoint_iter; // Value of TDewPoint used in NR calculation\n    var lnVP_iter; // Value of log of vapor water pressure used in NR calculation\n    var index = 1;\n    do {\n      // Current point\n      TDewPoint_iter = TDewPoint;\n      lnVP_iter = log(this.GetSatVapPres(TDewPoint_iter));\n\n      // Derivative of function, calculated analytically\n      var d_lnVP = this.dLnPws_(TDewPoint_iter);\n\n      // New estimate, bounded by domain of validity of eqn. 5 and 6\n      TDewPoint = TDewPoint_iter - (lnVP_iter - lnVP) / d_lnVP;\n      TDewPoint = max(TDewPoint, BOUNDS[0]);\n      TDewPoint = min(TDewPoint, BOUNDS[1]);\n\n      if (index > MAX_ITER_COUNT)\n        throw new Error('Convergence not reached in GetTDewPointFromVapPres. Stopping.');\n\n      index++;\n    } while (abs(TDewPoint - TDewPoint_iter) > PSYCHROLIB_TOLERANCE);\n    return min(TDewPoint, TDryBulb);\n  };\n\n  // Return vapor pressure given dew point temperature.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 36\n  this.GetVapPresFromTDewPoint = function(\n    // (o) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]\n    TDewPoint, // (i) Dew point temperature in F [IP] or C [SI]\n  ) {\n    return this.GetSatVapPres(TDewPoint);\n  };\n\n  /******************************************************************************************************\n   * Conversions from wet-bulb temperature, dew-point temperature, or relative humidity to humidity ratio\n   *****************************************************************************************************/\n\n  // Return wet-bulb temperature given dry-bulb temperature, humidity ratio, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 33 and 35 solved for Tstar\n  this.GetTWetBulbFromHumRatio = function(\n    // (o) Wet bulb temperature in F [IP] or C [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    // Declarations\n    var Wstar;\n    var TDewPoint, TWetBulb, TWetBulbSup, TWetBulbInf, BoundedHumRatio;\n    var index = 1;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n    BoundedHumRatio = max(HumRatio, MIN_HUM_RATIO);\n\n    TDewPoint = this.GetTDewPointFromHumRatio(TDryBulb, BoundedHumRatio, Pressure);\n\n    // Initial guesses\n    TWetBulbSup = TDryBulb;\n    TWetBulbInf = TDewPoint;\n    TWetBulb = (TWetBulbInf + TWetBulbSup) / 2;\n\n    // Bisection loop\n    while (TWetBulbSup - TWetBulbInf > PSYCHROLIB_TOLERANCE) {\n      // Compute humidity ratio at temperature Tstar\n      Wstar = this.GetHumRatioFromTWetBulb(TDryBulb, TWetBulb, Pressure);\n\n      // Get new bounds\n      if (Wstar > BoundedHumRatio) TWetBulbSup = TWetBulb;\n      else TWetBulbInf = TWetBulb;\n\n      // New guess of wet bulb temperature\n      TWetBulb = (TWetBulbSup + TWetBulbInf) / 2;\n\n      if (index > MAX_ITER_COUNT)\n        throw new Error('Convergence not reached in GetTWetBulbFromHumRatio. Stopping.');\n\n      index++;\n    }\n\n    return TWetBulb;\n  };\n\n  // Return humidity ratio given dry-bulb temperature, wet-bulb temperature, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 33 and 35\n  this.GetHumRatioFromTWetBulb = function(\n    // (o) Humidity Ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    TWetBulb, // (i) Wet bulb temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var Wsstar;\n    var HumRatio = INVALID;\n\n    if (!(TWetBulb <= TDryBulb))\n      throw new Error('Wet bulb temperature is above dry bulb temperature');\n\n    Wsstar = this.GetSatHumRatio(TWetBulb, Pressure);\n\n    if (this.isIP()) {\n      if (TWetBulb >= FREEZING_POINT_WATER_IP)\n        HumRatio =\n          ((1093 - 0.556 * TWetBulb) * Wsstar - 0.24 * (TDryBulb - TWetBulb)) /\n          (1093 + 0.444 * TDryBulb - TWetBulb);\n      else\n        HumRatio =\n          ((1220 - 0.04 * TWetBulb) * Wsstar - 0.24 * (TDryBulb - TWetBulb)) /\n          (1220 + 0.444 * TDryBulb - 0.48 * TWetBulb);\n    } else {\n      if (TWetBulb >= FREEZING_POINT_WATER_SI)\n        HumRatio =\n          ((2501 - 2.326 * TWetBulb) * Wsstar - 1.006 * (TDryBulb - TWetBulb)) /\n          (2501 + 1.86 * TDryBulb - 4.186 * TWetBulb);\n      else\n        HumRatio =\n          ((2830 - 0.24 * TWetBulb) * Wsstar - 1.006 * (TDryBulb - TWetBulb)) /\n          (2830 + 1.86 * TDryBulb - 2.1 * TWetBulb);\n    }\n    // Validity check.\n    return max(HumRatio, MIN_HUM_RATIO);\n  };\n\n  // Return humidity ratio given dry-bulb temperature, relative humidity, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetHumRatioFromRelHum = function(\n    // (o) Humidity Ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    RelHum, // (i) Relative humidity [0-1]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var VapPres;\n\n    if (!(RelHum >= 0 && RelHum <= 1)) throw new Error('Relative humidity is outside range [0,1]');\n\n    VapPres = this.GetVapPresFromRelHum(TDryBulb, RelHum);\n    return this.GetHumRatioFromVapPres(VapPres, Pressure);\n  };\n\n  // Return relative humidity given dry-bulb temperature, humidity ratio, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetRelHumFromHumRatio = function(\n    // (o) Relative humidity [0-1]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var VapPres;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n\n    VapPres = this.GetVapPresFromHumRatio(HumRatio, Pressure);\n    return this.GetRelHumFromVapPres(TDryBulb, VapPres);\n  };\n\n  // Return humidity ratio given dew-point temperature and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetHumRatioFromTDewPoint = function(\n    // (o) Humidity Ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    TDewPoint, // (i) Dew point temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var VapPres;\n\n    VapPres = this.GetSatVapPres(TDewPoint);\n    return this.GetHumRatioFromVapPres(VapPres, Pressure);\n  };\n\n  // Return dew-point temperature given dry-bulb temperature, humidity ratio, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetTDewPointFromHumRatio = function(\n    // (o) Dew Point temperature in F [IP] or C [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var VapPres;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n\n    VapPres = this.GetVapPresFromHumRatio(HumRatio, Pressure);\n    return this.GetTDewPointFromVapPres(TDryBulb, VapPres);\n  };\n\n  /******************************************************************************************************\n   * Conversions between humidity ratio and vapor pressure\n   *****************************************************************************************************/\n\n  // Return humidity ratio given water vapor pressure and atmospheric pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 20\n  this.GetHumRatioFromVapPres = function(\n    // (o) Humidity Ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    VapPres, // (i) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var HumRatio;\n\n    if (!(VapPres >= 0))\n      throw new Error('Partial pressure of water vapor in moist air is negative');\n\n    HumRatio = (0.621945 * VapPres) / (Pressure - VapPres);\n\n    // Validity check.\n    return max(HumRatio, MIN_HUM_RATIO);\n  };\n\n  // Return vapor pressure given humidity ratio and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 20 solved for pw\n  this.GetVapPresFromHumRatio = function(\n    // (o) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var VapPres, BoundedHumRatio;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n    BoundedHumRatio = max(HumRatio, MIN_HUM_RATIO);\n\n    VapPres = (Pressure * BoundedHumRatio) / (0.621945 + BoundedHumRatio);\n    return VapPres;\n  };\n\n  /******************************************************************************************************\n   * Conversions between humidity ratio and specific humidity\n   *****************************************************************************************************/\n\n  // Return the specific humidity from humidity ratio (aka mixing ratio)\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 9b\n  this.GetSpecificHumFromHumRatio = function(\n    // (o) Specific humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Dry_Air [IP] or kg_HO kg_Dry_Air [SI]\n  ) {\n    var BoundedHumRatio;\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n    BoundedHumRatio = max(HumRatio, MIN_HUM_RATIO);\n\n    return BoundedHumRatio / (1.0 + BoundedHumRatio);\n  };\n\n  // Return the humidity ratio (aka mixing ratio) from specific humidity\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 9b (solved for humidity ratio)\n  this.GetHumRatioFromSpecificHum = function(\n    // (o) Humidity ratio in lb_HO lb_Dry_Air [IP] or kg_HO kg_Dry_Air [SI]\n    SpecificHum, // (i) Specific humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n  ) {\n    var HumRatio;\n\n    if (!(SpecificHum >= 0.0 && SpecificHum < 1.0))\n      throw new Error('Specific humidity is outside range [0, 1[');\n\n    HumRatio = SpecificHum / (1.0 - SpecificHum);\n\n    // Validity check\n    return max(HumRatio, MIN_HUM_RATIO);\n  };\n\n  /******************************************************************************************************\n   * Dry Air Calculations\n   *****************************************************************************************************/\n\n  // Return dry-air enthalpy given dry-bulb temperature.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 28\n  this.GetDryAirEnthalpy = function(\n    // (o) Dry air enthalpy in Btu lb [IP] or J kg [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n  ) {\n    if (this.isIP()) return 0.24 * TDryBulb;\n    else return 1006 * TDryBulb;\n  };\n\n  // Return dry-air density given dry-bulb temperature and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  // Notes: eqn 14 for the perfect gas relationship for dry air.\n  // Eqn 1 for the universal gas constant.\n  // The factor 144 in IP is for the conversion of Psi = lb in to lb ft.\n  this.GetDryAirDensity = function(\n    // (o) Dry air density in lb ft [IP] or kg m [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    if (this.isIP()) return (144 * Pressure) / R_DA_IP / this.GetTRankineFromTFahrenheit(TDryBulb);\n    else return Pressure / R_DA_SI / this.GetTKelvinFromTCelsius(TDryBulb);\n  };\n\n  // Return dry-air volume given dry-bulb temperature and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1.\n  // Notes: eqn 14 for the perfect gas relationship for dry air.\n  // Eqn 1 for the universal gas constant.\n  // The factor 144 in IP is for the conversion of Psi = lb in to lb ft.\n  this.GetDryAirVolume = function(\n    // (o) Dry air volume ft lb [IP] or in m kg [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    if (this.isIP())\n      return (R_DA_IP * this.GetTRankineFromTFahrenheit(TDryBulb)) / (144 * Pressure);\n    else return (R_DA_SI * this.GetTKelvinFromTCelsius(TDryBulb)) / Pressure;\n  };\n\n  // Return dry bulb temperature from enthalpy and humidity ratio.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 30.\n  // Notes: based on the `GetMoistAirEnthalpy` function, rearranged for temperature.\n  this.GetTDryBulbFromEnthalpyAndHumRatio = function(\n    // (o) Dry-bulb temperature in F [IP] or C [SI]\n    MoistAirEnthalpy, // (i) Moist air enthalpy in Btu lb [IP] or J kg\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n  ) {\n    var BoundedHumRatio;\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n    BoundedHumRatio = max(HumRatio, MIN_HUM_RATIO);\n\n    if (this.isIP())\n      return (MoistAirEnthalpy - 1061.0 * BoundedHumRatio) / (0.24 + 0.444 * BoundedHumRatio);\n    else\n      return (\n        (MoistAirEnthalpy / 1000.0 - 2501.0 * BoundedHumRatio) / (1.006 + 1.86 * BoundedHumRatio)\n      );\n  };\n\n  // Return humidity ratio from enthalpy and dry-bulb temperature.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 30.\n  // Notes: based on the `GetMoistAirEnthalpy` function, rearranged for humidity ratio.\n  this.GetHumRatioFromEnthalpyAndTDryBulb = function(\n    // (o) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air\n    MoistAirEnthalpy, // (i) Moist air enthalpy in Btu lb [IP] or J kg\n    TDryBulb, // (i) Dry-bulb temperature in F [IP] or C [SI]\n  ) {\n    var HumRatio;\n    if (this.isIP()) HumRatio = (MoistAirEnthalpy - 0.24 * TDryBulb) / (1061.0 + 0.444 * TDryBulb);\n    else HumRatio = (MoistAirEnthalpy / 1000.0 - 1.006 * TDryBulb) / (2501.0 + 1.86 * TDryBulb);\n\n    // Validity check.\n    return max(HumRatio, MIN_HUM_RATIO);\n  };\n\n  /******************************************************************************************************\n   * Saturated Air Calculations\n   *****************************************************************************************************/\n\n  // Return saturation vapor pressure given dry-bulb temperature.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 5 & 6\n  // Important note: the ASHRAE formulae are defined above and below the freezing point but have\n  // a discontinuity at the freezing point. This is a small inaccuracy on ASHRAE's part: the formulae\n  // should be defined above and below the triple point of water (not the feezing point) in which case\n  // the discontinuity vanishes. It is essential to use the triple point of water otherwise function\n  // GetTDewPointFromVapPres, which inverts the present function, does not converge properly around\n  // the freezing point.\n  this.GetSatVapPres = function(\n    // (o) Vapor Pressure of saturated air in Psi [IP] or Pa [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n  ) {\n    var LnPws, T;\n\n    if (this.isIP()) {\n      if (!(TDryBulb >= -148 && TDryBulb <= 392))\n        throw new Error('Dry bulb temperature is outside range [-148, 392]');\n\n      T = this.GetTRankineFromTFahrenheit(TDryBulb);\n      if (TDryBulb <= TRIPLE_POINT_WATER_IP)\n        LnPws =\n          -1.0214165e4 / T -\n          4.8932428 -\n          5.3765794e-3 * T +\n          1.9202377e-7 * T * T +\n          3.5575832e-10 * pow(T, 3) -\n          9.0344688e-14 * pow(T, 4) +\n          4.1635019 * log(T);\n      else\n        LnPws =\n          -1.0440397e4 / T -\n          1.129465e1 -\n          2.7022355e-2 * T +\n          1.289036e-5 * T * T -\n          2.4780681e-9 * pow(T, 3) +\n          6.5459673 * log(T);\n    } else {\n      if (!(TDryBulb >= -100 && TDryBulb <= 200))\n        throw new Error('Dry bulb temperature is outside range [-100, 200]');\n\n      T = this.GetTKelvinFromTCelsius(TDryBulb);\n      if (TDryBulb <= TRIPLE_POINT_WATER_SI)\n        LnPws =\n          -5.6745359e3 / T +\n          6.3925247 -\n          9.677843e-3 * T +\n          6.2215701e-7 * T * T +\n          2.0747825e-9 * pow(T, 3) -\n          9.484024e-13 * pow(T, 4) +\n          4.1635019 * log(T);\n      else\n        LnPws =\n          -5.8002206e3 / T +\n          1.3914993 -\n          4.8640239e-2 * T +\n          4.1764768e-5 * T * T -\n          1.4452093e-8 * pow(T, 3) +\n          6.5459673 * log(T);\n    }\n\n    return exp(LnPws);\n  };\n\n  // Return humidity ratio of saturated air given dry-bulb temperature and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 36, solved for W\n  this.GetSatHumRatio = function(\n    // (o) Humidity ratio of saturated air in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var SatVaporPres, SatHumRatio;\n\n    SatVaporPres = this.GetSatVapPres(TDryBulb);\n    SatHumRatio = (0.621945 * SatVaporPres) / (Pressure - SatVaporPres);\n\n    // Validity check.\n    return max(SatHumRatio, MIN_HUM_RATIO);\n  };\n\n  // Return saturated air enthalpy given dry-bulb temperature and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1\n  this.GetSatAirEnthalpy = function(\n    // (o) Saturated air enthalpy in Btu lb [IP] or J kg [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    return this.GetMoistAirEnthalpy(TDryBulb, this.GetSatHumRatio(TDryBulb, Pressure));\n  };\n\n  /******************************************************************************************************\n   * Moist Air Calculations\n   *****************************************************************************************************/\n\n  // Return Vapor pressure deficit given dry-bulb temperature, humidity ratio, and pressure.\n  // Reference: see Oke (1987) eqn. 2.13a\n  this.GetVaporPressureDeficit = function(\n    // (o) Vapor pressure deficit in Psi [IP] or Pa [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var RelHum;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n\n    RelHum = this.GetRelHumFromHumRatio(TDryBulb, HumRatio, Pressure);\n    return this.GetSatVapPres(TDryBulb) * (1 - RelHum);\n  };\n\n  // Return the degree of saturation (i.e humidity ratio of the air / humidity ratio of the air at saturation\n  // at the same temperature and pressure) given dry-bulb temperature, humidity ratio, and atmospheric pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2009) ch. 1 eqn. 12\n  // Notes: the definition is absent from the 2017 Handbook\n  this.GetDegreeOfSaturation = function(\n    // (o) Degree of saturation (unitless)\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var BoundedHumRatio;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n    BoundedHumRatio = max(HumRatio, MIN_HUM_RATIO);\n\n    return BoundedHumRatio / this.GetSatHumRatio(TDryBulb, Pressure);\n  };\n\n  // Return moist air enthalpy given dry-bulb temperature and humidity ratio.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 30\n  this.GetMoistAirEnthalpy = function(\n    // (o) Moist Air Enthalpy in Btu lb [IP] or J kg [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n  ) {\n    var BoundedHumRatio;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n    BoundedHumRatio = max(HumRatio, MIN_HUM_RATIO);\n\n    if (this.isIP()) return 0.24 * TDryBulb + BoundedHumRatio * (1061 + 0.444 * TDryBulb);\n    else return (1.006 * TDryBulb + BoundedHumRatio * (2501 + 1.86 * TDryBulb)) * 1000;\n  };\n\n  // Return moist air specific volume given dry-bulb temperature, humidity ratio, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 26\n  // Notes: in IP units, R_DA_IP / 144 equals 0.370486 which is the coefficient appearing in eqn 26.\n  // The factor 144 is for the conversion of Psi = lb in to lb ft.\n  this.GetMoistAirVolume = function(\n    // (o) Specific Volume ft lb [IP] or in m kg [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var BoundedHumRatio;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n    BoundedHumRatio = max(HumRatio, MIN_HUM_RATIO);\n\n    if (this.isIP())\n      return (\n        (R_DA_IP * this.GetTRankineFromTFahrenheit(TDryBulb) * (1 + 1.607858 * BoundedHumRatio)) /\n        (144 * Pressure)\n      );\n    else\n      return (\n        (R_DA_SI * this.GetTKelvinFromTCelsius(TDryBulb) * (1 + 1.607858 * BoundedHumRatio)) /\n        Pressure\n      );\n  };\n\n  // Return dry-bulb temperature given moist air specific volume, humidity ratio, and pressure.\n  // Reference:\n  // ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 26\n  // Notes:\n  // In IP units, R_DA_IP / 144 equals 0.370486 which is the coefficient appearing in eqn 26\n  // The factor 144 is for the conversion of Psi = lb in to lb ft.\n  // Based on the `GetMoistAirVolume` function, rearranged for dry-bulb temperature.\n  this.GetTDryBulbFromMoistAirVolumeAndHumRatio = function(\n    // (o) Dry-bulb temperature in F [IP] or C [SI]\n    MoistAirVolume, // (i) Specific volume of moist air in ft lb of dry air [IP] or in m kg of dry air [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var BoundedHumRatio;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n    BoundedHumRatio = max(HumRatio, MIN_HUM_RATIO);\n\n    if (this.isIP())\n      return this.GetTFahrenheitFromTRankine(\n        (MoistAirVolume * (144 * Pressure)) / (R_DA_IP * (1 + 1.607858 * BoundedHumRatio)),\n      );\n    else\n      return this.GetTCelsiusFromTKelvin(\n        (MoistAirVolume * Pressure) / (R_DA_SI * (1 + 1.607858 * BoundedHumRatio)),\n      );\n  };\n\n  // Return moist air density given humidity ratio, dry bulb temperature, and pressure.\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn. 11\n  this.GetMoistAirDensity = function(\n    // (o) Moist air density in lb ft [IP] or kg m [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    HumRatio, // (i) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var BoundedHumRatio;\n\n    if (!(HumRatio >= 0)) throw new Error('Humidity ratio is negative');\n    BoundedHumRatio = max(HumRatio, MIN_HUM_RATIO);\n\n    return (1 + BoundedHumRatio) / this.GetMoistAirVolume(TDryBulb, BoundedHumRatio, Pressure);\n  };\n\n  /******************************************************************************************************\n   * Standard atmosphere\n   *****************************************************************************************************/\n\n  // Return standard atmosphere barometric pressure, given the elevation (altitude).\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 3\n  this.GetStandardAtmPressure = function(\n    // (o) Standard atmosphere barometric pressure in Psi [IP] or Pa [SI]\n    Altitude, // (i) Altitude in ft [IP] or m [SI]\n  ) {\n    var Pressure;\n\n    if (this.isIP()) Pressure = 14.696 * pow(1 - 6.8754e-6 * Altitude, 5.2559);\n    else Pressure = 101325 * pow(1 - 2.25577e-5 * Altitude, 5.2559);\n    return Pressure;\n  };\n\n  // Return standard atmosphere temperature, given the elevation (altitude).\n  // Reference: ASHRAE Handbook - Fundamentals (2017) ch. 1 eqn 4\n  this.GetStandardAtmTemperature = function(\n    // (o) Standard atmosphere dry bulb temperature in F [IP] or C [SI]\n    Altitude, // (i) Altitude in ft [IP] or m [SI]\n  ) {\n    var Temperature;\n    if (this.isIP()) Temperature = 59 - 0.0035662 * Altitude;\n    else Temperature = 15 - 0.0065 * Altitude;\n    return Temperature;\n  };\n\n  // Return sea level pressure given dry-bulb temperature, altitude above sea level and pressure.\n  // Reference: Hess SL, Introduction to theoretical meteorology, Holt Rinehart and Winston, NY 1959,\n  // ch. 6.5; Stull RB, Meteorology for scientists and engineers, 2nd edition,\n  // Brooks/Cole 2000, ch. 1.\n  // Notes: the standard procedure for the US is to use for TDryBulb the average\n  // of the current station temperature and the station temperature from 12 hours ago.\n  this.GetSeaLevelPressure = function(\n    // (o) Sea level barometric pressure in Psi [IP] or Pa [SI]\n    StnPressure, // (i) Observed station pressure in Psi [IP] or Pa [SI]\n    Altitude, // (i) Altitude above sea level in ft [IP] or m [SI]\n    TDryBulb, // (i) Dry bulb temperature ft lb [IP] or in m kg [SI]\n  ) {\n    var TColumn, H;\n    if (this.isIP()) {\n      // Calculate average temperature in column of air, assuming a lapse rate\n      // of 3.6 F/1000ft\n      TColumn = TDryBulb + (0.0036 * Altitude) / 2;\n\n      // Determine the scale height\n      H = 53.351 * this.GetTRankineFromTFahrenheit(TColumn);\n    } else {\n      // Calculate average temperature in column of air, assuming a lapse rate\n      // of 6.5 C/km\n      TColumn = TDryBulb + (0.0065 * Altitude) / 2;\n\n      // Determine the scale height\n      H = (287.055 * this.GetTKelvinFromTCelsius(TColumn)) / 9.807;\n    }\n\n    // Calculate the sea level pressure\n    var SeaLevelPressure = StnPressure * exp(Altitude / H);\n    return SeaLevelPressure;\n  };\n\n  // Return station pressure from sea level pressure\n  // Reference: see 'GetSeaLevelPressure'\n  // Notes: this function is just the inverse of 'GetSeaLevelPressure'.\n  this.GetStationPressure = function(\n    // (o) Station pressure in Psi [IP] or Pa [SI]\n    SeaLevelPressure, // (i) Sea level barometric pressure in Psi [IP] or Pa [SI]\n    Altitude, // (i) Altitude above sea level in ft [IP] or m [SI]\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n  ) {\n    return SeaLevelPressure / this.GetSeaLevelPressure(1, Altitude, TDryBulb);\n  };\n\n  /******************************************************************************************************\n   * Functions to set all psychrometric values\n   *****************************************************************************************************/\n\n  // Utility function to calculate humidity ratio, dew-point temperature, relative humidity,\n  // vapour pressure, moist air enthalpy, moist air volume, and degree of saturation of air given\n  // dry-bulb temperature, wet-bulb temperature, and pressure.\n  this.CalcPsychrometricsFromTWetBulb = function(\n    /**\n     * HumRatio            // (o) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n     * TDewPoint           // (o) Dew point temperature in F [IP] or C [SI]\n     * RelHum              // (o) Relative humidity [0-1]\n     * VapPres             // (o) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]\n     * MoistAirEnthalpy    // (o) Moist air enthalpy in Btu lb [IP] or J kg [SI]\n     * MoistAirVolume      // (o) Specific volume ft lb [IP] or in m kg [SI]\n     * DegreeOfSaturation  // (o) Degree of saturation [unitless]\n     */\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    TWetBulb, // (i) Wet bulb temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var HumRatio = this.GetHumRatioFromTWetBulb(TDryBulb, TWetBulb, Pressure);\n    var TDewPoint = this.GetTDewPointFromHumRatio(TDryBulb, HumRatio, Pressure);\n    var RelHum = this.GetRelHumFromHumRatio(TDryBulb, HumRatio, Pressure);\n    var VapPres = this.GetVapPresFromHumRatio(HumRatio, Pressure);\n    var MoistAirEnthalpy = this.GetMoistAirEnthalpy(TDryBulb, HumRatio);\n    var MoistAirVolume = this.GetMoistAirVolume(TDryBulb, HumRatio, Pressure);\n    var DegreeOfSaturation = this.GetDegreeOfSaturation(TDryBulb, HumRatio, Pressure);\n    return [\n      HumRatio,\n      TDewPoint,\n      RelHum,\n      VapPres,\n      MoistAirEnthalpy,\n      MoistAirVolume,\n      DegreeOfSaturation,\n    ];\n  };\n\n  // Utility function to calculate humidity ratio, wet-bulb temperature, relative humidity,\n  // vapour pressure, moist air enthalpy, moist air volume, and degree of saturation of air given\n  // dry-bulb temperature, dew-point temperature, and pressure.\n  this.CalcPsychrometricsFromTDewPoint = function(\n    /**\n     * HumRatio            // (o) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI]\n     * TWetBulb            // (o) Wet bulb temperature in F [IP] or C [SI]\n     * RelHum              // (o) Relative humidity [0-1]\n     * VapPres             // (o) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]\n     * MoistAirEnthalpy    // (o) Moist air enthalpy in Btu lb [IP] or J kg [SI]\n     * MoistAirVolume      // (o) Specific volume ft lb [IP] or in m kg [SI]\n     * DegreeOfSaturation  // (o) Degree of saturation [unitless]\n     */\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    TDewPoint, // (i) Dew point temperature in F [IP] or C [SI]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var HumRatio = this.GetHumRatioFromTDewPoint(TDewPoint, Pressure);\n    var TWetBulb = this.GetTWetBulbFromHumRatio(TDryBulb, HumRatio, Pressure);\n    var RelHum = this.GetRelHumFromHumRatio(TDryBulb, HumRatio, Pressure);\n    var VapPres = this.GetVapPresFromHumRatio(HumRatio, Pressure);\n    var MoistAirEnthalpy = this.GetMoistAirEnthalpy(TDryBulb, HumRatio);\n    var MoistAirVolume = this.GetMoistAirVolume(TDryBulb, HumRatio, Pressure);\n    var DegreeOfSaturation = this.GetDegreeOfSaturation(TDryBulb, HumRatio, Pressure);\n    return [\n      HumRatio,\n      TWetBulb,\n      RelHum,\n      VapPres,\n      MoistAirEnthalpy,\n      MoistAirVolume,\n      DegreeOfSaturation,\n    ];\n  };\n\n  // Utility function to calculate humidity ratio, wet-bulb temperature, dew-point temperature,\n  // vapour pressure, moist air enthalpy, moist air volume, and degree of saturation of air given\n  // dry-bulb temperature, relative humidity and pressure.\n  this.CalcPsychrometricsFromRelHum = function(\n    /**\n     * HumRatio            // (o) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI]\n     * TWetBulb            // (o) Wet bulb temperature in F [IP] or C [SI]\n     * TDewPoint           // (o) Dew point temperature in F [IP] or C [SI]\n     * VapPres             // (o) Partial pressure of water vapor in moist air [Psi]\n     * MoistAirEnthalpy    // (o) Moist air enthalpy in Btu lb [IP] or J kg [SI]\n     * MoistAirVolume      // (o) Specific volume ft lb [IP] or in m kg [SI]\n     * DegreeOfSaturation  // (o) Degree of saturation [unitless]\n     */\n    TDryBulb, // (i) Dry bulb temperature in F [IP] or C [SI]\n    RelHum, // (i) Relative humidity [0-1]\n    Pressure, // (i) Atmospheric pressure in Psi [IP] or Pa [SI]\n  ) {\n    var HumRatio = this.GetHumRatioFromRelHum(TDryBulb, RelHum, Pressure);\n    var TWetBulb = this.GetTWetBulbFromHumRatio(TDryBulb, HumRatio, Pressure);\n    var TDewPoint = this.GetTDewPointFromHumRatio(TDryBulb, HumRatio, Pressure);\n    var VapPres = this.GetVapPresFromHumRatio(HumRatio, Pressure);\n    var MoistAirEnthalpy = this.GetMoistAirEnthalpy(TDryBulb, HumRatio);\n    var MoistAirVolume = this.GetMoistAirVolume(TDryBulb, HumRatio, Pressure);\n    var DegreeOfSaturation = this.GetDegreeOfSaturation(TDryBulb, HumRatio, Pressure);\n    return [\n      HumRatio,\n      TWetBulb,\n      TDewPoint,\n      VapPres,\n      MoistAirEnthalpy,\n      MoistAirVolume,\n      DegreeOfSaturation,\n    ];\n  };\n};\n\nmodule.exports = psychrolib;\n","interface findVal {\n  valueWithKey: object,\n  value: number;\n}\n\nenum compareType {\n  Equals = 'Equals',\n  NotEquals = 'Not Equal',\n  GreaterThanEqual = 'Greater Than Equal',\n  GreaterThan = 'Greater Than',\n  LessThanEqual = 'Less Than Equal',\n  LessThan = 'Less Than',\n  Includes = 'Includes',\n  startsWith = 'Starts With',\n  endsWith = 'Ends With'\n}\n\nexport default class jsonStringCompare {\n  /**\n   * \n   */\n  static compare(self: any, s1: any, s2: any) {\n    const inputType = self.settings['function'].value;\n    if (self.settings['isNumber'].value) {\n      s1 = Number(s1)\n      s2 = Number(s2)\n    }\n    switch (inputType) {\n      case compareType.Equals:\n        return s1 === s2;\n      case compareType.NotEquals:\n        return s1 !== s2;\n      case compareType.GreaterThanEqual:\n        return s1 >= s2;\n      case compareType.GreaterThan:\n        return s1 > s2;\n      case compareType.LessThanEqual:\n        return s1 <= s2;\n      case compareType.LessThan:\n        return s1 < s2;\n      case compareType.LessThan:\n        return s1 < s2;\n      case compareType.Includes:\n        return s1.includes(s2);\n      case compareType.startsWith:\n        return s1.startsWith(s2);\n      case compareType.endsWith:\n        return s1.endsWith(s2);\n      default:\n        return s1 === s2;\n    }\n   \n  }\n\n  static findVal(object: { [x: string]: any; }, key: string) {\n    let value: findVal;\n    Object.keys(object).some(function (k) {\n      if (k === key) {\n        value = {\n          valueWithKey: { [key]: object[k] },\n          value: object[k]\n        }\n      }\n      if (object[k] && typeof object[k] === 'object') {\n        value = this.findVal(object[k], key);\n        return value !== undefined;\n      }\n    });\n    return value;\n  }\n\n\n  \n\n}\n","\nexport default class EdgeHelp {\n\n    static NetworkDesc =\n        `## Description\\n ` +\n        ` The is node is used for reading and writing values to the edge-io-28. This node uses an internal rest-api to talk to the edge-io-28. No details need to be set\\n ` +\n        `   \\n ` +\n        `### Enable\\n ` +\n        `   \\n ` +\n        ` The point enable will disable any new value being sent to the node **output**  \\n ` +\n        `   \\n ` +\n        `### Polling Interval\\n ` +\n        `   \\n ` +\n        ` This will change the poll rate of the edge-io-28 inputs. A normal setting is 1 second\\n ` +\n        ` The faster the polling rate is the higher the memory usage is\\n ` +\n        `   \\n ` +\n        `### Polling Interval Time Setting\\n ` +\n        `   \\n ` +\n        `Used in conjugation with the **Polling Interval**. Make the selection for the time units for **Seconds**, **Minutes**, **Hours** \\n ` +\n        `   \\n `;\n\n        static inputsDesc =\n        `## Description\\n ` +\n        ` The is node is used in conjunction with the edge-io-28. This node uses an internal rest-api to talk to the edge-io-28\\n ` +\n        `   \\n ` +\n        `## Digital Input\\n ` +\n        `   \\n ` +\n        `A total of 14 DIs can be used on the edge-io-28. There are 7 DIs and 7 UIs\\n ` +\n        `   \\n ` +\n        `### DIs (From the UIs)  \\n ` +\n        `   \\n ` +\n        ` The UIs can be setup and used to read a status change from a *Digital Input* (7 off dry input)\\n ` +\n        `   \\n ` +\n        `### DIs (From the UIs)  \\n ` +\n        `   \\n ` +\n        ` The UIs can be setup and used to read a status change from a *Digital Input* (7 off dry input)\\n ` +\n        `   \\n ` +\n        `## Universal Input\\n ` +\n        `   \\n ` +\n        ` The Universal Input or Analogue Input (7 off) can be used in a number of combinations for reading different sensor types\\n ` +\n        `   \\n ` +\n        `### UI as 0/10dc  \\n ` +\n        `   \\n ` +\n        ` When configured as a UI 0/10dc the node output value will return a value that is set in the **Low scale** & **High scale**\\n ` +\n        `   \\n ` +\n        `### UI as 0/20ma and or 4/20ma \\n ` +\n        `   \\n ` +\n        ` When configured as a UI 0/20ma and or 4/20ma the node output value will return a value that is set in the **Low scale** & **High scale**\\n ` +\n        `   \\n ` +\n        `### UI as 10K thermistor \\n ` +\n        `   \\n ` +\n        ` When configured as a UI 10K thermistor type 2 the node output value will return a value based on the resistance and corresponding temperature\\n ` +\n        `   \\n ` +\n        `## Point Configuration\\n ` +\n        `### Point Enable\\n ` +\n        `   \\n ` +\n        ` The point enable will disable any new value being sent to the node **output**  \\n ` +\n        `   \\n ` +\n        `### Point Debug\\n ` +\n        `   \\n ` +\n        ` The point debug will allow the node **output** to always send the value even if there is node change\\n ` +\n        ` This is just a guide to see if the polling is working\\n ` +\n        `   \\n ` +\n        `### Point Selection\\n ` +\n        `   \\n ` +\n        ` 1. Select the **Point Type** for example UO  \\n ` +\n        ` 2. Select the **Point Number** for example UO-1   \\n ` +\n        ` **Note:** You cant set a type **Digital** and point number **UI1** the correct types must be matched with the correct point numbers  \\n ` +\n        `   \\n ` +\n        `### Point Units\\n ` +\n        `   \\n ` +\n        ` The units can be set as required see steps below.  \\n ` +\n        ` 1. Select the **Units Category**.  \\n ` +\n        ` 2. Lock (**lock icon**) the node setting's and hit the **save** button to return the units types.  \\n ` +\n        ` 3. Select the units type.  \\n ` +\n        ` 4. Save and close the node as required  \\n ` +\n        `   \\n ` +\n        `### Point Low Scale\\n ` +\n        `   \\n ` +\n        ` This is used in when the UI type is set as a 0-10dc or 4-20ma. The **High Scale**  must be set as well \\n ` +\n        ` For example if the point type is 0-10dc and the *Low Scale* is set to 0 and *High Scale* is set to 100 \\   \\n ` +\n        ` the node output value when at 0vdc will return 0 and at 10vdc the node output value will return 100 \\   \\n ` +\n        `   \\n ` +\n        `### Point High Scale\\n ` +\n        `   \\n ` +\n        ` This is used in when the UI type is set as a 0-10dc or 4-20ma (See **Low Scale** setting for more info).  \\n ` +\n        `   \\n ` +\n        `### Point Decimal Places\\n ` +\n        `   \\n ` +\n        ` The units can be set as required see steps below.  \\n ` +\n        `   \\n ` +\n        `### Point Offset\\n ` +\n        `   \\n ` +\n        ` Enter a float value to offset. This will apply an math add function to the original value  \\n ` +\n        ` Example original value is 20 and offset is -1 the **node output** value result will be 19 \\n ` +\n        `   \\n ` +\n        `### Point Decimal Places\\n ` +\n        `   \\n ` +\n        ` Enter a int value to Decimal. This will apply an math round function to the original value \\n ` +\n        ` Example original value is 99.9999 and the device places is set to 0  the **node output** value result will be 99 \\n ` +\n        `   \\n ` +\n        `### Math Function\\n ` +\n        `   \\n ` +\n        ` The units can be set as required see steps below.  \\n ` +\n        ` 1. **na** Will apply not math.  \\n ` +\n        ` 2. **add** Will add a **value** node output.  \\n ` +\n        ` 3. **subtract** Will subtract a **value** node output.  \\n ` +\n        ` 4. **multiply** Will multiply a **value** node output.  \\n ` +\n        ` 5. **divide** Will divide a **value** node output. \\n ` +\n        ` 6. **invert** Will invert the node output. Example in original value = 0 the node output value will = 1.   \\n ` +\n        `   \\n ` +\n        `###  History Settings Database Type\\n ` +\n        `   \\n ` +\n        ` The are two options for the database type. The data can either be pushed to influxDB or PostgreSQL.  \\n ` +\n        ` 1. Select required database type (if type is *Nube DB PostgreSQL* *no more steps are required*).  \\n ` +\n        ` 2. Enter DB details like IP, port, username and password(if type is *InfluxDB*)\\n ` +\n        `   \\n ` +\n        `#### History Settings History Type\\n ` +\n        `   \\n ` +\n        ` 1. **Change Of Value (COV)**.  \\n ` +\n        ` 2. **Periodic**.  \\n ` +\n        ` 3. **Trigger Only**.  \\n ` +\n        `   \\n ` +\n        `####  History Settings Local Storage Limit\\n ` +\n        `   \\n ` +\n        ` 1. **Change Of Value (COV)**.  \\n ` +\n        ` 2. **Periodic**.  \\n ` +\n        ` 3. **Trigger Only**.  \\n ` +\n        `   \\n ` +\n        `####  History Settings Round minutes\\n ` +\n        `   \\n ` +\n        ` 1. **Change Of Value (COV)**.  \\n ` +\n        ` 2. **Periodic**.  \\n ` +\n        ` 3. **Trigger Only**.  \\n ` +\n        `   \\n ` +\n        `### Alarm Settings\\n ` +\n        `   \\n ` +\n        ` to be added  \\n ` +\n        `   \\n ` +\n        `### Tag Settings\\n ` +\n        `   \\n ` +\n        ` to be added  \\n `;\n  \n\n\n        static outputsDesc =\n        `## Description\\n ` +\n        ` The is node is used in conjunction with the edge-io-28. This node uses an internal rest-api to talk to the edge-io-28\\n ` +\n        `   \\n ` +\n        `## Digital Output\\n ` +\n        `   \\n ` +\n        ` The DOs can be used to drive a 0-12vdc relay (5 off) or an onboard Normally Open Relay (2 off)\\n ` +\n        `### DOs  \\n ` +\n        `   \\n ` +\n        ` The input of the node can will drive the output on/true  with any value > 1 or a true value \\n ` +\n        ` Any value < 0 or a false will drive the output off/false \\n ` +\n        `### Relay Output  \\n ` +\n        `   \\n ` +\n        ` The input of the node can will drive the output on/true  with any value > 1 or a true value \\n ` +\n        ` Any value < 0 or a false will drive the output off/false \\n ` +\n        `## Universal Output\\n ` +\n        `   \\n ` +\n        ` The Universal Output or Analogue Output (7 off) has a voltage range of 0 to 12vdc\\n ` +\n        ` The UOs can be used as an AO floating point 0/10dc or a binary on/off 0-12dc \\n ` +\n        `### UOs as 0/10dc  \\n ` +\n        `   \\n ` +\n        ` When configured as a UOs a the node input value is a float value between 0/100 to drive a voltage of 0/10dc \\n ` +\n        `### UOs as On/Off  \\n ` +\n        `   \\n ` +\n        ` The input of the node can will drive the output on/true  with any value > 1 or a true value \\n ` +\n        ` Any value < 0 or a false will drive the output off/false \\n ` +\n        `## Point Configuration\\n ` +\n        `### Point Enable\\n ` +\n        `   \\n ` +\n        ` The point enable will disable any new value being sent to the node **output**  \\n ` +\n        `### Point Selection\\n ` +\n        `   \\n ` +\n        ` 1. Select the **Point Type** for example UO  \\n ` +\n        ` 2. Select the **Point Number** for example UO-1   \\n ` +\n        `### Point Settings\\n ` +\n        `   \\n ` +\n        ` The DOs can be used to drive a 0-12vdc relay (5 off) or an onboard Normally Open Relay (2 off)\\n ` +\n        `### Point Units\\n ` +\n        `   \\n ` +\n        ` The units can be set as required see steps below.  \\n ` +\n        ` 1. Select the **Units Category**.  \\n ` +\n        ` 2. Lock (**lock icon**) the node setting's and hit the **save** button to return the units types.  \\n ` +\n        ` 3. Select the units type.  \\n ` +\n        ` 4. Save and close the node as required  \\n ` +\n        `###  History Settings Database Type\\n ` +\n        `   \\n ` +\n        ` The are two options for the database type. The data can either be pushed to influxDB or PostgreSQL.  \\n ` +\n        ` 1. Select required database type (if type is *Nube DB PostgreSQL* *no more steps are required*).  \\n ` +\n        ` 2. Enter DB details like IP, port, username and password(if type is *InfluxDB*)\\n ` +\n        `#### History Settings History Type\\n ` +\n        `   \\n ` +\n        ` 1. **Change Of Value (COV)**.  \\n ` +\n        ` 2. **Periodic**.  \\n ` +\n        ` 3. **Trigger Only**.  \\n ` +\n        `####  History Settings Local Storage Limit\\n ` +\n        `   \\n ` +\n        ` 1. **Change Of Value (COV)**.  \\n ` +\n        ` 2. **Periodic**.  \\n ` +\n        ` 3. **Trigger Only**.  \\n ` +\n        `####  History Settings Round minutes\\n ` +\n        `   \\n ` +\n        ` 1. **Change Of Value (COV)**.  \\n ` +\n        ` 2. **Periodic**.  \\n ` +\n        ` 3. **Trigger Only**.  \\n ` +\n        `### Alarm Settings\\n ` +\n        `   \\n ` +\n        ` to be added  \\n ` +\n        `### Tag Settings\\n ` +\n        `   \\n ` +\n        ` to be added  \\n `;\n}\n\n","export default class BACnetEnumsUnits {\n  static unitCategory = ['Common Metric', 'Common Imperial', 'Electrical', 'Energy', 'Enthalpy', 'Entropy', 'Force', 'Frequency', 'Humidity', 'Length', 'Light', 'Mass', 'Flow', 'Power', 'Pressure', 'Temperature', 'Time', 'Torque', 'Velocity', 'Volume', 'Volumetric Flow', 'Other'].map(\n    point => {\n      return { value: point, text: point };\n    },\n  );\n  static unitType(type: string) {\n    switch (type) {\n      case 'Common Metric':\n        return Object.keys(BACnetEnumsUnits.COMMON_METRIC);\n      case 'Common Imperial':\n        return Object.keys(BACnetEnumsUnits.COMMON_IMPERIAL);\n      case 'Electrical':\n        return Object.keys(BACnetEnumsUnits.Electrical);\n      case 'Energy':\n        return Object.keys(BACnetEnumsUnits.Energy);\n      case 'Enthalpy':\n        return Object.keys(BACnetEnumsUnits.Enthalpy);\n      case 'Entropy':\n        return Object.keys(BACnetEnumsUnits.Entropy);\n      case 'Force':\n        return Object.keys(BACnetEnumsUnits.Force);\n      case 'Frequency':\n        return Object.keys(BACnetEnumsUnits.Frequency);\n      case 'Humidity':\n        return Object.keys(BACnetEnumsUnits.Humidity);\n      case 'Length':\n        return Object.keys(BACnetEnumsUnits.Length);\n      case 'Light':\n        return Object.keys(BACnetEnumsUnits.Light);\n      case 'Mass':\n        return Object.keys(BACnetEnumsUnits.Mass);\n      case 'Flow':\n        return Object.keys(BACnetEnumsUnits.Flow);\n      case 'Power':\n        return Object.keys(BACnetEnumsUnits.Entropy);\n      case 'Pressure':\n        return Object.keys(BACnetEnumsUnits.Pressure);\n      case 'Temperature':\n        return Object.keys(BACnetEnumsUnits.Temperature);\n      case 'Time':\n        return Object.keys(BACnetEnumsUnits.Time);\n      case 'Torque':\n        return Object.keys(BACnetEnumsUnits.Torque);\n      case 'Velocity':\n        return Object.keys(BACnetEnumsUnits.Velocity);\n      case 'Volume':\n        return Object.keys(BACnetEnumsUnits.Volume);\n      case 'Volumetric Flow':\n        return Object.keys(BACnetEnumsUnits.VolumetricFlow);\n      case 'Other':\n        return Object.keys(BACnetEnumsUnits.Other);\n    }\n  }\n\n  static COMMON_METRIC = {\n    NO_UNITS: 95,\n    PERCENT: 98,\n    PERCENT_RELATIVE_HUMIDITY: 29,\n    DEGREES_CELSIUS: 62,\n    KILOPASCALS: 54,\n  };\n\n  static COMMON_IMPERIAL = {\n    NO_UNITS: 95,\n    PERCENT: 98,\n    PERCENT_RELATIVE_HUMIDITY: 29,\n    DEGREES_FAHRENHEIT: 64,\n    POUNDS_FORCE_PER_SQUARE_INCH: 56,\n  };\n\n  static Electrical = {\n    MILLIAMPERES: 2,\n    AMPERES: 3,\n    AMPERES_PER_METER: 167,\n    AMPERES_PER_SQUARE_METER: 168,\n    AMPERE_SQUARE_METERS: 169,\n    DECIBELS: 199,\n    DECIBELS_MILLIVOLT: 200,\n    DECIBELS_VOLT: 201,\n    FARADS: 170,\n    HENRYS: 171,\n    OHMS: 4,\n    OHM_METERS: 172,\n    MILLIOHMS: 145,\n    KILOHMS: 122,\n    MEGOHMS: 123,\n    MICROSIEMENS: 190,\n    MILLISIEMENS: 202,\n    SIEMENS: 173 /* 1 mho equals 1 siemens */,\n    SIEMENS_PER_METER: 174,\n    TESLAS: 175,\n    VOLTS: 5,\n    MILLIVOLTS: 124,\n    KILOVOLTS: 6,\n    MEGAVOLTS: 7,\n    VOLT_AMPERES: 8,\n    KILOVOLT_AMPERES: 9,\n    MEGAVOLT_AMPERES: 10,\n    VOLT_AMPERES_REACTIVE: 11,\n    KILOVOLT_AMPERES_REACTIVE: 12,\n    MEGAVOLT_AMPERES_REACTIVE: 13,\n    VOLTS_PER_DEGREE_KELVIN: 176,\n    VOLTS_PER_METER: 177,\n    DEGREES_PHASE: 14,\n    POWER_FACTOR: 15,\n    WEBERS: 178,\n  };\n\n\n  static Energy = {\n    /* Energy */\n    JOULES: 16,\n    KILOJOULES: 17,\n    KILOJOULES_PER_KILOGRAM: 125,\n    MEGAJOULES: 126,\n    WATT_HOURS: 18,\n    KILOWATT_HOURS: 19,\n    MEGAWATT_HOURS: 146,\n    WATT_HOURS_REACTIVE: 203,\n    KILOWATT_HOURS_REACTIVE: 204,\n    MEGAWATT_HOURS_REACTIVE: 205,\n    BTUS: 20,\n    KILO_BTUS: 147,\n    MEGA_BTUS: 148,\n    THERMS: 21,\n    TON_HOURS: 22,\n  };\n\n  static Enthalpy = {\n    /* Enthalpy */\n    JOULES_PER_KILOGRAM_DRY_AIR: 23,\n    KILOJOULES_PER_KILOGRAM_DRY_AIR: 149,\n    MEGAJOULES_PER_KILOGRAM_DRY_AIR: 150,\n    BTUS_PER_POUND_DRY_AIR: 24,\n    BTUS_PER_POUND: 117,\n  };\n  static Entropy = {\n    /* Entropy */\n    JOULES_PER_DEGREE_KELVIN: 127,\n    KILOJOULES_PER_DEGREE_KELVIN: 151,\n    MEGAJOULES_PER_DEGREE_KELVIN: 152,\n    JOULES_PER_KILOGRAM_DEGREE_KELVIN: 128,\n  };\n  static Force = {\n    /* Force */\n    NEWTON: 153,\n  };\n  static Frequency = {\n    /* Frequency */\n    CYCLES_PER_HOUR: 25,\n    CYCLES_PER_MINUTE: 26,\n    HERTZ: 27,\n    KILOHERTZ: 129,\n    MEGAHERTZ: 130,\n    PER_HOUR: 131,\n  };\n\n  static Humidity = {\n    /* Humidity */\n    GRAMS_OF_WATER_PER_KILOGRAM_DRY_AIR: 28,\n    PERCENT_RELATIVE_HUMIDITY: 29,\n  };\n  static Length = {\n    /* Length */\n    MICROMETERS: 194,\n    MILLIMETERS: 30,\n    CENTIMETERS: 118,\n    KILOMETERS: 193,\n    METERS: 31,\n    INCHES: 32,\n    FEET: 33,\n  };\n  static Light = {\n    /* Light */\n    CANDELAS: 179,\n    CANDELAS_PER_SQUARE_METER: 180,\n    WATTS_PER_SQUARE_FOOT: 34,\n    WATTS_PER_SQUARE_METER: 35,\n    LUMENS: 36,\n    LUXES: 37,\n    FOOT_CANDLES: 38,\n  };\n  static Mass = {\n    /* Mass */\n    MILLIGRAMS: 196,\n    GRAMS: 195,\n    KILOGRAMS: 39,\n    POUNDS_MASS: 40,\n    TONS: 41,\n  };\n  static Flow = {\n    /* Mass Flow */\n    GRAMS_PER_SECOND: 154,\n    GRAMS_PER_MINUTE: 155,\n    KILOGRAMS_PER_SECOND: 42,\n    KILOGRAMS_PER_MINUTE: 43,\n    KILOGRAMS_PER_HOUR: 44,\n    POUNDS_MASS_PER_SECOND: 119,\n    POUNDS_MASS_PER_MINUTE: 45,\n    POUNDS_MASS_PER_HOUR: 46,\n    TONS_PER_HOUR: 156,\n  };\n  static Power = {\n    /* Power */\n    MILLIWATTS: 132,\n    WATTS: 47,\n    KILOWATTS: 48,\n    MEGAWATTS: 49,\n    BTUS_PER_HOUR: 50,\n    KILO_BTUS_PER_HOUR: 157,\n    HORSEPOWER: 51,\n    TONS_REFRIGERATION: 52,\n  };\n  static Pressure = {\n    /* Pressure */\n    PASCALS: 53,\n    HECTOPASCALS: 133,\n    KILOPASCALS: 54,\n    MILLIBARS: 134,\n    BARS: 55,\n    POUNDS_FORCE_PER_SQUARE_INCH: 56,\n    MILLIMETERS_OF_WATER: 206,\n    CENTIMETERS_OF_WATER: 57,\n    INCHES_OF_WATER: 58,\n    MILLIMETERS_OF_MERCURY: 59,\n    CENTIMETERS_OF_MERCURY: 60,\n    INCHES_OF_MERCURY: 61,\n  };\n  static Temperature = {\n    /* Temperature */\n    DEGREES_CELSIUS: 62,\n    DEGREES_KELVIN: 63,\n    DEGREES_KELVIN_PER_HOUR: 181,\n    DEGREES_KELVIN_PER_MINUTE: 182,\n    DEGREES_FAHRENHEIT: 64,\n    DEGREE_DAYS_CELSIUS: 65,\n    DEGREE_DAYS_FAHRENHEIT: 66,\n    DELTA_DEGREES_FAHRENHEIT: 120,\n    DELTA_DEGREES_KELVIN: 121,\n  };\n  static Time = {\n    /* Time */\n    YEARS: 67,\n    MONTHS: 68,\n    WEEKS: 69,\n    DAYS: 70,\n    HOURS: 71,\n    MINUTES: 72,\n    SECONDS: 73,\n    HUNDREDTHS_SECONDS: 158,\n    MILLISECONDS: 159,\n  };\n  static Torque = {\n    /* Torque */\n    NEWTON_METERS: 160,\n  };\n  static Velocity = {\n    /* Velocity */\n    MILLIMETERS_PER_SECOND: 161,\n    MILLIMETERS_PER_MINUTE: 162,\n    METERS_PER_SECOND: 74,\n    METERS_PER_MINUTE: 163,\n    METERS_PER_HOUR: 164,\n    KILOMETERS_PER_HOUR: 75,\n    FEET_PER_SECOND: 76,\n    FEET_PER_MINUTE: 77,\n    MILES_PER_HOUR: 78,\n  };\n  static Volume = {\n    /* Volume */\n    CUBIC_FEET: 79,\n    CUBIC_METERS: 80,\n    IMPERIAL_GALLONS: 81,\n    MILLILITERS: 197,\n    LITERS: 82,\n    US_GALLONS: 83,\n  };\n  static VolumetricFlow = {\n    /* Volumetric Flow */\n    CUBIC_FEET_PER_SECOND: 142,\n    CUBIC_FEET_PER_MINUTE: 84,\n    CUBIC_FEET_PER_HOUR: 191,\n    CUBIC_METERS_PER_SECOND: 85,\n    CUBIC_METERS_PER_MINUTE: 165,\n    CUBIC_METERS_PER_HOUR: 135,\n    IMPERIAL_GALLONS_PER_MINUTE: 86,\n    MILLILITERS_PER_SECOND: 198,\n    LITERS_PER_SECOND: 87,\n    LITERS_PER_MINUTE: 88,\n    LITERS_PER_HOUR: 136,\n    US_GALLONS_PER_MINUTE: 89,\n    US_GALLONS_PER_HOUR: 192,\n  };\n  static Other = {\n    /* Other */\n    DEGREES_ANGULAR: 90,\n    DEGREES_CELSIUS_PER_HOUR: 91,\n    DEGREES_CELSIUS_PER_MINUTE: 92,\n    DEGREES_FAHRENHEIT_PER_HOUR: 93,\n    DEGREES_FAHRENHEIT_PER_MINUTE: 94,\n    JOULE_SECONDS: 183,\n    KILOGRAMS_PER_CUBIC_METER: 186,\n    KW_HOURS_PER_SQUARE_METER: 137,\n    KW_HOURS_PER_SQUARE_FOOT: 138,\n    MEGAJOULES_PER_SQUARE_METER: 139,\n    MEGAJOULES_PER_SQUARE_FOOT: 140,\n    NO_UNITS: 95,\n    NEWTON_SECONDS: 187,\n    NEWTONS_PER_METER: 188,\n    PARTS_PER_MILLION: 96,\n    PARTS_PER_BILLION: 97,\n    PERCENT: 98,\n    PERCENT_OBSCURATION_PER_FOOT: 143,\n    PERCENT_OBSCURATION_PER_METER: 144,\n    PERCENT_PER_SECOND: 99,\n    PER_MINUTE: 100,\n    PER_SECOND: 101,\n    PSI_PER_DEGREE_FAHRENHEIT: 102,\n    RADIANS: 103,\n    RADIANS_PER_SECOND: 184,\n    REVOLUTIONS_PER_MINUTE: 104,\n    SQUARE_METERS_PER_NEWTON: 185,\n    WATTS_PER_METER_PER_DEGREE_KELVIN: 189,\n    WATTS_PER_SQUARE_METER_DEGREE_KELVIN: 141,\n    PER_MILLE: 207,\n    GRAMS_PER_GRAM: 208,\n    KILOGRAMS_PER_KILOGRAM: 209,\n    GRAMS_PER_KILOGRAM: 210,\n    MILLIGRAMS_PER_GRAM: 211,\n    MILLIGRAMS_PER_KILOGRAM: 212,\n    GRAMS_PER_MILLILITER: 213,\n    GRAMS_PER_LITER: 214,\n    MILLIGRAMS_PER_LITER: 215,\n    MICROGRAMS_PER_LITER: 216,\n    GRAMS_PER_CUBIC_METER: 217,\n    MILLIGRAMS_PER_CUBIC_METER: 218,\n    MICROGRAMS_PER_CUBIC_METER: 219,\n    NANOGRAMS_PER_CUBIC_METER: 220,\n    GRAMS_PER_CUBIC_CENTIMETER: 221,\n    BECQUERELS: 222,\n    MEGABECQUERELS: 224,\n    GRAY: 225,\n    MILLIGRAY: 226,\n    MICROGRAY: 227,\n    SIEVERTS: 228,\n    MILLISIEVERTS: 229,\n    MICROSIEVERTS: 230,\n    MICROSIEVERTS_PER_HOUR: 231,\n    DECIBELS_A: 232,\n    NEPHELOMETRIC_TURBIDITY_UNIT: 233,\n    PH: 234,\n    GRAMS_PER_SQUARE_METER: 235,\n    MINUTES_PER_DEGREE_KELVIN: 236,\n  };\n\n}\n\n\n\n    // static BACNET_ENGINEERING_UNITS = {\n    //   /* Area */\n    //   METERS_PER_SECOND_PER_SECOND: 166,\n    //   SQUARE_METERS: 0,\n    //   SQUARE_CENTIMETERS: 116,\n    //   SQUARE_FEET: 1,\n    //   SQUARE_INCHES: 115,\n    //   /* Currency */\n    //   // CURRENCY1: 105,\n    //   // CURRENCY2: 106,\n    //   // CURRENCY3: 107,\n    //   // CURRENCY4: 108,\n    //   // CURRENCY5: 109,\n    //   // CURRENCY6: 110,\n    //   // CURRENCY7: 111,\n    //   // CURRENCY8: 112,\n    //   // CURRENCY9: 113,\n    //   // CURRENCY10: 114,\n\n    //   /* Electrical */\n    //   MILLIAMPERES: 2,\n    //   AMPERES: 3,\n    //   AMPERES_PER_METER: 167,\n    //   AMPERES_PER_SQUARE_METER: 168,\n    //   AMPERE_SQUARE_METERS: 169,\n    //   DECIBELS: 199,\n    //   DECIBELS_MILLIVOLT: 200,\n    //   DECIBELS_VOLT: 201,\n    //   FARADS: 170,\n    //   HENRYS: 171,\n    //   OHMS: 4,\n    //   OHM_METERS: 172,\n    //   MILLIOHMS: 145,\n    //   KILOHMS: 122,\n    //   MEGOHMS: 123,\n    //   MICROSIEMENS: 190,\n    //   MILLISIEMENS: 202,\n    //   SIEMENS: 173 /* 1 mho equals 1 siemens */,\n    //   SIEMENS_PER_METER: 174,\n    //   TESLAS: 175,\n    //   VOLTS: 5,\n    //   MILLIVOLTS: 124,\n    //   KILOVOLTS: 6,\n    //   MEGAVOLTS: 7,\n    //   VOLT_AMPERES: 8,\n    //   KILOVOLT_AMPERES: 9,\n    //   MEGAVOLT_AMPERES: 10,\n    //   VOLT_AMPERES_REACTIVE: 11,\n    //   KILOVOLT_AMPERES_REACTIVE: 12,\n    //   MEGAVOLT_AMPERES_REACTIVE: 13,\n    //   VOLTS_PER_DEGREE_KELVIN: 176,\n    //   VOLTS_PER_METER: 177,\n    //   DEGREES_PHASE: 14,\n    //   POWER_FACTOR: 15,\n    //   WEBERS: 178,\n    //   /* Energy */\n    //   JOULES: 16,\n    //   KILOJOULES: 17,\n    //   KILOJOULES_PER_KILOGRAM: 125,\n    //   MEGAJOULES: 126,\n    //   WATT_HOURS: 18,\n    //   KILOWATT_HOURS: 19,\n    //   MEGAWATT_HOURS: 146,\n    //   WATT_HOURS_REACTIVE: 203,\n    //   KILOWATT_HOURS_REACTIVE: 204,\n    //   MEGAWATT_HOURS_REACTIVE: 205,\n    //   BTUS: 20,\n    //   KILO_BTUS: 147,\n    //   MEGA_BTUS: 148,\n    //   THERMS: 21,\n    //   TON_HOURS: 22,\n    //   /* Enthalpy */\n    //   JOULES_PER_KILOGRAM_DRY_AIR: 23,\n    //   KILOJOULES_PER_KILOGRAM_DRY_AIR: 149,\n    //   MEGAJOULES_PER_KILOGRAM_DRY_AIR: 150,\n    //   BTUS_PER_POUND_DRY_AIR: 24,\n    //   BTUS_PER_POUND: 117,\n    //   /* Entropy */\n    //   JOULES_PER_DEGREE_KELVIN: 127,\n    //   KILOJOULES_PER_DEGREE_KELVIN: 151,\n    //   MEGAJOULES_PER_DEGREE_KELVIN: 152,\n    //   JOULES_PER_KILOGRAM_DEGREE_KELVIN: 128,\n    //   /* Force */\n    //   NEWTON: 153,\n    //   /* Frequency */\n    //   CYCLES_PER_HOUR: 25,\n    //   CYCLES_PER_MINUTE: 26,\n    //   HERTZ: 27,\n    //   KILOHERTZ: 129,\n    //   MEGAHERTZ: 130,\n    //   PER_HOUR: 131,\n    //   /* Humidity */\n    //   GRAMS_OF_WATER_PER_KILOGRAM_DRY_AIR: 28,\n    //   PERCENT_RELATIVE_HUMIDITY: 29,\n    //   /* Length */\n    //   MICROMETERS: 194,\n    //   MILLIMETERS: 30,\n    //   CENTIMETERS: 118,\n    //   KILOMETERS: 193,\n    //   METERS: 31,\n    //   INCHES: 32,\n    //   FEET: 33,\n    //   /* Light */\n    //   CANDELAS: 179,\n    //   CANDELAS_PER_SQUARE_METER: 180,\n    //   WATTS_PER_SQUARE_FOOT: 34,\n    //   WATTS_PER_SQUARE_METER: 35,\n    //   LUMENS: 36,\n    //   LUXES: 37,\n    //   FOOT_CANDLES: 38,\n    //   /* Mass */\n    //   MILLIGRAMS: 196,\n    //   GRAMS: 195,\n    //   KILOGRAMS: 39,\n    //   POUNDS_MASS: 40,\n    //   TONS: 41,\n    //   /* Mass Flow */\n    //   GRAMS_PER_SECOND: 154,\n    //   GRAMS_PER_MINUTE: 155,\n    //   KILOGRAMS_PER_SECOND: 42,\n    //   KILOGRAMS_PER_MINUTE: 43,\n    //   KILOGRAMS_PER_HOUR: 44,\n    //   POUNDS_MASS_PER_SECOND: 119,\n    //   POUNDS_MASS_PER_MINUTE: 45,\n    //   POUNDS_MASS_PER_HOUR: 46,\n    //   TONS_PER_HOUR: 156,\n    //   /* Power */\n    //   MILLIWATTS: 132,\n    //   WATTS: 47,\n    //   KILOWATTS: 48,\n    //   MEGAWATTS: 49,\n    //   BTUS_PER_HOUR: 50,\n    //   KILO_BTUS_PER_HOUR: 157,\n    //   HORSEPOWER: 51,\n    //   TONS_REFRIGERATION: 52,\n    //   /* Pressure */\n    //   PASCALS: 53,\n    //   HECTOPASCALS: 133,\n    //   KILOPASCALS: 54,\n    //   MILLIBARS: 134,\n    //   BARS: 55,\n    //   POUNDS_FORCE_PER_SQUARE_INCH: 56,\n    //   MILLIMETERS_OF_WATER: 206,\n    //   CENTIMETERS_OF_WATER: 57,\n    //   INCHES_OF_WATER: 58,\n    //   MILLIMETERS_OF_MERCURY: 59,\n    //   CENTIMETERS_OF_MERCURY: 60,\n    //   INCHES_OF_MERCURY: 61,\n    //   /* Temperature */\n    //   DEGREES_CELSIUS: 62,\n    //   DEGREES_KELVIN: 63,\n    //   DEGREES_KELVIN_PER_HOUR: 181,\n    //   DEGREES_KELVIN_PER_MINUTE: 182,\n    //   DEGREES_FAHRENHEIT: 64,\n    //   DEGREE_DAYS_CELSIUS: 65,\n    //   DEGREE_DAYS_FAHRENHEIT: 66,\n    //   DELTA_DEGREES_FAHRENHEIT: 120,\n    //   DELTA_DEGREES_KELVIN: 121,\n    //   /* Time */\n    //   YEARS: 67,\n    //   MONTHS: 68,\n    //   WEEKS: 69,\n    //   DAYS: 70,\n    //   HOURS: 71,\n    //   MINUTES: 72,\n    //   SECONDS: 73,\n    //   HUNDREDTHS_SECONDS: 158,\n    //   MILLISECONDS: 159,\n    //   /* Torque */\n    //   NEWTON_METERS: 160,\n    //   /* Velocity */\n    //   MILLIMETERS_PER_SECOND: 161,\n    //   MILLIMETERS_PER_MINUTE: 162,\n    //   METERS_PER_SECOND: 74,\n    //   METERS_PER_MINUTE: 163,\n    //   METERS_PER_HOUR: 164,\n    //   KILOMETERS_PER_HOUR: 75,\n    //   FEET_PER_SECOND: 76,\n    //   FEET_PER_MINUTE: 77,\n    //   MILES_PER_HOUR: 78,\n    //   /* Volume */\n    //   CUBIC_FEET: 79,\n    //   CUBIC_METERS: 80,\n    //   IMPERIAL_GALLONS: 81,\n    //   MILLILITERS: 197,\n    //   LITERS: 82,\n    //   US_GALLONS: 83,\n    //   /* Volumetric Flow */\n    //   CUBIC_FEET_PER_SECOND: 142,\n    //   CUBIC_FEET_PER_MINUTE: 84,\n    //   CUBIC_FEET_PER_HOUR: 191,\n    //   CUBIC_METERS_PER_SECOND: 85,\n    //   CUBIC_METERS_PER_MINUTE: 165,\n    //   CUBIC_METERS_PER_HOUR: 135,\n    //   IMPERIAL_GALLONS_PER_MINUTE: 86,\n    //   MILLILITERS_PER_SECOND: 198,\n    //   LITERS_PER_SECOND: 87,\n    //   LITERS_PER_MINUTE: 88,\n    //   LITERS_PER_HOUR: 136,\n    //   US_GALLONS_PER_MINUTE: 89,\n    //   US_GALLONS_PER_HOUR: 192,\n    //   /* Other */\n    //   DEGREES_ANGULAR: 90,\n    //   DEGREES_CELSIUS_PER_HOUR: 91,\n    //   DEGREES_CELSIUS_PER_MINUTE: 92,\n    //   DEGREES_FAHRENHEIT_PER_HOUR: 93,\n    //   DEGREES_FAHRENHEIT_PER_MINUTE: 94,\n    //   JOULE_SECONDS: 183,\n    //   KILOGRAMS_PER_CUBIC_METER: 186,\n    //   KW_HOURS_PER_SQUARE_METER: 137,\n    //   KW_HOURS_PER_SQUARE_FOOT: 138,\n    //   MEGAJOULES_PER_SQUARE_METER: 139,\n    //   MEGAJOULES_PER_SQUARE_FOOT: 140,\n    //   NO_UNITS: 95,\n    //   NEWTON_SECONDS: 187,\n    //   NEWTONS_PER_METER: 188,\n    //   PARTS_PER_MILLION: 96,\n    //   PARTS_PER_BILLION: 97,\n    //   PERCENT: 98,\n    //   PERCENT_OBSCURATION_PER_FOOT: 143,\n    //   PERCENT_OBSCURATION_PER_METER: 144,\n    //   PERCENT_PER_SECOND: 99,\n    //   PER_MINUTE: 100,\n    //   PER_SECOND: 101,\n    //   PSI_PER_DEGREE_FAHRENHEIT: 102,\n    //   RADIANS: 103,\n    //   RADIANS_PER_SECOND: 184,\n    //   REVOLUTIONS_PER_MINUTE: 104,\n    //   SQUARE_METERS_PER_NEWTON: 185,\n    //   WATTS_PER_METER_PER_DEGREE_KELVIN: 189,\n    //   WATTS_PER_SQUARE_METER_DEGREE_KELVIN: 141,\n    //   PER_MILLE: 207,\n    //   GRAMS_PER_GRAM: 208,\n    //   KILOGRAMS_PER_KILOGRAM: 209,\n    //   GRAMS_PER_KILOGRAM: 210,\n    //   MILLIGRAMS_PER_GRAM: 211,\n    //   MILLIGRAMS_PER_KILOGRAM: 212,\n    //   GRAMS_PER_MILLILITER: 213,\n    //   GRAMS_PER_LITER: 214,\n    //   MILLIGRAMS_PER_LITER: 215,\n    //   MICROGRAMS_PER_LITER: 216,\n    //   GRAMS_PER_CUBIC_METER: 217,\n    //   MILLIGRAMS_PER_CUBIC_METER: 218,\n    //   MICROGRAMS_PER_CUBIC_METER: 219,\n    //   NANOGRAMS_PER_CUBIC_METER: 220,\n    //   GRAMS_PER_CUBIC_CENTIMETER: 221,\n    //   BECQUERELS: 222,\n    //   MEGABECQUERELS: 224,\n    //   GRAY: 225,\n    //   MILLIGRAY: 226,\n    //   MICROGRAY: 227,\n    //   SIEVERTS: 228,\n    //   MILLISIEVERTS: 229,\n    //   MICROSIEVERTS: 230,\n    //   MICROSIEVERTS_PER_HOUR: 231,\n    //   DECIBELS_A: 232,\n    //   NEPHELOMETRIC_TURBIDITY_UNIT: 233,\n    //   PH: 234,\n    //   GRAMS_PER_SQUARE_METER: 235,\n    //   MINUTES_PER_DEGREE_KELVIN: 236,\n    //   /* Enumerated values 0-255 are reserved for definition by ASHRAE. */\n    //   /* Enumerated values 256-65535 may be used by others subject to */\n    //   /* the procedures and constraints described in Clause 23. */\n    //   /* The last enumeration used in this version is 236. */\n    //   // MAX_UNITS: 237,\n    //   /* do the proprietary range inside of enum so that\n    //              compilers will allocate adequate sized datatype for enum\n    //              which is used to store decoding */\n    //   // PROPRIETARY_RANGE_MIN: 256,\n    //   // PROPRIETARY_RANGE_MAX: 65535\n    // };\n","import * as Bacnet from 'node-bacnet';\nimport {\n  ADD_DEVICE,\n  ADD_POINT,\n  GET_BACNET_CLIENT,\n  GET_NETWORK_SETTINGS,\n  GET_POINTS,\n  GET_PRESENT_VALUE,\n  REMOVE_DEVICE,\n  REMOVE_POINT,\n  SEND_PAYLOAD_TO_CHILD,\n  SEND_POINT_VALUE,\n  WRITE_PRESENT_VALUE,\n} from './bacnet-constant';\nimport { DeviceObject } from './interface';\nimport { PromiseActor } from '../../../../promise-actor';\n\nconst Logger = require('logplease');\nconst logger = Logger.create('bacnet-utils', { color: Logger.Colors.Grey });\n\nexport const singleton = new PromiseActor();\n\nexport default class BacnetUtils {\n  static getBacnetClient(networkNode): Bacnet {\n    if (networkNode && networkNode['subscribe']) {\n      return networkNode['subscribe'](this.createMessage(GET_BACNET_CLIENT));\n    } else {\n      logger.error('Network Node is not available on getBacnetClient');\n      return null;\n    }\n  }\n\n  static getPoints(deviceNode): Array<DeviceObject> {\n    if (deviceNode && deviceNode['subscribe']) {\n      return deviceNode['subscribe'](this.createMessage(GET_POINTS));\n    } else {\n      logger.error('Device Node is not available on getPoints');\n      return [];\n    }\n  }\n\n  static getPresentValue(deviceNode, payload): Promise<any> {\n    if (deviceNode && deviceNode['subscribe']) {\n      return deviceNode['subscribe'](this.createMessage(GET_PRESENT_VALUE, payload));\n    } else {\n      logger.error('Device Node is not available on getPresentValue');\n      return null;\n    }\n  }\n\n  static writePresentValue(deviceNode, payload) {\n    if (deviceNode && deviceNode['subscribe']) {\n      deviceNode['subscribe'](this.createMessage(WRITE_PRESENT_VALUE, payload));\n    } else {\n      logger.error('Device Node is not available on writePresentValue');\n    }\n  }\n\n  static getNetworkSettings(parentNode): any {\n    if (parentNode && parentNode['subscribe']) {\n      return parentNode['subscribe'](this.createMessage(GET_NETWORK_SETTINGS));\n    } else {\n      logger.error('Parent Node is not available on getNetworkSettings');\n      return null;\n    }\n  }\n\n  static sendPayloadToChild(childNode, payload) {\n    if (childNode && childNode['subscribe']) {\n      childNode['subscribe'](this.createMessage(SEND_PAYLOAD_TO_CHILD, payload));\n    } else {\n      logger.error('Child Node is not available on sendPayloadToChild');\n    }\n  }\n\n  static sendPointValue(pointNode, payload) {\n    if (pointNode && pointNode['subscribe']) {\n      pointNode['subscribe'](this.createMessage(SEND_POINT_VALUE, payload));\n    } else {\n      logger.error('Point Node is not available on sendPointValue');\n    }\n  }\n\n  static addDevice(networkNode, payload) {\n    if (networkNode && networkNode['subscribe']) {\n      networkNode['subscribe'](this.createMessage(ADD_DEVICE, payload));\n    } else {\n      logger.error('Network Node is not available on addDevice');\n    }\n  }\n\n  static removeDevice(networkNode, payload) {\n    if (networkNode && networkNode['subscribe']) {\n      networkNode['subscribe'](this.createMessage(REMOVE_DEVICE, payload));\n    } else {\n      logger.error('Network Node is not available on removeDevice');\n    }\n  }\n\n  static addPoint(deviceNode, payload) {\n    if (deviceNode && deviceNode['subscribe']) {\n      deviceNode['subscribe'](this.createMessage(ADD_POINT, payload));\n    } else {\n      logger.error('Device Node is not available on addPoint');\n    }\n  }\n\n  static removePoint(deviceNode, payload) {\n    if (deviceNode && deviceNode['subscribe']) {\n      deviceNode['subscribe'](this.createMessage(REMOVE_POINT, payload));\n    } else {\n      logger.error('Device Node is not available on removePoint');\n    }\n  }\n\n  private static createMessage(action, payload = null): any {\n    return { action, payload };\n  }\n}\n","import { isFunction } from './helper';\n\nconst logger = require('logplease').create('reliability', { color: 1 });\n\n//TODO: should be notify in frontend instead of using `alert`\nfunction logError(error, ...args: any[]) {\n  logger.error(error);\n  if (typeof alert !== 'undefined') {\n    alert(error.toString());\n  }\n}\n\nexport const ErrorHandler = (target: any, propertyKey: string, descriptor: any) => {\n  const fn = descriptor.value!;\n  descriptor.value = function DescriptorValue(...args: any[]) {\n    try {\n      return fn.apply(this, args);\n    } catch (error) {\n      logError(error, args);\n    }\n  };\n  return descriptor;\n};\n\nexport const ErrorCallbackHandler = (errHandler: Function) => {\n  return (target: any, propertyKey: string, descriptor: any) => {\n    const fn = descriptor.value!;\n    descriptor.value = function DescriptorValue(...args: any[]) {\n      try {\n        return fn.apply(this, args);\n      } catch (error) {\n        if (isFunction(errHandler)) {\n          errHandler(error, args);\n        } else {\n          logError(error, args);\n        }\n      }\n    };\n    return descriptor;\n  };\n};\n\nexport const AsyncErrorHandler = {};\n","module.exports = require(\"enumify\");","//\n// BACnet device implementation.\n// Utility functions.\n//\n\nconst bacnet = require('node-bacnet');\n\nclass Util {\n  /**\n   * Take an enum group and a value, and return the string text for that enum.\n   *\n   * @example\n   * // Both lines will output `PRESENT_VALUE`\n   * console.log(\n   *   getEnumName(\n   *     bacnet.enum.PropertyIdentifier,\n   *     bacnet.enum.PropertyIdentifier.PRESENT_VALUE\n   *   )\n   * );\n   * console.log(getEnumName(bacnet.enum.PropertyIdentifier, 85));\n   */\n  static getEnumName(group, value) {\n    return Object.keys(group).find(key => group[key] === value) + '(' + value + ')';\n  }\n\n  /**\n   * Helper function for property values.\n   */\n  static getPropName(propertyId) {\n    return Util.getEnumName(bacnet.enum.PropertyIdentifier, propertyId);\n  }\n}\n\nmodule.exports = Util;\n","module.exports = require(\"mqtt\");","import { PointOutput } from '../../../../backend/models/point-model';\nimport { IMessageSubscriber, NodeStoreItem, Observer } from '../../../../utils/pattern';\nimport { Container, Side } from '../../../container';\nimport { NodeSettings, SettingType} from '../../../node';\nimport { Type } from '../../../node-io';\nimport Registry from '../../../registry';\nimport CryptoUtils from '../../../utils/crypto-utils';\nimport { ConnectionOutput, DependantConnectionNode } from '../connection-node-mixin';\nimport { CentralizedPointOutputObserver, HasPointOutputObservers } from '../model/point-node';\nimport { ProtocolDeviceNode } from '../ProtocolDeviceNode';\nimport { DefaultMqttClient, MqttClientWrapper } from './core/mqtt-device';\nimport { MQTTMessage, SillyMqttPoint } from './core/mqtt-model';\nimport { MqttPointStoreItem, MqttPublisherStore, MqttSubscriberStore } from './mqtt-client-node-store';\n\nexport const MQTT_CLIENT_NODE = 'protocols/mqtt/mqtt-network';\nexport const REGISTER_MQTT_PUBLISHER = 'REGISTER_MQTT_PUBLISHER';\nexport const UNREGISTER_MQTT_PUBLISHER = 'UNREGISTER_MQTT_PUBLISHER';\nexport const UPDATE_MQTT_PUBLISHER = 'UPDATE_MQTT_PUBLISHER';\nexport const PUBLISH_MQTT_DATA = 'PUBLISH_MQTT_DATA';\nexport const REGISTER_MQTT_SUBSCRIBER = 'REGISTER_MQTT_SUBSCRIBER';\nexport const UPDATE_MQTT_SUBSCRIBER = 'UPDATE_MQTT_SUBSCRIBER';\nexport const UNREGISTER_MQTT_SUBSCRIBER = 'UNREGISTER_MQTT_SUBSCRIBER';\nexport const REGISTER_MQTT_POINT = 'REGISTER_MQTT_POINT';\nexport const UPDATE_MQTT_POINT = 'UPDATE_MQTT_POINT';\nexport const UNREGISTER_MQTT_POINT = 'UNREGISTER_MQTT_POINT';\n\nclass MqttCentralizedPointOutputObserver extends CentralizedPointOutputObserver<SillyMqttPoint> {\n\n  protected convert(data: PointOutput<SillyMqttPoint>): object {\n    let output = {};\n    output[data.point.identifier()] = {\n      publisherTopic : data.point.publishedTopic(),\n      subscriberTopic: data.point.subscribedTopic(),\n      pointValue     : data.point.pointValue,\n      status         : data.connStatus.status.label,\n      error          : data.connStatus.error,\n    };\n    return output;\n  }\n\n}\n\n/**\n * It resolves one mqtt client per host\n */\nclass MqttClientNode extends ProtocolDeviceNode implements HasPointOutputObservers<SillyMqttPoint>, IMessageSubscriber {\n\n  private readonly _oTopicsSlot = 2;\n  private publishers: MqttPublisherStore = new MqttPublisherStore();\n  private subscribers: MqttSubscriberStore = new MqttSubscriberStore();\n  private mqttClient: MqttClientWrapper = null;\n  //TODO: should implement queue properly\n  private retriedItems: { action: string; payload: any }[] = [];\n\n  constructor(container) {\n    super(container, `MQTT Network`,\n          'This node acts as a container for MQTT nodes. ' +\n          'All MQTT nodes should be added within the MQTT-Network container. ' +\n          'The MQTT broker details can be configured in settings.',\n    );\n    this.mixinEnableInputSetting();\n    this.settings['server'] = { description: 'Broker URL', value: 'localhost', type: SettingType.STRING };\n    this.settings['port'] = { description: 'Broker port', value: 1883, type: SettingType.NUMBER };\n    this.settings['authentication'] = { description: 'Use Authentication', value: false, type: SettingType.BOOLEAN };\n    this.settings['username'] = { description: 'User name', value: '', type: SettingType.STRING };\n    this.settings['password'] = { description: 'Password', value: '', type: SettingType.PASSWORD };\n\n    this.setSettingsConfig({\n                             groups    : [\n                               { server: { weight: 3 }, port: { weight: 1 } },\n                               { enable: {}, authentication: {} },\n                               { username: {}, password: {} },\n                             ],\n                             conditions: {\n                               username: setting => !!setting['authentication'].value,\n                               password: setting => !!setting['authentication'].value,\n                             },\n                           });\n    this.addOutput('topics', Type.JSON);\n  }\n\n  private static createMqttConnectionOptions(settings: { [name: string]: NodeSettings }) {\n    const options: any = { host: settings['server'].value };\n\n    const port = settings['port'].value;\n    const username = settings['username'].value;\n    const password = settings['password'].value;\n\n    if (port != null) options.port = port;\n    if (username != null && username != '') options.username = username;\n    if (password != null && password != '') options.password = CryptoUtils.decrypt(password);\n    return options;\n  }\n\n  pointObservers(): Observer<PointOutput<SillyMqttPoint>>[] {\n    return [new MqttCentralizedPointOutputObserver(this, this._oTopicsSlot)];\n  }\n\n  listen({ action, payload }: { action: string; payload: NodeStoreItem }): any {\n    this.debugInfo(`Handling ${action}:${payload.identifier}...`);\n    switch (action) {\n      case REGISTER_MQTT_POINT:\n        return this.registerMqttPoint(payload);\n      case UPDATE_MQTT_POINT:\n        return this.updateMqttPoint(payload);\n      case UNREGISTER_MQTT_POINT:\n        return this.unregisterMqttPoint(payload);\n      case REGISTER_MQTT_PUBLISHER:\n        return this.publishers.register(payload);\n      case UPDATE_MQTT_PUBLISHER:\n        return this.publishers.update(payload, null, (p, force?: boolean) => this.afterUnregister(p, force));\n      case UNREGISTER_MQTT_PUBLISHER:\n        return this.publishers.unregister(payload, true, p => this.afterUnregister(p, true));\n      case REGISTER_MQTT_SUBSCRIBER:\n        return this.registerMqttSubscriber(payload);\n      case UPDATE_MQTT_SUBSCRIBER:\n        return this.updateMqttSubscriber(payload);\n      case UNREGISTER_MQTT_SUBSCRIBER:\n        return this.unregisterMqttSubscriber(payload);\n      case PUBLISH_MQTT_DATA:\n        return this.publishMqttData(payload);\n      default:\n        this.debugWarn('Request action doesn\\'t match');\n    }\n  }\n\n  connObserverNodes(): Observer<ConnectionOutput>[] {\n    let nodeIds = [...new Set(this.publishers.listNodeIds().concat(this.subscribers.listNodeIds()))];\n    return nodeIds.map(id => Registry._nodes[id])\n                  .filter(n => n)\n                  .map(n => (<DependantConnectionNode><unknown>n).statusObserver());\n  }\n\n  isConnConnected(): boolean {\n    return this.mqttClient?.isConnected();\n  }\n\n  onReceiveMessage(msg: MQTTMessage): void {\n    if (this.side !== Side.server) return;\n    let subscribersByTopic = this.subscribers.lookup(msg.topic);\n    if (!subscribersByTopic) {\n      this.debug(`Not found any subscriber on MQTT topic '${msg.topic}'`);\n      return;\n    }\n    Object.entries(subscribersByTopic).forEach(([nodeId, val]) => {\n      if (!val?.enabled) {\n        return;\n      }\n      let node = Registry._nodes[nodeId];\n      if (!node) {\n        this.debugWarn(`MQTT topic '${msg.topic}' is subscribed by Node ${nodeId} that not found`);\n        return;\n      }\n      try {\n        this.debugInfo(`Dispatch message on MQTT topic '${msg.topic}' to Node Id '${nodeId}'`);\n        val.func(msg.message);\n      } catch (e) {\n        this.debugWarn(`Message on MQTT topic '${msg.topic}' cannot be dispatched due to ${e}`);\n      }\n    });\n  }\n\n  protected createThenStart() {\n    const options = MqttClientNode.createMqttConnectionOptions(this.settings);\n    options.clientId = `mqttjs_wires_cid_${this.container.id}_id${this.id}`;\n    this.mqttClient = DefaultMqttClient.init(\n      options,\n      (client: MqttClientWrapper) => this.retryConnection(client),\n      (client: MqttClientWrapper, msg?: string) => this.updateClientStatus(client, msg),\n      (msg: MQTTMessage) => this.onReceiveMessage(msg),\n    );\n  }\n\n  protected stop(): void {\n    if (this.mqttClient) {\n      this.mqttClient.stop();\n      this.mqttClient = null;\n    }\n  }\n\n  private updateClientStatus(client: MqttClientWrapper, errMsg?: string): void {\n    this.notifyConnStatusOutput(this.getConnectionStatus(), errMsg);\n  }\n\n  private retryConnection(client: MqttClientWrapper): void {\n    this.debugInfo('Retry connection after MQTT client connected...');\n    //TODO dirty fix to avoid infinite loop\n    let count = 0,\n        max   = 500;\n    while (this.retriedItems.length > 0 && count < max) {\n      this.listen(this.retriedItems.shift());\n      count++;\n    }\n    this.updateClientStatus(client);\n  }\n\n  private publishMqttData(payload: NodeStoreItem): any {\n    if (this.side !== Side.server || !payload?.enabled) {\n      return null;\n    }\n    if (!this.isConnConnected()) {\n      payload.lenient = true;\n      this.retriedItems.push({ action: PUBLISH_MQTT_DATA, payload: payload });\n      return null;\n    }\n    let converter = this.publishers.lookup(payload?.identifier)?.func;\n    this.mqttClient.publish(payload?.identifier, converter ? converter(payload?.data) : payload?.data?.toString());\n    return payload?.data;\n  }\n\n  private registerMqttSubscriber(payload: NodeStoreItem) {\n    if (!this.isConnConnected()) {\n      payload.lenient = true;\n      this.retriedItems.push({ action: REGISTER_MQTT_SUBSCRIBER, payload: payload });\n      return;\n    }\n    this.subscribers.register(payload, p => this.mqttClient.subscribe(p?.identifier));\n  }\n\n  private unregisterMqttSubscriber(payload: NodeStoreItem) {\n    if (!this.isConnConnected()) {\n      payload.lenient = true;\n      this.retriedItems.push({ action: UNREGISTER_MQTT_SUBSCRIBER, payload: payload });\n      return;\n    }\n    this.subscribers.unregister(payload, true, p => {\n      this.mqttClientDoUnsubscribe(p);\n      this.afterUnregister(p, true);\n    });\n  }\n\n  private updateMqttSubscriber(payload: NodeStoreItem) {\n    if (!this.isConnConnected()) {\n      payload.lenient = true;\n      this.retriedItems.push({ action: UPDATE_MQTT_SUBSCRIBER, payload: payload });\n      return;\n    }\n    this.subscribers.update(payload, p => this.mqttClient.subscribe(p?.identifier),\n                            (p, force?: boolean) => {\n                              this.mqttClientDoUnsubscribe(p);\n                              this.afterUnregister(p, force);\n                            });\n  }\n\n  private mqttClientDoUnsubscribe(payload: NodeStoreItem) {\n    if (!this.subscribers.has(payload.identifier, (k, v) => v?.enabled)) {\n      this.mqttClient.unsubscribe(payload?.identifier);\n    }\n  }\n\n  private registerMqttPoint(payload: NodeStoreItem) {\n    let item = payload as MqttPointStoreItem;\n    let d = this.listen({ action: REGISTER_MQTT_PUBLISHER, payload: item.toPublisher() });\n    this.listen({ action: REGISTER_MQTT_SUBSCRIBER, payload: item.toSubscriber() });\n    return d;\n  }\n\n  private unregisterMqttPoint(payload: NodeStoreItem) {\n    let item = payload as MqttPointStoreItem;\n    let d = this.listen({ action: UNREGISTER_MQTT_PUBLISHER, payload: item.toPublisher() });\n    this.listen({ action: UNREGISTER_MQTT_SUBSCRIBER, payload: item.toSubscriber() });\n    this.afterUnregister(payload, true);\n    return d;\n  }\n\n  private updateMqttPoint(payload: NodeStoreItem) {\n    let item = payload as MqttPointStoreItem;\n    try {\n      return this.listen({ action: UPDATE_MQTT_PUBLISHER, payload: item.toPublisher() });\n    } finally {\n      this.listen({ action: UPDATE_MQTT_SUBSCRIBER, payload: item.toSubscriber() });\n    }\n  }\n\n  private afterUnregister(payload: NodeStoreItem, force: boolean): void {\n    if (force) {\n      let output = this.outputs[this._oTopicsSlot].data;\n      if (output) {\n        delete output[payload.identifier];\n      }\n      this.setOutputData(this._oTopicsSlot, output);\n    }\n  }\n}\n\nContainer.registerNodeType(MQTT_CLIENT_NODE, MqttClientNode);\n","module.exports = require(\"cron\");","module.exports = require(\"jsonata\");","module.exports = require(\"cronstrue\");","import { Container, Side } from './container';\nimport { Node, SerializedNode } from './node';\nimport { UNKNOWN_NODE } from './constants';\n\nexport default class ContainerUtils {\n  static getSortedAvailableContainers(nodes): Array<number> {\n    let containersIds: Array<number> = nodes.map(node => +node.cid);\n    let subContainerIds: Array<number> = nodes\n      .filter(node => node.sub_container !== undefined)\n      .map(node => +node.sub_container.id);\n    containersIds = [...new Set([...containersIds, ...subContainerIds])];\n    containersIds.sort((a, b) => a - b);\n    return containersIds;\n  }\n\n  static fallbackNodeIfDoesNotExist(nodes) {\n    return nodes.map(node => {\n      let node_class = Container.nodes_types[node.type];\n      if (!node_class) {\n        node.type = UNKNOWN_NODE;\n      }\n      return node;\n    });\n  }\n\n  static addInputsLinkNodes(createdNodes: Array<Node>, nodesWithLinks, updateInput?) {\n    createdNodes.forEach(node => {\n      node.inputs &&\n        Object.keys(node.inputs).forEach(key => {\n          let isChanged: boolean = false;\n          let nodeWithLink = nodesWithLinks.find(n => n.id === node.id && n.cid === node.cid);\n          if (nodeWithLink.inputs && nodeWithLink.inputs[key] && nodeWithLink.inputs[key].link) {\n            const link = nodeWithLink.inputs[key].link;\n            const connectedNode = createdNodes.find(n => n.id === link.target_node_id && n.cid === nodeWithLink.cid);\n            if (\n              connectedNode && // when Move To Container\n              connectedNode.outputs &&\n              connectedNode.outputs[link.target_input_id ?? link.target_slot]\n            ) {\n              node.inputs[key].link = nodeWithLink.inputs[key].link;\n              isChanged = true;\n            }\n          }\n          if (isChanged && updateInput) {\n            updateInput(node);\n          }\n        });\n    });\n  }\n\n  static addOutputsLinkNodes(createdNodes: Array<Node>, nodesWithLinks, updateOutputs?) {\n    createdNodes.forEach(node => {\n      node.outputs &&\n        Object.keys(node.outputs).forEach(key => {\n          let isChanged: boolean = false;\n          let nodeWithLink = nodesWithLinks.find(n => n.id === node.id && n.cid === node.cid);\n          if (nodeWithLink && nodeWithLink.outputs && nodeWithLink.outputs[key] && nodeWithLink.outputs[key].links) {\n            const links = nodeWithLink.outputs[key].links;\n            links.forEach(link => {\n              const connectedNode = createdNodes.find(n => n.id === link.target_node_id && n.cid === nodeWithLink.cid);\n              if (\n                connectedNode && // when Move To Container\n                connectedNode.inputs &&\n                connectedNode.inputs[link.target_input_id ?? link.target_slot]\n              ) {\n                if (!node.outputs[key].links) {\n                  node.outputs[key].links = [];\n                }\n                node.outputs[key].links.push(link);\n                isChanged = true;\n              }\n            });\n          }\n          if (isChanged && updateOutputs) {\n            updateOutputs(node);\n          }\n        });\n    });\n  }\n\n  static addSettingsProperties(node: Node, settings) {\n    Object.keys(settings).forEach(key => {\n      if (node.settings && node.settings[key]) {\n        node.settings[key].value = settings[key].value;\n      }\n    });\n  }\n\n  static addSettingsValues(importedNodes: Array<Node>, originalNodes, updateSettings?) {\n    let serializedNodes: Array<SerializedNode> = [];\n    importedNodes.forEach(node => {\n      let originalNode = originalNodes.find(n => n.id == node.id);\n      Object.keys(node.settings).forEach(key => {\n        let isChanged: boolean = false;\n        if (\n          originalNode &&\n          originalNode.settings &&\n          originalNode.settings[key] &&\n          originalNode.settings[key].value != null\n        ) {\n          node.settings[key].value = originalNode.settings[key].value;\n          isChanged = true;\n        }\n        if (isChanged && updateSettings) {\n          updateSettings(node);\n        }\n      });\n      serializedNodes.push(node.serialize());\n    });\n    return serializedNodes;\n  }\n\n  static removeBrokenLinks(container: Container) {\n    const nodes = container._nodes;\n    for (let id in nodes) {\n      const node = nodes[id];\n      node.outputs &&\n        Object.keys(node.outputs).map(key => {\n          let output = node.outputs[key];\n          if (output && output.links) {\n            node.outputs[key].links = output.links.filter(link => {\n              return container.getNodeById(link.target_node_id);\n            });\n          }\n        });\n\n      if (node.inputs) {\n        node.inputs = Object.keys(node.inputs).map(key => {\n          let input = node.inputs[key];\n          if (input && input.link) {\n            if (!container.getNodeById(input.link.target_node_id)) {\n              delete node.inputs[key].link;\n            }\n          }\n          return input;\n        });\n        if (container.db) {\n          container.db.updateNode(node.id, node.cid, {\n            $set: { inputs: node.inputs, outputs: node.outputs },\n          });\n        }\n        continue;\n      }\n\n      if (container.db) {\n        container.db.updateNode(node.id, node.cid, {\n          $set: { outputs: node.outputs },\n        });\n      }\n    }\n  }\n\n  /**\n   * Exported nodes will be remapped into new ids for importing on same container\n   * This will be applied for those nodes cid == req.params.cid\n   * @param container\n   * @param nodes\n   * @param cid {number}\n   * @param lastNodeId {number}\n   * @returns nodes\n   */\n  static remapNodesId(container: Container, nodes, cid: number, lastNodeId: number): any {\n    const nodesIdMap = {};\n    nodes.forEach(node => {\n      nodesIdMap[node.id] = ++lastNodeId;\n    });\n    // Update last_node_id\n    if (cid === 0) {\n      container.db.updateLastRootNodeId(lastNodeId);\n    } else {\n      container.db.updateNode(container.container_node.id, container.container_node.container.id, {\n        $set: { 'sub_container.last_node_id': lastNodeId },\n      });\n    }\n    container.last_node_id = lastNodeId;\n    return nodes.map(node => {\n      node.id = nodesIdMap[node.id];\n      // Relinking outputs with new ids\n      node.outputs &&\n        Object.keys(node.outputs).map(key => {\n          let output = node.outputs[key];\n          if (output && output.links) {\n            output.links = output.links\n              .filter(link => nodesIdMap[link.target_node_id] !== undefined)\n              .map(link => {\n                link.target_node_id = nodesIdMap[link.target_node_id];\n                return link;\n              });\n          }\n          node.outputs[key] = output;\n        });\n      // Relinking inputs with new ids\n      node.inputs &&\n        Object.keys(node.inputs).map(key => {\n          let input = node.inputs[key];\n          if (input && input.link) {\n            if (nodesIdMap[input.link.target_node_id]) {\n              input.link.target_node_id = nodesIdMap[input.link.target_node_id];\n              node.inputs[key] = input;\n            } else {\n              delete node.inputs[key].link;\n            }\n          }\n        });\n      return node;\n    });\n  }\n\n  static updateSubContainerLastNodeId(container: Container, lastNodeId: number) {\n    container.db.updateNode(container.container_node.id, container.container_node.container.id, {\n      $set: { 'sub_container.last_node_id': lastNodeId },\n    });\n  }\n\n  /**\n   * Exported containers will be mapped as a new container and other existing nodes will be added on rootContainer\n   * @param container\n   * @param nodes\n   * @param paramsCid\n   * @param firstCid\n   * @param allNew {boolean} true for move operation\n   * @returns {nodes, convertedParamsCid}\n   */\n  static remapContainersId(\n    container: Container,\n    nodes,\n    paramsCid: number,\n    firstCid: number,\n    allNew: boolean = false,\n  ): any {\n    const containersIdMap = {};\n    let lastContainerId = Container.last_container_id;\n    if (allNew) {\n      containersIdMap[paramsCid] = ++lastContainerId;\n    } else {\n      containersIdMap[firstCid] = paramsCid;\n    }\n    nodes.forEach(node => {\n      if (node.sub_container) {\n        if (!containersIdMap[node.sub_container.id]) {\n          containersIdMap[node.sub_container.id] = ++lastContainerId;\n        }\n      }\n    });\n    Container.last_container_id = lastContainerId;\n    container.db.updateLastContainerId(lastContainerId);\n    nodes = nodes.map(node => {\n      node.cid = containersIdMap[node.cid];\n      if (node.sub_container) node.sub_container.id = containersIdMap[node.sub_container.id];\n      return node;\n    });\n    return { nodes, convertedParamsCid: containersIdMap[paramsCid] };\n  }\n\n  static adjustPosition(container: Container, containerNodes, pos, isCloned): any {\n    const minImportXCoordinate = Math.min(...containerNodes.map(node => node.pos[0]));\n    const minImportYCoordinate = Math.min(...containerNodes.map(node => node.pos[1]));\n\n    let startingXCoordinate;\n    let startingYCoordinate;\n    if (isCloned) {\n      startingXCoordinate = 0;\n      startingYCoordinate = pos[1] - minImportYCoordinate + 100;\n    } else {\n      startingXCoordinate = pos[0] - minImportXCoordinate;\n      startingYCoordinate = pos[1] - minImportYCoordinate;\n    }\n\n    containerNodes.forEach(node => {\n      node.pos[0] += startingXCoordinate;\n      node.pos[1] += startingYCoordinate;\n    });\n    return containerNodes;\n  }\n\n  static sortNodes(nodes) {\n    nodes.sort((a, b) => a.id - b.id);\n  }\n\n  static createContainersIfDoesNotExist(containerIds, side: Side) {\n    containerIds.forEach(cid => {\n      if (!Container.containers[cid]) Container.containers[cid] = new Container(side, cid);\n    });\n  }\n\n  static reRenderNodes(resCid, nodes): Node[] {\n    const containersIds = ContainerUtils.getSortedAvailableContainers(nodes);\n    Container.last_container_id = containersIds[containersIds.length - 1];\n    const selectedNodes: Array<Node> = [];\n    const createdNodes: Array<Node> = [];\n    ContainerUtils.createContainersIfDoesNotExist(containersIds, Side.editor);\n    let isFirstContainer = true;\n    containersIds.forEach(cid => {\n      let containerNodes = nodes.filter(node => node.cid === cid);\n      containerNodes.sort((a, b) => a.id - b.id);\n      containerNodes.forEach(node => {\n        const container = Container.containers[node.cid];\n        const n: Node = container.createNode(node.type, node, null, true);\n        if (resCid == cid) {\n          selectedNodes.push(n);\n        }\n        createdNodes.push(n);\n        container.last_node_id = n.id;\n      });\n      isFirstContainer = false;\n    });\n    ContainerUtils.addInputsLinkNodes(createdNodes, nodes);\n    ContainerUtils.addOutputsLinkNodes(createdNodes, nodes);\n    ContainerUtils.addSettingsValues(createdNodes, nodes);\n    return selectedNodes;\n  }\n}\n","import { AxiosResponse, default as axios } from 'axios';\nimport { get } from 'lodash';\nimport config from '../config';\nimport { Entry } from './entry';\n\nexport abstract class Api<T extends Entry> {\n  protected client = axios.create({ baseURL: config.backendSync.baseUrl });\n\n  abstract list(objId?: string): Promise<T[]>;\n\n  abstract get(objId: string): Promise<T[]>;\n\n  abstract create(obj: T, parentId?: string): Promise<any>;\n\n  abstract update(obj: T, objId?: string): Promise<any>;\n\n  abstract delete(objId: string): Promise<any>;\n\n  abstract factoryEntry(): T;\n\n  protected fetchMany(url: string, respKey?: string): Promise<T[]> {\n    return this.client.get(url).then(this.extractData(respKey)).then(this.assignAllTo(() => this.factoryEntry()));\n  }\n\n  protected fetchOne(url: string, respKey?: string) {\n    return this.client.get(url).then(this.extractData(respKey)).then(p => Object.assign(this.factoryEntry(), p));\n  }\n\n  protected newEntry<T>(c: new () => T): T {\n    return new c();\n  }\n\n  protected extractData<T>(path: string = null) {\n    return (response: AxiosResponse<T>) => (path ? get(response.data, path) : response.data);\n  }\n\n  /**\n   * Create a provided class instance using a factory method, for all given elements, and merge each element\n   * into the class instance.\n   *\n   * Higher-order function\n   */\n  protected assignAllTo<T>(factory: () => T) {\n    return (properties: any[]): T[] => properties.map(p => Object.assign(factory(), p));\n  }\n}\n","import { get, isEqual } from 'lodash';\nimport { Api } from '../../../../backend/api';\nimport { Entry } from '../../../../backend/entry';\nimport config from '../../../../config';\nimport { singleton as actor } from '../../../../promise-actor';\nimport { IOT_TYPES } from '../../../constants';\nimport { Container, Side } from '../../../container';\nimport { ContainerNode } from '../../../container-node';\nimport { BROADCAST, Node, SettingType } from '../../../node';\nimport EntryNode from './entry-node';\nimport Mixin from './mixin';\n\n/**\n *\n * @param <T> Type of the Entry that this container manages\n */\nexport default abstract class ApiContainerNode<T extends Entry> extends ContainerNode implements EntryNode<T> {\n  extra_node_types = this.childNodeType().filter(v => IOT_TYPES.includes(v));\n  properties: {\n    entry: T;\n    is_protected: boolean;\n  };\n  clonable = false;\n  movable = false;\n  settingFields: {};\n  entry = Mixin.prototype.entry.bind(this);\n  entryId = Mixin.prototype.entryId.bind(this);\n  deactivate = Mixin.prototype.deactivate.bind(this);\n  createSettingForm = Mixin.prototype.createSettingForm.bind(this);\n  getTakenIdentifiers = Mixin.prototype.getTakenIdentifiers.bind(this);\n  makeIdentifier = Mixin.prototype.makeIdentifier.bind(this);\n  findFreeIdentifier = Mixin.prototype.findFreeIdentifier.bind(this);\n  protected api: Api<T>;\n\n  constructor(container: Container) {\n    super(container);\n    this.description = 'placeholder'; // FIXME\n    this.api = this.initAPI();\n    this.settings['name'] = {\n      description: 'Entry',\n      value      : this.title,\n      type       : SettingType.READONLY,\n    };\n  }\n\n  abstract namePrefix(): string;\n\n  abstract createEntry(): Promise<T>;\n\n  entryFactory(): T {\n    return this.api.factoryEntry();\n  }\n\n  updateEntry(body: T): Promise<any> {\n    return this.api.update(body, this.entryId());\n  }\n\n  deleteEntry(): Promise<any> {\n    return this.api.delete(this.entryId());\n  }\n\n  onAdded() {\n    Mixin.prototype.onAdded.call(this);\n    super.onAdded();\n  }\n\n  applyEntry(entry: T) {\n    Mixin.prototype.applyEntry.call(this, entry);\n    this.applyTitle();\n    this.broadcastTitleToClients();\n  }\n\n  applyTitle() {\n    this.sub_container.name = this.title;\n    this.size = this.computeSize();\n    this.container.runWithEditor(e => {\n      if (get(e, 'renderer.container.id') === this.container.id) {\n        e.emit('rerender-siderbar-containers');\n      }\n    });\n  }\n\n  onAfterSettingsChange(old) {\n    Mixin.prototype.onAfterSettingsChange.call(this);\n    super.onAfterSettingsChange(old);\n  }\n\n  onCreated() {\n    super.onCreated();\n    const namePrefix = this.namePrefix();\n    const nameSuffix = this.entry() ? ' ' + this.entryId() : '';\n    this.settings['name'].value = namePrefix + nameSuffix;\n    Mixin.prototype.onCreated.call(this);\n  }\n\n  onRemoved() {\n    Mixin.prototype.onRemoved.call(this);\n  }\n\n  shouldRejectNodeType(type: string): boolean {\n    // reject all IoT nodes as children, except the correct hierarchical child node type. Allow all others\n    return !this.childNodeType().includes(type);\n  }\n\n  syncWithBackend() {\n    if (this.side !== Side.server) return;\n    actor.process(() => this.fetchChildren().then(children => {\n                    const childIds = children.map(v => v.entryId());\n                    const childNodes = this.collectChildNodes(this.sub_container.getNodes()).map(\n                      n => n as EntryNode<Entry>);\n                    const existingChildNodes = childNodes.filter(n => childIds.includes(n.entryId()));\n                    const obsoleteChildNodes = childNodes.filter(\n                      n => !n.properties.is_protected && !childIds.includes(n.entryId()),\n                    );\n                    obsoleteChildNodes.forEach(n => {\n                      n.deactivate();\n                      n.container.removeBroadcasted(n);\n                    });\n                    this.processNextChildEntry(children, existingChildNodes);\n                  }),\n    );\n  }\n\n  onGetMessageToEditorSide({ action, payload }) {\n    super.onGetMessageToEditorSide({ action, payload, key: null });\n    if (action === BROADCAST.UPDATE_TITLE) this.applyTitle();\n  }\n\n  protected abstract initAPI(): Api<T>;\n\n  protected abstract childNodeType(): string[];\n\n  /**\n   * Fetch all current child entries of the main entry from the remote API\n   */\n  protected abstract fetchChildren(): Promise<Entry[]>;\n\n  /**\n   * When given an array of child-nodes, returns only the nodes that manage child entries of the main entry\n   */\n  protected abstract collectChildNodes(nodes: Node[]): Node[];\n\n  /**\n   * Recursively and asynchronously processes the next of the remaining entries from the remote API\n   */\n  protected processNextChildEntry(remaining: Entry[], childNodes: EntryNode<Entry>[]) {\n    if (!remaining || remaining.length === 0) return;\n    const entry = remaining.pop();\n    let existingNode = childNodes.find(node => node.entryId() === entry.entryId());\n    const callback = () => {\n      if (existingNode instanceof ApiContainerNode) {\n        (<ApiContainerNode<any>>existingNode).syncWithBackend();\n      }\n      this.processNextChildEntry(remaining, childNodes);\n    };\n    if (!existingNode) {\n      // console.log('Creating child node for ' + this.title + ' ' + (entry.entryId() || ''));\n      const maxVerticalPosition = Math.max(100, ...this.sub_container.getNodes(false).map(n => n.pos[1]));\n      const pos = [250, maxVerticalPosition + config.backendSync.nodeDistance];\n      // existingNode is used above! Leave this reassignment:\n      existingNode = <EntryNode<Entry>>(\n        this.sub_container.createNode(entry.nodeType(), { properties: { entry }, pos }, null, false, callback)\n      );\n    } else if (!isEqual(existingNode.entry(), entry)) {\n      // console.log('Found existing node with outdated entry, updating...');\n      existingNode.applyEntry(entry);\n      existingNode.persistConfiguration(callback);\n    } else {\n      callback();\n    }\n  }\n}\n","import { Entry } from '../../../../backend/entry';\nimport ApiContainerNode from './api-container-node';\n\n/**\n * Container node that contains a collection of API synced child nodes, but has itself no entity\n * or parent\n */\nexport default abstract class TopLevelApiContainerNode<C extends Entry> extends ApiContainerNode<C> {\n  settingFields = {};\n\n  entryFactory = () => null;\n\n  applyEntry = () => {\n    // Top level container's entry is always 'null'\n    this.title = this.namePrefix();\n    this.sub_container.name = this.title;\n  };\n\n  onAdded = () => {\n    this.ignore_remove = true;\n    this.removable = false;\n    this.movable = false;\n    this.applyEntry();\n    this.syncWithBackend();\n  };\n\n  createEntry = () => Promise.resolve(null);\n\n  updateEntry = (body: any) => Promise.resolve(null);\n\n  deleteEntry = () => Promise.resolve(null);\n\n  namePrefix = () => this.title;\n\n  getTakenIdentifiers = () => Promise.resolve([]);\n\n  makeIdentifier = (n: number): string => null;\n\n  findFreeIdentifier = (): Promise<string> => Promise.resolve(null);\n}\n","module.exports = require(\"lodash-decorators/debounce\");","module.exports = require(\"socket.io\");","import app from '../app';\n\nconst schemaMiddleware = (schema, property) => {\n  return (req, res, next) => {\n    const { error } = schema.validate(req[property]);\n    const valid = error == null;\n    if (valid) {\n      next();\n    } else {\n      const { details } = error;\n      const message = details.map(i => i.message).join(',');\n      res.status(422).json({ error: message });\n    }\n  };\n};\n\nconst isAuthenticated = async (token: string): Promise<boolean> => {\n  try {\n    await app.db.isAuthenticated(token);\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n\nconst authMiddleware = () => {\n  return async (req, res, next) => {\n    const token = req.headers['token'];\n    if (!token) {\n      res.status(403).json({ error: 'Please provide token' });\n      return;\n    }\n    if (await isAuthenticated(token)) {\n      next();\n    } else {\n      res.status(403).json({ error: 'Please provide valid token' });\n    }\n  };\n};\n\nexport { schemaMiddleware, authMiddleware };\n","\nimport { Container } from '../../container';\nimport { ContainerNode } from '../../container-node';\n\nexport const CONTAINER_NODE_TYPE = 'container/folder';\n\n//Container: a node that contains a container of other nodes\nContainer.registerNodeType(CONTAINER_NODE_TYPE, ContainerNode, null, true, true);\n","import { isNotNull, isNull } from '../../../utils/helper';\nimport { Side } from '../../container';\nimport { Node } from '../../node';\nimport Icons from '../../node-icons';\nimport { NodeIO } from '../../node-io';\n\nexport abstract class AbstractFolderIONode extends Node {\n\n  protected constructor(container, title: string, description: string) {\n    super(container);\n    this.title = title;\n    this.description = description;\n    this.iconImageUrl = Icons.aiIcon;\n  }\n\n  onAdd() {\n    // To backward compatible\n    if (!this.isUnderContainer() || isNull(this.properties['slot']) || this.properties['slot'] === -1) return;\n    let slot = this.properties['slot'];\n    delete this.properties['slot'];\n    this.emitChange(this, 'properties');\n    this.correctParentIO(this.container.container_node, slot);\n  }\n\n  abstract onCreated();\n\n  abstract onRemoved();\n\n  abstract onAfterSettingsChange();\n\n  protected abstract correctParentIO(containerNode: Node, slot: number);\n\n  protected isUnderContainer() {\n    return isNotNull(this.container.container_node);\n  }\n\n  protected emitChange(node: Node, ...properties) {\n    if (node.side === Side.server) {\n      let s_node = node.serialize();\n      let updated = properties.reduce((o, prop) => ((o[prop] = s_node[prop]), o), {});\n      node.container.db.updateNode(node.id, node.container.id, { $set: updated });\n    }\n  }\n\n  protected findParentOutputById(containerNode: Node, inputOrOutput: string) {\n    return Object.entries(containerNode[inputOrOutput])\n                 .find(([_, io]) => this.id === (<NodeIO>io).subNodeId) ?? [null, null];\n  }\n\n}\n","import { NodeSettings } from '../node';\n\nexport default class SettingUtils {\n  /**\n   * Inserts new setting into specific position in this.settings\n   * @returns {object}\n   */\n  static insertIntoObjectAtPosition(\n    object: { [name: string]: NodeSettings },\n    insert: object,\n    after: string = '',\n    before: string = '',\n  ): { [name: string]: NodeSettings } {\n    if (before === '' && after === '') {\n      // add to end\n      Object.assign(object, insert);\n      return object;\n    }\n    // Create a temp object and index variable\n    const newObj = {};\n    let insertAfter = false;\n    const matchBoth = before !== '' && after !== '';\n    let foundFlag = false;\n\n    // Loop through the original object\n    for (let prop in object) {\n      if (object.hasOwnProperty(prop)) {\n        // look for matches for before and after keys\n        if (!foundFlag && matchBoth && insertAfter && before === prop) {\n          Object.assign(newObj, insert);\n          foundFlag = true;\n          insertAfter = false;\n        } else if (!foundFlag && !matchBoth && (insertAfter || before === prop)) {\n          Object.assign(newObj, insert);\n          foundFlag = true;\n          insertAfter = false;\n        } else if (!foundFlag && prop === after) {\n          insertAfter = true;\n        }\n        // Add the current item in the loop\n        newObj[prop] = object[prop];\n      }\n    }\n    if (!foundFlag) Object.assign(newObj, insert);\n\n    return newObj;\n  }\n}\n","let TAGNAME = {\n  CHILLER: 'Chiller',\n  CHWP: 'CHWP',\n  PlantChilledWater: 'Plant-Chilled Water',\n  BuildingInfo: 'Building Info',\n  HeatExchanger: 'Heat Exchanger',\n  CoolingTower: 'Cooling Tower',\n  CWP: 'CWP',\n  PlantCoolingTower: 'Plant-Cooling Tower',\n  Boiler: 'Boiler',\n  HWP: 'HWP',\n  BoilerPlant: 'Boiler Plant',\n  FloorControl: 'Floor Control',\n  AHU_VAV: 'AHU-VAV',\n  AHU_CAV: 'AHU_CAV',\n  FCU: 'FCU',\n  FTU: 'FTU',\n  PAC_HotWaterReheat: 'PAC - Hot Water Reheat',\n  PAC_ReverseCycle: 'PAC - Reverse Cycle',\n  PAC_ElectricReheat: 'PAC - Electric Reheat',\n  PAC_Electric_Reheat_WaterCooled: 'PAC - Electric Reheat - Water Cooled',\n  OutsideAirFan: 'Outside Air Fan',\n  SupplyAirFan: 'Supply Air Fan',\n  ReturnAirFan: 'ReturnAirFan',\n  AHUReturnAirFan: 'AHU Return Air Fan',\n  CarParkSupplyAirFan: 'CarPark Supply Air Fan',\n  CarParkExhaustAirFan: 'CarPark Exhaust Air Fan',\n  ToiletExhaustAirFan: 'Toilet Exhaust Air Fan',\n  KitchenExhaustAirFan: 'Kitchen Exhaust Air Fan',\n  ExhaustAirFan: 'Exhaust Air Fan',\n  GeneralExhaustAirFan: 'General Exhaust Air Fan',\n  VAV: 'VAV',\n  Power_SubMeter: 'Power_SubMeter',\n  PowerSiteMeter: 'Power Site Meter',\n  Gas_SubMeter: 'Gas sub-Meter',\n  Gas_SiteMeter: 'Gas Site Meter',\n  Water_subMeter: 'Water sub-Meter',\n  Water_SiteMeter: 'Water Site Meter',\n}\nexport default class tagRefs {\n\n  static acronyms = {\n    BMS: 'BMS',\n    RTD: 'RTD',\n    AHU: 'AHU',\n    CW: 'CW',\n    RTU: 'RTU',\n    RH: 'RH',\n    CHWP: 'CHWP',\n    CWP: 'CWP',\n    HWP: 'HWP',\n    EVP: 'EVP',\n    FCU: 'FCU',\n    FTU: 'FTU',\n    VAV: 'VAV',\n    CT: 'CT',\n    CTF: 'CTF',\n    RT: 'RT',\n    RAT: 'RAT',\n    SAT: 'SAT',\n    ZT: 'ZT',\n    CHL: 'CHL',\n    BLR: 'BLR',\n    AC: 'AC',\n    RAC: 'RAC',\n    EVAP: 'EVAP',\n    HVAC: 'HVAC',\n    HLI: 'HLI',\n    BTU: 'BTU',\n    CMD: 'CMD',\n    REM: 'REM',\n    SYS: 'SYS',\n    RV: 'RV',\n    SOL: 'SOL',\n    DX: 'DX',\n    BACnet: 'BACnet',\n    LoRa: 'LoRa',\n    KNX: 'KNX',\n    LoRaWAN: 'LoRaWAN',\n    Modbus: 'Modbus',\n    LON: 'LON',\n    N2: 'N2',\n    SP: 'SP',\n    SETP: 'SETP',\n    LIQ: 'LIQ',\n    PMP: 'PMP',\n    TEMP: 'TEMP',\n    TMP: 'TMP',\n    PRESS: 'PRESS',\n    EEV: 'EEV',\n    DISCH: 'DISCH',\n  }\n  \n\n  static tagCategory = Object.values(TAGNAME).map(\n    point => {\n      return { value: point, text: point };\n    },\n  )\n\n  static tagType(type: string) {\n    switch (type) {\n      case TAGNAME.CHILLER:\n        return tagRefs.CHILLER;\n      case TAGNAME.CHWP:\n        return tagRefs.CHWP;\n      case TAGNAME.PlantChilledWater:\n        return tagRefs.PlantChilledWater;\n      case TAGNAME.BuildingInfo:\n        return tagRefs.BuildingInfo;\n      case TAGNAME.HeatExchanger:\n        return tagRefs.HeatExchanger;\n      case TAGNAME.CoolingTower:\n        return tagRefs.CoolingTower;\n      case TAGNAME.CWP:\n        return tagRefs.CWP;\n      case TAGNAME.PlantCoolingTower:\n        return tagRefs.PlantCoolingTower;\n      case TAGNAME.Boiler:\n        return tagRefs.Boiler;\n      case TAGNAME.HWP:\n        return tagRefs.HWP;\n      case TAGNAME.BoilerPlant:\n        return tagRefs.BoilerPlant;\n      case TAGNAME.FloorControl:\n        return tagRefs.FloorControl;\n      case TAGNAME.AHU_VAV:\n        return tagRefs.AHU_VAV;\n      case TAGNAME.AHU_CAV:\n        return tagRefs.AHU_CAV;\n      case TAGNAME.FCU:\n        return tagRefs.FCU;\n      case TAGNAME.FTU:\n        return tagRefs.FTU;\n      case TAGNAME.PAC_HotWaterReheat:\n        return tagRefs.PAC_HotWaterReheat;\n      case TAGNAME.PAC_ReverseCycle:\n        return tagRefs.PAC_ReverseCycle;\n      case TAGNAME.PAC_ElectricReheat:\n        return tagRefs.PAC_ElectricReheat;\n      case TAGNAME.PAC_Electric_Reheat_WaterCooled:\n        return tagRefs.PAC_Electric_Reheat_WaterCooled;\n      case TAGNAME.OutsideAirFan:\n        return tagRefs.OutsideAirFan;\n      case TAGNAME.SupplyAirFan:\n        return tagRefs.SupplyAirFan;\n      case TAGNAME.ReturnAirFan:\n        return tagRefs.ReturnAirFan;\n      case TAGNAME.AHUReturnAirFan:\n        return tagRefs.AHUReturnAirFan;\n      case TAGNAME.CarParkSupplyAirFan:\n        return tagRefs.CarParkSupplyAirFan;\n      case TAGNAME.ToiletExhaustAirFan:\n        return tagRefs.ToiletExhaustAirFan;\n      case TAGNAME.KitchenExhaustAirFan:\n        return tagRefs.KitchenExhaustAirFan;\n      case TAGNAME.ExhaustAirFan:\n        return tagRefs.ExhaustAirFan;\n      case TAGNAME.GeneralExhaustAirFan:\n        return tagRefs.GeneralExhaustAirFan;\n      case TAGNAME.VAV:\n        return tagRefs.VAV;\n      case TAGNAME.Power_SubMeter:\n        return tagRefs.Power_SubMeter;\n      case TAGNAME.PowerSiteMeter:\n        return tagRefs.PowerSiteMeter;\n      case TAGNAME.Gas_SubMeter:\n        return tagRefs.Gas_SubMeter;\n      case TAGNAME.Gas_SiteMeter:\n        return tagRefs.Gas_SiteMeter;\n      case TAGNAME.Water_subMeter:\n        return tagRefs.Water_subMeter;\n    }\n  }\n\n  static CHILLER = {\n    'Chiller S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'cmd', 'chilled', 'chiller'],\n    },\n    'Chiller Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'sensor', 'chilled', 'chiller'],\n    },\n    'Chiller Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fault', 'sensor', 'chilled', 'chiller'],\n    },\n    'Load': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['load', 'sensor', 'chilled', 'chiller'],\n    },\n    'Chilled Water Supply Temperature': {\n      kind: 'number',\n      unit: 'Temperature',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'supply', 'chilled', 'chiller'],\n    },\n    'Chilled Water Supply Temperature Setpoint': {\n      kind: 'number',\n      unit: 'Temperature',\n      equipType: '',\n      tags: ['water', 'temp', 'sp', 'supply', 'chilled', 'chiller'],\n    },\n    'Chilled Water Return Temperature': {\n      kind: 'number',\n      unit: 'Temperature',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'return', 'chilled', 'chiller'],\n    },\n    'Condenser Water Supply Temperature': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'supply', 'condenser', 'chiller'],\n    },\n    'Condenser Water Return Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'return', 'condenser', 'chiller'],\n    },\n  };\n\n\n  static CHWP = {\n    'Chilled Water Pump S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'cmd', 'chilled', 'pump'],\n    },\n    'Chilled Water Pump Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'sensor', 'chilled', 'pump'],\n    },\n    'Chilled Water Pump Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fault', 'sensor', 'chilled', 'pump'],\n    },\n    'Chilled Water Pump Differential Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'pressure', 'sensor', 'differential', 'chilled', 'pump'],\n    },\n    'Chilled Water Pump Differential Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'pressure', 'sp', 'differential', 'chilled', 'pump'],\n    },\n    'Chilled Water Flow': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'flow', 'sensor', 'chilled', 'pump'],\n    },\n    'Chilled Water Flow Setpoint': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'flow', 'sp', 'chilled', 'pump'],\n    },\n    'Chilled Water Pump Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['speed', 'cmd', 'chilled', 'pump'],\n    },\n  }\n\n  static PlantChilledWater = {\n    'Common Chilled Water Supply Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'supply', 'chilled', 'common'],\n    },\n    'Common Chilled Water Return Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'return', 'chilled', 'common'],\n    },\n    'Common Chilled Water Differential Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'pressure', 'sensor', 'differential', 'chilled', 'common'],\n    },\n    'Common Chilled Water Bypass Valve': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'bypass', 'cmd', 'chilled', 'common'],\n    },\n    'Common Chilled Water Differential Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'pressure', 'sp', 'differential', 'chilled', 'common'],\n    },\n  }\n\n  static BuildingInfo = {\n    'Outside Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'outside', 'dryBulb/wetBulb', 'buildingInfo'],\n    },\n    'Outside Air Enthalpy': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'enthalpy', 'sensor', 'outside', 'buildingInfo'],\n    },\n    'Outside Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'outside', 'buildingInfo'],\n    },\n  }\n  static HeatExchanger = {\n    'Primary Supply Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'supply', 'hot', 'primaryLoop', 'heatExchanger'],\n    },\n    'Primary Return Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'return', 'hot', 'primaryLoop', 'heatExchanger'],\n    },\n    'Primary Loop Valve': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'cmd', 'hot', 'primaryLoop', 'heatExchanger'],\n    },\n    'Secondary Supply Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'supply', 'hot', 'secondaryLoop', 'heatExchanger'],\n    },\n    'Secondary Return Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'return', 'hot', 'secondaryLoop', 'heatExchanger'],\n    },\n    'Secondary Loop Valve': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'cmd', 'hot', 'secondaryLoop', 'heatExchanger'],\n    },\n  }\n  static CoolingTower = {\n    'Cooling Tower S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'condenser', 'coolingTower'],\n    },\n    'Cooling Tower Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'condenser', 'coolingTower'],\n    },\n    'Cooling Tower Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'condenser', 'coolingTower'],\n    },\n    'Cooling Tower Fan Speed': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'cmd', 'condenser', 'coolingTower'],\n    },\n    'Condenser Water Supply Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'supply', 'condenser', 'coolingTower'],\n    },\n    'Condenser Water Supply Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sp', 'supply', 'condenser', 'coolingTower'],\n    },\n    'Condenser Water Return Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'return', 'condenser', 'coolingTower'],\n    },\n  }\n  static CWP = {\n    'Condenser Water Pump S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'cmd', 'condenser', 'pump'],\n    },\n    'Condenser Water Pump Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'sensor', 'condenser', 'pump'],\n    },\n    'Condenser Water Pump Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fault', 'sensor', 'condenser', 'pump'],\n    },\n    'Condenser Water Pump Differential Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'pressure', 'sensor', 'differential', 'condenser', 'pump'],\n    },\n    'Condenser Water Pump Differential Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'pressure', 'sp', 'differential', 'condenser', 'pump'],\n    },\n    'Condenser Water Flow': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: [''],\n    },\n    'Condenser Water Pump Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['speed', 'cmd', 'condenser', 'pump'],\n    },\n  }\n  static PlantCoolingTower = {\n    'Common Condenser Water Supply Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'supply', 'condenser', 'common'],\n    },\n    'Common Condenser Pressure Diff': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'pressure', 'sensor', 'differential', 'condenser', 'common'],\n    },\n    'Common Bypass Valve': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'bypass', 'cmd', 'condenser', 'common'],\n    },\n    'Common Condenser Water Return Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'return', 'condenser', 'common'],\n    },\n  }\n  static Boiler = {\n    'Boiler S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'cmd', 'hot', 'boiler'],\n    },\n    'Boiler Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'sensor', 'hot', 'boiler'],\n    },\n    'Boiler Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fault', 'sensor', 'hot', 'boiler'],\n    },\n    'Hot Water Supply Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'supply', 'hot', 'boiler'],\n    },\n    'Hot Water Supply Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sp', 'supply', 'hot', 'boiler'],\n    },\n    'Hot Water Return Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'return', 'hot', 'boiler'],\n    },\n  }\n  static HWP = {\n    'Hot Water Pump S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'cmd', 'hot', 'pump'],\n    },\n    'Hot Water Pump Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['run', 'sensor', 'hot', 'pump'],\n    },\n    'Hot Water Pump Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fault', 'sensor', 'hot', 'pump'],\n    },\n    'Hot Water Pump Differential Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'pressure', 'sensor', 'differential', 'hot', 'pump'],\n    },\n    'Hot Water Pump Differential Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'pressure', 'sp', 'differential', 'hot', 'pump'],\n    },\n    'Hot Water Pump Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['speed', 'cmd', 'hot', 'pump'],\n    },\n  }\n  static BoilerPlant = {\n    'Common Hot Water Supply Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'supply', 'hot', 'common'],\n    },\n    'Common Hot Water Return Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'temp', 'sensor', 'return', 'hot', 'common'],\n    },\n  }\n  static FloorControl = {\n    'Floor Occupancy': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['run', 'cmd', 'occupied', 'floor'],\n    },\n    'After Hours Active Time': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['run', 'cmd', 'afterHour', 'activeTime', 'floor'],\n    },\n    'Zone Occupancy': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['run', 'cmd', 'occupied', 'zone', 'floor'],\n    },\n    'Zone After Hours Active Time': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['run', 'cmd', 'afterHour', 'activeTime', 'zone', 'floor'],\n    },\n    'After Hours ElapsedTime': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['afterHour', 'floor'],\n    },\n    'AH Enable': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['cmd', 'afterHour', 'ahuRef', 'floor'],\n    },\n    'VAV Enable': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['enable', 'cmd', 'vav', 'floor'],\n    },\n    'Return Air Damper': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'cmd', 'return', 'common', 'damper', 'floor'],\n    },\n    'Supply Air Damper': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'cmd', 'supply', 'common', 'damper', 'floor'],\n    },\n    'Isolation Air Damper': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'cmd', 'isolation', 'damper', 'floor'],\n    },\n    'Zone Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'zone', 'floor'],\n    },\n  }\n  static AHU_VAV = {\n    'AHU Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'supply', 'ahu'],\n    },\n    'AHU Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'supply', 'ahu'],\n    },\n    'AHU Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'supply', 'ahu'],\n    },\n    'AHU Fan Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'cmd', 'supply', 'ahu'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'ahu'],\n    },\n    'Supply Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'supply', 'ahu'],\n    },\n    'Supply Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'supply', 'ahu'],\n    },\n    'Supply Air Static Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sp', 'supply', 'ahu'],\n    },\n    'Supply Air Flow': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'flow', 'sensor', 'supply', 'ahu'],\n    },\n    'Outside/Return/Room Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'outside/return', 'ahu'],\n    },\n    'Return/Room Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'return', 'ahu'],\n    },\n    'Supply/Return/Room Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'supply/return', 'ahu'],\n    },\n    'Outside Air Relative Humidity': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'outside', 'ahu'],\n    },\n    'Cooling Coil Valve Control': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'cmd', 'chilled', 'ahu'],\n    },\n    'Heating Coil Valve Control': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'cmd', 'hot', 'ahu'],\n    },\n    'Air Off Coil Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'offCoil', 'hot/cold', 'ahu'],\n    },\n    'Outside Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'outside', 'ahu'],\n    },\n    'Mix Air Temperature': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'mix', 'ahu'],\n    },\n    'Minimum Outside Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'outside', 'minimum', 'ahu'],\n    },\n    'Minimum Outside Air Damper Feedback': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'sensor', 'outside', 'minimum', 'ahu'],\n    },\n    'Return Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'return', 'ahu'],\n    },\n    'Exhaust Air Damper': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'exhaust', 'ahu'],\n    },\n    'RACO2': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'co2', 'sensor', 'return', 'ahu'],\n    },\n    'Electric Duct Heater S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['edh', 'run', 'cmd', 'ahu'],\n    },\n    'Electric Duct Heater Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['edh', 'run', 'sensor', 'ahu'],\n    },\n    'Dew Point': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['dewPoint', 'sensor', 'ahu'],\n    },\n    'Dew Point Setpoint': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['dewPoint', 'sp', 'ahu'],\n    },\n    'Filter Differential Pressure': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['pressure', 'sensor', 'filter', 'delta', 'ahu'],\n    },\n    'Filter Differential Pressure Setpoint': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['pressure', 'sp', 'filter', 'delta', 'ahu'],\n    },\n    'Filter Status': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['fault', 'sensor', 'filter', 'ahu'],\n    },\n  }\n  static AHU_CAV = {\n    'AHU Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'supply', 'ahu'],\n    },\n    'AHU Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'supply', 'ahu'],\n    },\n    'AHU Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'supply', 'ahu'],\n    },\n    'Speed': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'sensor', 'supply', 'ahu'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'ahu'],\n    },\n    'Supply Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'supply', 'ahu'],\n    },\n    'Return Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return', 'ahu'],\n    },\n    'Room Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'zone', 'ahu'],\n    },\n    'Outside Air Temperature': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'outside', 'ahu'],\n    },\n    'Mix Air Temperature': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'mix', 'ahu'],\n    },\n    'Return Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'return', 'ahu'],\n    },\n    'Room Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'zone', 'ahu'],\n    },\n    'Return Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'return', 'ahu'],\n    },\n    'Room Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'zone', 'ahu'],\n    },\n    'Outside Air Relative Humidity': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'outside', 'ahu'],\n    },\n    'Cooling Coil Valve Control': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'cmd', 'chilled', 'ahu'],\n    },\n    'Heating Coil Valve Control': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'cmd', 'hot', 'ahu'],\n    },\n    'Air Off Coil Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'offCoil', 'hot/cold', 'ahu'],\n    },\n    'Outside Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'outside', 'ahu'],\n    },\n    'Minimum Outside Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'outside', 'minimum', 'ahu'],\n    },\n    'Minimum Outside Air Damper Feedback': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'sensor', 'outside', 'minimum', 'ahu'],\n    },\n    'Exhaust Air Damper': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'exhaust', 'ahu'],\n    },\n    'RACO2': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'co2', 'sensor', 'return', 'ahu'],\n    },\n    'Electric Duct Heater S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['edh', 'run', 'cmd', 'ahu'],\n    },\n    'Electric Duct Heater Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['edh', 'run', 'sensor', 'ahu'],\n    },\n    'Dew Point': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['dewPoint', 'sensor', 'ahu'],\n    },\n    'Dew Point Setpoint': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['dewPoint', 'sp', 'ahu'],\n    },\n    'Filter Differential Pressure/Status': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'filter', 'ahu'],\n    },\n  }\n  static FCU = {\n    'FCU Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'fcu'],\n    },\n    'FCU Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'fcu'],\n    },\n    'FCU Fan Speed': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'sensor', 'supply', 'fcu'],\n    },\n    'FCU Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'fcu'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'fcu'],\n    },\n    'Supply Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'supply', 'fcu'],\n    },\n    'Return/Room Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return/zone', 'fcu'],\n    },\n    'Return/Room Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'return/zone', 'fcu'],\n    },\n    'Return/Room Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'return/zone', 'fcu'],\n    },\n    'Cooling Coil Valve Control': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'cmd', 'chilled', 'fcu'],\n    },\n    'Heating Coil Valve Control': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'cmd', 'hot', 'fcu'],\n    },\n    'Air Off Coil Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'offCoil', 'hot/cold', 'fcu'],\n    },\n    'Outside Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'outside', 'fcu'],\n    },\n    'Filter Differential Pressure/Status': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'filter', 'fcu'],\n    },\n  }\n  static FTU = {\n    'FTU Fan S/S': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'run', 'cmd', 'ftu'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'ftu'],\n    },\n    'Return/Room Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return/zone', 'ftu'],\n    },\n    'Heating Coil Valve Control': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'cmd', 'hot', 'ftu'],\n    },\n    'Airflow': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'flow', 'sensor', 'ftu'],\n    },\n    'Damper Feedback': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'sensor', 'ftu'],\n    },\n  }\n  static PAC_HotWaterReheat = {\n    'PAC Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'pac'],\n    },\n    'PAC Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'pac'],\n    },\n    'PAC Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'pac'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'pac'],\n    },\n    'Return/Room Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return/zone', 'pac'],\n    },\n    'Return/Room Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'return/zone', 'pac'],\n    },\n    'Return/Room Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'return/zone', 'pac'],\n    },\n    'Compressor S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['refrig', 'run', 'cmd', 'pac'],\n    },\n    'Heating Coil Valve Control': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'valve', 'cmd', 'hot', 'pac'],\n    },\n    'Air Off Coil Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'offCoil', 'hot/cold', 'pac'],\n    },\n    'Outside Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'outside', 'pac'],\n    },\n    'Filter Differential Pressure/Status': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'filter', 'pac'],\n    },\n  }\n  static PAC_ReverseCycle = {\n    'PAC Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'pac'],\n    },\n    'PAC Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'pac'],\n    },\n    'PAC Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'pac'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'pac'],\n    },\n    'Return/Room Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return/zone', 'pac'],\n    },\n    'Return/Room Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'return/zone', 'pac'],\n    },\n    'Return/Room Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'return/zone', 'pac'],\n    },\n    'Compressor S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['refrig', 'run', 'cmd', 'reverse', 'pac'],\n    },\n    'Reverse Valve Control': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['valve', 'run', 'cmd', 'reverse', 'pac'],\n    },\n    'Air Off Coil Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'offCoil', 'hot/cold', 'pac'],\n    },\n    'Outside Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'outside', 'pac'],\n    },\n    'Filter Differential Pressure/Status': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'filter', 'pac'],\n    },\n  }\n  static PAC_ElectricReheat = {\n    'PAC Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'pac'],\n    },\n    'PAC Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'pac'],\n    },\n    'PAC Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'pac'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'pac'],\n    },\n    'Return/Room Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return/zone', 'pac'],\n    },\n    'Return/Room Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'return/zone', 'pac'],\n    },\n    'Return/Room Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'return/zone', 'pac'],\n    },\n    'Compressor S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['refrig', 'run', 'cmd', 'pac'],\n    },\n    'Electric Duct Heater S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['edh', 'run', 'cmd', 'pac'],\n    },\n    'Air Off Coil Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'offCoil', 'hot/cold', 'pac'],\n    },\n    'Outside Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'outside', 'pac'],\n    },\n    'Filter Differential Pressure/Status': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'filter', 'pac'],\n    },\n  }\n  static PAC_Electric_Reheat_WaterCooled = {\n    'PAC Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'pac'],\n    },\n    'PAC Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'pac'],\n    },\n    'PAC Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'pac'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'pac'],\n    },\n    'Return/Room Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return/zone', 'pac'],\n    },\n    'Return/Room Air Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'return/zone', 'pac'],\n    },\n    'Return/Room Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'return/zone', 'pac'],\n    },\n    'Compressor S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['refrig', 'run', 'cmd', 'pac'],\n    },\n    'Electric Duct Heater S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['edh', 'run', 'cmd', 'pac'],\n    },\n    'Condenser Water Call': {\n      kind: 'boolean',\n      unit: '',\n      equipType: '',\n      tags: ['run', 'cmd', 'condenser', 'pac'],\n    },\n    'Air Off Coil Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'offCoil', 'hot/cold', 'pac'],\n    },\n    'Outside Air Damper Control': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'outside', 'pac'],\n    },\n    'Filter Differential Pressure/Status': {\n      kind: 'number/boolean',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'filter', 'pac'],\n    },\n  }\n  static OutsideAirFan = {\n    'Outside Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'outside', 'oaf'],\n    },\n    'Outside Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'outside', 'oaf'],\n    },\n    'Outside Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'outside', 'oaf'],\n    },\n    'Outside Air Fan Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'cmd', 'outside', 'oaf'],\n    },\n    'Outside Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'outside', 'oaf'],\n    },\n    'Outside Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'outside', 'oaf'],\n    },\n    'Outside Air Flow': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'flow', 'sensor', 'return', 'oaf'],\n    },\n    'Outside Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'outside', 'oaf'],\n    },\n    'Outside Air Static Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sp', 'outside', 'oaf'],\n    },\n  }\n  static SupplyAirFan = {\n    'Supply Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'supply', 'saf'],\n    },\n    'Supply Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'supply', 'saf'],\n    },\n    'Supply Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'supply', 'saf'],\n    },\n    'Supply Air Fan Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'cmd', 'supply', 'saf'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'saf'],\n    },\n    'Supply Air Flow': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'flow', 'sensor', 'supply', 'saf'],\n    },\n    'Supply Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'supply', 'saf'],\n    },\n    'Supply Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'supply', 'saf'],\n    },\n    'Supply Air Static Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sp', 'supply', 'saf'],\n    },\n  }\n  static ReturnAirFan = {\n    'Return Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'return', 'raf'],\n    },\n    'Return Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'return', 'raf'],\n    },\n    'Return Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'return', 'raf'],\n    },\n    'Return Air Fan Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'cmd', 'return', 'raf'],\n    },\n    'Return Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return', 'raf'],\n    },\n    'Return Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'return', 'raf'],\n    },\n    'Return Air Flow': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'flow', 'sensor', 'return', 'raf'],\n    },\n    'Return Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'return', 'raf'],\n    },\n    'Return Air Enthalpy': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'enthalpy', 'sensor', 'return', 'raf'],\n    },\n    'Return Air Suction Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'return', 'raf'],\n    },\n    'Return Air CO2': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'co2', 'sensor', 'return', 'raf'],\n    },\n    'Return Air Static Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sp', 'return', 'raf'],\n    },\n  }\n  static AHUReturnAirFan = {\n    'AHU Return Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'return', 'ahu'],\n    },\n    'AHU Return Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'return', 'ahu'],\n    },\n    'AHU Return Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'return', 'ahu'],\n    },\n    'AHU Return Air Fan Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'cmd', 'return', 'ahu'],\n    },\n    'AHU Return Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return', 'ahu'],\n    },\n    'AHU Return Air Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'return', 'ahu'],\n    },\n    'AHU Return Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'return', 'ahu'],\n    },\n    'AHU Return Air CO2': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'co2', 'sensor', 'return', 'ahu'],\n    },\n    'AHU Return Air Static Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sp', 'return', 'ahu'],\n    },\n  }\n  static CarParkSupplyAirFan = {\n    'CarPark Supply Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'supply', 'carpark'],\n    },\n    'CarPark Supply Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'supply', 'carpark'],\n    },\n    'CarPark Supply Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'supply', 'carpark'],\n    },\n    'CarPark Supply Air Fan Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'cmd', 'supply', 'carpark'],\n    },\n    'CarPark Supply Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'supply', 'carpark'],\n    },\n    'CarPark Supply Air Static Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sp', 'supply', 'carpark'],\n    },\n  }\n  static CarParkExhaustAirFan = {\n    'CarPark Exhaust Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'exhaust', 'carpark'],\n    },\n    'CarPark Exhaust Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'exhaust', 'carpark'],\n    },\n    'CarPark Exhaust Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'exhaust', 'carpark'],\n    },\n    'CarPark Exhaust Air Fan Speed': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['fan', 'speed', 'cmd', 'exhaust', 'carpark'],\n    },\n    'CarPark Exhaust Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'exhaust', 'carpark'],\n    },\n    'CarPark Exhaust Air Static Pressure Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sp', 'exhaust', 'carpark'],\n    },\n    'CarPark Exhaust Carbon Monoxide': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'co', 'sensor', 'exhaust', 'carpark'],\n    },\n    'CarPark Exhaust Carbon Monoxide Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'co', 'sp', 'exhaust', 'carpark'],\n    },\n  }\n  static ToiletExhaustAirFan = {\n    'Toilet Exhaust Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'exhaust', 'toilet'],\n    },\n    'Toilet Exhaust Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'exhaust', 'toilet'],\n    },\n    'Toilet Exhaust Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'exhaust', 'toilet'],\n    },\n    'Toilet Exhaust Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'exhaust', 'toilet'],\n    },\n  }\n  static KitchenExhaustAirFan = {\n    'Kitchen Exhaust Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'exhaust', 'kitchen'],\n    },\n    'Kitchen Exhaust Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'exhaust', 'kitchen'],\n    },\n    'Kitchen Exhaust Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'exhaust', 'kitchen'],\n    },\n    'Kitchen Exhaust Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'exhaust', 'kitchen'],\n    },\n  }\n  static ExhaustAirFan = {\n    'Exhaust Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'exhaust'],\n    },\n    'Exhaust Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'exhaust'],\n    },\n    'Exhaust Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'exhaust'],\n    },\n    'Exhaust Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'exhaust'],\n    },\n  }\n  static GeneralExhaustAirFan = {\n    'General Exhaust Air Fan S/S': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'cmd', 'exhaust', 'general'],\n    },\n    'General Exhaust Air Fan Status': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'run', 'sensor', 'exhaust', 'general'],\n    },\n    'General Exhaust Air Fan Fault': {\n      kind: 'boolean',\n      unit: '',\n      equipType: 'hisTsPrecision',\n      tags: ['fan', 'fault', 'sensor', 'exhaust', 'general'],\n    },\n    'General Exhaust Air Static Pressure': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'pressure', 'sensor', 'exhaust', 'general'],\n    },\n  }\n  static VAV = {\n    'Zone/Room Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'zone', 'vav'],\n    },\n    'Zone/Room Temperature Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sp', 'zone', 'vav'],\n    },\n    'Supply Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'supply', 'vav'],\n    },\n    'Return Air Temperature': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'temp', 'sensor', 'return', 'vav'],\n    },\n    'Zone/Room Relative Humidity': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'humidity', 'sensor', 'zone', 'vav'],\n    },\n    'Damper': {\n      kind: 'number',\n      unit: '%',\n      equipType: '',\n      tags: ['air', 'damper', 'cmd', 'vav'],\n    },\n    'Airflow': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'flow', 'sensor', 'vav'],\n    },\n    'Airflow Setpoint': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'flow', 'sp', 'vav'],\n    },\n    'Minimum Airflow': {\n      kind: 'string',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'flow', 'sensor', 'min', 'vav'],\n    },\n    'Electric Duct Heater Status': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['edh', 'run', 'sensor', 'vav'],\n    },\n    'Electric Duct Heater S/S': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['edh', 'run', 'cmd', 'vav'],\n    },\n    'Terminal Load': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'sensor', 'terminalLoad', 'vav'],\n    },\n    'Maximum Airflow': {\n      kind: 'number',\n      unit: '',\n      equipType: '',\n      tags: ['air', 'flow', 'sensor', 'max', 'vav'],\n    },\n  }\n  static Power_SubMeter = {\n    'Total Active Energy': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['elec', 'energy', 'sensor', 'active', 'exclusion', 'hisOnWrite'],\n    },\n    'Total Active Power': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['elec', 'power', 'sensor', 'active'],\n    },\n  }\n  static PowerSiteMeter = {\n    'Total Active Energy': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['elec', 'energy', 'sensor', 'active'],\n    },\n    'Total Active Power': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['elec', 'power', 'sensor', 'active'],\n    },\n    'Energy Target': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['elec ', 'energy', 'target'],\n    },\n    '???': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['gas', 'sensor', 'inclusion', 'hisTotalized'],\n    },\n  }\n  static Gas_SubMeter = {\n    'Total Gas Consumption': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['gas', 'sensor', 'exclusion', 'hisTotalized'],\n    },\n  }\n  static Gas_SiteMeter = {\n    'Total Gas Consumption': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['gas', 'sensor', 'inclusion', 'hisTotalized'],\n    },\n    'Gas Target': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['gas', 'target', 'sensor', 'exclusion', 'hisTotalized'],\n    },\n  }\n  static Water_subMeter = {\n    'Total Water Consumption': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'sensor', 'inclusion/exclusion', 'hisTotalized'],\n    },\n  }\n  static Water_SiteMeter = {\n    'Total Water Consumption': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'sensor'],\n    },\n    'Water Target': {\n      kind: '',\n      unit: '',\n      equipType: '',\n      tags: ['water', 'target'],\n    },\n  }\n};\n\n\n","import { SettingType } from '../../node';\nimport { User } from '../../../database/models/user';\nimport Utils from '../../utils';\nimport axios from 'axios';\nimport { Side } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\n\nexport default abstract class BasePointNode extends FlexibleNode {\n  previousAdvancedSetting = false;\n  advancedSetting = false;\n\n  protected constructor() {\n    super();\n    this.settings['url'] = {\n      description: 'Select Url',\n      value: '',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [],\n      },\n    };\n    this.settings['point'] = { description: 'Select Point', value: '', type: SettingType.STRING };\n    this.settings['point'] = {\n      description: 'Select Point',\n      value: '',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [],\n      },\n    };\n  }\n\n  onAdded() {\n    this.previousAdvancedSetting = this.settings['advancedSetting'].value;\n    this.advancedSetting = this.previousAdvancedSetting;\n    this.updateTitle();\n  }\n\n  async onInputUpdated() {\n    if (this.side !== Side.server) return;\n    await this.reload();\n    this.updateTitle();\n    this.broadcastTitleToClients();\n  }\n\n  abstract async reload(): Promise<any>;\n\n  async fetchPointValue({ jwt, host, port }, point): Promise<any> {\n    const url = `${Utils.buildUrl(host, port)}/points/${point}`;\n    const pointValue = await axios.get(url, { headers: { Authorization: jwt } });\n    return pointValue.data;\n  }\n\n  protected async fetchConnection(): Promise<User> {\n    const users = await this.container.db.getAsyncUsers();\n    const urls = users.map(user => {\n      return {\n        value: JSON.stringify(user),\n        text: `${Utils.buildUrl(user.host, user.port)}/points (${user.nodeId})`,\n      };\n    });\n    this.settings['url'].config.items = urls;\n    this.broadcastSettingsToClients();\n    const url = this.settings['url'].value;\n    const user = this.settings['url'].value;\n    const urlJson = JSON.parse(url);\n    const findUrl = urls.find(x => JSON.parse(x.value).nodeId === urlJson.nodeId);\n    if (!user || !findUrl) {\n      throw { message: 'No connection' };\n    }\n    this.settings['url'].value = findUrl.value;\n    this.broadcastSettingsToClients();\n    return (user && JSON.parse(user)) || null;\n  }\n\n  protected async fetchPoints({ jwt, host, port }): Promise<string> {\n    const url = `${Utils.buildUrl(host, port)}/points`;\n    const response = await axios.get(url, { headers: { Authorization: jwt } });\n    const rawPoints = this.filterPoint(Object.keys(response.data));\n    const points = rawPoints.map(point => {\n      return { value: point, text: point };\n    });\n    this.settings['point'].config.items = points;\n    this.broadcastSettingsToClients();\n    const point = this.settings['point'].value;\n    if (!point || !points.map(x => x.value).includes(point)) {\n      throw { message: 'No point' };\n    }\n    return point;\n  }\n\n  protected filterPoint(points) {\n    return points;\n  }\n\n  abstract updateTitle();\n}\n","export default class NodeUtils {\n  /**\n   * @Deprecated: Use Node::persistProperties\n   */\n  static persistProperties(\n    self,\n    saveSettings = false,\n    saveProperties = false,\n    saveInputs = false,\n    saveOutputs = false,\n  ) {\n    if (!self.container.db) return;\n    var setProps = {};\n    if (saveSettings) setProps['settings'] = self.settings;\n    if (saveProperties) setProps['properties'] = self.properties;\n    if (saveInputs) setProps['inputs'] = self.inputs;\n    if (saveOutputs) setProps['outputs'] = self.outputs;\n    self.container.db.updateNode(self.id, self.container.id, {\n      $set: setProps,\n    });\n  }\n}\n","export default class EdgeGPIOUtils {\n  /*\n  used for scaling a UO !!! YES its backwards 0 is high and 100 is low !!!\n  to drive a UO as an DO send 0 for ON and 100 for OFF // Example to send 6vdc console.log(scaleToGPIOValue(60, 0, 120)) returns 48\n  to drive a UO as an AO send 100 to 0 as a float\n  */\n  static scaleToGPIOValue = (\n    val: number,\n    minOutput: number,\n    maxOutput: number,\n    minInput = 120,\n    maxInput = 0,\n  ): number => {\n    let value = val;\n    let pinValue = ((maxOutput - minOutput) * (value - minInput)) / (maxInput - minInput) + minOutput;\n    if (pinValue > maxOutput) {\n      pinValue = maxOutput;\n      value = maxInput;\n    } else if (pinValue < minOutput) {\n      pinValue = minOutput;\n      value = minInput;\n    }\n    return pinValue;\n  };\n\n  /*\n    used for scaling a UI\n    Example for scaling a 0/10dc to 0 to 1000. \n    scaleFromGPIOValue(0.7, 0, 1000)\n    */\n  static scaleFromGPIOValue = (\n    pinValue: number,\n    minOutput: number,\n    maxOutput: number,\n    minInput = 0,\n    maxInput = 1,\n  ): number => {\n    return ((maxOutput - minOutput) * (pinValue - minInput)) / (maxInput - minInput) + minOutput;\n  };\n\n  /*\n    used for scaling a UI as a DI\n    off/open = around 0.9 vdc. When on the pin jumper its set as a 10K\n    on/closed = around 0.1 vdc\n    */\n  static uiAsDI = (val: number): number => {\n    if (val > 0.6) {\n      return 0; // false/open\n    }\n    if (val < 0.2) {\n      return 1; // true/closed\n    }\n  };\n\n  /*\n    The bbb returns the DI as 0 for closed/on and 1 for open/off\n  */\n  static diInvert = (val: number): number => {\n    return (val ^= 1);\n  };\n\n  //  scale or convert 4-20mA reading to temperature\n  //      -value_420 is input value in 4-20mA\n  //      -min_target is minimum target temperature @4mA, defualts to 0C\n  //      -max_target is maximum target temperature  @20mA, defualts to 100C\n  //      -min_range is minimum input range, defaults to 4 mA.\n  //      -max_range is maximum input range, defaults to 20mA\n\n  static scale420maToRange(value_420: number, min_target: number, max_target: number) {\n    const limit = true,\n      min_range = 4,\n      max_range = 20;\n    const slope = (max_target - min_target) / (max_range - min_range);\n    if (limit)\n      if (value_420 <= min_range) return min_target;\n      else if (value_420 >= max_range) return max_target;\n    return (value_420 - min_range) * slope + min_target;\n  }\n\n  //  scale or convert ui reading to 4-20mA\n  //      -ui_value is input value in ui reading (0-1 range)\n  //      -min_target is minimum target output, defualts to 4mA\n  //      -max_target is maximum target output, defualts to 20mA\n  //      -min_range is minimum input range, defaults to 0.0\n  //      -max_range is maximum input range, defaults to 1.0\n  //\n\n  static scaleUI420ma(ui_value: number, min_range: number, max_range: number) {\n    const min_target = 4,\n      max_target = 20,\n      limit = true;\n    const slope = max_target / (max_range - min_range);\n    const value_420 = (ui_value - min_range) * slope;\n    if (limit)\n      if (value_420 <= min_target) return min_target;\n      else if (value_420 >= max_target) return max_target;\n\n    return value_420;\n  }\n}\n","export enum MATH_FUNC_TYPE {\n  NA = 0,\n  ADD = 1,\n  SUBTRACT = 2,\n  MULTIPLY = 3,\n  DIVIDE = 4,\n  REMAINDER = 5,\n  EXP = 6,\n  BOOL_INVERT = 7,\n  ONE_TO_TRUE = 8,\n  TRUE_TO_ONE = 9,\n  NUMBER_INVERT = 10,\n}\n\nexport default class MathUtils {\n  /**\n   * Values will be converted into the range min-max\n   * @param {number} value\n   * @param {number} min\n   * @param {number} max\n   */\n  static clamp(value: number, min: number, max: number): number {\n    return Math.min(Math.max(value, min), max);\n  }\n\n  /**\n   * It rounds to decimal place\n   * @param {any} value\n   * @param {number} decimals\n   * @returns {number}\n   */\n  static decimals(value: any, decimals: number): number {\n    if (isNaN(value)) return undefined;\n    const out = value.toFixed(MathUtils.clamp(decimals, 0, 5));\n    parseFloat(out);\n    return out;\n  }\n\n  /**\n   * It converts a 1 to a 0 or a 0 to a 1\n   * @param {number} value\n   */\n  static numInvert(value: number): number {\n    return value ^ 1;\n  }\n\n  /**\n   * It convert a true to a 1\n   * @param {number} value\n   */\n  static trueToOne(value: boolean): number {\n    if (typeof value === 'boolean') {\n      return value ? 1 : 0;\n    }\n    return undefined;\n  }\n\n  /**\n   * It convert a 1 to a true\n   * @param {number} value\n   */\n  static oneToTrue(value: number): boolean {\n    if (typeof value === 'number') {\n      return !!value;\n    }\n    return undefined;\n  }\n\n  /**\n   * It inverts the boolean value\n   * @param {boolean} value\n   */\n  static invert(value: boolean): boolean {\n    if (typeof value === 'boolean') {\n      return !value;\n    }\n    return undefined;\n  }\n\n  /**\n   * Checks whether all values are numbers or not\n   * @param values list of comma separated values\n   * @returns {boolean}\n   */\n  static validateNumbers = (...values: any) => {\n    return values.every(x => !isNaN(x));\n  };\n\n  static mathSwitch(mathFuncType: number, val: any, mathValue: number) {\n    let out;\n    switch (mathFuncType) {\n      case MATH_FUNC_TYPE.NA:\n        out = 0;\n        break;\n      case MATH_FUNC_TYPE.ADD:\n        out = val + mathValue;\n        break;\n      case MATH_FUNC_TYPE.SUBTRACT:\n        out = val - mathValue;\n        break;\n      case MATH_FUNC_TYPE.MULTIPLY:\n        out = val * mathValue;\n        break;\n      case MATH_FUNC_TYPE.DIVIDE:\n        out = val / mathValue;\n        break;\n      case MATH_FUNC_TYPE.REMAINDER:\n        out = 1;\n        break;\n      case MATH_FUNC_TYPE.EXP:\n        out = 1;\n        break;\n      case MATH_FUNC_TYPE.BOOL_INVERT:\n        out = MathUtils.invert(val);\n        break;\n      case MATH_FUNC_TYPE.ONE_TO_TRUE:\n        out = MathUtils.oneToTrue(val);\n        break;\n      case MATH_FUNC_TYPE.TRUE_TO_ONE:\n        out = MathUtils.trueToOne(val);\n        break;\n      case MATH_FUNC_TYPE.NUMBER_INVERT:\n        out = MathUtils.numInvert(val);\n        break;\n    }\n    return out;\n  }\n}\n","import { PointOutput, PointValue } from '../../../../backend/models/point-model';\nimport { ErrorHandler } from '../../../../utils/decorators';\nimport { isFunction } from '../../../../utils/helper';\nimport { IMessageSubscriber, NodeStoreItem, Observer } from '../../../../utils/pattern';\nimport { Container } from '../../../container';\nimport { Type } from '../../../node-io';\nimport Registry from '../../../registry';\nimport { ConnectionOutput, DependantConnectionNode } from '../connection-node-mixin';\nimport { ContainerErrorNodeStore, OneIdentifierOneNodeStore } from '../model/container-node-store';\nimport { CentralizedPointOutputObserver, HasPointOutputObservers } from '../model/point-node';\nimport { ProtocolDeviceNode } from '../ProtocolDeviceNode';\nimport BACnetDevice from './core/bacnet-device';\nimport { BacnetPoint, BacnetPointCreator, PointKind } from './core/bacnet-model';\n\nexport const BACNET_SERVER_NODE_TYPE = 'protocols/bacnet-server/bacnet-server';\nexport const REGISTER_BACNET_POINT = 'REGISTER_BACNET_POINT';\nexport const UPDATE_BACNET_POINT = 'UPDATE_BACNET_POINT';\nexport const PUSH_BACNET_POINT_VALUE = 'PUSH_BACNET_POINT_VALUE';\nexport const UNREGISTER_BACNET_POINT = 'UNREGISTER_BACNET_POINT';\n\nclass BACNetCentralizedPointOutputObserver extends CentralizedPointOutputObserver<BacnetPoint> {\n\n  protected convert(data: PointOutput<BacnetPoint>): object {\n    let output = {};\n    output[data.point.identifier()] = {\n      objectId  : data.point.objectInstance,\n      objectType: data.point.objectType.label,\n      objectName: data.point.objectName,\n      pointValue: data.point.pointValue,\n      status    : data.connStatus.status.label,\n      error     : data.connStatus.error,\n    };\n    return output;\n  }\n\n}\n\nclass BacnetNodeServerStore extends OneIdentifierOneNodeStore<PointValue> {\n\n  public getError(): ContainerErrorNodeStore {\n    return this.errors;\n  }\n\n  public getNodes(): { [identifier: string]: { identifier: string, nodeId: string; enabled: boolean; func: Function } } {\n    return this.nodes;\n  }\n\n  protected alreadyExistedMsg(payload: NodeStoreItem): string {\n    return `Already exist object with ${payload.data?.objectInstance} and type ${payload.data?.objectType}`;\n  }\n}\n\nclass BACnetServerNode extends ProtocolDeviceNode implements IMessageSubscriber, HasPointOutputObservers<BacnetPoint> {\n\n  private readonly _oPointsSlot = 2;\n  private device: BACnetDevice = null;\n  private store: BacnetNodeServerStore = new BacnetNodeServerStore();\n\n  constructor(container) {\n    super(\n      container,\n      'BACnet Server',\n      'A BACnet server is used to host BACnet points to be read/written by other BACnet devices. ' +\n      'The bacnet-server node acts as a container for bacnet-server-point nodes. ' +\n      'All bacnet-server-point nodes should be added within the bacnet-server container. ' +\n      'IP configurations for the BACnet server connection are set from settings.',\n    );\n\n    this.mixinEnableInputSetting();\n    this.addInputWithSettings('address', Type.STRING, '0.0.0.0', 'BACnet Server Address');\n    this.addInputWithSettings('broadcast', Type.STRING, '255.255.255.255', 'Broadcast Address');\n    this.addInputWithSettings('port', Type.NUMBER, 47808, 'BACnet port');\n    this.addInputWithSettings('id', Type.NUMBER, 1, 'BACnet Device Id');\n    this.addInputWithSettings('name', Type.STRING, 'nube-bacnet', 'BACnet Device Name');\n    this.addInputWithSettings('apdu', Type.NUMBER, 1476, 'BACnet APDU');\n\n    this.addOutput('points', Type.JSON);\n  }\n\n  listen({ action, payload }: { action: string; payload: NodeStoreItem }) {\n    this.debugInfo(`Handling ${action}:${payload.identifier}...`);\n    switch (action) {\n      case REGISTER_BACNET_POINT:\n        return this.store.register(payload, p => this.afterRegister(p));\n      case UPDATE_BACNET_POINT:\n        return this.store.update(payload, p => this.afterUpdate(p), (p, force) => this.afterUnregister(p, force));\n      case PUSH_BACNET_POINT_VALUE:\n        return this.pushValue(payload);\n      case UNREGISTER_BACNET_POINT:\n        return this.store.unregister(payload, true, p => this.afterUnregister(p, true));\n      default:\n        this.debugWarn(`Request action doesn't match`);\n    }\n  }\n\n  connObserverNodes(): Observer<ConnectionOutput>[] {\n    return this.store.listNodeIds()\n               .map(id => Registry._nodes[id])\n               .filter(n => n)\n               .map(n => (<DependantConnectionNode><unknown>n).statusObserver());\n  }\n\n  pointObservers(): Observer<PointOutput<BacnetPoint>>[] {\n    return [new BACNetCentralizedPointOutputObserver(this, this._oPointsSlot)];\n  }\n\n  applyTitle() {\n    super.applyTitle();\n    this.broadcastSettingsToClients();\n    this.broadcastNameToClients();\n  }\n\n  isConnConnected(): boolean {\n    return this.device !== null;\n  }\n\n  @ErrorHandler\n  onReceiveMessage(object: object): void {\n    if (!this.getConnectionStatus().isConnected()) {\n      return;\n    }\n    let kind = PointKind.lookupByValue(object['objectType']);\n    let bp = BacnetPointCreator.create(this.isEnabled(), object['objectId'], kind, null,\n                                       object['presentValue'], object['priority'], object['priorityArray']);\n    let pointNode = this.store.lookup(bp.identifier());\n    if (pointNode && Registry._nodes[pointNode.nodeId] && isFunction(pointNode.func)) {\n      pointNode.func(bp);\n    } else {\n      this.debug(`Receive message to BACnet Point ${bp.identifier()} but not found node`);\n      //TODO: how to add new node from server\n    }\n  }\n\n  protected createThenStart() {\n    this.device = new BACnetDevice({\n                                     deviceId        : this.settings['id'].value,\n                                     name            : this.settings['name'].value,\n                                     databaseRevision: 1,\n                                   }, {\n                                     port       : this.settings['port'].value,\n                                     address    : this.settings['address'].value,\n                                     broadcast  : this.settings['broadcast'].value,\n                                     apduTimeout: this.settings['apdu'].value,\n                                   }, data => this.onReceiveMessage(data));\n    this.device.start();\n  }\n\n  protected stop() {\n    if (!this.device) {\n      return;\n    }\n    try {\n      this.device.stop();\n      this.device = null;\n    } catch (e) {\n      this.debugWarn(`Cannot closed BACnet client ${e}`);\n    }\n  }\n\n  private afterRegister(payload: NodeStoreItem) {\n    if (payload.enabled && this.getConnectionStatus().isConnected()) {\n      this.device.addPoint(payload.data);\n      return payload.data;\n    }\n    return null;\n  }\n\n  private afterUpdate(payload: NodeStoreItem) {\n    if (payload.enabled && this.getConnectionStatus().isConnected()) {\n      return this.device.updatePoint(payload.data);\n    }\n    return null;\n  }\n\n  private pushValue(payload: NodeStoreItem) {\n    if (payload.enabled && this.getConnectionStatus().isConnected()) {\n      return this.device.updateValue(payload.data);\n    }\n    return null;\n  }\n\n  private afterUnregister(payload: NodeStoreItem, force?: boolean) {\n    if (payload.data?.objectInstance && this.getConnectionStatus().isConnected()) {\n      this.device.delObject(payload.data?.objectInstance, payload.data?.objectType?.value);\n    }\n    if (force) {\n      let output = this.outputs[this._oPointsSlot].data;\n      if (output) {\n        delete output[payload.identifier];\n      }\n      this.setOutputData(this._oPointsSlot, output);\n    }\n  }\n\n}\n\nContainer.registerNodeType(BACNET_SERVER_NODE_TYPE, BACnetServerNode);\n","import { isNull, unionToArray } from '../../../../utils/helper';\nimport { NodeStoreItem } from '../../../../utils/pattern';\n\nexport interface ContainerNodeStore<T> {\n\n  checkExistence(payload: NodeStoreItem): void;\n\n  lookup(identifier: string): any;\n\n  register(payload: NodeStoreItem, afterUpdate?: (p) => T): T;\n\n  update(payload: NodeStoreItem, afterUpdate?: (p) => T, afterUnregisterIfExisted?: (p, force?: boolean) => void): T;\n\n  unregister(payload: NodeStoreItem, force?: boolean, afterUnregister?: (p, force?: boolean) => void): void;\n\n  listNodeIds(): string[];\n\n}\n\nexport interface ContainerErrorNodeStore {\n\n  hasError(nodeId: string): boolean;\n\n  addError(nodeId: string): void;\n\n  removeError(nodeId: string): void;\n\n  listErrors(): Set<string>;\n\n}\n\nexport interface IOneIdentifierManyNodeStore<T> extends ContainerNodeStore<T> {\n\n  has(identifier, predicate: (key, value) => boolean): boolean;\n\n}\n\nexport class DefaultContainerErrorNode implements ContainerErrorNodeStore {\n  private nodeIdErrors: Set<string> = new Set<string>();\n\n  hasError(nodeId: string): boolean {\n    return this.nodeIdErrors.has(nodeId);\n  }\n\n  addError(nodeId: string): void {\n    this.nodeIdErrors.add(nodeId);\n  }\n\n  removeError(nodeId: string): void {\n    this.nodeIdErrors.delete(nodeId);\n  }\n\n  listErrors(): Set<string> {\n    return this.nodeIdErrors;\n  }\n}\n\nexport abstract class AbstractContainerStore<T> implements ContainerNodeStore<T> {\n\n  abstract checkExistence(payload: NodeStoreItem): void;\n\n  abstract lookup(identifier: string): any;\n\n  abstract unregister(payload: NodeStoreItem, force?: boolean, cb?: (p, force?: boolean) => void): void;\n\n  abstract listNodeIds(): string[];\n\n  register(payload: NodeStoreItem, cb?: (p) => T): T {\n    this.checkExistence(payload);\n    this.add(payload);\n    return cb && cb(payload);\n  }\n\n  update(payload: NodeStoreItem, afterUpdate?: (p) => T, afterUnregisterIfExisted?: (p, force?: boolean) => void): T {\n    if (payload?.identifier !== payload?.prev?.identifier) {\n      try {\n        this.checkExistence(payload?.prev);\n      } catch (e) {\n        this.unregister(payload?.prev, true, (p) => afterUnregisterIfExisted && afterUnregisterIfExisted(p, true));\n      }\n      return this.register(payload, afterUpdate);\n    }\n    if (!payload?.enabled) {\n      this.unregister(payload, false, (p) => afterUnregisterIfExisted && afterUnregisterIfExisted(p, false));\n      return payload?.data;\n    }\n    this.add(payload);\n    return afterUpdate && afterUpdate(payload);\n  }\n\n  protected abstract add(payload: NodeStoreItem): string;\n\n}\n\nexport abstract class OneIdentifierOneNodeStore<T> extends AbstractContainerStore<T> {\n\n  protected nodes: { [identifier: string]: { identifier: string, nodeId: string; enabled: boolean; func: Function } } = {};\n  protected errors: ContainerErrorNodeStore = new DefaultContainerErrorNode();\n\n  checkExistence(payload: NodeStoreItem): void {\n    if (this.nodes[payload?.identifier]) {\n      if (payload.lenient && this.nodes[payload.identifier].nodeId === payload.nodeId) {\n        return;\n      }\n      if (this.nodes[payload.identifier].nodeId !== payload.nodeId) {\n        this.errors.addError(payload.nodeId);\n      }\n      throw new Error(this.alreadyExistedMsg(payload));\n    }\n  }\n\n  lookup(identifier: string): { identifier: string, nodeId: string; enabled: boolean; func: Function } {\n    return this.nodes[identifier] ?? null;\n  }\n\n  update(payload: NodeStoreItem, afterUpdate?: (p) => T, afterUnregisterIfExisted?: (p, force?: boolean) => void): T {\n    this.errors.removeError(payload?.nodeId);\n    return super.update(payload, afterUpdate, afterUnregisterIfExisted);\n  }\n\n  unregister(payload: NodeStoreItem, force?: boolean, cb?: (p, force?: boolean) => void): void {\n    if (isNull(payload)) {\n      return null;\n    }\n    this.errors.removeError(payload?.nodeId);\n    let item = this.lookup(payload.identifier);\n    if (isNull(item)) {\n      return null;\n    }\n    if (item.nodeId !== payload.nodeId) {\n      return null;\n    }\n    if (force) {\n      delete this.nodes[payload.identifier];\n    } else {\n      this.nodes[this.add(payload)].enabled = false;\n    }\n    return cb && cb(payload);\n  }\n\n  listNodeIds(): string[] {\n    return unionToArray(Object.values(this.nodes).map(v => v.nodeId), this.errors.listErrors());\n  }\n\n  protected add(payload: NodeStoreItem): string {\n    this.errors.removeError(payload?.nodeId);\n    this.nodes[payload.identifier] = {\n      identifier: payload.identifier,\n      nodeId    : payload.nodeId,\n      enabled   : payload.enabled,\n      func      : payload.callback,\n    };\n    return payload.identifier;\n  }\n\n  protected abstract alreadyExistedMsg(payload: NodeStoreItem): string;\n\n}\n\nexport abstract class OneIdentifierManyNodeStore<T> extends AbstractContainerStore<T>\n  implements IOneIdentifierManyNodeStore<T> {\n\n  private nodes: { [identifier: string]: { [nodeId: string]: { enabled: boolean; func?: Function } } } = {};\n\n  checkExistence(payload: NodeStoreItem): void {\n    if (this.nodes[payload?.identifier] && this.nodes[payload?.identifier][payload?.nodeId]) {\n      if (payload?.lenient) {\n        return;\n      }\n      throw new Error(this.alreadyExistedMsg(payload));\n    }\n  }\n\n  lookup(identifier: string): { [nodeId: string]: { enabled: boolean; func?: Function } } {\n    return this.nodes[identifier] ?? {};\n  }\n\n  unregister(payload: NodeStoreItem, force?: boolean, afterUnregister?: (p, force?: boolean) => void): void {\n    let item = this.lookup(payload.identifier);\n    if (isNull(item) || isNull(item[payload?.nodeId])) {\n      return null;\n    }\n    if (force) {\n      if (this.nodes[payload?.identifier]) {\n        delete this.nodes[payload?.identifier][payload?.nodeId];\n      }\n    } else {\n      this.nodes[this.add(payload)][payload?.nodeId].enabled = false;\n    }\n    return afterUnregister && afterUnregister(payload);\n  }\n\n  listNodeIds(): string[] {\n    return unionToArray(...Object.values(this.nodes).map(v => Object.keys(v)));\n  }\n\n  has(identifier, predicate: (key, value) => boolean): boolean {\n    return Object.entries(this.lookup(identifier)).some(object => predicate(object[0], object[1]));\n  }\n\n  protected add(payload: NodeStoreItem): string {\n    this.nodes[payload?.identifier] = this.nodes[payload?.identifier] ?? {};\n    this.nodes[payload?.identifier][payload?.nodeId] = {\n      enabled: payload?.enabled,\n      func   : payload?.callback,\n    };\n    return payload?.identifier;\n  }\n\n  protected abstract alreadyExistedMsg(payload: NodeStoreItem): string;\n}\n","import { ErrorCallbackHandler } from '../../../utils/decorators';\nimport { ConnectionStatus } from '../../../utils/enums';\nimport { DefaultObservable, ICentralizedListener, NodeStoreItem, Observable, Observer } from '../../../utils/pattern';\nimport { Side } from '../../container';\nimport { ContainerNode } from '../../container-node';\nimport Registry from '../../registry';\nimport { ConnectionOutput, ExternalConnectionNode, ExternalConnectionNodeMixin } from './connection-node-mixin';\n\nexport interface IProtocolDeviceNode extends ExternalConnectionNode, ICentralizedListener {\n\n  statusObservable(observers: Observer<ConnectionOutput>[]): Observable<ConnectionOutput>;\n\n}\n\nexport abstract class ProtocolDeviceNode extends ExternalConnectionNodeMixin(ContainerNode)\n  implements IProtocolDeviceNode {\n  private readonly _title: string;\n\n  protected constructor(container, title, description) {\n    super(container);\n    this._title = title;\n    this.description = description;\n    this.mixinConnectionStatusOutput();\n  }\n\n  onCreated() {\n    super.onCreated();\n    // this.name = `${this._title} cid_${this.container.id}_id${this.id}`;\n  }\n\n  onAdded() {\n    this.startOrStop();\n    this.applyTitle();\n  }\n\n  onAfterSettingsChange() {\n    this.startOrStop();\n    this.applyTitle();\n  }\n\n  onInputUpdated() {\n    this.reEvaluateSettingByInput(this.inputs, this.settings);\n    this.onAfterSettingsChange();\n  }\n\n  onRemoved() {\n    this.stop();\n    super.onRemoved();\n  }\n\n  applyTitle() {\n    super.applyTitle();\n  }\n\n  statusObservable(observers: Observer<ConnectionOutput>[]): Observable<ConnectionOutput> {\n    observers.push(this.statusObserver());\n    return new DefaultObservable<ConnectionOutput>(observers);\n  }\n\n  abstract listen({ action, payload }: { action: string; payload: NodeStoreItem });\n\n  abstract connObserverNodes(): Observer<ConnectionOutput>[];\n\n  protected statusOutputIdx(): number {\n    return 0;\n  }\n\n  protected enableDescription(): string {\n    return `Enable ${this._title}`;\n  }\n\n  protected startOrStop(): void {\n    if (this.side !== Side.server) return;\n    this.stop(); // to restart device\n    this.connectionStatus = ConnectionStatus.UNCONNECTED;\n    if (this.isEnabled()) {\n      this.kickoff(this);\n    }\n    this.notifyConnStatusOutput();\n  }\n\n  @ErrorCallbackHandler((err, node) => node.handleErrorInKickOff(err))\n  protected kickoff(node: ProtocolDeviceNode) {\n    node.createThenStart();\n    this.notifyConnStatusOutput(ConnectionStatus.CONNECTED);\n  }\n\n  protected handleErrorInKickOff(err: Error) {\n    this.notifyConnStatusOutput(ConnectionStatus.ERROR, err.message);\n  }\n\n  protected notifyConnStatusOutput(status?: ConnectionStatus, errMsg?: string) {\n    this.connectionStatus = status ?? this.connectionStatus;\n    let nodeId = Registry.getId(this.cid, this.id);\n    this.statusObservable(this.connObserverNodes()).notify(new ConnectionOutput(this.getConnectionStatus(), errMsg),\n                                                           nodeId);\n  }\n\n  protected abstract createThenStart(): void;\n\n  protected abstract stop(): void;\n}\n\n","import { Enumify } from 'enumify';\n\nexport class ConnectionStatus extends Enumify {\n\n  static CONNECTED = new ConnectionStatus('CONNECTED');\n  static DISCONNECTED = new ConnectionStatus('DISCONNECTED');\n  static ERROR = new ConnectionStatus('ERROR');\n  static UNCONNECTED = new ConnectionStatus('UNCONNECTED');\n  static _ = ConnectionStatus.closeEnum();\n\n  readonly label: string;\n\n  constructor(label: string) {\n    super();\n    this.label = label;\n  }\n\n  static lookupByLabel(label: string): ConnectionStatus {\n    return ConnectionStatus.enumValues.map(e => <ConnectionStatus><unknown>e).find(value => value.label === label);\n  }\n\n  isConnected(): boolean {\n    return this === ConnectionStatus.CONNECTED;\n  }\n\n  isError(): boolean {\n    return this === ConnectionStatus.ERROR;\n  }\n\n  isDisconnected(): boolean {\n    return this === ConnectionStatus.DISCONNECTED;\n  }\n\n  isUnconnected(): boolean {\n    return this === ConnectionStatus.UNCONNECTED;\n  }\n}\n\nexport enum HistoryMode {\n  COV,\n  TRIGGERED,\n}\n","import { Constructor, isFunction } from '../../utils/helper';\nimport { Node, NodeSettingConfig, NodeSettings} from '../node';\nimport { NodeInput, Type } from '../node-io';\n\n/**\n * Represents decorator to evaluate {@link NodeSettings} by {@link NodeInput}\n */\nexport interface NodeInputEvaluation {\n  reEvaluateSettingByInput(inputs: { [p: number]: NodeInput }, settings: { [p: string]: NodeSettings }): void;\n}\n\nexport class NodeInputOutputDecoratorProxy implements NodeInputEvaluation {\n  func: any;\n\n  private constructor(func: any) {\n    this.func = func;\n  }\n\n  // static execute(func: any): void {\n  //   new NodeInputOutputDecoratorProxy(func).reEvaluateSettingByInput(this.inputs, this.settings);\n  // }\n\n  reEvaluateSettingByInput(inputs: { [p: number]: NodeInput }, settings: { [p: string]: NodeSettings }): void {\n    if (this.func && isFunction(this.func)) {\n      this.func(inputs, settings);\n    }\n  }\n}\n\nexport interface HasEnabled {\n  isEnabled(): boolean;\n}\n\nexport function AbleEnableNode<TBase extends Constructor<Node>>(Base: TBase) {\n  abstract class AbleEnableNodeBase extends Base implements NodeInputEvaluation, HasEnabled {\n    mixinEnableInputSetting(): NodeSettingConfig {\n      this.addInputWithSettings(this.enableSettingKey(), Type.BOOLEAN, false, this.enableDescription());\n      return { conditions: {} };\n    }\n\n    reEvaluateSettingByInput(inputs: { [p: number]: NodeInput }, settings: { [p: string]: NodeSettings }): void {\n      //TODO: need find a way to auto execute super mixin method\n      // NodeInputOutputDecoratorProxy.execute(super['reEvaluateSettingByInput']);\n      if (isFunction(super['reEvaluateSettingByInput'])) {\n        super['reEvaluateSettingByInput'](inputs, settings);\n      }\n      this.settings[this.enableSettingKey()].value =\n        this.inputs[this.enableInputIdx()].data ?? this.settings[this.enableSettingKey()].value;\n    }\n\n    protected abstract enableDescription(): string;\n\n    protected enableInputIdx(): number {\n      return 0;\n    }\n\n    protected enableSettingKey(): string {\n      return 'enable';\n    }\n\n    isEnabled(): boolean {\n      let parentIsEnabled = true;\n      if (isFunction(super['isEnabled'])) {\n        parentIsEnabled = super['isEnabled']();\n      }\n      return parentIsEnabled && this.settings[this.enableSettingKey()]?.value;\n    }\n  }\n\n  return AbleEnableNodeBase;\n}\n","//\n// BACnet device implementation.\n// Property of an object, such as the current value or maximum reading.\n//\n\nconst nodeUtil = require('util');\nconst bacnet   = require('node-bacnet');\n\nconst propertyTypeMap = require('./typemap-property');\nconst Util            = require('./util');\n\nconst pi = bacnet && bacnet.enum.PropertyIdentifier;\n\nconst typeEnumMap = bacnet && {\n  [pi.OBJECT_TYPE]: bacnet.enum.ObjectType,\n};\n\nclass BACnetObjectProperty {\n  constructor(obj, propertyId, typeId = undefined, readOnly = false) {\n    this.obj           = obj;\n    this.propertyId    = propertyId;\n    this.typeId        = typeId === undefined || typeId === null ? propertyTypeMap[propertyId] : typeId;\n    this.readOnly      = readOnly;\n    this.subscriptions = [];\n    if (this.typeId === undefined) {\n      throw new Error(\n        `Property ${Util.getPropName(propertyId)} has no default ` +\n        `type set, you must specify one yourself or update the bacnet-device ` +\n        `Node module.`,\n      );\n    }\n\n    this.callbacks = [];\n  }\n\n  get value() {\n    return this._value;\n  }\n\n  set value(newValue) {\n    if (this.readOnly) {\n      throw new Error(`Property ${Util.getPropName(this.propertyId)} cannot be changed.`);\n    }\n    this._value = newValue;\n\n    // Notify any subscribeCov listeners.\n    this.obj.onPropertyChanged(this);\n\n    // Notify and subscribeProperty listeners.\n    this.callbacks.forEach(cb => {\n      cb.fn(this);\n    });\n  }\n\n  addCallback(id, fn) {\n    this.callbacks.push({ id: id, fn: fn });\n  }\n\n  removeCallback(id) {\n    this.callbacks = this.callbacks.filter(cb => cb.id !== id);\n  }\n\n  valueAsString() {\n    let lookup = typeEnumMap[this.propertyId];\n    let value  = this._value;\n    if (lookup) {\n      value = Util.getEnumName(lookup, value);\n    }\n    return value;\n  }\n\n  toString() {\n    return `BACnetObjectProperty { ${Util.getPropName(\n      this.propertyId,\n    )} = ${this.valueAsString()} }`;\n  }\n\n  [nodeUtil.inspect.custom]() {\n    return this.toString();\n  }\n}\n\nmodule.exports = BACnetObjectProperty;\n","import { Enumify } from 'enumify';\nimport { PointModel, PointValue, PointValueCreator } from '../../../../../backend/models/point-model';\nimport { isNull } from '../../../../../utils/helper';\n\nexport class PointKind extends Enumify {\n  static ANALOG_INPUT = new PointKind(0, 'analog-input');\n  static ANALOG_OUTPUT = new PointKind(1, 'analog-output');\n  static ANALOG_VALUE = new PointKind(2, 'analog-value');\n  static BINARY_INPUT = new PointKind(3, 'binary-input');\n  static BINARY_OUTPUT = new PointKind(4, 'binary-output');\n  static BINARY_VALUE = new PointKind(5, 'binary-value');\n  static MULTI_STATE_INPUT = new PointKind(13, 'multi-state-input');\n  static MULTI_STATE_OUTPUT = new PointKind(14, 'multi-state-output');\n  static MULTI_STATE_VALUE = new PointKind(19, 'multi-state-value');\n\n  static _ = PointKind.closeEnum();\n\n  readonly value: number;\n  readonly label: string;\n\n  constructor(value: number, label: string) {\n    super();\n    this.value = value;\n    this.label = label;\n  }\n\n  static items(): { text: string; value: any }[] {\n    return PointKind.enumKeys.map(k => {\n      return { value: k, text: (<PointKind>PointKind.enumValueOf(k)).label };\n    });\n  }\n\n  static lookupByValue(objectType: number): PointKind {\n    return PointKind.enumValues.map(pk => <PointKind>pk).find(pk => pk.value === objectType);\n  }\n\n  static lookupByLabel(objectType: string): PointKind {\n    return PointKind.enumValues.map(pk => <PointKind>pk).find(pk => pk.label === objectType);\n  }\n}\n\nexport interface BacnetPoint extends PointModel {\n  objectInstance: number;\n\n  objectType: PointKind;\n\n  objectName: string;\n}\n\nexport class BacnetPointCreator {\n  private constructor() {\n  }\n\n  static from = (json: object): BacnetPoint => {\n    if (isNull(json)) {\n      return null;\n    }\n    // @ts-ignore\n    let pv = json?.pointValue;\n    // @ts-ignore\n    return BacnetPointCreator.create(json?.enabled, json?.objectInstance, json?.objectType, json?.objectName,\n                                     pv?.presentValue, pv?.priority, pv?.priorityArray);\n  };\n\n  static create = (enabled: boolean, objectInstance: number, objectType: PointKind, objectName: string,\n                   presentValue?: number, priority?: number, priorityArray?: any): BacnetPoint => {\n    return BacnetPointCreator.by(enabled, objectInstance, objectType, objectName,\n                                 PointValueCreator.create(presentValue, priority, priorityArray));\n  };\n\n  static by = (enabled: boolean, objectInstance: number, objectType: PointKind, objectName: string,\n               pointValue: PointValue): BacnetPoint => {\n    return new DefaultBacnetPoint(enabled, objectInstance, objectType, objectName, pointValue);\n  };\n}\n\nclass DefaultBacnetPoint implements BacnetPoint {\n  enabled: boolean;\n  objectInstance: number;\n  objectType: PointKind;\n  objectName: string;\n  pointValue: PointValue;\n\n  constructor(enabled: boolean, objectInstance: number, objectType: PointKind, objectName: string,\n              pointValue: PointValue) {\n    this.enabled = enabled || false;\n    this.objectInstance = objectInstance;\n    this.objectType = objectType;\n    this.objectName = objectName;\n    this.pointValue = pointValue;\n  }\n\n  identifier(): string {\n    return `${this.objectType.enumKey}:${this.objectInstance}`;\n  }\n\n  mightOnlyValueChanged(bp: BacnetPoint): boolean {\n    return (this.enabled === bp?.enabled && this.objectInstance === bp?.objectInstance &&\n            this.objectType === bp?.objectType && this.objectName === bp?.objectName);\n  }\n\n  equals(bp: BacnetPoint): boolean {\n    return this.identifier() === bp?.identifier();\n  }\n}\n","import { Node, SettingType} from '../../../node';\nimport { Container } from '../../../container';\nimport { Type } from '../../../node-io';\n\nexport enum LORA_DATA_TYPE_NAMES {\n  INT8 = 0,\n  UINT8,\n  INT16,\n  UINT16,\n  INT32,\n  UINT32,\n  FLOAT,\n}\n\nexport const LORA_DATA_TYPE_LENGTHS = [\n  1, // INT8\n  1, // UINT8\n  2, // INT16\n  2, // UINT16\n  4, // INT32\n  4, // UINT32\n  4, // FLOAT\n];\n\nexport class LoRaRawTwoWayInput extends Node {\n  payloadDefinition: Array<LORA_DATA_TYPE_NAMES> = [];\n\n  constructor() {\n    super();\n    this.title = `Nube LoRaRAW Two Way In`;\n    this.description = 'This node parses Nubes LoRa Two Way protocol';\n    this.settings['enable'] = {\n      description: 'enable',\n      type: SettingType.BOOLEAN,\n      value: false,\n    };\n    this.settings['senderId'] = {\n      description: 'sender Id',\n      type: SettingType.NUMBER,\n      value: 0,\n    };\n    this.settings['port'] = {\n      description: 'port number',\n      type: SettingType.NUMBER,\n      value: 0,\n    };\n    this.settings['types'] = {\n      description: 'Types',\n      type: SettingType.READONLY,\n      value: 'INT8, INT16, INT32, FLOAT',\n      // value: 'INT8, UINT8, INT16, UINT16, INT32, UINT32, FLOAT',\n    };\n    this.settings['definition'] = {\n      description: 'payload definition (JSON)',\n      type: SettingType.STRING,\n      value: '',\n    };\n\n    this.addInput('rawInput', Type.STRING);\n    this.addOutput('error', Type.STRING);\n  }\n\n  init() {\n    this.updateOutputs();\n  }\n\n  onAdded() {\n    this.payloadDefinition = this.stringToDataTypes(this.settings['definition'].value);\n  }\n\n  onInputUpdated() {\n    let data: string = this.getInputData(0) || '';\n    if (this.settings['enable'].value === false) return;\n    if (!data) return;\n    if (!data || data.length <= 6 * 2 || data.substring(0, 8) !== 'FFFFFFFF') {\n      // 6 = 4(ff's) + 1(slaveid) + 1(port). (x2 for HEX)\n      return;\n    }\n\n    const senderId = parseInt(data.substring(10, 12), 16);\n    const port = parseInt(data.substring(12, 14), 16);\n\n    if (senderId !== this.settings['senderId'].value || port !== this.settings['port'].value) {\n      return;\n    }\n\n    // remove newline\n    if (data.substring(data.length - 2, data.length) === '\\r\\n') {\n      data = data.substring(0, data.length - 2);\n    } else if (data.length % 2 === 1 && data[data.length - 1] === '\\n') {\n      data = data.substring(0, data.length - 1);\n    }\n\n    // PARSING\n\n    const parseError = msg => {\n      this.setOutputData(0, 'parse error: ' + msg);\n    };\n\n    // convert hex string to buffer\n    let buffer = Buffer.from(data.substring(14), 'hex');\n    let pointParsed = new Array<boolean>(this.payloadDefinition.length);\n    pointParsed.fill(false);\n\n    for (let i = 0; i < buffer.length; ) {\n      let point = buffer.readUInt8(i++);\n      let type_length = 0;\n\n      if (point >= this.payloadDefinition.length) {\n        parseError('invalid point ' + point);\n        return;\n      }\n      if (pointParsed[point]) {\n        parseError('point already parsed: ' + point);\n        return;\n      }\n\n      type_length = LORA_DATA_TYPE_LENGTHS[this.payloadDefinition[point]];\n\n      if (buffer.length - i < type_length) {\n        parseError('invalid length');\n        return;\n      }\n\n      switch (this.payloadDefinition[point]) {\n        case LORA_DATA_TYPE_NAMES.INT8:\n          this.setOutputData(point + 1, buffer.readInt8(i));\n          break;\n\n        case LORA_DATA_TYPE_NAMES.UINT8:\n          this.setOutputData(point + 1, buffer.readUInt8(i));\n          break;\n\n        case LORA_DATA_TYPE_NAMES.INT16:\n          this.setOutputData(point + 1, buffer.readInt16LE(i));\n          break;\n\n        case LORA_DATA_TYPE_NAMES.UINT16:\n          this.setOutputData(point + 1, buffer.readUInt16LE(i));\n          break;\n\n        case LORA_DATA_TYPE_NAMES.INT32:\n          this.setOutputData(point + 1, buffer.readInt32LE(i));\n          break;\n\n        case LORA_DATA_TYPE_NAMES.UINT32:\n          this.setOutputData(point + 1, buffer.readUInt32LE(i));\n          break;\n\n        case LORA_DATA_TYPE_NAMES.FLOAT:\n          this.setOutputData(point + 1, buffer.readFloatLE(i));\n          break;\n      }\n      pointParsed[point] = true;\n      i += type_length;\n    }\n\n    this.setOutputData(0, null);\n  }\n\n  onAfterSettingsChange() {\n    this.payloadDefinition = this.updateOutputs();\n    this.setOutputData(0, null);\n    this.onInputUpdated();\n  }\n\n  private updateOutputs() {\n    const data = this.stringToDataTypes(this.settings['definition'].value);\n    if (this.payloadDefinition.length !== data.length) {\n      const outputsCount = this.getOutputsCount();\n      for (let i = 1; i < outputsCount; i++) {\n        this.removeOutput(i);\n      }\n      for (let i = 0; i < data.length; i++) {\n        this.addOutput(i.toString(), Type.NUMBER);\n      }\n      this.updateNodeOutput();\n    }\n    return data;\n  }\n\n  stringToDataTypes(str) {\n    const data = str\n      .toUpperCase()\n      .replace(/ /g, '')\n      .split(',')\n      .filter(x => x !== '');\n\n    if (data && data.length) {\n      for (let i = 0; i < data.length; i++) {\n        if (LORA_DATA_TYPE_NAMES[data[i]] === undefined) {\n          this.setOutputData(1, 'settings parse error');\n          return undefined;\n        }\n        data[i] = LORA_DATA_TYPE_NAMES[data[i]];\n      }\n    }\n    return data;\n  }\n}\nContainer.registerNodeType('protocols/lora-raw/lora-raw-two-way-in', LoRaRawTwoWayInput);\n","module.exports = require(\"modbus-serial\");","module.exports = require(\"net\");","module.exports = require(\"mqtt-match\");","import { PointValue } from '../../../../backend/models/point-model';\nimport { NodeStoreItem } from '../../../../utils/pattern';\nimport { OneIdentifierManyNodeStore, OneIdentifierOneNodeStore } from '../model/container-node-store';\n\nexport class MqttPointStoreItem implements NodeStoreItem {\n\n  identifier: string;\n  nodeId: string;\n  enabled: boolean;\n  lenient?: boolean;\n  publisher: {\n    identifier?: string,\n    prev?: NodeStoreItem,\n    data?: any,\n    callback?: Function\n  };\n  subscriber: {\n    identifier?: string,\n    prev?: NodeStoreItem,\n    callback?: Function\n  };\n\n  constructor(identifier: string, nodeId: string, enabled: boolean,\n              publisher: { identifier?: string; prev?: NodeStoreItem; data?: any; callback?: Function },\n              subscriber: { identifier?: string; prev?: NodeStoreItem; callback?: Function }) {\n    this.identifier = identifier;\n    this.nodeId = nodeId;\n    this.enabled = enabled;\n    this.publisher = publisher;\n    this.subscriber = subscriber;\n  }\n\n  toPublisher(): NodeStoreItem {\n    return this.to(this.publisher as NodeStoreItem);\n  }\n\n  toSubscriber(): NodeStoreItem {\n    return this.to(this.subscriber as NodeStoreItem);\n  }\n\n  private to(ps: NodeStoreItem) {\n    return {\n      identifier: ps?.identifier ?? this.identifier,\n      nodeId    : this.nodeId,\n      enabled   : this.enabled,\n      prev      : ps?.prev,\n      data      : ps?.data,\n      lenient   : this.lenient,\n      callback  : ps?.callback,\n    } as NodeStoreItem;\n  }\n}\n\n//TODO: current only per MQTT topic per point node. Can enhance to support multiple point nodes with same topic\nexport class MqttPublisherStore extends OneIdentifierOneNodeStore<PointValue> {\n\n  protected alreadyExistedMsg(payload: NodeStoreItem): string {\n    return `Already exist MQTT publisher bind to topic ${payload?.identifier}`;\n  }\n\n}\n\nexport class MqttSubscriberStore extends OneIdentifierManyNodeStore<any> {\n\n  protected alreadyExistedMsg(payload: NodeStoreItem): string {\n    return `Already existed MQTT subscriber bind to topic ${payload?.identifier} with node id ${payload.nodeId}`;\n  }\n\n}\n","module.exports = require(\"serialport\");","import FileUtils from './file-utils';\n\nexport default class UuidUtils {\n  /**\n   * Generates a UUID 28 digit\n   * @returns {string}\n   */\n  static createUUID = (a: string = ''): string =>\n    a\n      ? ((Number(a) ^ (Math.random() * 16)) >> (Number(a) / 4)).toString(16)\n      : `${1e7}-${1e3}-${4e3}-${8e3}-${1e11}`.replace(/[018]/g, UuidUtils.createUUID);\n  /**\n   * Generates a UUID 8 digit\n   * @returns {string}\n   */\n  static create8DigId = (a: string = ''): string =>\n    a\n      ? ((Number(a) ^ (Math.random() * 16)) >> (Number(a) / 4)).toString(16)\n      : `${1e7}`.replace(/[018]/g, UuidUtils.create8DigId);\n\n  /**\n   * Generates a UUID 12 digit\n   * @returns {string}\n   */\n  static create12DigId = (a: string = ''): string =>\n    a\n      ? ((Number(a) ^ (Math.random() * 16)) >> (Number(a) / 4)).toString(16)\n      : `${1e7}-${4e3}`.replace(/[018]/g, UuidUtils.create12DigId);\n\n  static isUUID(data: string): boolean {\n    const dataArray: string[] = data\n      .toString()\n      .trim()\n      .split('-');\n    return dataArray.length >= 1 && dataArray[0].length === 8;\n  }\n\n  static async isUUIDFile(filePath): Promise<boolean> {\n    try {\n      let fileContent = await FileUtils.readFile(filePath);\n      if (fileContent) {\n        return UuidUtils.isUUID(fileContent);\n      } else return false;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  static async makeUUIDFile(dirPath, fileName): Promise<void> {\n    try {\n      await FileUtils.createDirectory(dirPath);\n      await FileUtils.writeFile(`${dirPath}/${fileName}`, UuidUtils.create8DigId());\n    } catch (e) {\n      throw e;\n    }\n  }\n}\n","module.exports = require(\"os\");","const ip = require('ip'); //for checking if IPs are valid\nconst network = require('network'); //for getting IPs and gateway address\nimport { exec } from 'child_process';\nconst cp = require('child_process');\nexport default class IpAddressUtils {\n  /**\n   * Get current network info\n   * @returns {object}\n   */\n  static getActiveNetworks() {\n    return new Promise<Array<any>>(resolve => {\n      network.get_interfaces_list(function(err, obj) {\n        if (err) resolve();\n        if (!obj) resolve();\n        resolve(obj);\n      });\n    });\n  }\n\n  /**\n   * Runs a system command\n   * @param iface {string} Name of the physical system interface\n   * @param upDown {string} system command options\n   * @returns {Promise}\n   *\n   */\n\n  static networkUpDown(iface: string, upDown: string) {\n    return new Promise((resolve, reject) => {\n      let command = `sudo ip link set ${iface} ${upDown}`;\n      // let command = 'sudo ip link set' +' '+ iface +' '+upDown\n      exec(command, (err, stdout, stderr) => {\n        if (err) {\n          reject({ err, stderr });\n        } else {\n          resolve(stdout);\n        }\n      });\n    });\n  }\n\n  /** check if new ip is valid\n   * @description Method for checking and build an ip address\n   * @param {string} newIP pass in an ip address\n   * @param {string} netNetmask pass in an ip net mask\n   * @param {string} newGateway pass in an  ip gateway\n   * @param newNameserver\n   * @returns {object} Will return a validIp: true, ipSubnet: '192.168.15.1/24 or if invalid it will return false\n   */\n\n  static checkIpValid(newIP: string, netNetmask: string, newGateway: string, newNameserver: string) {\n    const checkIP = ip.isV4Format(newIP);\n    const checkNetMask = ip.isV4Format(netNetmask);\n    const checkGateway = ip.isV4Format(newGateway);\n    const nameserver = ip.isV4Format(newNameserver);\n\n    if (checkIP && checkNetMask && checkGateway && nameserver) {\n      return true;\n    } else return false;\n  }\n\n  /**\n   * Gets BBB interface details\n   * @returns {Promise}\n   *\n   */\n  static bbbGetInterfaceDetails() {\n    return new Promise((resolve, reject) => {\n      cp.execSync('connmanctl services', (err, stdout, stderr) => {\n        if (err) {\n          reject({ err, stderr });\n        } else {\n          resolve(\n            stdout\n              .toString()\n              .replace(/\\s/g, '')\n              .substring(8),\n          );\n        }\n      });\n    });\n  }\n\n  /**\n   * Set BBB network as DHCP\n   * @returns {Promise}\n   *\n   */\n  static bbbSetIPDHCP(iface) {\n    return new Promise((resolve, reject) => {\n      const setIpDHCP = `sudo connmanctl config ${iface} --ipv4 dhcp`;\n      cp.execSync(setIpDHCP, (err, stdout, stderr) => {\n        if (err) {\n          reject({ err, stderr });\n        } else {\n          resolve(true);\n        }\n      });\n    });\n  }\n\n  /**\n   * Set BBB network as fixed IP\n   * @returns {Promise}\n   *\n   */\n  static bbbSetIPFixed(iface, ipAddress: string, subnetMask: string, gateway: string) {\n    return new Promise((resolve, reject) => {\n      const setIP = `sudo connmanctl config ${iface} --ipv4 manual ${ipAddress} ${subnetMask} ${gateway} --nameservers 8.8.8.8 8.8.4.4`;\n      cp.execSync(setIP, (err, stdout, stderr) => {\n        if (err) {\n          reject({ err, stderr });\n        } else {\n          resolve(true);\n        }\n      });\n    });\n  }\n}\n","module.exports = require(\"ip\");","export default class NodeColours {\n  /**\n   * Changes the node colour for the user\n   * NORMAL, light grey\n   * INFO, light green\n   * WARNING, light orange\n   * ERROR, light red\n   * @param self {string} pass in this instance\n   * @param NodeState {string} pass in the colour to use\n   */\n    static nodeColourChange(self, NodeState) {\n        self.setNodeState(NodeState);\n    }\n}\n","module.exports = require(\"source-map-support\");","module.exports = require(\"process\");","module.exports = require(\"minimist\");","module.exports = require(\"dotenv\");","import config from '../config';\nimport { Database } from '../database/database';\nimport {\n  EDGES_PARENT_CONTAINER_TYPE,\n  MODULES_PARENT_CONTAINER_TYPE,\n  SERVICES_PARENT_CONTAINER_TYPE,\n} from '../nodes/constants';\nimport { Container } from '../nodes/container';\nimport { Node } from '../nodes/node';\nimport { EdgesParentContainerNode } from '../nodes/nodes/IoT/datapoint-node';\nimport { ModulesParentContainerNode, ServicesParentContainerNode } from '../nodes/nodes/IoT/installer-node';\n\nexport class Backend {\n  database: Database;\n  edgesContainer: EdgesParentContainerNode;\n  modulesContainer: ModulesParentContainerNode;\n  servicesContainer: ServicesParentContainerNode;\n\n  constructor(database: Database) {\n    this.database = database;\n  }\n\n  start(): void {\n    if (!config.backendSync.enabled) {\n      return;\n    }\n    this.ensureParentContainers().then(() => this.refreshPeriodically());\n  }\n\n  private ensureParentContainers(): Promise<any> {\n    return this.findOrCreateNode(EDGES_PARENT_CONTAINER_TYPE, node => node instanceof EdgesParentContainerNode)\n               .then(edgesContainer => (this.edgesContainer = edgesContainer as EdgesParentContainerNode))\n               .then(() => this.findOrCreateNode(MODULES_PARENT_CONTAINER_TYPE,\n                                                 node => node instanceof ModulesParentContainerNode))\n               .then(modulesContainer => (this.modulesContainer = modulesContainer as ModulesParentContainerNode))\n               .then(() => this.findOrCreateNode(SERVICES_PARENT_CONTAINER_TYPE,\n                                                 node => node instanceof ServicesParentContainerNode))\n               .then(servicesContainer => (this.servicesContainer = servicesContainer as ServicesParentContainerNode));\n  }\n\n  private findOrCreateNode<N extends Node>(type_name: string, f: (Node) => boolean): Promise<N> {\n    const root: Container = Container.containers['0']; // root ID 0 is hard-coded\n    return new Promise((resolve, reject) => {\n      const existingNode = root.getNodes().find(f);\n      if (existingNode) {\n        resolve(<N>existingNode);\n      } else {\n        const newNode = root.createNode(type_name, null, null, false, () => resolve(<N>newNode));\n      }\n    });\n  }\n\n  private refreshPeriodically() {\n    setInterval(() => this.refreshParentContainers(), config.backendSync.nodeRefreshIntervalSeconds * 1000);\n  }\n\n  private refreshParentContainers() {\n    this.edgesContainer.syncWithBackend();\n    this.modulesContainer.syncWithBackend();\n    this.servicesContainer.syncWithBackend();\n  }\n}\n","import { isEmpty, isNull } from '../utils/helper';\nimport { Side } from './container';\nimport { Node } from './node';\nimport Registry from './registry';\nimport Utils from './utils';\n\nconst logger = require('logplease').create('node-link', { color: 5 });\n\nexport class Link {\n  target_node_id: number;\n  target_slot: number;\n  target_input_id?: number;\n}\n\nexport interface LinkInfo {\n  origin_id: number;\n  origin_slot: number;\n  target_id: number;\n  target_slot: number;\n  target_input_id?: number;\n}\n\nexport interface LinkHandler {\n  node: Node;\n\n  /**\n   * Create a link\n   * @param {LinkInfo} link\n   * @return true if create link successfully\n   */\n  make(link: LinkInfo): boolean;\n\n  /**\n   * Disconnect link in node input\n   * @param {number} slot input slot\n   * @param {number} index? input aka input id\n   */\n  disconnectInput(slot: number, index?: number): boolean;\n\n  /**\n   * Disconnect link in node output\n   * @param {number} slot output slot\n   * @param {number} index? output aka output id\n   */\n  disconnectOutput(slot: number, index?: number): boolean;\n\n  /**\n   * Recompute Input links\n   * @param {string} nodeId\n   */\n  recomputeInputLinks(nodeId?: string);\n\n  /**\n   * Recompute Output links\n   * @param {string} nodeId\n   */\n  recomputeOutputLinks(nodeId?: string);\n\n}\n\nexport const createLinkHandler = (node: Node): LinkHandler => {\n  return new DefaultLinkHandler(node);\n};\n\nclass DefaultLinkHandler implements LinkHandler {\n  readonly node: Node;\n\n  constructor(node: Node) {\n    this.node = node;\n  }\n\n  make(link: LinkInfo): boolean {\n    let target_node = this.node.container.getNodeById(link.target_id);\n    if (!target_node) {\n      logger.error('Can\\'t connect, target node not found');\n      return false;\n    }\n\n    //check output exist\n    if (!this.node.outputs || !this.node.outputs[link.origin_slot]) {\n      logger.error('Can\\'t connect, output not found');\n      return false;\n    }\n\n    //check input exist\n    let actualSlot = link.target_input_id ?? link.target_slot;\n\n    if (!target_node.inputs || !target_node.inputs[actualSlot]) {\n      logger.error('Can\\'t connect, input not found');\n      return false;\n    }\n\n    let output = this.node.outputs[link.origin_slot];\n    let input = target_node.inputs[actualSlot];\n\n    //check target node allows connection\n    if (target_node['onConnectInput'] && !target_node['onConnectInput'](actualSlot, output)) {\n      return false;\n    }\n\n    //if target node input already connected\n    if (input.link) target_node.disconnectInputLink(link.target_slot, link.target_input_id);\n\n    //create link\n    if (!output.links) output.links = [];\n\n    output.links.push({\n                        target_node_id : link.target_id,\n                        target_slot    : link.target_slot,\n                        target_input_id: link.target_input_id,\n                      });\n    input.link = { target_node_id: link.origin_id, target_slot: link.origin_slot };\n\n    //update input value\n    input.updated = true;\n    input.data = Utils.parseValue(output.data, input.type);\n    target_node.isUpdated = true;\n\n    if (target_node.id === this.node.id) {\n      this.emitChange(this.node, 'inputs', 'outputs');\n    } else {\n      this.emitChange(this.node, 'outputs');\n      this.emitChange(target_node, 'inputs');\n    }\n    logger.debug('Connected to ' + target_node.getReadableId());\n    return true;\n  }\n\n  disconnectInput(slot: number, index?: number): boolean {\n    // check input exist\n    let inputId = index ?? slot;\n    if (!this.node.inputs || !this.node.inputs[inputId]) {\n      logger.error(`Can't disconnect, input slot: ${inputId} not found on node: ${this.node.id}`);\n      return false;\n    }\n    const input = this.node.inputs[inputId];\n    const link = input.link;\n    if (!link) return false;\n\n    // disconnect output\n    let targetNode = this.node.container.getNodeById(link.target_node_id);\n    if (!targetNode) return false;\n\n    let output = targetNode.outputs[link.target_input_id ?? link.target_slot];\n    if (!output || !output.links) return false;\n    let number = output.links.findIndex(l => this.predicate(l, this.node.id, index, slot));\n    if (number !== -1) {\n      output.links.splice(number, 1);\n    }\n    input.link = null;\n    input.data = undefined;\n    input.updated = true;\n    this.node.isUpdated = true;\n\n    this.emitChange(this.node, 'inputs');\n    this.emitChange(targetNode, 'outputs');\n    logger.debug(`Disconnected from ${targetNode.getReadableId()}`);\n    return true;\n  }\n\n  disconnectOutput(slot: number, index?: number): boolean {\n    // check output exist\n    if (!this.node.outputs || !this.node.outputs[slot]) {\n      logger.error(`Can't disconnect, output slot: ${slot} not found on node: ${this.node.id}`);\n      return false;\n    }\n    const output = this.node.outputs[slot];\n    // check links\n    if (!output.links) return false;\n\n    let i = output.links.length;\n    while (i--) {\n      let link = output.links[i];\n      // remove link\n      const targetNode = this.node.container.getNodeById(link.target_node_id);\n      if (!targetNode) {\n        logger.error(`Node: ${link.target_node_id} is not available`);\n      }\n      if (targetNode && targetNode.inputs && targetNode.inputs[link.target_slot] &&\n          targetNode.inputs[link.target_slot].link) {\n        delete targetNode.inputs[link.target_slot].link;\n        // send null to target node input\n        targetNode.inputs[link.target_slot].data = undefined;\n        targetNode.inputs[link.target_slot].updated = true;\n        targetNode.isUpdated = true;\n        this.emitChange(this.node, 'inputs');\n      } else {\n        logger.error(`Tried to delete input link on: ${targetNode} of slot: ${link.target_slot}`);\n      }\n      output.links.splice(i, 1);\n      logger.debug(`Disconnected from ${targetNode?.getReadableId() ?? link.target_node_id}`);\n    }\n    delete output.links;\n\n    this.emitChange(this.node, 'outputs');\n    return true;\n  }\n\n  recomputeInputLinks(nodeId?: string) {\n    let node = Registry._nodes[nodeId] ?? this.node;\n    let slot = -1;\n    for (const [inputId, input] of Object.entries(node.inputs)) {\n      if (input.setting.hidden) {\n        continue;\n      }\n      slot++;\n      if (isNull(input.link)) {\n        continue;\n      }\n      let link = input.link;\n      let targetNode = node.container.getNodeById(link.target_node_id);\n      if (isNull(targetNode)) {\n        continue;\n      }\n      let outputId = link.target_input_id;\n      let outputSlot = link.target_slot;\n      let output = targetNode.outputs[outputId ?? outputSlot];\n      if (isNull(output)) {\n        continue;\n      }\n      let number = output.links.findIndex(l => this.predicate(l, node.id, +inputId, slot));\n      if (number === -1) {\n        continue;\n      }\n      output.links.splice(number, 1, { target_node_id: node.id, target_slot: slot, target_input_id: +inputId });\n      this.emitChange(targetNode, 'outputs');\n    }\n    this.emitChange(node, 'inputs');\n  }\n\n  recomputeOutputLinks(nodeId?: string) {\n    let node = Registry._nodes[nodeId] ?? this.node;\n    let slot = -1;\n    Object.entries(node.outputs).forEach(([outputId, output]) => {\n      slot++;\n      if (isEmpty(output.links)) {\n        return;\n      }\n      output.links.forEach(link => {\n        let targetNode = node.container.getNodeById(link.target_node_id);\n        if (isNull(targetNode) || isNull(targetNode.inputs[link.target_input_id ?? link.target_slot])) {\n          return;\n        }\n        targetNode.inputs[link.target_input_id ?? link.target_slot].link = {\n          target_node_id : node.id,\n          target_slot    : slot,\n          target_input_id: +outputId,\n        };\n        this.emitChange(targetNode, 'inputs');\n      });\n    });\n    this.emitChange(node, 'outputs');\n  }\n\n  /**\n   * TODO: must make high level for database invoker in isolate place later\n   * @param {Node} node\n   * @param properties\n   * @protected\n   */\n  protected emitChange(node: Node, ...properties) {\n    if (node.side === Side.server) {\n      let s_node = node.serialize();\n      let updated = properties.reduce((o, prop) => ((o[prop] = s_node[prop]), o), {});\n      node.container.db.updateNode(node.id, node.container.id, { $set: updated });\n    }\n  }\n\n  protected predicate(link: Link, targetNodeId: number, targetInputId: number, targetSlot: number): boolean {\n    if (link.target_node_id !== targetNodeId) {\n      return false;\n    }\n    if (link.target_input_id && targetInputId && link.target_input_id === targetInputId) {\n      return true;\n    }\n    return link.target_slot === targetSlot;\n  }\n}\n","import { get, merge } from 'lodash';\nimport { Api } from '../../../backend/api';\nimport { DeviceAPI, EdgeAPI, FolderAPI, NetworkAPI, PointAPI } from '../../../backend/datapoint';\nimport { Device, Edge, Folder, Network, Point } from '../../../backend/entry';\nimport config from '../../../config';\nimport { ERROR } from '../../../events';\nimport { singleton as actor } from '../../../promise-actor';\nimport {\n  DEVICE_CONTAINER_TYPE,\n  EDGE_CONTAINER_TYPE,\n  EDGES_PARENT_CONTAINER_TYPE,\n  GROUP_CONTAINER_TYPE,\n  NETWORK_CONTAINER_TYPE,\n  POINT_NODE_TYPE,\n} from '../../constants';\nimport { Container, Side } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport ApiContainerNode from './shared/api-container-node';\nimport EntryNode from './shared/entry-node';\nimport Mixin from './shared/mixin';\nimport TopLevelApiContainerNode from './shared/top-level-api-container-node';\n\nconst doNothing = () => {\n};\n\nexport class EdgesParentContainerNode extends TopLevelApiContainerNode<Edge> {\n  title: string = 'Edges';\n  extra_node_types = []; // not possible to create edges via API\n\n  collectChildNodes(nodes: Node[]): Node[] {\n    return nodes.filter(n => n instanceof EdgeContainerNode);\n  }\n\n  protected initAPI(): Api<Edge> {\n    return new EdgeAPI();\n  }\n\n  protected fetchChildren(): Promise<Edge[]> {\n    return this.api.list();\n  }\n\n  protected childNodeType(): string[] {\n    return [EDGE_CONTAINER_TYPE];\n  }\n}\n\nexport class EdgeContainerNode extends ApiContainerNode<Edge> {\n  title: string = 'Edge Container';\n  settingFields = {\n    code            : SettingType.STRING,\n    customer_code   : SettingType.STRING,\n    side_code       : SettingType.STRING,\n    model           : SettingType.STRING,\n    firmware_version: SettingType.STRING,\n    data_version    : SettingType.STRING,\n  };\n\n  onAdded() {\n    this.ignore_remove = true;\n    this.removable = false;\n    this.movable = false;\n    super.onAdded();\n  }\n\n  createEntry() {\n    return Promise.reject('ERROR: Edge creation not currently supported.');\n  }\n\n  deleteEntry() {\n    return Promise.reject('ERROR: Edge deletion not currently supported.');\n  }\n\n  collectChildNodes(nodes: Node[]): Node[] {\n    return nodes.filter(v => v instanceof NetworkContainerNode);\n  }\n\n  namePrefix() {\n    return 'Edge';\n  }\n\n  protected initAPI(): Api<Edge> {\n    return new EdgeAPI();\n  }\n\n  protected fetchChildren() {\n    return new NetworkAPI().list(this.entryId());\n  }\n\n  protected childNodeType(): string[] {\n    return [NETWORK_CONTAINER_TYPE];\n  }\n}\n\nexport class NetworkContainerNode extends ApiContainerNode<Network> {\n  title: string = 'Network Container';\n  settingFields = {\n    state   : SettingType.READONLY,\n    protocol: SettingType.READONLY,\n    code    : SettingType.STRING,\n  };\n  private protocols = ['GPIO', 'BACNET', 'MODBUS', 'UNKNOWN'].map(point => ({\n    value: point,\n    text : point,\n  }));\n\n  createSettingForm = (entry: Network) => {\n    return merge(Mixin.prototype.createSettingForm.call(this, entry), {\n      protocol: {\n        value : this.protocols[this.protocols.length - 1].value,\n        type  : SettingType.DROPDOWN,\n        config: {\n          items: this.protocols,\n        },\n      },\n    });\n  };\n\n  collectChildNodes(nodes: Node[]): Node[] {\n    return nodes.filter(v => v instanceof DeviceContainerNode);\n  }\n\n  namePrefix() {\n    return 'Network';\n  }\n\n  createEntry() {\n    const edge_node = <EdgeContainerNode>this.container.container_node;\n    if (!(edge_node instanceof EdgeContainerNode)) {\n      const errorMessage =\n              'Error: Trying to create network, but network node does not exist inside a valid Edge container...';\n      console.log(errorMessage);\n      return Promise.reject(errorMessage);\n    }\n    return this.findFreeIdentifier().then(code => this.api.create(<any>{ code }, edge_node.entryId()));\n  }\n\n  protected initAPI(): Api<Network> {\n    return new NetworkAPI();\n  }\n\n  protected fetchChildren(): Promise<any[]> {\n    return new DeviceAPI().list(this.entryId());\n  }\n\n  protected childNodeType(): string[] {\n    return [DEVICE_CONTAINER_TYPE];\n  }\n}\n\nexport class DeviceContainerNode extends ApiContainerNode<Device> {\n  title: string = 'Device Container';\n  settingFields = {\n    state       : SettingType.READONLY,\n    code        : SettingType.STRING,\n    manufacturer: SettingType.STRING,\n    protocol    : SettingType.STRING,\n    type        : SettingType.STRING,\n  };\n\n  collectChildNodes(nodes: Node[]): Node[] {\n    return nodes.filter(v => v instanceof GroupContainerNode || v instanceof PointNode);\n  }\n\n  namePrefix() {\n    return 'Device';\n  }\n\n  createEntry() {\n    const network_node = <NetworkContainerNode>this.container.container_node;\n    const edge_node = <EdgeContainerNode>network_node.container.container_node;\n    if (!(network_node instanceof NetworkContainerNode)) {\n      const errorMessage =\n              'Error: Trying to create device, but device node does not exist inside a valid Network container...';\n      return Promise.reject(errorMessage);\n    }\n    return this.findFreeIdentifier().then(code => this.api.create(<any>{\n                                                                    edge_id: edge_node.entryId(),\n                                                                    device : {\n                                                                      type: 'EQUIPMENT',\n                                                                      code,\n                                                                    },\n                                                                  },\n                                                                  network_node.entryId()));\n  }\n\n  protected initAPI(): Api<Device> {\n    return new DeviceAPI();\n  }\n\n  protected fetchChildren(): Promise<Folder[]> {\n    return new FolderAPI().list(this.entryId());\n  }\n\n  protected childNodeType(): string[] {\n    return [GROUP_CONTAINER_TYPE, POINT_NODE_TYPE];\n  }\n}\n\nexport class GroupContainerNode extends ApiContainerNode<Folder> {\n  title: string = 'Group Container';\n  settingFields = {\n    name: SettingType.STRING,\n  };\n\n  collectChildNodes(nodes: Node[]): Node[] {\n    return nodes.filter(v => v instanceof PointNode);\n  }\n\n  namePrefix() {\n    return 'Group';\n  }\n\n  createEntry() {\n    const device_node = <DeviceContainerNode>this.container.container_node;\n    const network_node = <NetworkContainerNode>device_node.container.container_node;\n    const edge_node = <EdgeContainerNode>network_node.container.container_node;\n    if (\n      !(device_node instanceof DeviceContainerNode) ||\n      !(network_node instanceof NetworkContainerNode) ||\n      !(edge_node instanceof EdgeContainerNode)\n    ) {\n      const errorMessage =\n              'Error: Trying to create group, but group node does not exist inside a valid Device container hierarchy...';\n      return Promise.reject(errorMessage);\n    }\n    return this.findFreeIdentifier().then(name => this.api.create(<any>{ folder: { name } }, device_node.entryId()));\n  }\n\n  protected initAPI(): Api<Folder> {\n    return new FolderAPI();\n  }\n\n  protected fetchChildren(): Promise<any[]> {\n    return new PointAPI().list(this.entryId());\n  }\n\n  protected childNodeType() {\n    return [POINT_NODE_TYPE];\n  }\n}\n\nexport class PointNode extends Node implements EntryNode<Point> {\n  title: string;\n  backend: Api<Point>;\n  properties: {\n    entry: Point;\n    is_protected: boolean;\n  };\n  clonable = false;\n  movable = false;\n  settingFields = {\n    edge        : SettingType.READONLY,\n    network     : SettingType.READONLY,\n    code        : SettingType.STRING,\n    enabled     : SettingType.BOOLEAN,\n    kind        : SettingType.STRING,\n    measure_unit: SettingType.STRING,\n    offset      : SettingType.NUMBER,\n    precision   : SettingType.NUMBER,\n    protocol    : SettingType.STRING,\n    type        : SettingType.STRING,\n  };\n\n  entry = Mixin.prototype.entry.bind(this);\n  entryId = Mixin.prototype.entryId.bind(this);\n  onAfterSettingsChange = Mixin.prototype.onAfterSettingsChange.bind(this);\n  applyEntry = Mixin.prototype.applyEntry.bind(this);\n  deactivate = Mixin.prototype.deactivate.bind(this);\n  onCreated = Mixin.prototype.onCreated.bind(this);\n  makeIdentifier = Mixin.prototype.makeIdentifier.bind(this);\n  findFreeIdentifier = Mixin.prototype.findFreeIdentifier.bind(this);\n  getTakenIdentifiers = Mixin.prototype.getTakenIdentifiers.bind(this);\n  createSettingForm = Mixin.prototype.createSettingForm.bind(this);\n\n  private interval: number;\n\n  constructor(container: Container) {\n    super(container);\n    this.title = 'Point container';\n    this.description = 'placeholder'; // FIXME\n    this.backend = new PointAPI();\n    this.settings['name'] = {\n      description: 'Point ID',\n      value      : this.title,\n      type       : SettingType.READONLY,\n    };\n    this.settings['priority'] = {\n      description: 'Priority',\n      value      : 1,\n      type       : SettingType.NUMBER,\n    };\n    this.addOutput('value', Type.NUMBER);\n    this.addInput('in', Type.NUMBER);\n  }\n\n  entryFactory() {\n    return new Point();\n  }\n\n  onAdded() {\n    Mixin.prototype.onAdded.call(this);\n    this.syncWithBackend();\n    this.interval = <any>(\n      setInterval(() => this.syncWithBackend(), config.backendSync.pointRefreshIntervalSeconds * 1000)\n    );\n  }\n\n  onRemoved() {\n    return Mixin.prototype.onRemoved.call(this);\n    // TODO: hmmm, wtf?\n    // if (this.interval) clearInterval(this.interval);\n  }\n\n  namePrefix() {\n    return 'Point';\n  }\n\n  syncWithBackend() {\n    // refactor into mixin and reuse\n    if (this.side !== Side.server) return;\n    actor.process(() => {\n      if (!this.entry()) return;\n      return (this.backend as PointAPI)\n        .fetchPointData(this.entryId())\n        .then(data => {\n          // we check again if the node is still active - this may have changed since the request was sent\n          if (!this.entry()) return; // TODO: Replace with isActive()\n          this.setOutputData(0, get(data, 'value'));\n        })\n        .catch(doNothing); // error response presumably means no value is set yet\n    });\n  }\n\n  onInputUpdated() {\n    let value = parseFloat(this.getInputData(0));\n    if (isNaN(value) || value === null) {\n      console.log('WARNING: Received non-numeric value on point inlet.');\n      return;\n    }\n    this.setOutputData(0, value);\n    const priority = Utils.clamp(this.settings['priority'].value, 1, 17);\n    (this.backend as PointAPI)\n      .updatePointData(this.entryId(), priority, value)\n      .catch(e => this.container.server_editor_socket.emit(ERROR, `Could not patch point value. ${e.message}`));\n  }\n\n  createEntry() {\n    const parentNode = this.container.container_node;\n    const device_node = parentNode.container.container_node;\n    const network_node = device_node.container.container_node;\n    const edge_node = network_node.container.container_node;\n    if (!(parentNode instanceof GroupContainerNode) || !(parentNode instanceof DeviceContainerNode)) {\n      const errorMessage =\n              'Error: Trying to create point, but point node does not exist inside a valid Group container hierarchy...';\n      console.log(errorMessage);\n      return Promise.reject(errorMessage);\n    }\n    return this.findFreeIdentifier().then(code => this.backend.create(\n      <any>{\n        device_id: (device_node as DeviceContainerNode).entryId(),\n        point    : {\n          network: (network_node as NetworkContainerNode).entryId(),\n          edge   : (edge_node as EdgeContainerNode).entryId(),\n          code,\n          unit   : { type: 'number' },\n          enabled: false,\n        },\n      },\n      parentNode.entryId(),\n                                          ),\n    );\n  }\n\n  updateEntry(body: Point) {\n    return this.backend.update(body, this.entryId());\n  }\n\n  deleteEntry() {\n    return this.backend.delete(this.entryId());\n  }\n}\n\nContainer.registerNodeType(EDGES_PARENT_CONTAINER_TYPE, EdgesParentContainerNode, null, false);\nContainer.registerNodeType(EDGE_CONTAINER_TYPE, EdgeContainerNode, null, false);\nContainer.registerNodeType(NETWORK_CONTAINER_TYPE, NetworkContainerNode, null, false);\nContainer.registerNodeType(DEVICE_CONTAINER_TYPE, DeviceContainerNode, null, false);\nContainer.registerNodeType(GROUP_CONTAINER_TYPE, GroupContainerNode, null, false);\nContainer.registerNodeType(POINT_NODE_TYPE, PointNode, null, false);\n","import { Api } from './api';\nimport { Device, Edge, Folder, Network, Point, PointData } from './entry';\n\nexport class EdgeAPI extends Api<Edge> {\n  list(_objId?: string): Promise<Edge[]> {\n    return this.fetchMany('edge', 'edges');\n  }\n\n  get(objId: string): Promise<Edge[]> {\n    return this.fetchOne(`edge/${objId}`);\n  }\n\n  create(obj: Edge): Promise<any> {\n    throw new Error('Method not implemented.');\n  }\n\n  update(obj: Edge, objId?: string): Promise<any> {\n    return this.client.patch(`edge/${objId}`, obj);\n  }\n\n  delete(objId: string): Promise<any> {\n    throw new Error('Method not implemented.');\n  }\n\n  factoryEntry(): Edge {\n    return this.newEntry(Edge);\n  }\n}\n\nexport class NetworkAPI extends Api<Network> {\n  list(objId?: string): Promise<Network[]> {\n    return this.fetchMany(`edge/${objId}/network`, 'networks');\n  }\n\n  get(objId: string): Promise<Network[]> {\n    return this.fetchOne(`network/${objId}`);\n  }\n\n  create(obj: Network, parentId: string): Promise<any> {\n    return this.client.post(`edge/${parentId}/network`, obj).then(this.extractData('resource'));\n  }\n\n  update(obj: Network, objId?: string): Promise<any> {\n    return this.client.patch(`network/${objId}`, obj);\n  }\n\n  delete(objId: string): Promise<any> {\n    return this.client.delete(`network/${objId}?_force=true`);\n  }\n\n  factoryEntry(): Network {\n    return this.newEntry(Network);\n  }\n}\n\nexport class DeviceAPI extends Api<Device> {\n  factoryEntry(): Device {\n    return this.newEntry(Device);\n  }\n\n  list(objId?: string): Promise<Device[]> {\n    return this.client.get(`network/${objId}/device`)\n               .then(this.extractData('devices'))\n               .then(v => v.map(d => d.device))\n               .then(this.assignAllTo(() => new Device()));\n  }\n\n  get(objId: string): Promise<Device[]> {\n    return this.fetchOne(`device/${objId}`);\n  }\n\n  create(obj: Device, parentId?: string): Promise<any> {\n    return this.client.post(`network/${parentId}/device`, obj).then(this.extractData('resource.device'));\n  }\n\n  update(obj: Device, objId?: string): Promise<any> {\n    return this.client.patch(`device/${objId}`, obj);\n  }\n\n  delete(objId: string): Promise<any> {\n    return this.client.delete(`device/${objId}?_force=true`);\n  }\n}\n\nexport class FolderAPI extends Api<Folder> {\n  list(objId?: string): Promise<Folder[]> {\n    return this.fetchMany(`device/${objId}/folder`, 'folders');\n  }\n\n  get(objId: string): Promise<Folder[]> {\n    return this.fetchOne(`folder/${objId}`);\n  }\n\n  create(obj: Folder, parentId?: string): Promise<any> {\n    return this.client.post(`device/${parentId}/folder`, obj).then(this.extractData('resource'));\n  }\n\n  update(obj: Folder, objId?: string): Promise<any> {\n    return this.client.patch(`folder/${objId}`, obj);\n  }\n\n  delete(objId: string): Promise<any> {\n    return this.client.delete(`folder/${objId}?_force=true`);\n  }\n\n  factoryEntry(): Folder {\n    return this.newEntry(Folder);\n  }\n}\n\nexport class PointAPI extends Api<Point> {\n  factoryEntry(): Point {\n    return this.newEntry(Point);\n  }\n\n  list(objId?: string): Promise<Point[]> {\n    return this.fetchMany(`folder/${objId}/point`, 'points');\n  }\n\n  get(objId: string): Promise<Point[]> {\n    return this.fetchOne(`point/${objId}`);\n  }\n\n  create(obj: Point, parentId?: string): Promise<any> {\n    return this.client.post(`folder/${parentId}/point`, obj).then(this.extractData('resource.point'));\n  }\n\n  update(obj: Point, objId?: string): Promise<any> {\n    return this.client.patch(`point/${objId}`, obj);\n  }\n\n  delete(objId: string): Promise<any> {\n    return this.client.delete(`point/${objId}?_force=true`);\n  }\n\n  fetchPointData(pointId: string): Promise<PointData> {\n    return this.client.get(`point/${pointId}/data`).then(this.extractData());\n  }\n\n  updatePointData(pointId: string, priority: number, value: number): Promise<any> {\n    return this.client.put(`point/${pointId}/data`, { priority, value });\n  }\n}\n","import { merge } from 'lodash';\nimport { Api } from '../../../backend/api';\nimport { Service } from '../../../backend/entry';\nimport { ModuleAPI, ServiceAPI } from '../../../backend/installer';\nimport { singleton as actor } from '../../../promise-actor';\nimport {\n  MODULE_NODE_TYPE,\n  MODULES_PARENT_CONTAINER_TYPE,\n  SERVICE_NODE_TYPE,\n  SERVICES_PARENT_CONTAINER_TYPE,\n} from '../../constants';\nimport { Container, Side } from '../../container';\nimport { Node, SettingType } from '../../node';\nimport ApiNode from './shared/api-node';\nimport Mixin from './shared/mixin';\nimport TopLevelApiContainerNode from './shared/top-level-api-container-node';\n\nexport class ModulesParentContainerNode extends TopLevelApiContainerNode<Service> {\n  title: string = 'Modules';\n\n  collectChildNodes(nodes: Node[]): ModuleNode[] {\n    return <ModuleNode[]>nodes.filter(v => v instanceof ModuleNode);\n  }\n\n  protected initAPI(): Api<Service> {\n    return new ModuleAPI();\n  }\n\n  protected fetchChildren() {\n    return this.api.list();\n  }\n\n  protected childNodeType() {\n    return [MODULE_NODE_TYPE];\n  }\n}\n\nexport class ServicesParentContainerNode extends TopLevelApiContainerNode<Service> {\n  title: string = 'Services';\n\n  collectChildNodes(nodes: Node[]): ServiceNode[] {\n    return <ServiceNode[]>nodes.filter(v => v instanceof ServiceNode);\n  }\n\n  protected initAPI(): Api<Service> {\n    return new ServiceAPI();\n  }\n\n  protected fetchChildren() {\n    return this.api.list();\n  }\n\n  protected childNodeType() {\n    return [SERVICE_NODE_TYPE];\n  }\n}\n\nabstract class BaseServiceNode<A extends Api<Service>> extends ApiNode<Service, A> {\n  properties: {\n    entry: Service;\n    is_protected: boolean;\n  };\n  required_settings = ['service_id', 'service_name', 'version'];\n  settingFields = {\n    service_id     : SettingType.STRING,\n    service_name   : SettingType.STRING,\n    version        : SettingType.STRING,\n    service_type   : SettingType.STRING,\n    published_by   : SettingType.STRING,\n    state          : SettingType.STRING,\n    deploy_id      : SettingType.STRING,\n    deploy_location: SettingType.STRING,\n    created_at     : SettingType.READONLY,\n    modified_at    : SettingType.READONLY,\n  };\n  settingsHeaderComponent = {\n    props   : ['self'],\n    template:\n      '<div>' +\n      '  <v-alert v-if=\"self.properties.is_protected\" type=\"warning\">Waiting for required fields <br />' +\n      `    <small>(${this.required_settings.join(', ')})</small>` +\n      '  </v-alert>' +\n      '</div>',\n  };\n  onAdded = Mixin.prototype.onAdded.bind(this);\n  onRemoved = Mixin.prototype.onRemoved.bind(this);\n\n  constructor(container: Container) {\n    super(container);\n    this.title = this.namePrefix();\n  }\n\n  entryId = () => this.entry() && this.entry().service_id;\n\n  syncWithBackend = () => {\n  };\n\n  onAfterSettingsChange() {\n    if (this.side !== Side.server || !this.areSettingsValid()) return;\n    if (!this.entry()) {\n      actor.process(() =>\n                      this.createEntry()\n                          .then(entry => this.applyEntry(entry))\n                          .then(() => this.displayMessage(`${this.namePrefix()} entry created.`))\n                          .catch(e => this.displayError(e, 'Entry not created.')),\n      );\n    } else {\n      // update entry\n      Mixin.prototype.onAfterSettingsChange.call(this);\n    }\n  }\n\n  applyEntry(entry: Service) {\n    this.settingFields['service_id'] = SettingType.READONLY;\n    Mixin.prototype.applyEntry.call(this, entry);\n    this.properties.is_protected = !entry;\n    this.broadcastPropertiesToClients();\n  }\n\n  onCreated() {\n    if (this.entry()) {\n      this.applyEntry(this.entry());\n    } else {\n      this.properties.is_protected = true; // await manual configuration\n      merge(this.settings, this.createSettingForm(null));\n    }\n  }\n\n  createEntry() {\n    const entry = Object.keys(this.settingFields)\n                        .map(key => ({ [key]: this.settings[key].value }))\n                        .reduce(merge);\n    return this.backend.create(this.settings['service_id'].value, <any>entry);\n  }\n\n  private areSettingsValid(): boolean {\n    return this.required_settings.map(key => this.settings[key].value).reduce((a, b) => a && b);\n  }\n}\n\nclass ModuleNode extends BaseServiceNode<ModuleAPI> {\n  namePrefix() {\n    return 'Module';\n  }\n\n  protected initAPI(): ModuleAPI {\n    return new ModuleAPI();\n  }\n}\n\nclass ServiceNode extends BaseServiceNode<ServiceAPI> {\n  namePrefix() {\n    return 'Service';\n  }\n\n  initAPI(): ServiceAPI {\n    return new ServiceAPI();\n  }\n}\n\nContainer.registerNodeType(MODULES_PARENT_CONTAINER_TYPE, ModulesParentContainerNode, null, false);\nContainer.registerNodeType(SERVICES_PARENT_CONTAINER_TYPE, ServicesParentContainerNode, null, false);\nContainer.registerNodeType(MODULE_NODE_TYPE, ModuleNode, null, false);\nContainer.registerNodeType(SERVICE_NODE_TYPE, ServiceNode, null, false);\n","import { Api } from './api';\nimport { Service } from './entry';\n\nabstract class ApplicationAPI extends Api<Service> {\n  list(_objId?: string): Promise<Service[]> {\n    return this.fetchMany(this.url(), 'services');\n  }\n\n  get(objId: string): Promise<Service[]> {\n    return this.fetchOne(`${this.url()}/${objId}`);\n  }\n\n  create(obj: Service, parentId?: string): Promise<any> {\n    return this.client.post(this.url(), { obj }).then(() => this.get(parentId));\n  }\n\n  update(obj: Service, objId: string): Promise<any> {\n    return this.client.patch(`${this.url()}/${objId}`, { service_id: objId, obj });\n  }\n\n  delete(objId: string): Promise<any> {\n    return this.client.delete(`${this.url()}/${objId}`);\n  }\n\n  factoryEntry(): Service {\n    return this.newEntry(Service);\n  }\n\n  protected abstract url(): string;\n}\n\nexport class ModuleAPI extends ApplicationAPI {\n  protected url(): string {\n    return 'modules';\n  }\n}\n\nexport class ServiceAPI extends ApplicationAPI {\n  protected url(): string {\n    return 'services';\n  }\n}\n","import { Api } from '../../../../backend/api';\nimport { Entry } from '../../../../backend/entry';\nimport { Container } from '../../../container';\nimport { Node, SettingType } from '../../../node';\nimport EntryNode from './entry-node';\nimport Mixin from './mixin';\n\nexport default abstract class ApiNode<T extends Entry, A extends Api<T>> extends Node implements EntryNode<T> {\n  properties: {\n    entry: T; // main entry\n    is_protected: boolean; // If true the node won't be deleted if the remote counter-part is missing\n  };\n  settingFields: {};\n  clonable = false;\n  removable = false;\n  movable = false;\n  entry = Mixin.prototype.entry.bind(this);\n  entryId = Mixin.prototype.entryId.bind(this);\n  deactivate = Mixin.prototype.deactivate.bind(this);\n  createSettingForm = Mixin.prototype.createSettingForm.bind(this);\n  getTakenIdentifiers = Mixin.prototype.getTakenIdentifiers.bind(this);\n  makeIdentifier = Mixin.prototype.makeIdentifier.bind(this);\n  findFreeIdentifier = Mixin.prototype.findFreeIdentifier.bind(this);\n  backend: A;\n\n  protected constructor(container: Container) {\n    super(container);\n    this.description = 'placeholder'; // FIXME\n    this.backend = this.initAPI();\n    this.settings['name'] = {\n      description: 'Entry',\n      value      : this.title,\n      type       : SettingType.READONLY,\n    };\n  }\n\n  entryFactory = (): T => this.backend.factoryEntry();\n\n  updateEntry = (body: T): Promise<any> => this.backend.update(body, this.entryId());\n\n  deleteEntry = (): Promise<any> => this.backend.delete(this.entryId());\n\n  abstract namePrefix(): string;\n\n  abstract createEntry(): Promise<T>;\n\n  abstract applyEntry(entry: T): void;\n\n  abstract syncWithBackend(): void;\n\n  protected abstract initAPI(): A;\n}\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 15.09.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport Debounce from 'lodash-decorators/debounce';\nimport { Database } from '../database/database';\nimport { UiNode } from '../nodes/nodes/dashboard/ui-node';\nimport { DashboardServerSocket } from './dashboard-server-socket';\n\nexport interface UiPanel {\n  name: string;\n  title: string;\n  icon: string;\n  subPanels: Array<UiSubpanel>;\n}\n\nexport interface UiSubpanel {\n  title: string;\n  name: string;\n  uiElements: Array<UiElement>;\n}\n\nexport interface UiElement {\n  title: string;\n  type: string;\n\n  // link to node\n  cid: number;\n  id: number;\n  name: string;\n}\n\nexport class Dashboard {\n  db: Database;\n  uiPanels: Array<UiPanel>;\n  socket: DashboardServerSocket;\n\n  constructor(socket: DashboardServerSocket) {\n    this.socket = socket;\n    this.uiPanels = [];\n  }\n\n  loadFromDatabase(db: Database) {\n    this.db = db;\n    db.getUiPanels((err, docs) => {\n      if (err) return console.log(err);\n\n      this.uiPanels = docs || [];\n    });\n  }\n\n  onNodeRemoved(node: UiNode) {\n    if (!node.isDashboardNode) return;\n\n    this.removeElementForNode(node);\n    this.removeEmptyPanels();\n    this.sendUiPanel(node.settings['ui-panel'].value);\n  }\n\n  onNodeChangePanelOrTitle(node: UiNode, newPanelName: string, newTitle: string) {\n    this.removeElementForNode(node);\n\n    //add new element\n    const uiElemet: UiElement = {\n      title: newTitle,\n      type: node.uiElementType,\n      cid: node.container.id,\n      id: node.id,\n      name: node.name,\n    };\n\n    let newPanel = this.getUiPanel(newPanelName);\n    if (!newPanel) {\n      //add to new panel\n      newPanel = this.addUiPanel(newPanelName);\n      newPanel.subPanels[0].uiElements.push(uiElemet);\n\n      if (this.db) this.db.addUiPanel(newPanel);\n    } else {\n      //update existing panel\n      newPanel.subPanels[0].uiElements.push(uiElemet);\n      if (this.db)\n        this.db.updateUiPanel(newPanel.name, { $set: { subPanels: newPanel.subPanels } });\n    }\n    this.removeEmptyPanels();\n    this.socket.io.emit('getUiPanelsList', this.getUiPanelsList());\n    this.sendUiPanel(node.settings['ui-panel'].value);\n  }\n\n  @Debounce(100)\n  sendUiPanel(uiPanelValue) {\n    this.socket.io.emit('getUiPanel', this.getUiPanel(uiPanelValue));\n  }\n\n  removeEmptyPanels() {\n    let changed = false;\n    for (let p = 0; p < this.uiPanels.length; p++) {\n      let panel = this.uiPanels[p];\n      if (panel.subPanels.every(s => s.uiElements.length == 0)) {\n        // remove panel\n        changed = true;\n        this.uiPanels = this.uiPanels.filter(pan => pan.name != panel.name);\n        if (this.db) this.db.removeUiPanel(panel.name);\n      }\n    }\n    if (changed) this.socket.io.emit('getUiPanelsList', this.getUiPanelsList());\n  }\n\n  removeElementForNode(node: UiNode) {\n    const oldPanel = this.getUiPanel(node.settings['ui-panel'].value);\n    if (oldPanel) {\n      //remove old element\n      for (let s = 0; s < oldPanel.subPanels.length; s++) {\n        const subPanel = oldPanel.subPanels[s];\n        for (let e = 0; e < subPanel.uiElements.length; e++) {\n          const element = subPanel.uiElements[e];\n          if (element.cid == node.container.id && element.id == node.id) {\n            subPanel.uiElements.splice(e, 1);\n\n            if (this.db)\n              this.db.updateUiPanel(oldPanel.name, { $set: { subPanels: oldPanel.subPanels } });\n          }\n        }\n      }\n    }\n  }\n\n  getUiPanel(name: string): UiPanel {\n    return this.uiPanels.find(p => p.name === name);\n  }\n\n  getUiPanelsList(): Array<string> {\n    let arr = [];\n    this.uiPanels.forEach(p => {\n      arr.push({ name: p.name, title: p.title, icon: p.icon });\n    });\n    return arr;\n  }\n\n  addUiPanel(name: string): UiPanel {\n    const subPanel: UiSubpanel = {\n      title: '',\n      name: '',\n      uiElements: [],\n    };\n    const panel: UiPanel = {\n      name: name,\n      title: name,\n      icon: 'label_outline',\n      subPanels: [subPanel],\n    };\n    this.uiPanels.push(panel);\n    return panel;\n  }\n}\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 04.07.2016.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport * as bodyParser from 'body-parser';\nimport * as cookieParser from 'cookie-parser';\nimport * as express from 'express';\nimport * as http from 'http';\nimport * as morgan from 'morgan';\nimport * as path from 'path';\nimport * as socket from 'socket.io';\nimport conf from '../config';\nimport * as config from '../config.json';\nimport { DashboardServerSocket } from './dashboard-server-socket';\nimport { EditorServerSocket } from './editor-server-socket';\nimport { authMiddleware } from './middleware';\nimport { PingPongServerSocket } from './ping-pong-server-socket';\nimport { WireNameServerSocket } from './wire-name-server-socket';\n\nconst expressValidator = require('express-validator');\n\nconst log = require('logplease').create('server', { color: 3 });\n\nconst isDev = process.env.NODE_ENV !== 'production';\n\nexport class Server {\n  express: express.Application;\n  server: http.Server;\n\n  editorSocket: EditorServerSocket;\n  dashboardSocket: DashboardServerSocket;\n  wireNameSocket: WireNameServerSocket;\n  private pingPongSocket: PingPongServerSocket;\n\n  constructor(workingDir: string) {\n    this.express = express();\n    this.express.locals.moment = require('moment');\n    /* webpack-strip-block:removed */\n    this.middleware(workingDir);\n    this.routes();\n    this.handleErrors();\n    this.configure();\n    this.start_io();\n  }\n\n  /* webpack-strip-block:removed */\n\n  private middleware(workingDir: string) {\n    if (config.webServer.debug) {\n      this.express.use(\n        morgan('dev', {\n          skip: function (req, res) {\n            return res.statusCode < 400;\n          },\n        }),\n      );\n    }\n    this.express.use(bodyParser.json({ limit: '5mb' }));\n    this.express.use(bodyParser.urlencoded({ extended: false }));\n    this.express.use(cookieParser());\n    this.express.use(expressValidator());\n    const publicFolder = path.resolve(workingDir, 'public');\n    log.info(`App Server Dir : '${publicFolder}'`);\n    this.express.use('/', express.static(publicFolder));\n  }\n\n  private routes() {\n    // api console logger, after respective apis got called this method will be triggered\n    this.express.use('/api/', function (req, res, next) {\n      const send = res.send;\n      (<any>res).send = function (body) {\n        if (![200, 201].includes(res.statusCode)) log.warn(body);\n        send.call(this, body);\n      };\n      next();\n    });\n    this.express.use('/dashboard', authMiddleware(), require('./routes/dashboard'));\n    this.express.use('/api/dashboard', authMiddleware(), require('./routes/api-dashboard'));\n    this.express.use('/editor', authMiddleware(), require('./routes/editor'));\n    this.express.use('/api/editor', authMiddleware(), require('./routes/api-editor'));\n    this.express.use('/api/wire-name', authMiddleware(), require('./routes/api-wire-name'));\n    this.express.use('/api/auth', require('./routes/auth'));\n    this.express.use('/api/help', authMiddleware(), require('./routes/api-help'));\n    this.express.use('/api/platform', authMiddleware(), require('./routes/api-platform'));\n\n  }\n\n  private handleErrors() {\n    // Route not found middleware\n    this.express.use((req: express.Request, res: express.Response): void => {\n      res.status(404);\n      res.json({ error: { message: 'Not Found' } });\n    });\n    // Error handler\n    this.express.use(\n      (\n        err: Error & { status: number },\n        req: express.Request,\n        res: express.Response,\n        next: express.NextFunction,\n      ): void => {\n        log.warn(err);\n        res.status(err.status || 500);\n        res.json({ error: { message: err.message, error: isDev ? err : {} } });\n      },\n    );\n  }\n\n  private configure() {\n    const port = normalizePort(conf.port);\n    this.express.set('port', port);\n\n    this.server = http.createServer(this.express);\n    this.server.listen(port);\n    this.server.on('error', onError);\n    this.server.on('listening', onListening);\n\n    function normalizePort(val: number | string): number | string | boolean {\n      const port: number = typeof val === 'string' ? parseInt(val, 10) : val;\n      if (isNaN(port)) {\n        return val;\n      } else if (port >= 0) {\n        return port;\n      } else {\n        return false;\n      }\n    }\n\n    const that = this;\n\n    function onError(error: NodeJS.ErrnoException): void {\n      if (error.syscall !== 'listen') throw error;\n      const bind = typeof port === 'string' ? 'Pipe ' + port : 'Port ' + port;\n      switch (error.code) {\n        case 'EACCES':\n          console.error(`${bind} requires elevated privileges`);\n          process.exit(1);\n          break;\n        case 'EADDRINUSE':\n          console.error(`${bind} is already in use`);\n          process.exit(1);\n          break;\n        default:\n          throw error;\n      }\n    }\n\n    function onListening(): void {\n      const addr = that.server.address();\n      const bind = typeof addr === 'string' ? `pipe ${addr}` : `port ${addr.port}`;\n      log.info(`Listening on ${bind}`);\n    }\n  }\n\n  private start_io() {\n    const io_root: SocketIO.Server = socket(this.server);\n    this.editorSocket = new EditorServerSocket(io_root);\n    this.dashboardSocket = new DashboardServerSocket(io_root);\n    this.wireNameSocket = new WireNameServerSocket(io_root);\n    this.pingPongSocket = new PingPongServerSocket(this.server, io_root);\n  }\n}\n","module.exports = require(\"body-parser\");","module.exports = require(\"cookie-parser\");","module.exports = require(\"http\");","module.exports = require(\"morgan\");","import { Container } from '../nodes/container';\nimport app from '../app';\nimport Namespace = SocketIO.Namespace;\n\nconst log = require('logplease').create('server', { color: 3 });\n\nexport class DashboardServerSocket {\n  io_root: SocketIO.Server;\n  io: Namespace;\n\n  constructor(io_root: SocketIO.Server) {\n    this.io_root = io_root;\n    const io = this.io_root.of('/dashboard');\n    this.io = io;\n\n    io.on('connection', function(socket) {\n      log.debug('New client connected to dashboard');\n\n      socket.on('disconnect', () => {\n        log.debug('Client disconnected from dashboard');\n      });\n\n      socket.on('getUiPanel', name => {\n        log.debug('getUiPanel: ' + name);\n        socket.emit('getUiPanel', app.dashboard.getUiPanel(name));\n      });\n\n      socket.on('getUiPanelsList', () => {\n        log.debug('getUiPanelsList');\n        socket.emit('getUiPanelsList', app.dashboard.getUiPanelsList());\n      });\n\n      socket.on('nodeMessageToServerSide', n => {\n        let cont = Container.containers[n.cid];\n        if (!cont) {\n          log.error(\n            \"Can't send node message to server-side. Container id [\" + n.cid + '] does not exist',\n          );\n          return;\n        }\n\n        let node = cont.getNodeById(n.id);\n        if (!node) {\n          log.error(\n            \"Can't send node message to server-side. Node id [\" +\n              n.cid +\n              '/' +\n              n.id +\n              '] does not exist',\n          );\n          return;\n        }\n\n        if (!node['onGetMessageToServerSide']) {\n          log.error(\n            \"Can't send node message to server-side. Node \" +\n              node.getReadableId() +\n              'dont have onGetMessageToServerSide method!',\n          );\n          return;\n        }\n\n        node['onGetMessageToServerSide'](n.message);\n      });\n\n      //redirect message\n      socket.on('nodeMessageToEditorSide', n => {\n        let cont = Container.containers[n.cid];\n        if (!cont) {\n          log.error(\n            \"Can't send node message to editor-side. Container id [\" + n.cid + '] does not exist',\n          );\n          return;\n        }\n\n        let node = cont.getNodeById(n.id);\n        if (!node) {\n          log.error(\n            \"Can't send node message to editor-side. Node id [\" +\n              n.cid +\n              '/' +\n              n.id +\n              '] does not exist',\n          );\n          return;\n        }\n\n        app.server.editorSocket.io.in(n.cid).emit('nodeMessageToEditorSide', n);\n      });\n\n      //redirect message\n      socket.on('nodeMessageToDashboardSide', n => {\n        let cont = Container.containers[n.cid];\n        if (!cont) {\n          log.error(\n            \"Can't send node message to dashboard-side. Container id [\" +\n              n.cid +\n              '] does not exist',\n          );\n          return;\n        }\n\n        let node = cont.getNodeById(n.id);\n        if (!node) {\n          log.error(\n            \"Can't send node message to dashboard-side. Node id [\" +\n              n.cid +\n              '/' +\n              n.id +\n              '] does not exist',\n          );\n          return;\n        }\n\n        app.server.dashboardSocket.io.in(n.cid).emit('nodeMessageToDashboardSide', n);\n      });\n\n      socket.on('nodeSettings', n => {\n        let cont = Container.containers[n.cid];\n        if (!cont) {\n          log.error(\"Can't update node settings. Container id [\" + n.cid + '] does not exist');\n          return;\n        }\n\n        let node = cont.getNodeById(n.id);\n        if (!node) {\n          log.error(\n            \"Can't update node settings. Node id [\" + n.cid + '/' + n.id + '] does not exist',\n          );\n          return;\n        }\n\n        let oldName = node.name;\n        let oldSettings = JSON.parse(JSON.stringify(node.settings));\n\n        if (node['onBeforeSettingsChange']) node['onBeforeSettingsChange'](n.settings, n.name);\n\n        for (let key in n.settings) {\n          let s = n.settings[key];\n          try {\n            node.settings[key].value = s.value;\n          } catch (error) {\n            log.error(error);\n          }\n        }\n\n        node.name = n.name;\n        Promise.resolve(node['onAfterSettingsChange'](oldSettings, oldName)).then(() => {\n          const args = {\n            id: n.id,\n            cid: n.cid,\n            settings: node.settings,\n            name: n.name,\n            oldSettings: oldSettings,\n            oldName: oldName\n          };\n          app.server.editorSocket.io.emit('nodeSettings', args);\n\n          if (node.isDashboardNode) {\n            app.server.dashboardSocket.io.in(n.cid).emit('nodeSettings', args);\n          }\n\n          if (app.db)\n            app.db.updateNode(node.id, node.container.id, {\n              $set: { settings: node.settings, name: node.name },\n            });\n        });\n      });\n\n      socket.on('dashboardElementGetNodeState', n => {\n        let cont = Container.containers[n.cid];\n        if (!cont) {\n          log.error(\n            \"Can't get dashboard element state. Container id [\" + n.cid + '] does not exist',\n          );\n          return;\n        }\n\n        let node = cont.getNodeById(n.id);\n        if (!node) {\n          log.error(\n            \"Can't get dashboard element state. Node id [\" +\n              n.cid +\n              '/' +\n              n.id +\n              '] does not exist',\n          );\n          return;\n        }\n\n        //you can override get state logic\n        if (node['onDashboardElementGetNodeState']) {\n          node['onDashboardElementGetNodeState'](n.options);\n        } else {\n          let m = { id: node.id, cid: node.container.id, state: node.properties['state'] };\n          socket.emit('dashboardElementGetNodeState', m);\n        }\n      });\n\n      socket.on('dashboardElementSetNodeState', n => {\n        let cont = Container.containers[n.cid];\n        if (!cont) {\n          log.error(\n            \"Can't set node state from dashboard element. Container id [\" +\n              n.cid +\n              '] does not exist',\n          );\n          return;\n        }\n\n        let node = cont.getNodeById(n.id);\n        if (!node) {\n          log.error(\n            \"Can't set node state from dashboard element. Node id [\" +\n              n.cid +\n              '/' +\n              n.id +\n              '] does not exist',\n          );\n          return;\n        }\n\n        //you can override get state logic\n        if (node['onDashboardElementSetNodeState']) {\n          node['onDashboardElementSetNodeState'](n.state);\n        } else {\n          node.properties['state'] = n.state;\n          //send state back to all clients\n          let m = { id: node.id, cid: node.container.id, state: node.properties['state'] };\n          let panelName = this.settings['ui-panel'].value;\n          io.in('' + panelName).emit('dashboardElementGetNodeState', m);\n        }\n      });\n\n      // client join to dashboard room\n      socket.on('join-room', room => {\n        if ((<any>socket).room != null) {\n          log.debug('Leave dashboard room [' + (<any>socket).room + ']');\n          socket.leave((<any>socket).room, () => {\n            (<any>socket).room = room;\n            socket.join(room, () => {\n              log.debug('Join to dashboard room [' + room + ']');\n            });\n          });\n        } else {\n          (<any>socket).room = room;\n          socket.join(room, () => {\n            log.debug('Join to dashboard room [' + room + ']');\n          });\n        }\n      });\n\n      socket.on('leave-room', room => {\n        socket.leave(room, () => {\n          log.debug('Leave dashboard room [' + room + ']');\n        });\n        (<any>socket).room = null;\n      });\n    });\n  }\n}\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 25.01.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Container, Side } from '../nodes/container';\nimport { Node } from '../nodes/node';\nimport app from '../app';\nimport Namespace = SocketIO.Namespace;\nimport NodeUtils from '../nodes/node-utils';\n\nconst log = require('logplease').create('server', { color: 3 });\nconst SLOTS_VALUES_INTERVAL = 200;\n\nexport class EditorServerSocket {\n  io_root: SocketIO.Server;\n  io: Namespace;\n\n  constructor(io_root: SocketIO.Server) {\n    this.io_root = io_root;\n    const io = io_root.of('/editor');\n    this.io = io;\n\n    io.on('connection', function(socket) {\n      log.debug('New client connected to editor');\n\n      socket.on('disconnect', () => {\n        log.debug('Client disconnected from editor');\n      });\n\n      // join client to container room\n      socket.on('room', function(room) {\n        if ((<any>socket).room != null) {\n          socket.leave((<any>socket).room, function() {\n            // it is necessary to waiting for leave room before join only if it's the same room (same id)\n            (<any>socket).room = room;\n            socket.join(room, () => {\n              log.debug('Switch editor room to [' + room + ']');\n            });\n          });\n        } else {\n          (<any>socket).room = room;\n          socket.join(room, () => {\n            log.debug('Join to editor room [' + room + ']');\n          });\n        }\n      });\n\n      socket.on('nodeMessageToServerSide', function(n) {\n        let node = EditorServerSocket.checkContainerNodeValidity(n, Side.server);\n        node && node['onGetMessageToServerSide'](n.message);\n      });\n\n      //redirect message\n      socket.on('nodeMessageToEditorSide', function(n) {\n        let node = EditorServerSocket.checkContainerNodeValidity(n, Side.editor);\n        node && app.server.editorSocket.io.in(n.cid).emit('nodeMessageToEditorSide', n);\n      });\n\n      //redirect message\n      socket.on('nodeMessageToDashboardSide', function(n) {\n        let node = EditorServerSocket.checkContainerNodeValidity(n, Side.dashboard);\n        node && app.server.dashboardSocket.io.in(n.cid).emit('nodeMessageToDashboardSide', n);\n      });\n    });\n\n    setInterval(() => {\n      this.sendSlotsValues(io);\n    }, SLOTS_VALUES_INTERVAL);\n  }\n\n  sendSlotsValues(io) {\n    const connectedSocket = io.connected;\n    for (let key of Object.keys(connectedSocket)) {\n      const room: number = +Object.keys(io.connected[key].rooms).filter(x => x !== key)[0];\n      let slotsValues = NodeUtils.getNodesIOValues(room);\n      io.to(room).emit('nodes-io-values', slotsValues);\n    }\n  }\n\n  /**\n   * @param {Node} n\n   * @param {Side} side\n   * @returns {Node} Node if Container and Node is valid otherwise null\n   */\n  static checkContainerNodeValidity(n: Node, side: Side): Node {\n    let cont = Container.containers[n.cid];\n    if (!cont) {\n      log.error(\n        `Can't send node message to ${side}-side. Container id [\"${n.cid}'] does not exist`,\n      );\n      return null;\n    }\n\n    let node = cont.getNodeById(n.id);\n    if (!node) {\n      log.error(\n        `Can't send node message to ${side}-side. Node id [\"${n.cid}'/'${n.id}'] does not exist`,\n      );\n      return null;\n    }\n    return node;\n  }\n}\n","import { Container } from './container';\nimport Utils from './utils';\n\nexport default class NodeUtils {\n  static getNodesIOValues(cid: number): any {\n    let container = Container.containers[cid];\n    if (!container || !container._nodes) return;\n\n    let inputs_values = [];\n    let outputs_values = [];\n    for (let id in container._nodes) {\n      let node = container._nodes[id];\n      if (node.inputs) {\n        for (let i in node.inputs) {\n          let data = node.getInputData(Number(i));\n          data = Utils.formatAndTrimValue(data);\n          inputs_values.push({\n            nodeId: node.id,\n            inputId: i,\n            type: node.type,\n            data,\n          });\n        }\n      }\n\n      if (node.outputs) {\n        for (let o in node.outputs) {\n          let data = node.outputs[o].data;\n          data = Utils.formatAndTrimValue(data);\n          outputs_values.push({\n            nodeId: node.id,\n            outputId: o,\n            type: node.type,\n            data,\n          });\n        }\n      }\n    }\n    return {\n      cid: cid,\n      inputs: inputs_values,\n      outputs: outputs_values,\n    };\n  }\n}\n","import { Server } from 'http';\nimport * as SocketIO from 'socket.io';\nimport { Namespace, Socket } from 'socket.io';\n\nconst logger = require('logplease').create('heartbeat', { color: 3 });\n\nexport class PingPongServerSocket {\n  private io: Namespace;\n\n  constructor(httpServer: Server, io_root?: SocketIO.Server) {\n    let socketServer = io_root ?? SocketIO(httpServer, { path: '/heartbeat' });\n    this.io = socketServer.of(io_root ? '/heartbeat' : '/ping');\n    this.io.on('connect', socket => this.listen(socket));\n  }\n\n  private listen(client: Socket): void {\n    logger.debug(`New client ${client.id} connected into server path ${client.server.path()}`);\n    logger.debug(`Handshake: ${JSON.stringify(client.handshake)}`);\n    client.on('disconnect', () => {\n      logger.debug(`Client ${client.id} is disconnected`);\n    });\n  }\n}\n","import Namespace = SocketIO.Namespace;\n\nconst log = require('logplease').create('server', { color: 3 });\n\nexport class WireNameServerSocket {\n  io_root: SocketIO.Server;\n  io: Namespace;\n\n  constructor(io_root: SocketIO.Server) {\n    this.io_root = io_root;\n    const io = io_root.of('/wire-name');\n    this.io = io;\n\n    io.on('connection', function(socket) {\n      log.debug('New client connected to wire');\n\n      socket.on('disconnect', () => {\n        log.debug('Client disconnected from wire');\n      });\n    });\n  }\n}\n","module.exports = require(\"express-validator\");","/**\n * Created by Derwish (derwish.pro@gmail.com) on 04.07.2016.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport * as express from 'express';\nimport { Container } from '../../nodes/container';\nlet router = express.Router();\n\nrouter.get('/', function(req, res, next) {\n  res.render('dashboard/index', { container_id: 0 });\n});\n\nrouter.get('/c/:cid', function(req, res, next) {\n  res.render('dashboard/index', { container_id: req.params.cid });\n});\n\n//node direct page get\nrouter.get('/c/:cid/n/:id*', function(req, res) {\n  let cont = Container.containers[req.params.cid];\n  if (!cont)\n    return res\n      .status(404)\n      .send(`Can't send request to node. Container id [${req.params.cid}] not found.`);\n\n  let node = cont.getNodeById(req.params.id);\n  if (!node)\n    return res\n      .status(404)\n      .send(`Can't send request to node. Node id [${req.params.cid}/${req.params.id}] not found.`);\n\n  if (node['onDashboardGetRequest']) node['onDashboardGetRequest'](req, res);\n  else\n    return res\n      .status(404)\n      .send(\n        `Can't send request to node. Node id [${req.params.cid}/${req.params.id}] does not accept requests.`,\n      );\n});\n\n//node direct page post\nrouter.post('/c/:cid/n/:id*', function(req, res) {\n  let cont = Container.containers[req.params.cid];\n  if (!cont)\n    return res\n      .status(404)\n      .send(`Can't send request to node. Container id [${req.params.cid}] not found.`);\n\n  let node = cont.getNodeById(req.params.id);\n  if (!node)\n    return res\n      .status(404)\n      .send(`Can't send request to node. Node id [${req.params.cid}/${req.params.id}] not found.`);\n\n  if (node['onDashboardPostRequest']) node['onDashboardPostRequest'](req, res);\n  else\n    return res\n      .status(404)\n      .send(\n        `Can't send request to node. Node id [${req.params.cid}/${req.params.id}] does not accept requests.`,\n      );\n});\n\nmodule.exports = router;\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 25.02.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport * as express from 'express';\nlet router = express.Router();\n\nimport { Container } from '../../nodes/container';\n\n/**\n * Get container\n */\nrouter.get('/c/:cid', function(req, res) {\n  let container = Container.containers[req.params.cid];\n  if (!container)\n    return res.status(404).send(`Can't get container. Container id [${req.params.cid}] not found.`);\n  let s = container.serialize(true);\n  res.json(s);\n});\n\nmodule.exports = router;\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 04.07.2016.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport * as express from 'express';\nimport * as config from '../../config.json';\nimport { Container } from '../../nodes/container';\n\nlet router = express.Router();\n\nrouter.get('/', function(req, res) {\n  res.render('editor/index', {\n    split: req.query.split,\n    container_id: 0,\n    theme: config.nodeEditor.theme,\n  });\n});\n\nrouter.get('/c/:cid', function(req, res) {\n  let cid = req.params.cid || 0;\n\n  if (!Container.containers[cid]) return res.redirect('/editor');\n\n  res.render('editor/index', {\n    split: req.query.split,\n    container_id: cid,\n    theme: config.nodeEditor.theme,\n  });\n});\n\nrouter.get('/split', function(req, res) {\n  res.render('editor/split', { container_id: 0 });\n});\n\nrouter.get('/split/c/:cid', function(req, res) {\n  let cid = req.params.cid || 0;\n\n  if (!Container.containers[cid]) return res.redirect('/editor/split');\n\n  res.render('editor/split', { container_id: cid });\n});\n\nmodule.exports = router;\n","import * as express from 'express';\nimport { Container, Side } from '../../nodes/container';\nimport { Node, SerializedNode } from '../../nodes/node';\nimport app from '../../app';\nimport conf from '../../config';\nimport ContainerUtils from '../../nodes/container-utils';\nimport { LinkInfo } from '../../nodes/node-link';\nimport { CONTAINER_NODE_TYPE } from '../../nodes/nodes/container/folder';\nimport { CLONE, ERROR, IMPORT, MOVE_TO_CONTAINER } from '../../events';\n\nlet router = express.Router();\n\nsetInterval(updateActiveNodes, 500);\n\nfunction updateActiveNodes() {\n  if (!app.rootContainer) return;\n\n  for (let c in Container.containers) {\n    let container = Container.containers[c];\n\n    let activeNodesIds = [];\n\n    for (let id in container._nodes) {\n      let node = container._nodes[id];\n      if (node.isRecentlyActive) {\n        node.isRecentlyActive = false;\n        activeNodesIds.push(node.id);\n      }\n    }\n\n    if (activeNodesIds.length > 0)\n      app.server.editorSocket.io.in('' + container.id).emit('nodes-active', {\n        ids: activeNodesIds,\n        cid: container.id,\n      });\n  }\n}\n\n/**\n * Get container\n */\nrouter.get('/c/:cid', function(req, res) {\n  let container = Container.containers[req.params.cid];\n  if (!container) return res.status(404).send(`Can't get container. Container id [${req.params.cid}] not found.`);\n\n  let s = container.serialize();\n  res.json(s);\n});\n\nrouter.get('/c/:cid/file', function(req, res) {\n  let container = Container.containers[req.params.cid];\n  if (!container) return res.status(404).send(`Can't export container. Container id [${req.params.cid}] not found.`);\n\n  let s = container.container_node.serialize();\n  //remove links\n  if (s.inputs) for (let i in s.inputs) if (s.inputs[i].link) delete s.inputs[i].link;\n  if (s.outputs) for (let i in s.outputs) if (s.outputs[i].links) delete s.outputs[i].links;\n\n  let text = JSON.stringify(s);\n  let cont_name = container.name.replace(/[^a-z0-9]/gi, '_').toLowerCase();\n  let filename = 'shub_' + cont_name + '.json';\n  res.set({ 'Content-Disposition': 'attachment; filename=\"' + filename + '\"' });\n  res.send(text);\n});\n\n//------------------ nodes ------------------------\n\n/**\n * Create node\n */\nrouter.post('/c/:cid/n/', function(req, res) {\n  let container = Container.containers[req.params.cid];\n  if (!container) return res.status(404).send(`Can't create node. Container id [${req.params.cid}] not found.`);\n\n  let node = container.createNode(req.body.type, { pos: req.body.position });\n\n  if (!node) return res.status(404).send(`Can't create node. Node type [${req.body.type}] not found.`);\n\n  app.server.editorSocket.io.emit('node-create', {\n    id: node.id,\n    cid: req.params.cid,\n    type: node.type,\n    pos: node.pos,\n  });\n\n  if (node.isDashboardNode)\n    app.server.dashboardSocket.io.in(req.params.cid).emit('node-create', {\n      id: node.id,\n      cid: req.params.cid,\n      type: node.type,\n      pos: node.pos,\n    });\n\n  res.send(`New node created: type [${node.type}] id [${node.container.id}/${node.id}]`);\n});\n\n/**\n * Delete nodes\n */\nrouter.delete('/c/:cid/n/', function(req, res) {\n  let container: Container = Container.containers[req.params.cid];\n  if (!container) return res.status(404).send(`Can't delete node. Container id [${req.params.cid}] not found.`);\n\n  removeNodes(container, req.body, +req.params.cid).then(\n    () => {\n      res.send(`Nodes deleted: ids ${req.params.cid}/${JSON.stringify(req.body.ids)}`);\n    },\n    err => {\n      res.status(404).send(err);\n    },\n  );\n});\n\n/**\n * Update node position\n */\nrouter.put('/c/:cid/n/:id/position', function(req, res) {\n  let container = Container.containers[req.params.cid];\n  if (!container)\n    return res.status(404).send(`Can't update node position. Container id [${req.params.cid}] not found.`);\n\n  let node = container.getNodeById(req.params.id);\n  if (!node)\n    return res.status(404).send(`Can't update node position. Node id [${req.params.cid}/${req.params.id}] not found.`);\n\n  node.pos = req.body.position;\n\n  if (app.db) app.db.updateNode(node.id, node.container.id, { $set: { pos: node.pos } });\n\n  app.server.editorSocket.io.emit('node-update-position', {\n    id: req.params.id,\n    cid: req.params.cid,\n    pos: node.pos,\n  });\n  res.send(`Node position updated: type [${node.type}] id [${node.container.id}/${node.id}]`);\n});\n\n/**\n * Update node size\n */\nrouter.put('/c/:cid/n/:id/size', function(req, res) {\n  let container = Container.containers[req.params.cid];\n  if (!container) return res.status(404).send(`Can't update node size. Container id [${req.params.cid}] not found.`);\n\n  let node = container.getNodeById(req.params.id);\n  if (!node)\n    return res.status(404).send(`Can't update node size. Node id [${req.params.cid}/${req.params.id}] not found.`);\n\n  node.size = req.body.size;\n\n  if (app.db) app.db.updateNode(node.id, node.container.id, { $set: { size: node.size } });\n\n  app.server.editorSocket.io.emit('node-update-size', {\n    id: req.params.id,\n    cid: req.params.cid,\n    size: node.size,\n  });\n  res.send(`Node size updated: type [${node.type}] id [${node.container.id}/${node.id}]`);\n});\n\n/**\n * Update node collapsed\n */\nrouter.put('/c/:cid/n/:id/collapse', function(req, res) {\n  let container = Container.containers[req.params.cid];\n  if (!container)\n    return res.status(404).send(`Can't update node collapse. Container id [${req.params.cid}] not found.`);\n\n  let node = container.getNodeById(req.params.id);\n  if (!node)\n    return res.status(404).send(`Can't update node collapse. Node id [${req.params.cid}/${req.params.id}] not found.`);\n\n  node.flags.collapsed = req.body.collapsed;\n\n  if (app.db) app.db.updateNode(node.id, node.container.id, { $set: { \"flags.collapsed\": node.flags.collapsed } });\n\n  app.server.editorSocket.io.emit('node-update-collapsed', {\n    id: req.params.id,\n    cid: req.params.cid,\n    \"flags.collapsed\": node.flags.collapsed,\n  });\n  res.send(`Node collapsed updated: type [${node.type}] id [${node.container.id}/${node.id}]`);\n});\n\n/**\n * Move nodes to new container\n */\nrouter.put('/c/:cid/move', function(req, res) {\n  const paramsCid = +req.params.cid;\n  let container = Container.containers[paramsCid];\n  if (!container) return res.status(404).send(`Can't move nodes. Container id [${paramsCid}] not found.`);\n  const ids: Array<number> = req.body;\n  exportNodes(container, ids, paramsCid).then(\n    exportedNodes => {\n      const { nodes, convertedParamsCid } = moveNodesToNewContainer(container, exportedNodes, paramsCid);\n      removeNodes(container, ids, paramsCid).then(\n        () => {\n          app.server.editorSocket.io.emit(MOVE_TO_CONTAINER, {\n            cid: paramsCid,\n            nodes,\n            convertedParamsCid: convertedParamsCid,\n            message: 'Nodes Moved to new Container!',\n          });\n          res.send('Moved nodes successfully');\n        },\n        error => {\n          sendNotFoundError(res, error);\n        },\n      );\n    },\n    error => {\n      sendNotFoundError(res, error);\n    },\n  );\n});\n\nrouter.post('/c/:cid/clone', function(req, res) {\n  const paramsCid = +req.params.cid;\n  let container = Container.containers[paramsCid];\n  if (!container) return res.status(404).send(`Can't clone node. Container id [${paramsCid}] not found.`);\n  const { ids, pos } = req.body;\n  exportNodes(container, ids, paramsCid).then(\n    exportedNodes => {\n      const nodes = importNodes(container, exportedNodes, paramsCid, pos, true);\n      app.server.editorSocket.io.emit(CLONE, { cid: paramsCid, nodes, message: 'Nodes Cloned!' });\n      res.send('Nodes Cloned!');\n    },\n    error => {\n      sendNotFoundError(res, error);\n    },\n  );\n});\n\nrouter.post('/c/:cid/export', function(req, res) {\n  const paramsCid = +req.params.cid;\n  const container = Container.containers[paramsCid];\n  if (!container) return res.status(404).send(`Can't export nodes. Container id [${paramsCid}] not found.`);\n  exportNodes(container, req.body, paramsCid).then(\n    output => {\n      res.status(200).json(output);\n    },\n    err => {\n      res.status(404).send(err);\n    },\n  );\n});\n\nrouter.post('/c/:cid/import', function(req, res) {\n  const paramsCid = +req.params.cid;\n  const container = Container.containers[paramsCid];\n  if (!container) return res.status(404).send(`Can't import nodes. Container id [${paramsCid}] not found.`);\n  const { ids, pos } = req.body;\n  const nodes = importNodes(container, ids, paramsCid, pos);\n  app.server.editorSocket.io.emit(IMPORT, { cid: paramsCid, nodes, message: 'Nodes Imported!' });\n  res.send('Nodes Imported!');\n});\n\n//------------------ links ------------------------\n\n/**\n * Create link\n */\nrouter.post('/c/:cid/l', function(req, res) {\n  let container = Container.containers[req.params.cid];\n  if (!container) {\n    return res.status(404).send(`Can't create link. Container id [${req.params.cid}] not found.`);\n  }\n  let link: LinkInfo = req.body;\n  let node = container.getNodeById(link.origin_id);\n  let targetNode = container.getNodeById(link.target_id);\n  if (!node) {\n    return res.status(404).send(`Can't create link. Node id [${req.params.cid}/${link.origin_id}] not found.`);\n  }\n  if (!targetNode) {\n    return res.status(404).send(`Can't create link. Node id [${req.params.cid}/${link.target_id}] not found.`);\n  }\n  //if user drag to node instead of slot\n  if (link.target_slot === -1) {\n    //todo find free input\n    let input = targetNode.getInputInfo(0);\n    if (!input) {\n      return res\n        .status(404)\n        .send(`Can't create link. Node id [${req.params.cid}/${link.target_id}] has no free inputs.`);\n    }\n    link.target_slot = 0;\n  }\n  if (node.connect(link.origin_slot, targetNode.id, link.target_slot, link.target_input_id)) {\n    app.server.editorSocket.io.emit('link-create', { cid: req.params.cid, link: link });\n    return res.send(\n      `Link created: from [${node.container.id}/${node.id}] to [${targetNode.container.id}/${targetNode.id}]`,\n    );\n  }\n  return res\n    .status(400)\n    .send(`Link created: from [${node.container.id}/${node.id}] to [${targetNode.container.id}/${targetNode.id}]`);\n});\n\n/**\n * Delete link\n */\nrouter.delete('/c/:cid/l', function(req, res) {\n  let container = Container.containers[req.params.cid];\n  if (!container) return res.status(404).send(`Can't delete link. Container id [${req.params.cid}] not found.`);\n\n  let link: LinkInfo = req.body;\n  let node = container.getNodeById(link.origin_id);\n  let targetNode = container.getNodeById(link.target_id);\n  if (!node) {\n    return res.status(404).send(`Can't delete link. Node id [${req.params.cid}/${link.origin_id}] not found.`);\n  }\n  if (!targetNode) {\n    return res.status(404).send(`Can't delete link. Node id [${req.params.cid}/${link.target_id}] not found.`);\n  }\n  if (targetNode.disconnectInputLink(link.target_slot, link.target_input_id)) {\n    app.server.editorSocket.io.emit('link-delete', { cid: req.params.cid, link: link });\n    return res.send(\n      `Link deleted: from [${node.container.id}/${node.id}] to [${targetNode.container.id}/${targetNode.id}]`,\n    );\n  }\n  return res\n    .status(400)\n    .send(\n      `Cannot delete link: from [${node.container.id}/${node.id}] to [${targetNode.container.id}/${targetNode.id}]`,\n    );\n});\n\n//------------------ Container ------------------------\n\n/**\n * Run step container\n */\nrouter.get('/state', function(req, res) {\n  let state = {\n    isRunning: app.rootContainer.isRunning,\n  };\n  res.json(state);\n});\n\n/**\n * Run container\n */\nrouter.post('/run', function(req, res) {\n  app.rootContainer.run(conf.loopInterval);\n  app.server.editorSocket.io.emit('container-run');\n  res.send(`Run container`);\n});\n\n/**\n * Stop container\n */\nrouter.post('/stop', function(req, res) {\n  app.rootContainer.stop();\n  app.server.editorSocket.io.emit('container-stop');\n  res.send(`Stop container`);\n});\n\n/**\n * Run step container\n */\nrouter.post('/step', function(req, res) {\n  app.rootContainer.runStep();\n  app.server.editorSocket.io.emit('container-run-step');\n  res.send(`Run step container`);\n});\n\n//------------------ nodes internal requests ------------------------\n\nrouter.get('/c/:cid/n/:id*', function(req, res) {\n  let cont = Container.containers[req.params.cid];\n  if (!cont) return res.status(404).send(`Can't send request to node. Container id [${req.params.cid}] not found.`);\n\n  let node = cont.getNodeById(req.params.id);\n  if (!node)\n    return res.status(404).send(`Can't send request to node. Node id [${req.params.cid}/${req.params.id}] not found.`);\n\n  if (node['onEditorApiGetRequest']) node['onEditorApiGetRequest'](req, res);\n  else\n    return res\n      .status(404)\n      .send(`Can't send request to node. Node id [${req.params.cid}/${req.params.id}] does not accept requests.`);\n});\n\nrouter.post('/c/:cid/n/:id*', function(req, res) {\n  let cont = Container.containers[req.params.cid];\n  if (!cont) return res.status(404).send(`Can't send request to node. Container id [${req.params.cid}] not found.`);\n\n  let node = cont.getNodeById(req.params.id);\n  if (!node)\n    return res.status(404).send(`Can't send request to node. Node id [${req.params.cid}/${req.params.id}] not found.`);\n\n  if (node['onEditorApiPostRequest']) node['onEditorApiPostRequest'](req, res);\n  else\n    return res\n      .status(404)\n      .send(`Can't send request to node. Node id [${req.params.cid}/${req.params.id}] does not accept requests.`);\n});\n\nrouter.post('/c/:cid/n-type', function(req, res) {\n  let cont = Container.containers[req.params.cid];\n  if (!cont) return res.status(404).send(`Can't receive request to node. Container id [${req.params.cid}] not found.`);\n\n  let type = req.body.type;\n  if (!type) return res.status(404).send(`Can't receive request to node. Node type is not defined.`);\n\n  let includeSubcontainers = req.body.subcontainers == true;\n  let nodes = cont.getNodesByType(type, includeSubcontainers);\n  if (nodes.length == 0)\n    return res\n      .status(404)\n      .send(`Can't receive request to node. Node type [${type}] not found in container [${req.params.cid}].`);\n\n  nodes.forEach(node => {\n    if (node['onEditorApiPostRequest']) node['onEditorApiPostRequest'](req, res);\n    else return res.status(404).send(`Can't receive request to node. Node type [${type}] does not accept requests.`);\n  });\n\n  if (!res.headersSent) res.status(400).send(`No node has processed the request.`);\n});\n\nfunction sendNotFoundError(res, error) {\n  res.status(404).send(error);\n  app.server.editorSocket.io.emit(ERROR, error);\n}\n\nfunction pushNewWrapperContainer(nodes, paramsCid, convertedParamsCid) {\n  const containersIds = ContainerUtils.getSortedAvailableContainers(nodes);\n  const containerNodes = nodes.filter(node => node.cid == convertedParamsCid);\n  const lastNodeId = Math.max(...containerNodes.map(node => +node.id));\n  const newContainerNode = {\n    cid: paramsCid,\n    type: CONTAINER_NODE_TYPE,\n    pos: nodes[0].pos,\n    sub_container: { id: containersIds[0], last_node_id: lastNodeId },\n  };\n  nodes.push(newContainerNode);\n  return nodes;\n}\n\nfunction moveNodesToNewContainer(\n  container: Container,\n  nodes,\n  paramsCid: number,\n): { nodes: Array<SerializedNode>; convertedParamsCid: number } {\n  const importedNodes: Array<Node> = [];\n  let convertedParamsCid: number;\n  ({ nodes, convertedParamsCid } = ContainerUtils.remapContainersId(container, nodes, paramsCid, null, true));\n  nodes = pushNewWrapperContainer(nodes, paramsCid, convertedParamsCid);\n\n  const containersIds = ContainerUtils.getSortedAvailableContainers(nodes);\n  ContainerUtils.createContainersIfDoesNotExist(containersIds, Side.server); // Needed to be sorted\n\n  containersIds.forEach(cid => {\n    let containerNodes = nodes.filter(node => node.cid == cid);\n    ContainerUtils.sortNodes(containerNodes);\n    const container = Container.containers[cid];\n    containerNodes.forEach(node => {\n      const n = container.createNode(node.type, node, null, true);\n      importedNodes.push(n);\n      container.last_node_id = n.id;\n    });\n    if (container.container_node) ContainerUtils.updateSubContainerLastNodeId(container, container.last_node_id);\n  });\n  ContainerUtils.removeBrokenLinks(Container.containers[paramsCid]);\n  ContainerUtils.removeBrokenLinks(Container.containers[convertedParamsCid]);\n  ContainerUtils.addInputsLinkNodes(importedNodes, nodes, updateInputs);\n  ContainerUtils.addOutputsLinkNodes(importedNodes, nodes, updateOutputs);\n  const outputNodes: Array<SerializedNode> = ContainerUtils.addSettingsValues(importedNodes, nodes, updateSettings);\n  return { nodes: outputNodes, convertedParamsCid };\n}\n\nfunction importNodes(container: Container, nodes, paramsCid: number, pos, isCloned = false): Array<SerializedNode> {\n  const importedNodes: Array<Node> = [];\n\n  let containersIds: Array<number> = ContainerUtils.getSortedAvailableContainers(nodes);\n  const firstCid = Math.min(...containersIds);\n  ({ nodes } = ContainerUtils.remapContainersId(container, nodes, paramsCid, firstCid));\n  nodes = ContainerUtils.fallbackNodeIfDoesNotExist(nodes);\n  containersIds = ContainerUtils.getSortedAvailableContainers(nodes);\n  ContainerUtils.createContainersIfDoesNotExist(containersIds, Side.server); // Needed to be sorted\n\n  containersIds.forEach(cid => {\n    let containerNodes = nodes.filter(node => node.cid == cid);\n    if (cid === paramsCid) {\n      const lastNodeId = container.last_node_id;\n      containerNodes = ContainerUtils.remapNodesId(container, containerNodes, cid, lastNodeId);\n      containerNodes = ContainerUtils.adjustPosition(container, containerNodes, pos, isCloned);\n      // We need sorting because, last_node_id should be replaced out with the max id\n      ContainerUtils.sortNodes(containerNodes);\n      containerNodes.forEach(node => {\n        importedNodes.push(container.createNode(node.type, node, null, true));\n      });\n      container.setDirtyCanvas(true, true);\n    } else {\n      const container = Container.containers[cid];\n      containerNodes = ContainerUtils.adjustPosition(container, containerNodes, pos, isCloned);\n      ContainerUtils.sortNodes(containerNodes);\n      containerNodes.forEach(node => {\n        const n = container.createNode(node.type, node, null, true);\n        importedNodes.push(n);\n        container.last_node_id = n.id;\n      });\n      if (container.container_node) ContainerUtils.updateSubContainerLastNodeId(container, container.last_node_id);\n    }\n  });\n  ContainerUtils.addInputsLinkNodes(importedNodes, nodes, updateInputs);\n  ContainerUtils.addOutputsLinkNodes(importedNodes, nodes, updateOutputs);\n  return ContainerUtils.addSettingsValues(importedNodes, nodes, updateSettings);\n}\n\nfunction updateInputs(node) {\n  if (app.db) {\n    app.db.updateNode(node.id, node.cid, {\n      $set: { inputs: node.inputs },\n    });\n  }\n}\n\nfunction updateOutputs(node) {\n  if (app.db) {\n    app.db.updateNode(node.id, node.cid, {\n      $set: { outputs: node.outputs },\n    });\n  }\n}\n\nfunction updateSettings(node) {\n  if (app.db) {\n    app.db.updateNode(node.id, node.cid, {\n      $set: { settings: node.settings },\n    });\n  }\n}\n\nfunction exportNodes(container, ids: Array<number>, paramsCid: number): Promise<any[]> {\n  return new Promise((resolve, reject) => {\n    container.db.getNodes((err, docs) => {\n      if (!err) {\n        const output = [];\n        ids.forEach(id => {\n          const node = docs.find(node => node.id === id && node.cid === paramsCid);\n          if (node) {\n            output.push(node);\n            addSubContainerNodes(node, output);\n          }\n        });\n        resolve(output);\n      } else {\n        reject(\"Can't able to get nodes from DB!\");\n      }\n\n      function addSubContainerNodes(node, output) {\n        if (node.sub_container) {\n          docs.forEach(n => {\n            if (n.cid == node.sub_container.id) {\n              output.push(n);\n              addSubContainerNodes(n, output);\n            }\n          });\n        }\n      }\n    });\n  });\n}\n\nfunction removeNodes(container: Container, ids: Array<number>, cid: number): Promise<void> {\n  for (let id of ids) {\n    const node = container.getNodeById(id);\n    if (!node) return Promise.reject(`Can't delete node. Node id [${cid}/${id}] not found.`);\n    container.removeBroadcasted(node);\n  }\n  return Promise.resolve();\n}\n\nmodule.exports = router;\n","import * as express from 'express';\nimport app from '../../app';\nimport WireNameDataSource from '../../database/datasource/WireNameDataSource';\n\nlet router = express.Router();\n\nrouter.get('', async function(req, res) {\n  try {\n    const wire = await WireNameDataSource.getWireName();\n    res.json(wire);\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nrouter.put('', async function({ body }, res) {\n  const { name } = body;\n  try {\n    await WireNameDataSource.changeWireName(name);\n    app.server.wireNameSocket.io.emit('wire-name-update', name);\n    res.status(201).send(body);\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nmodule.exports = router;\n","import * as fs from 'fs';\nimport config from '../../config';\nconst log = require('logplease').create('auth-database', { color: 4 });\nimport FileUtils from '../../nodes/utils/file-utils';\n\nconst file = `${config.dataDir}/wire-name.txt`;\nexport default class WireNameDataSource {\n\n  static getWireName(): Promise<string> {\n    return new Promise((resolve, reject) => {\n      FileUtils.createFile(file).then(() => {\n        fs.readFile(file, { encoding: 'utf-8' }, (err, data) => {\n          if (err) {\n            reject(err);\n            log.error(err);\n          } else {\n            resolve(data);\n          }\n        });\n      });\n    });\n  }\n\n  static changeWireName(wireName: string): Promise<string> {\n    return new Promise((resolve, reject) => {\n      FileUtils.createFile(file).then(() => {\n        fs.writeFile(file, wireName, err => {\n          if (err) {\n            reject(err);\n            log.error(err);\n          } else {\n            resolve(wireName);\n          }\n        });\n      });\n    });\n  }\n\n}\n","import * as express from 'express';\nimport app from '../../app';\nimport { authMiddleware, schemaMiddleware } from '../middleware';\n\nconst Joi = require('@hapi/joi');\nlet router = express.Router();\n\nconst authUserSchema = Joi.object({\n  username: Joi.string().min(5),\n  password: Joi.string().min(5),\n});\n\nrouter.route('/user').post(schemaMiddleware(authUserSchema, 'body'), async (req, res) => {\n  try {\n    const authUser = await app.db.addAuthUser(req.body);\n    res.status(201).send(authUser);\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nrouter.route('/user').get(async (req, res) => {\n  try {\n    const authUser = await app.db.getAuthUser();\n    res.status(200).send(authUser);\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nrouter.route('/users').delete(authMiddleware(), async (req, res) => {\n  try {\n    const authUser = await app.db.deleteAuthUsers();\n    res.status(200).send(authUser);\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nrouter.route('/login').post(schemaMiddleware(authUserSchema, 'body'), async (req, res) => {\n  try {\n    const token = await app.db.getAuthToken(req.body);\n    res.status(200).send({ token });\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nmodule.exports = router;\n","module.exports = require(\"@hapi/joi\");","import * as express from 'express';\nimport HelpDataSource from '../../database/datasource/HelpDataSource';\n\nlet router = express.Router();\n\nrouter.get('', async function(req, res) {\n  try {\n    const stringHtml = await HelpDataSource.getHelpComment();\n    res.json(stringHtml);\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nrouter.put('', async function({ body }, res) {\n  const { stringHtml } = body;\n  try {\n    await HelpDataSource.changeHelpComment(stringHtml);\n    res.status(201).send(\"successful\");\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nmodule.exports = router;\n\n","import * as fs from 'fs';\nimport config from '../../config';\nconst log = require('logplease').create('auth-database', { color: 4 });\nimport FileUtils from '../../nodes/utils/file-utils';\n\nconst file = `${config.dataDir}/help-comment.txt`;\nexport default class HelpDataSource {\n\n  static getHelpComment(): Promise<string> {\n    return new Promise((resolve, reject) => {\n      FileUtils.createFile(file).then(() => {\n        fs.readFile(file, { encoding: 'utf-8' }, (err, data) => {\n          if (err) {\n            reject(err);\n            log.error(err);\n          } else {\n            resolve(data);\n          }\n        });\n      });\n    });\n  }\n\n  static changeHelpComment(stringHtml: string): Promise<string> {\n    return new Promise((resolve, reject) => {\n      FileUtils.createFile(file).then(() => {\n        fs.writeFile(file, stringHtml, err => {\n          if (err) {\n            reject(err);\n            log.error(err);\n          } else {\n            resolve(stringHtml);\n          }\n        });\n      });\n    });\n  }\n\n}\n\n","import * as express from 'express';\nimport PlatformDataSource from '../../database/datasource/PlatformDataSource';\n\nlet router = express.Router();\n\nrouter.get('', async function(req, res) {\n  try {\n    const platform = await PlatformDataSource.getPlatform();\n    res.json(platform);\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nrouter.put('', async function({ body }, res) {\n  try {\n    await PlatformDataSource.updatePlatform(body);\n    res.status(201).send(\"successful\");\n  } catch (e) {\n    res.status(500).send(e);\n  }\n});\n\nmodule.exports = router;\n\n","import * as fs from 'fs';\nimport config from '../../config';\nconst log = require('logplease').create('auth-database', { color: 4 });\nimport FileUtils from '../../nodes/utils/file-utils';\n\nconst file = `${config.dataDir}/platform.db`;\nexport default class PlatformDataSource {\n\n    static getPlatform(): Promise<any> {\n        return new Promise((resolve, reject) => {\n            FileUtils.createFile(file).then(() => {\n                fs.readFile(file, { encoding: 'utf-8' }, (err, data) => {\n                    if (err) {\n                        reject(err);\n                        log.error(err);\n                    } else {\n                        const obj = data ? JSON.parse(data) : {};\n                        resolve(obj);\n                    }\n                });\n            });\n        });\n    }\n\n    static updatePlatform(data: any): Promise<any> {\n        return new Promise((resolve, reject) => {\n            FileUtils.createFile(file).then(() => {\n                var json = JSON.stringify(data);\n                fs.writeFile(file, json, 'utf-8', err => {\n                    if (err) {\n                        reject(err);\n                        log.error(err);\n                    } else {\n                        resolve(json);\n                    }\n                });\n            });\n        });\n    }\n\n}\n\n","/**\n * Add all new nodes classes here!!!\n */\n// import './alerts/alerts';\nimport './bsa/bsa-cumulocity-device';\nimport './bsa/bsa-cumulocity-point';\nimport './bsa/bsa-cumulocity-alarm';\nimport './boolean/and';\nimport './boolean/or';\nimport './boolean/xor';\nimport './boolean/not';\nimport './boolean/toggle';\nimport './boolean/one-shot';\nimport './boolean/min-on-off';\nimport './boolean/on-delay';\nimport './boolean/off-delay';\nimport './boolean/ticker';\nimport './compare/equal';\nimport './compare/greater-than';\nimport './compare/less-than';\nimport './compare/between';\nimport './compare/hysteresis';\nimport './compare/type-check';\nimport './connection/local-transmitter-single';\nimport './connection/local-receiver-single';\nimport './connection/local-transmitter';\nimport './connection/local-receiver';\nimport './connection/hub';\nimport './container/folder';\nimport './container/folder-input';\nimport './container/folder-output';\nimport './conversion/bool-to-int';\nimport './conversion/bit-mask';\nimport './conversion/bit-split';\nimport './conversion/byte-array-to-int';\nimport './conversion/data-conversion';\nimport './conversion/int-to-byte-four-array';\nimport './count/any-event-counter';\nimport './count/counter';\nimport './count/triggered-ramp';\nimport './count/interval-ramp';\nimport './count/waveform';\nimport './csv/csv-merge-rows';\nimport './csv/csv-merge-columns';\nimport './custom-function/function';\n// import './custom-function/merge-function';\n// import './custom-function/fan-out-function';\n// import './custom-function/uuid';\nimport './dashboard/label';\nimport './dashboard/button';\nimport './dashboard/switch';\nimport './dashboard/progress';\nimport './dashboard/slider';\nimport './dashboard/text-box';\nimport './dashboard/log';\nimport './dashboard/chart';\nimport './debug/console';\nimport './debug/notes';\nimport './debug/watch';\nimport './filter/only-true';\nimport './filter/only-false';\nimport './filter/only-between';\nimport './filter/only-greater';\nimport './filter/only-lower';\nimport './filter/only-equal';\nimport './filter/prevent-null';\nimport './filter/prevent-equal';\nimport './filter/prevent-duplicates';\n//import './filter/reduce-events';\n//import './filter/reduce-duplicates';\nimport './history/data-store';\nimport './history/influx-db';\nimport './history/history';\nimport './history/point-persistence';\nimport './history/point-tag';\nimport './hvac/deadband';\nimport './hvac/thermostat';\nimport './hvac/PID';\nimport './hvac/toggle-duration';\nimport './hvac/psychometrics';\nimport './hvac/energy-conversion';\nimport './hvac/power-conversion';\nimport './hvac/volume-conversion';\nimport './hvac/temperature-conversion';\nimport './hvac/atm-pressure-conversion';\nimport './hvac/pressure-conversion';\n// import './IoT/datapoint-node';\n// import './IoT/installer-node';\n// import './IoT/IoT-point-folder';\n// import './IoT/IoT-network';\nimport './json/array-builder';\nimport './json/json-builder';\nimport './json/json-enum-builder';\nimport './json/json-filter';\nimport './json/json-filter-compare';\nimport './json/json-filter-multiple';\nimport './json/json-checker';\n//  import './json/json-func';\n//  import './json/json-keys';\n import './json/json-parse';\n//  import './json/json-query';\nimport './latch/any-latch';\nimport './latch/bool-latch';\nimport './latch/num-latch';\nimport './latch/string-latch';\nimport './latch/set-reset';\nimport './math/add';\nimport './math/subtract';\nimport './math/multiply';\nimport './math/divide';\nimport './math/absolute';\nimport './math/modulus';\nimport './math/power';\nimport './math-advanced/acos';\nimport './math-advanced/asin';\nimport './math-advanced/atan';\nimport './math-advanced/cbrt';\nimport './math-advanced/cos';\nimport './math-advanced/exp';\nimport './math-advanced/log';\nimport './math-advanced/log10';\nimport './math-advanced/sin';\nimport './math-advanced/sqrt';\nimport './math-advanced/tan';\nimport './math-trigger/trigger-add';\nimport './math-trigger/trigger-subtract';\nimport './math-trigger/trigger-multiply';\nimport './math-trigger/trigger-divide';\nimport './math-trigger/trigger-modulus';\nimport './math-trigger/trigger-power';\n//import './network/network-ping';\n//import './network/network-scan';\nimport './miscellaneous/num-series-generator';\nimport './miscellaneous/append-to-strings';\nimport './nube/login';\n// import './nube/password';\nimport './nube/api-input';\nimport './nube/api-output';\nimport './nube/api-schedules';\nimport './nube/get-schedules';\nimport './num-transform/round';\nimport './num-transform/floor';\nimport './num-transform/ceil';\nimport './num-transform/limit';\nimport './num-transform/scale';\nimport './num-transform/linear-shaper';\nimport './num-transform/fade';\nimport './num-transform/rate-limit';\nimport './point/bool-constant';\nimport './point/num-constant';\nimport './point/string-constant';\nimport './point/json-constant';\nimport './point/bool-writable';\nimport './point/num-writable';\nimport './point/string-writable';\nimport './point/generic-point';\nimport './protocols/email/email';\n//import './protocols/http/http-client';\n//import './protocols/http/dynamic-http-client';\nimport './protocols/edge-28/edge-28-network';\nimport './protocols/edge-28/edge-28-input';\nimport './protocols/edge-28/edge-28-output';\nimport './protocols/edge-28/edge-28-lora-reset';\nimport './protocols/bacnet/bacnet-network';\nimport './protocols/bacnet/bacnet-device';\nimport './protocols/bacnet/bacnet-point';\nimport './protocols/bacnet-server/bacnet-server-node';\nimport './protocols/bacnet-server/bacnet-server-point';\nimport './protocols/lora-raw/lora';\n// import './protocols/lora-raw/lora-filter';\nimport './protocols/lora-raw/lora-two-way-in';\nimport './protocols/lora-raw/lora-two-way-out';\nimport './protocols/lora-raw/lora-two-way-test';\n// import './protocols/lora-raw/rubix-compute-lora-reset';\nimport './protocols/modbus/modbus-server';\nimport './protocols/modbus/modbus-rtu-device';\nimport './protocols/modbus/modbus-rtu-point';\nimport './protocols/modbus/modbus-rtu-network';\nimport './protocols/mqtt/mqtt-client';\nimport './protocols/mqtt/mqtt-client-single';\nimport './protocols/mqtt/mqtt-client-node';\nimport './protocols/mqtt/mqtt-point-node';\nimport './protocols/mqtt/mqtt-generic-node';\nimport './protocols/mqtt-broker/mqtt-broker';\nimport './protocols/mqtt/topic-parts';\nimport './protocols/mqtt/topic-builder';\n// import './protocols/mqtt-broker/mqtt-broker';\n// import './protocols/mqtt/mqtt-point';\n// import './protocols/mqtt/mqtt-point-read';\nimport './protocols/serial-connector/serial-connector';\n//import './protocols/websocket/web-socket';\n//import './schedule/event-schedule';\nimport './schedule/weekly-schedule';\nimport './schedule/schedule-merge';\nimport './schedule/schedule-checker';\n//import './social/slack-bot';\n//import './social/sms-twilio';\nimport './statistics/min-max-avg';\nimport './statistics/avg';\nimport './statistics/min';\nimport './statistics/max';\nimport './statistics/sum';\nimport './statistics/median';\nimport './statistics/range';\nimport './statistics/rank';\nimport './statistics/stats-all';\nimport './streams/stream-average';\nimport './streams/stream-highest';\nimport './streams/stream-lowest';\nimport './streams/stream-sum';\nimport './streams/stream-merge';\nimport './streams/gate';\nimport './streams/stack';\nimport './streams/queue';\nimport './streams/stream-delay';\nimport './streams/stream-delay-meter';\nimport './streams/frequency-meter';\nimport './string/string-acronyms';\nimport './string/string-compare';\nimport './string/substring-cut';\nimport './string/string-join';\nimport './string/string-length';\nimport './string/string-index-of';\nimport './string/char-at-index';\nimport './string/string-split';\nimport './string/string-case';\nimport './string/char-to-ascii';\nimport './string/ascii-to-char';\nimport './string/string-buffer';\nimport './switch/bool-switch';\nimport './switch/num-switch';\nimport './switch/string-switch';\nimport './switch/bool-select';\nimport './switch/num-select';\nimport './switch/string-select';\nimport './switch/bool-output-select';\nimport './switch/num-output-select';\nimport './switch/string-output-select';\nimport './system/host-info';\nimport './system/platform';\nimport './system/system-info';\nimport './system/beep';\nimport './system/execute-cmd';\n//import './system/file';\nimport './system/flow-export';\n//import './system/json-file';\nimport './system/ip/network-interfaces-bbb';\nimport './system/ip/network-interfaces';\nimport './system/wires-version';\nimport './time/time-conversion';\nimport './time/time-conversion-plus';\nimport './time/timezone-conversion';\nimport './time/clock';\nimport './time/date';\nimport './time/time-diff';\nimport './time/stopwatch';\nimport './time/cron-interval';\nimport './time/cron-weekly';\nimport './time/cron-expression';\nimport './time/timestamp-generator';\nimport './trigger/change-of-value';\nimport './trigger/random';\nimport './trigger/inject';\nimport './trigger/interval-inject';\nimport './trigger/iterator';\nimport './widget/schedule-afterhours-off';\nimport './widget/schedule-prestart-fixed';\nimport './unknown/unknown-export';\n","import axios from 'axios';\nimport { Container, Side } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport { bsaClientConfig } from './bsa-client-config';\nimport SystemUtils from '../system/system-utils';\n\nclass BSACumulocityDeviceNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Create BSA Cumulocity Device';\n    this.description = '';\n    this.addInput('createDevice', Type.BOOLEAN);\n    this.addOutput('id', Type.NUMBER);\n    this.addOutput('message', Type.STRING);\n\n    this.settings['CumulocityDeviceName'] = {\n      description: 'Cumulocity Device Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n  }\n\n  async onAdded() {\n    await this.onAfterSettingsChange();\n  }\n\n  async onInputUpdated() {\n    if (this.side !== Side.server) return;\n    if (this.getInputData(0) && this.inputs[0].updated) {\n      if (this.outputs[0].data && this.outputs[0].data.length == 0) await this.createDevice();\n      await this.checkDeviceExists();\n    }\n  }\n\n  async onAfterSettingsChange() {\n    if (this.side !== Side.server) return;\n    await this.checkDeviceExists();\n  }\n\n  getDeviceName(): string {\n    let deviceName = this.settings['CumulocityDeviceName'].value || 'unknownDevice';\n    if (!deviceName.startsWith('c8y_')) deviceName = 'c8y_' + deviceName;\n    return deviceName;\n  }\n\n  async checkDeviceExists() {\n    let deviceName = this.getDeviceName();\n    let cfg: any = bsaClientConfig('device');\n    cfg = {\n      ...cfg,\n      method: 'GET',\n      url: `${cfg.url}?query=name+eq+${deviceName}`,\n    };\n    try {\n      const response = await axios(cfg);\n      const ids = [];\n      response.data.managedObjects.forEach(device => {\n        ids.push(Number(device.id));\n      });\n      this.setOutputData(0, ids);\n      this.setOutputData(1, null);\n    } catch (error) {\n      this.setOutputData(1, String(error));\n    }\n  }\n\n  async createDevice() {\n    let clientIdFromPlat;\n    let deviceIdFromPlat;\n    try {\n      clientIdFromPlat = await SystemUtils.getClientID(this);\n    } catch (e) {\n      clientIdFromPlat = 'unknownClientID';\n    }\n    try {\n      deviceIdFromPlat = await SystemUtils.getDeviceID(this);\n    } catch (e) {\n      deviceIdFromPlat = 'unknownDeviceID';\n    }\n    let deviceName = this.getDeviceName();\n    let cfg: any = bsaClientConfig('device');\n    cfg = {\n      ...cfg,\n      method: 'POST',\n      data: {\n        name: deviceName,\n        type: 'c8y_nube',\n        deviceid: deviceIdFromPlat,\n        clientid: clientIdFromPlat,\n        c8y_IsDevice: {},\n      },\n    };\n    try {\n      await axios(cfg);\n    } catch (error) {\n      this.setOutputData(1, String(error));\n    }\n  }\n}\n\nContainer.registerNodeType('bsa/bsa-cumulocity-device', BSACumulocityDeviceNode);\n","import * as moment from 'moment-timezone';\n\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport TimeUtils, { TIME_TYPE } from '../../utils/time-utils';\nimport axios from 'axios';\nimport { Container, Side } from '../../container';\nimport { bsaClientConfig } from './bsa-client-config';\n\nenum HistoryMode {\n  COV = 0,\n  PERIODIC = 1,\n  TRIGGER_ONLY = 2,\n}\n\nclass BSACumulocityNode extends Node {\n  // dynamically calculate position when starting\n  histTriggerInput: number;\n  clearStoredHisInput: number;\n  histErrorOutput: number;\n  storedHistCountOutput: number;\n  lastHistExportOutput: number;\n  // configurable parameters from each extended node for extracting values to store on DB\n  valueInput: number = 0;\n  // extra parameter for nodes\n  interval: number = -1;\n  timeoutFunc: any;\n\n  constructor() {\n    super();\n    this.title = 'BSA Cumulocity Point (History)';\n    this.description = '';\n    this.addInput('input', Type.ANY);\n  }\n\n  addHistoryConfiguration() {\n    this.addInput('histTrigger', Type.BOOLEAN);\n    this.addInput('clearStoredHis', Type.BOOLEAN);\n    this.addOutput('histError', Type.ANY);\n    this.addOutput('storedHistCount', Type.NUMBER);\n    this.addOutput('lastHistExport', Type.STRING);\n\n    /**\n     * History settings\n     */\n    this.settings['enable'] = {\n      description: 'History Enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n\n    this.settings['CumulocityDeviceID'] = {\n      description: 'Cumulocity Device ID (Number)',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    this.settings['CumulocityPointName'] = {\n      description: 'Measurement Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    this.settings['CumulocityPointType'] = {\n      description: 'Measurement Type',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    this.settings['CumulocitySeries'] = {\n      description: 'Series Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    this.settings['historyMode'] = {\n      description: 'History Logging Mode',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: HistoryMode.COV, text: 'Change Of Value (COV)' },\n          { value: HistoryMode.PERIODIC, text: 'Periodic' },\n          { value: HistoryMode.TRIGGER_ONLY, text: 'Trigger Only' },\n        ],\n      },\n      value: HistoryMode.COV,\n    };\n\n    this.settings['dataType'] = {\n      description: 'Data type for storing',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: Type.NUMBER, text: 'Number' },\n          { value: Type.BOOLEAN, text: 'Boolean' },\n          { value: Type.STRING, text: 'String' },\n        ],\n      },\n      value: Type.NUMBER,\n    };\n    this.settings['threshold'] = {\n      description: 'COV Threshold',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['period'] = {\n      description: 'Logging Interval',\n      value: 15,\n      type: SettingType.NUMBER,\n    };\n    this.settings['periodUnits'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: TIME_TYPE.MILLISECONDS, text: 'Milliseconds' },\n          { value: TIME_TYPE.SECONDS, text: 'Seconds' },\n          { value: TIME_TYPE.MINUTES, text: 'Minutes' },\n          { value: TIME_TYPE.HOURS, text: 'Hours' },\n        ],\n      },\n      value: TIME_TYPE.MINUTES,\n    };\n\n    this.settings['storage-limit'] = {\n      description: 'Local Storage Limit (Max 50)',\n      value: 25,\n      type: SettingType.NUMBER,\n    };\n    this.settings['minuteRoundValue'] = {\n      description: 'Round minutes up in increments of',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.settings['decimals'] = {\n      description: 'Decimal Places (Limit 5)',\n      value: 3,\n      type: SettingType.NUMBER,\n    };\n    this.settings['timeAsString'] = {\n      description: 'Display Timestamp as',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: false, text: 'Numeric' },\n          { value: true, text: 'String' },\n        ],\n      },\n      value: true,\n    };\n\n    this.settings['units'] = {\n      description: 'Units',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    this.properties['obj'] = [];\n  }\n\n  setup() {\n    this.addHistoryConfiguration();\n  }\n\n  init() {\n    this.assignInputsOutputs();\n  }\n\n  onAdded() {\n    this.assignInputsOutputs();\n    this.resetOutputs();\n    this.doPeriodicHistoryFunctions();\n  }\n\n  async onInputUpdated() {\n    if (this.getInputData(this.clearStoredHisInput)) {\n      this.properties['obj'] = [];\n      this.updateHistoryCountOutput();\n    }\n    await this.doNonPeriodicHistoryFunctions();\n  }\n\n  async onAfterSettingsChange() {\n    await this.doNonPeriodicHistoryFunctions();\n    this.doPeriodicHistoryFunctions();\n  }\n\n  onRemoved() {\n    clearInterval(this.timeoutFunc);\n  }\n\n  assignInputsOutputs() {\n    for (let input in this.inputs) {\n      if (this.inputs.hasOwnProperty(input)) {\n        if (this.inputs[input].name == 'histTrigger') this.histTriggerInput = Number(input);\n        if (this.inputs[input].name == 'clearStoredHis') this.clearStoredHisInput = Number(input);\n      }\n    }\n\n    for (let output in this.outputs) {\n      if (this.outputs.hasOwnProperty(output)) {\n        if (this.outputs[output].name == 'histError') this.histErrorOutput = Number(output);\n        else if (this.outputs[output].name == 'storedHistCount') this.storedHistCountOutput = Number(output);\n        else if (this.outputs[output].name == 'lastHistExport') this.lastHistExportOutput = Number(output);\n      }\n    }\n  }\n\n  resetOutputs() {\n    this.updateHistoryCountOutput();\n  }\n\n  async doNonPeriodicHistoryFunctions() {\n    if (this.side !== Side.server) return;\n    if (!this.settings['enable'].value) return;\n    const input = this.getInputData(this.valueInput);\n\n    if (this.checkTriggered()) {\n      await this.storeLogEntry(input);\n    } else if (this.checkCOV(input)) {\n      await this.storeLogEntry(input);\n    }\n\n    if (this.properties['obj'].length > 0) await this.trySendStoredData();\n  }\n\n  async trySendStoredData() {\n    let decimals = this.settings['decimals'].value;\n    decimals = Utils.clamp(decimals, 0, 5);\n\n    const multiPointPost = [];\n\n    let measurementName = this.settings['CumulocityPointName'].value || 'c8y_unknownPoint';\n    if (!measurementName.startsWith('c8y_')) measurementName = 'c8y_' + measurementName;\n    let measurementType = this.settings['CumulocityPointType'].value || 'c8y_unknownType';\n    if (!measurementType.startsWith('c8y_')) measurementType = 'c8y_' + measurementType;\n    const seriesName = this.settings['CumulocitySeries'].value || 'unknownSeries';\n\n    this.properties['obj'].forEach(log => {\n      const dataType = this.settings['dataType'].value;\n      log.payload = this.convertInput(log.payload, dataType, decimals);\n      multiPointPost.push({\n        source: {\n          id: this.settings['CumulocityDeviceID'].value,\n        },\n        time: log.timestamp,\n        type: measurementType,\n        [measurementName]: {\n          [seriesName]: {\n            value: log.payload,\n            unit: String(this.settings['units'].value) || 'undefined',\n          },\n        },\n      });\n    });\n    this.debugInfo(`SENDING DATA: ${JSON.stringify(multiPointPost)}`);\n    let cfg: any = bsaClientConfig('measurement');\n    cfg = { ...cfg, method: 'POST', data: { measurements: multiPointPost } };\n    try {\n      const response = await axios(cfg);\n      this.debugInfo(`RESPONSE FROM SERVER: ${JSON.stringify(response.data)}`);\n      this.properties['obj'] = [];\n      this.persistProperties(false, true);\n      this.setOutputData(this.histErrorOutput, '');\n      this.settings['timeAsString'].value\n        ? this.setOutputData(this.lastHistExportOutput, moment().format(), true)\n        : this.setOutputData(this.lastHistExportOutput, moment().valueOf(), true);\n      this.updateHistoryCountOutput();\n    } catch (e) {\n      this.debugErr(`ERROR: ${e}`);\n      this.setOutputData(this.histErrorOutput, e);\n    }\n  }\n\n  async storeLogEntry(input) {\n    if (input == null) return;\n    // cap the amount of data that can be stored\n    const storageLimit = Utils.clamp(this.settings['storage-limit'].value, 0, 50);\n    const minuteRound = Utils.clamp(this.settings['minuteRoundValue'].value, 0, 60);\n    const now = minuteRound ? TimeUtils.nearestFutureMinutes(minuteRound, moment()) : moment();\n    // object data\n    const msg = {\n      payload: input,\n      timestamp: now.toISOString(),\n    };\n    // build an object\n    this.properties['obj'].push(msg);\n    while (this.properties['obj'].length > storageLimit) {\n      this.properties['obj'].shift();\n    }\n    this.properties['lastHistoryValue'] = input;\n    this.persistProperties(false, true);\n    this.updateHistoryCountOutput();\n  }\n\n  checkTriggered() {\n    return (\n      this.settings['historyMode'].value === HistoryMode.TRIGGER_ONLY &&\n      this.getInputData(this.histTriggerInput) &&\n      this.inputs[this.histTriggerInput].updated\n    );\n  }\n\n  checkCOV(input) {\n    if (this.settings['historyMode'].value === HistoryMode.COV) {\n      const threshold = this.settings['threshold'].value;\n      if (!isNaN(input) && !isNaN(this.properties['lastHistoryValue'])) {\n        return Math.abs(Number(input) - Number(this.properties['lastHistoryValue'])) >= threshold;\n      } else {\n        return input !== this.properties['lastHistoryValue'];\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Sets values in periodic period when HistoryMode is `PERIODIC`\n   */\n  doPeriodicHistoryFunctions() {\n    if (this.side !== Side.server) return;\n    const enable = this.settings['enable'].value;\n    const isPeriodic = this.settings['historyMode'].value === HistoryMode.PERIODIC;\n    if (!enable || !isPeriodic) {\n      if (this.timeoutFunc) {\n        this.interval = -1;\n        clearInterval(this.timeoutFunc);\n        this.debugInfo('Clearing Periodic interval data insertion...');\n      }\n    }\n    if (enable && isPeriodic) {\n      const interval = TimeUtils.timeConvert(this.settings['period'].value, this.settings['periodUnits'].value);\n      if (this.interval !== interval) {\n        clearInterval(this.timeoutFunc);\n        this.timeoutFunc = setInterval(async () => {\n          const input = this.getInputData(this.valueInput);\n          await this.storeLogEntry(input);\n          if (this.properties['obj'].length > 0) await this.trySendStoredData();\n        }, interval);\n        this.interval = interval;\n        this.debugInfo(`Setting Periodic Period of: ${interval} ms`);\n      }\n    }\n  }\n\n  updateHistoryCountOutput() {\n    this.setOutputData(this.storedHistCountOutput, (this.properties['obj'] && this.properties['obj'].length) || 0);\n  }\n}\n\nContainer.registerNodeType('bsa/bsa-cumulocity-point', BSACumulocityNode);\n","import axios from 'axios';\nimport * as _ from 'lodash';\nimport { Container, Side } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport { bsaClientConfig } from './bsa-client-config';\n\nlet moment = require('moment-timezone');\n\nenum ALARM_TYPE {\n  WARNING = 'WARNING',\n  MINOR = 'MINOR',\n  MAJOR = 'MAJOR',\n  CRITICAL = 'CRITICAL',\n}\n\nconst alarmConfig = {\n  items: [\n    { value: ALARM_TYPE.WARNING, text: ALARM_TYPE.WARNING },\n    { value: ALARM_TYPE.MINOR, text: ALARM_TYPE.MINOR },\n    { value: ALARM_TYPE.MAJOR, text: ALARM_TYPE.MAJOR },\n    { value: ALARM_TYPE.CRITICAL, text: ALARM_TYPE.CRITICAL },\n  ],\n};\n\nclass BSACumulocityAlarmNode extends Node {\n  constructor() {\n    super();\n    this.title = 'BSA Cumulocity Alarm';\n    this.description = '';\n    this.addInput('alarmInput', Type.BOOLEAN);\n    this.addInputWithSettings('alarmText', Type.STRING, 'No Alarm Message Available', 'Enter Alarm Message');\n    this.addInputWithSettings('alarmClass', Type.DROPDOWN, ALARM_TYPE.WARNING, 'Alarm Class', false, alarmConfig);\n\n    this.addOutput('status', Type.BOOLEAN);\n    this.addOutput('error', Type.STRING);\n\n    this.settings['enable'] = {\n      description: 'Alarm Enable',\n      value: true,\n      type: SettingType.BOOLEAN,\n    };\n\n    this.settings['CumulocityDeviceID'] = {\n      description: 'Cumulocity Device ID (Number)',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    this.settings['CumulocityAlarmName'] = {\n      description: 'Alarm Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n  }\n\n  onCreated() {\n    if (_.isEmpty(this.properties['alarmRegistry'])) this.properties['alarmRegistry'] = {};\n  }\n\n  async onInputUpdated() {\n    if (this.side !== Side.server) return;\n    if (!this.settings['enable'].value) return;\n    if (this.inputs[0].updated) await this.postAlarm(this.getInputData(0));\n  }\n\n  async onAfterSettingsChange() {\n    await this.onInputUpdated();\n  }\n\n  async postAlarm(alarmInput) {\n    let alarmName = this.settings['CumulocityAlarmName'].value || 'c8y_unknownAlarm';\n    if (!alarmName.startsWith('c8y_')) alarmName = 'c8y_' + alarmName;\n\n    let cfg: any = bsaClientConfig('alarm');\n    if (alarmInput) {\n      cfg = {\n        ...cfg,\n        method: 'POST',\n        data: {\n          source: {\n            id: this.settings['CumulocityDeviceID'].value,\n          },\n          text: this.getInputData(1),\n          time: moment().toISOString(),\n          type: alarmName,\n          status: 'ACTIVE',\n          severity: this.getInputData(2),\n        },\n      };\n      try {\n        const response = await axios(cfg);\n        this.setOutputData(0, true);\n        this.setOutputData(1, false);\n        this.properties['alarmRegistry'][alarmName] = response.data.id;\n        this.debugInfo(`ALARM_REGISTRY ${JSON.stringify(this.properties['alarmRegistry'])}`);\n      } catch (error) {\n        this.debugErr(error);\n        this.setOutputData(0, false);\n        this.setOutputData(1, error);\n      }\n    } else if (!alarmInput) {\n      const alarmID = this.properties['alarmRegistry'][alarmName];\n      if (!alarmID) return;\n      cfg = {\n        ...cfg,\n        method: 'PUT',\n        url: `alarm/alarms/${alarmID}`,\n        data: { status: 'CLEARED' },\n      };\n      try {\n        await axios(cfg);\n        this.setOutputData(0, false);\n        this.setOutputData(1, false);\n        delete this.properties['alarmRegistry'][alarmName];\n        this.debugInfo(`Cleared alarm ${alarmName}`);\n        this.debugInfo(`ALARM_REGISTRY ${JSON.stringify(this.properties['alarmRegistry'])}`);\n      } catch (error) {\n        this.debugErr(`ERROR ${error}`);\n        this.setOutputData(0, false);\n        this.setOutputData(1, error);\n      }\n    }\n    this.persistProperties(false, true);\n  }\n}\n\nContainer.registerNodeType('bsa/bsa-cumulocity-alarm', BSACumulocityAlarmNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass AndNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicSettingsExist = false;\n    this.dynamicInputsType = Type.BOOLEAN;\n    this.title = 'AND';\n    this.description =\n      \"Performs a logical 'AND' operation (output 'true' when ALL inputs are 'true'). You can specify the number of inputs in the node settings.\";\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('out not', Type.BOOLEAN);\n    this.setOutputData(0, false);\n    this.setOutputData(1, true);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const allInputs = this.getDefinedInputValues();\n    if (allInputs.length == 0) {\n      this.setOutputData(0, false);\n      this.setOutputData(1, true);\n      return;\n    }\n    const areAllInputsTrue = allInputs.every(v => v === true);\n    this.setOutputData(0, areAllInputsTrue);\n    this.setOutputData(1, !areAllInputsTrue);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('boolean/and', AndNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass OrNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicSettingsExist = false;\n    this.dynamicInputsType = Type.BOOLEAN;\n    this.title = 'OR';\n    this.description =\n      \"Performs a logical 'OR' operation (output 'true' when ANY input is 'true'). You can specify the number of inputs in the node settings.\";\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('out not', Type.BOOLEAN);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const allInputs = this.getDefinedInputValues();\n    if (allInputs.length == 0) {\n      this.setOutputData(0, false);\n      this.setOutputData(1, true);\n      return;\n    }\n\n    const anyTrue = allInputs.some(v => v == true);\n    this.setOutputData(0, anyTrue);\n    this.setOutputData(1, !anyTrue);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('boolean/or', OrNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport Icons from '../../node-icons';\nimport { Type } from '../../node-io';\n\nlet logicMainColour = Icons.logicMainColour;\nlet logicAndIcon = Icons.logicAndIcon;\nlet logicOrIcon = Icons.logicOrIcon;\n\nclass XorNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'XOR';\n    this.description =\n      \"Performs a logical 'XOR' operation (output 'true' when EITHER input is 'true', but not both). Limited to only 2 inputs.\";\n\n    // this.headerColor = logicMainColour;\n    //this.iconImageUrl = logicAndIcon;\n\n    this.addInput('in 1', Type.BOOLEAN);\n    this.addInput('in 2', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('out not', Type.BOOLEAN);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const in1 = this.getInputData(0);\n    const in2 = this.getInputData(1);\n    if ((in1 && !in2) || (!in1 && in2)) {\n      this.setOutputData(0, true);\n      this.setOutputData(1, false);\n    } else {\n      this.setOutputData(0, false);\n      this.setOutputData(1, true);\n    }\n  }\n}\nContainer.registerNodeType('boolean/xor', XorNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport Icons from '../../node-icons';\nimport { Type } from '../../node-io';\n\nlet logicMainColour = Icons.logicMainColour;\nlet logicNotIcon = Icons.logicNotIcon;\n\nclass NotNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'NOT';\n    this.description =\n      \"Performs a logical 'NOT' operation (output will be the inverse of the input).\";\n    // this.headerColor = logicMainColour;\n    // this.iconImageUrl = logicNotIcon;\n    this.addInput('input', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    this.emitTransformedInput(x => !x);\n  }\n}\nContainer.registerNodeType('boolean/not', NotNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass ToggleNode extends Node {\n  state = false;\n  lastVal;\n  count = 0;\n\n\n  constructor() {\n    super();\n\n    this.title = 'Toggle';\n    this.description =\n      \"When the 'input' transitions from 'false' to 'true', 'output' will switch between 'false'/'true'.   (See Figure A.)\";\n    this.addInput('input', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    //this.addOutput('toggle out', Type.BOOLEAN);\n    this.settings['reset-on-disc'] = {\n      description: 'Reset on disconnected or input is null',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.setOutputData(0, null);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let input = this.getInputData(0);\n\n    // sends a true/false on each input update\n    if (this.count === 0) {\n      //this.setOutputData(1, false);\n      this.count = 1;\n    } else if (this.count === 1) {\n      //this.setOutputData(1, true);\n      this.count = 0;\n    }\n\n    if (input == null || input == undefined) {\n      if (this.settings['reset-on-disc'].value) {\n        this.lastVal = false;\n        this.setOutputData(0, null);\n        this.state = false;\n      }\n    } else if (input == this.lastVal) return;\n    if (input == true) {\n      this.setOutputData(0, !this.state);\n      this.state = !this.state;\n    }\n    this.lastVal = input;\n  }\n}\nContainer.registerNodeType('boolean/toggle', ToggleNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils, { TIME_TYPE } from '../../utils/time-utils';\n\nclass OneShotNode extends Node {\n  lastFireValue: boolean;\n  enabled: boolean;\n  lastResetValue: boolean;\n  timeoutFunc;\n  remainingFunc;\n  timeUnits;\n  remainingUpdateMillis;\n  remainingUpdateSize;\n\n\n  constructor() {\n    super();\n    this.title = 'One Shot';\n    this.description =\n      \"Triggers output to 'true' for 'interval' duration when 'trigger' input transitions from 'false' to 'true.  Output is reset to 'false' when 'reset' transitions from 'false' to 'true. 'interval' units can be configured from settings. Maximum interval setting is 587 hours. (See Figure A.).  If 'Retrigger While Output Is 'true'' setting is false, then 'fire' input transitions will have an effect when output is 'false'.\";\n\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Interval (Max is 597 Hours)');\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('remaining', Type.NUMBER);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: TIME_TYPE.MILLISECONDS, text: 'Milliseconds' },\n          { value: TIME_TYPE.SECONDS, text: 'Seconds' },\n          { value: TIME_TYPE.MINUTES, text: 'Minutes' },\n          { value: TIME_TYPE.HOURS, text: 'Hours' },\n        ],\n      },\n      value: TIME_TYPE.SECONDS,\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n\n    this.settings['retrigger'] = {\n      description: \"Retrigger While Output is 'true'?\",\n      value: true,\n      type: SettingType.BOOLEAN,\n    };\n\n  }\n\n  onCreated() {\n    this.setOutputData(0, false);\n    this.setOutputData(1, 0);\n    this.lastFireValue = false;\n    this.lastResetValue = false;\n    this.enabled = false;\n  }\n\n  onAdded() {\n \n    this.onAfterSettingsChange();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onAfterSettingsChange() {\n    this.timeUnits = this.settings['time'].value;\n    this.inputs[2]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.outputs[1]['name'] = `[remaining] (${this.timeUnits})`;\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let reset = this.getInputData(1);\n    if (reset == null) reset = false;\n    if (reset == true && reset != this.lastResetValue) {\n      this.clearTimers();\n      this.setOutputData(0, false);\n      this.setOutputData(1, 0);\n      this.enabled = false;\n    }\n    this.lastResetValue = reset;\n\n    let fire = this.getInputData(0);\n    if (fire == null) fire = false;\n    if (fire == true && fire != this.lastFireValue) {\n      const retrigger = this.settings['retrigger'].value;\n      if (retrigger || this.enabled === false) {\n        const delay = this.getInputData(2);\n        const delayMilli = TimeUtils.timeConvert(delay, this.timeUnits);\n        this.clearTimers();\n        this.setOutputData(0, true);\n        this.setOutputData(1, delay);\n        this.enabled = true;\n        this.timeoutFunc = setTimeout(() => {\n          this.enabled = false;\n          this.setOutputData(0, false);\n          this.setOutputData(1, 0);\n          clearInterval(this.remainingFunc);\n        }, delayMilli);\n        switch(this.timeUnits){\n          case TIME_TYPE.MILLISECONDS:\n            this.remainingUpdateMillis = 500;\n            this.remainingUpdateSize = 500;\n            break;\n          case TIME_TYPE.SECONDS:\n            this.remainingUpdateMillis = 1000;\n            this.remainingUpdateSize = 1;\n            break;\n          case TIME_TYPE.MINUTES:\n            this.remainingUpdateMillis = 6000;\n            this.remainingUpdateSize = 0.1;\n            break;\n          case TIME_TYPE.HOURS:\n            this.remainingUpdateMillis = 360000;\n            this.remainingUpdateSize = 0.1;\n            break;\n        }\n        this.remainingFunc = setInterval(() => {\n          const remaining = this.outputs[1].data - this.remainingUpdateSize;\n          this.setOutputData(1, remaining);\n        }, this.remainingUpdateMillis);\n      }\n    }\n    this.lastFireValue = fire;\n    this.setOutputData(0, this.outputs[0].data);\n    this.setOutputData(1, this.outputs[1].data);\n  }\n\n  private clearTimers() {\n    if (this.timeoutFunc) clearTimeout(this.timeoutFunc);\n    if (this.remainingFunc) clearInterval(this.remainingFunc);\n  }\n  \n}\nContainer.registerNodeType('boolean/one-shot', OneShotNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport TimeUtils from '../../utils/time-utils';\n\n// TODO: Check logic\nclass MinOnOffNode extends Node {\n  lastValue: boolean;\n  timeOn: number;\n  timeOff: number;\n  minOnEnabled: boolean;\n  minOffEnabled: boolean;\n  minOnTime: number;\n  minOffTime: number;\n  lastResetValue: boolean;\n\n  constructor() {\n    super();\n    this.title = 'Min On Off';\n    this.description =\n      \"output matches input but is delayed by the 'minOn' and 'minOff' durations. output will remain 'true' for 'minOn' duration then match the input value. output will remain 'false' for 'minOff' duration then match the input value. 'minOn' and 'minOff' delays are cancelled when 'reset' transitions from 'false' to 'true. minOn active is true during minOn periods. minOff active is true during minOff periods.  'minOn' and 'minOff' units can be configured from settings. Maximum minOn and 'minOff' setting is 587 hours.   (See Figure A.)\";\n\n    this.addInput('input', Type.BOOLEAN);\n    this.addInputWithSettings('minOn', Type.NUMBER, 1, 'Minimum On Time');\n    this.addInputWithSettings('minOff', Type.NUMBER, 1, 'Minimum Off Time');\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('minOn active', Type.BOOLEAN);\n    this.addOutput('minOff active', Type.BOOLEAN);\n    this.settings['timeMinOn'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.settings['timeMinOff'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [\n        { minOn: { weight: 2 }, timeMinOn: {} },\n        { minOff: { weight: 2 }, timeMinOff: {} },\n      ],\n    });\n\n    this.setOutputData(0, false);\n    this.setOutputData(1, false);\n    this.setOutputData(2, false);\n    this.timeOn = null;\n    this.timeOff = null;\n    this.minOnEnabled = false;\n    this.minOffEnabled = false;\n    this.lastResetValue = false;\n  }\n\n  onCreated() {\n    this.setOutputData(0, false);\n    this.setOutputData(1, false);\n    this.setOutputData(2, false);\n  }\n\n  onAdded() {\n    this.inputs[1]['name'] = `[minOn] (${this.settings['timeMinOn'].value})`;\n    this.inputs[2]['name'] = `[minOff] (${this.settings['timeMinOff'].value})`;\n    this.onInputUpdated();\n  }\n\n  onExecute() {\n    let elapsed = null;\n    if (this.minOnEnabled) {\n      elapsed = Date.now() - this.timeOn;\n      if (elapsed >= this.minOnTime) {\n        this.minOnEnabled = false;\n        this.onInputUpdated();\n        this.setOutputData(1, false);\n      }\n    }\n    if (this.minOffEnabled) {\n      elapsed = Date.now() - this.timeOff;\n      if (elapsed >= this.minOffTime) {\n        this.minOffEnabled = false;\n        this.onInputUpdated();\n        this.setOutputData(2, false);\n      }\n    }\n    this.setOutputData(1, this.outputs[1].data)\n    this.setOutputData(2, this.outputs[2].data)\n  }\n\n  onInputUpdated() {\n    let reset = this.getInputData(3);\n    if (reset == null) reset = false;\n    if (reset == true && reset != this.lastResetValue) {\n      this.setOutputData(0, false);\n      this.minOnEnabled = false;\n      this.minOffEnabled = false;\n      this.setOutputData(1, false);\n      this.setOutputData(2, false);\n    }\n    this.lastResetValue = reset;\n\n    let minOn = this.getInputData(1);\n    minOn = TimeUtils.timeConvert(minOn, this.settings['timeMinOn'].value);\n    this.minOnTime = minOn;\n\n    let minOff = this.getInputData(2);\n    minOff = TimeUtils.timeConvert(minOff, this.settings['timeMinOff'].value);\n    this.minOffTime = minOff;\n\n    let input = this.getInputData(0);\n    if (!Utils.hasInput(input)) input = false;\n    if (!this.minOnEnabled && !this.minOffEnabled) {\n      this.setOutputData(0, input);\n      if (input && input != this.lastValue) {\n        this.timeOn = Date.now();\n        this.minOnEnabled = true;\n        this.setOutputData(1, true);\n      } else if (!input && input != this.lastValue) {\n        this.timeOff = Date.now();\n        this.minOffEnabled = true;\n        this.setOutputData(2, true);\n      }\n      this.lastValue = input;\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[1]['name'] = `[minOn] (${this.settings['timeMinOn'].value})`;\n    this.inputs[2]['name'] = `[minOff] (${this.settings['timeMinOff'].value})`;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('boolean/min-on-off', MinOnOffNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils, { TIME_TYPE } from '../../utils/time-utils';\n\nclass DelayOnNode extends Node {\n  lastInput:boolean;\n  lastReset:boolean;\n  timeoutFunc;\n  enabled = false;\n  remainingFunc;\n  timeUnits;\n  remainingUpdateMillis;\n  remainingUpdateSize;\n\n\n  constructor() {\n    super();\n    this.title = 'On Delay';\n    this.description =\n      \"output matches input, but output transitions from 'false' to 'true' are delayed by 'delay' duration. The delay is cancelled when 'reset' transitions from 'false' to 'true. onDelay active is true during onDelay periods. 'delay' units can be configured from settings. Maximum delay setting is 587 hours.  (See Figure A.)\";\n\n    this.addInput('input', Type.BOOLEAN);\n    this.addInputWithSettings('delay', Type.NUMBER, 1, 'On Delay Duration (Max 597 Hours)');\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('onDelay active', Type.BOOLEAN);\n    this.addOutput('remaining', Type.NUMBER);\n\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: TIME_TYPE.MILLISECONDS, text: 'Milliseconds' },\n          { value: TIME_TYPE.SECONDS, text: 'Seconds' },\n          { value: TIME_TYPE.MINUTES, text: 'Minutes' },\n          { value: TIME_TYPE.HOURS, text: 'Hours' },\n        ],\n      },\n      value: TIME_TYPE.SECONDS,\n    };\n    this.setSettingsConfig({\n      groups: [{ delay: { weight: 2 }, time: {} }],\n    });\n\n    \n  }\n\n  onCreated() {\n    this.setOutputData(0, false);\n    this.setOutputData(1, false);\n    this.setOutputData(2, 0);\n    this.lastInput = false;\n    this.lastReset = false;\n  }\n\n  onAdded() {\n \n    this.onAfterSettingsChange();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onAfterSettingsChange() {\n    this.timeUnits = this.settings['time'].value;\n    this.inputs[1]['name'] = `[delay] (${this.timeUnits})`;\n    this.outputs[2]['name'] = `[remaining] (${this.timeUnits})`;\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const delay = this.getInputData(1);\n    const delayMilli = TimeUtils.timeConvert(delay, this.timeUnits);\n\n    let input = this.getInputData(0);\n    if (input !== true) input = false;\n\n    const reset = this.getInputData(2);\n    if (reset && this.inputs[2].updated && !this.lastReset && this.enabled) {\n      this.clearTimers();\n      this.setOutputData(0, input);\n      this.setOutputData(1, false);\n      this.setOutputData(2, 0);\n      this.enabled = false;\n    }\n    this.lastReset = reset;\n\n    if (input && this.inputs[0].updated && !this.lastInput) {\n      this.setOutputData(1, true);\n      this.setOutputData(2, delay);\n      this.enabled = true;\n      this.clearTimers();\n      this.timeoutFunc = setTimeout(() => {\n        this.enabled = false;\n        this.setOutputData(0, true);\n        this.setOutputData(1, false);\n        this.setOutputData(2, 0);\n        clearInterval(this.remainingFunc);\n      }, delayMilli);\n      switch(this.timeUnits){\n        case TIME_TYPE.MILLISECONDS:\n          this.remainingUpdateMillis = 500;\n          this.remainingUpdateSize = 500;\n          break;\n        case TIME_TYPE.SECONDS:\n          this.remainingUpdateMillis = 1000;\n          this.remainingUpdateSize = 1;\n          break;\n        case TIME_TYPE.MINUTES:\n          this.remainingUpdateMillis = 6000;\n          this.remainingUpdateSize = 0.1;\n          break;\n        case TIME_TYPE.HOURS:\n          this.remainingUpdateMillis = 360000;\n          this.remainingUpdateSize = 0.1;\n          break;\n      }\n      this.remainingFunc = setInterval(() => {\n        const remaining = this.outputs[2].data - this.remainingUpdateSize;\n        this.setOutputData(2, remaining);\n      }, this.remainingUpdateMillis);\n    }\n    this.lastInput = input;\n    if (!input) {\n      this.setOutputData(0, false);\n      this.setOutputData(1, false);\n      this.setOutputData(2, 0);\n      if (this.inputs[0].updated && this.enabled) {\n        this.clearTimers();\n        this.enabled = false;\n      }\n    }\n  }\n\n  private clearTimers() {\n    if (this.timeoutFunc) clearTimeout(this.timeoutFunc);\n    if (this.remainingFunc) clearInterval(this.remainingFunc);\n  }\n\n}\nContainer.registerNodeType('boolean/on-delay', DelayOnNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils, { TIME_TYPE } from '../../utils/time-utils';\n\nclass DelayOffNode extends Node {\n  lastInput:boolean;\n  lastReset:boolean;\n  timeoutFunc;\n  enabled = false;\n  remainingFunc;\n  timeUnits;\n  remainingUpdateMillis;\n  remainingUpdateSize;\n\n\n  constructor() {\n    super();\n    this.title = 'Off Delay';\n    this.description =\n      \"output matches input, but output transitions from 'true' to 'false' are delayed by 'delay' duration. The delay is cancelled when 'reset' transitions from 'false' to 'true. offDelay active is true during offDelay periods. 'delay' units can be configured from settings.  Maximum delay setting is 587 hours. (See Figure A.)\";\n    this.addInput('input', Type.BOOLEAN);\n    this.addInputWithSettings('delay', Type.NUMBER, 1, 'Off Delay Duration (Max 597 Hours)');\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('offDelay active', Type.BOOLEAN);\n    this.addOutput('remaining', Type.NUMBER);\n\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: TIME_TYPE.MILLISECONDS, text: 'Milliseconds' },\n          { value: TIME_TYPE.SECONDS, text: 'Seconds' },\n          { value: TIME_TYPE.MINUTES, text: 'Minutes' },\n          { value: TIME_TYPE.HOURS, text: 'Hours' },\n        ],\n      },\n      value: TIME_TYPE.SECONDS,\n    };\n    this.setSettingsConfig({\n      groups: [{ delay: { weight: 2 }, time: {} }],\n    });\n    \n  }\n\n  onCreated() {\n    this.setOutputData(0, false);\n    this.setOutputData(1, false);\n    this.setOutputData(2, 0);\n    this.lastInput = false;\n    this.lastReset = false;\n  }\n\n  onAdded() {\n \n    this.onAfterSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.timeUnits = this.settings['time'].value;\n    this.inputs[1]['name'] = `[delay] (${this.timeUnits})`;\n    this.outputs[2]['name'] = `[remaining] (${this.timeUnits})`;\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const delay = this.getInputData(1);\n    const delayMilli = TimeUtils.timeConvert(delay, this.timeUnits);\n\n    let input = this.getInputData(0);\n    if (input !== true) input = false;\n\n    const reset = this.getInputData(2);\n    if (reset && this.inputs[2].updated && !this.lastReset && this.enabled) {\n      this.clearTimers();\n      this.setOutputData(0, input);\n      this.setOutputData(1, false);\n      this.setOutputData(2, 0);\n      this.enabled = false;\n    }\n    this.lastReset = reset;\n\n    if (!input && this.inputs[0].updated && this.lastInput) {\n      this.setOutputData(1, true);\n      this.setOutputData(2, delay);\n      this.clearTimers();\n      this.enabled = true;\n      this.timeoutFunc = setTimeout(() => {\n        this.enabled = false;\n        this.setOutputData(0, false);\n        this.setOutputData(1, false);\n        this.setOutputData(2, 0);\n        clearInterval(this.remainingFunc);\n      }, delayMilli);\n      switch(this.timeUnits){\n        case TIME_TYPE.MILLISECONDS:\n          this.remainingUpdateMillis = 500;\n          this.remainingUpdateSize = 500;\n          break;\n        case TIME_TYPE.SECONDS:\n          this.remainingUpdateMillis = 1000;\n          this.remainingUpdateSize = 1;\n          break;\n        case TIME_TYPE.MINUTES:\n          this.remainingUpdateMillis = 6000;\n          this.remainingUpdateSize = 0.1;\n          break;\n        case TIME_TYPE.HOURS:\n          this.remainingUpdateMillis = 360000;\n          this.remainingUpdateSize = 0.1;\n          break;\n      }\n      this.remainingFunc = setInterval(() => {\n        const remaining = this.outputs[2].data - this.remainingUpdateSize;\n        this.setOutputData(2, remaining);\n      }, this.remainingUpdateMillis);\n    }\n    this.lastInput = input;\n    if (input) {\n      this.setOutputData(0, true);\n      this.setOutputData(1, false);\n      this.setOutputData(2, 0);\n      if (this.inputs[0].updated && this.enabled) {\n        this.clearTimers();\n        this.enabled = false;\n      }\n    }\n  }\n\n  private clearTimers() {\n    if (this.timeoutFunc) clearTimeout(this.timeoutFunc);\n    if (this.remainingFunc) clearInterval(this.remainingFunc);\n  }\n}\nContainer.registerNodeType('boolean/off-delay', DelayOffNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass TickerNode extends Node {\n  lastInterval = 1000;\n  state: boolean = false;\n  runState: boolean = true;\n  timeoutFunc;\n\n\n  constructor() {\n    super();\n    this.title = 'Ticker';\n    this.description =\n      \"While 'enable' is 'true', output will change to 'true' at every 'interval' period. If 'Generate False' setting is set to true, output will be 'false' for the second half of the 'interval' period. When 'enable' is 'false', output will be 'false'. 'interval' units can be configured from settings.  Maximum interval setting is 587 hours.  (See Figure A.)\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Interval');\n    this.addOutput('output', Type.BOOLEAN);\n\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n\n    this.settings['false'] = {\n      description: 'Generate False',\n      value: true,\n      type: SettingType.BOOLEAN,\n    };\n    this.setOutputData(0, false);\n  }\n\n  onAdded() {\n \n    //this.title = `Ticker (${this.settings['time'].value})`;\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    clearInterval(this.timeoutFunc);\n    let enable = this.getInputData(0);\n    if (!enable) {\n      this.setOutputData(0, false);\n      this.runState = false;\n      return;\n    }\n    let interval = this.getInputData(1);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    this.timeoutFunc = setInterval(() => {\n      this.state = !this.state;\n      if (!this.state && this.settings['false'].value) {\n        this.setOutputData(0, false);\n        return;\n      }\n      if (this.state) this.setOutputData(0, true);\n    }, interval / 2);\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let enable = this.getInputData(0);\n\n    if (!enable && this.runState) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, false);\n      this.runState = false;\n      this.state = false;\n      return;\n    } else if (!enable && !this.runState) {\n      this.setOutputData(0, false);\n      this.runState = false;\n      this.state = false;\n      return;\n    } else if (enable) {\n      let interval = this.getInputData(1);\n      interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n\n      if (this.runState) {\n        if (interval != this.lastInterval) {\n          this.lastInterval = interval;\n          clearInterval(this.timeoutFunc);\n          this.timeoutFunc = setInterval(() => {\n            this.state = !this.state;\n            if (!this.state && this.settings['false'].value) {\n              this.setOutputData(0, false);\n              return;\n            }\n            if (this.state) this.setOutputData(0, true);\n          }, interval / 2);\n        }\n        return;\n      } else if (!this.runState) {\n        this.runState = true;\n        this.state = true;\n        this.setOutputData(0, true);\n        this.timeoutFunc = setInterval(() => {\n          this.state = !this.state;\n          if (!this.state && this.settings['false'].value) {\n            this.setOutputData(0, false);\n            return;\n          }\n          if (this.state) this.setOutputData(0, true);\n        }, interval / 2);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    //this.title = `Ticker (${this.settings['time'].value})`;\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('boolean/ticker', TickerNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass EqualNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Equal';\n    this.description =\n      \"'output equal' is 'true' when 'in 1' and 'in 2' are identical, otherwise 'output equal' is 'false'.  Can be used to compare boolean, numeric, and string values; it can also be used to compare 'null' values. 'output not equal' is always the opposite of 'out equal'.\";\n\n    this.addInput('in 1', Type.ANY);\n    this.addInputWithSettings('in 2', Type.ANY, null, 'in 2');\n    this.addOutput('out equal', Type.BOOLEAN);\n    this.addOutput('out not equal', Type.BOOLEAN);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n\n  onInputUpdated() {\n    let a = this.getInputData(0);\n    if (!Utils.hasInput(a)) {\n      this.setOutputData(0, false);\n      this.setOutputData(1, true);\n      return;\n    }\n    a = (a || '').toString(); // making string null i.e `''` and other `null` same\n    const b = (this.getInputData(1) || '').toString();\n    if (a === b) {\n      this.setOutputData(0, true);\n      this.setOutputData(1, false);\n    } else {\n      this.setOutputData(0, false);\n      this.setOutputData(1, true);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('compare/equal', EqualNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass GreaterNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Greater than';\n    this.description =\n      \"'out >' is 'true' when 'in 1' is greater than 'in 2', otherwise 'out >' is 'false'. 'out >=' is 'true' when 'in 1' is greater than or equal to 'in 2', otherwise 'out>=' is 'false'.  Both Outputs will be 'false' if either input is undefined.\";\n\n    this.addInput('in 1', Type.NUMBER);\n    this.addInputWithSettings('in 2', Type.NUMBER, 0, 'In 2 Constant', false);\n    this.addOutput('out >', Type.BOOLEAN);\n    this.addOutput('out >=', Type.BOOLEAN);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n  \n\n  onInputUpdated() {\n    let a = this.getInputData(0);\n    let b = this.getInputData(1);\n\n    if (a != null && b != null) {\n      this.setOutputData(0, a > b);\n      this.setOutputData(1, a >= b);\n    } else {\n      this.setOutputData(0, false);\n      this.setOutputData(1, false);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('compare/greater-than', GreaterNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass LessThanNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Less than';\n    this.description =\n      \"'out <' is 'true' when 'in 1' is less than 'in 2', otherwise 'out <' is 'false'.  'out <=' is 'true' when 'in 1' is less than or equal to 'in 2', otherwise 'out <=' is 'false'.  Both outputs will be 'false' if either input is undefined.\";\n    this.addInput('in 1', Type.NUMBER);\n    this.addInputWithSettings('in 2', Type.NUMBER, 0, 'In 2 Constant', false);\n    this.addOutput('out <', Type.BOOLEAN);\n    this.addOutput('out <=', Type.BOOLEAN);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let a = this.getInputData(0);\n    let b = this.getInputData(1);\n\n    if (a != null && b != null) {\n      this.setOutputData(0, a < b);\n      this.setOutputData(1, a <= b);\n      return;\n    } else {\n      this.setOutputData(0, false);\n      this.setOutputData(1, false);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('compare/less-than', LessThanNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass BetweenNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Between';\n    this.description =\n      \"'output' is 'true' when 'in 1' is within the numeric range between 'from' value and 'to' value (exclusive), otherwise 'output' is 'false'.  'output' will be 'false' if either input is undefined. 'outp not' is always the opposite of 'output'.\";\n\n    this.addInput('input', Type.NUMBER);\n    this.addInputWithSettings('from', Type.NUMBER, 0, 'From Value', false);\n    this.addInputWithSettings('to', Type.NUMBER, 1, 'To Value', false);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('out not', Type.BOOLEAN);\n    this.setOutputData(0, false);\n    this.setOutputData(1, true);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    let from = this.getInputData(1);\n    let to = this.getInputData(2);\n\n    if (val != null && from != null && to != null) {\n      //if (val >= from && val <= to) {\n      if (val >= Math.min(from, to) && val <= Math.max(from, to)) {\n        this.setOutputData(0, true);\n        this.setOutputData(1, false);\n      } else {\n        this.setOutputData(0, false);\n        this.setOutputData(1, true);\n      }\n    } else {\n      this.setOutputData(0, false);\n      this.setOutputData(1, true);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('compare/between', BetweenNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass HysteresisNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Hysteresis';\n    this.description =\n      \"Boolean 'output' based on 'input' in relation to 'risingEdge' and 'fallingEdge' setpoints.  There are 2 cases: 'risingEdge' greater than 'fallingEdge', and 'risingEdge' less than 'fallingEdge'. [For 'risingEdge' > 'fallingEdge'] => 'output' is 'true' when 'input' is greater than 'risingEdge'.  'output' is  'false' when 'input' is less than 'fallingEdge'. [For 'fallingEdge' < 'fallingEdge'] => 'output' is 'false' when 'input' is greater than 'risingEdge'.  'output' is 'true' when 'input' is less than 'fallingEdge'.  In both cases, when 'input' is between 'risingEdge' and 'fallingEdge', 'output' will remain in its current state.  \";\n\n    this.addInput('input', Type.NUMBER);\n    this.addInputWithSettings('risingEdge', Type.NUMBER, 20, 'Rising Edge', false);\n    this.addInputWithSettings('fallingEdge', Type.NUMBER, 10, 'Falling Edge', false);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('out not', Type.BOOLEAN);\n    this.setOutputData(0, false);\n    this.setOutputData(1, true);\n  }\n\n  onAdded() {\n \n    this.setOutputData(0, false);\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let inMsg = this.getInputData(0);\n    let risingEdge = this.getInputData(1);\n    let fallingEdge = this.getInputData(2);\n\n    if (risingEdge != null && fallingEdge != null) {\n      if (risingEdge > fallingEdge) {\n        if (inMsg <= fallingEdge) {\n          this.setOutputData(0, false);\n          this.setOutputData(1, true);\n        }\n        if (inMsg >= risingEdge) {\n          this.setOutputData(0, true);\n          this.setOutputData(1, false);\n        }\n      } else if (risingEdge < fallingEdge) {\n        if (inMsg >= fallingEdge) {\n          this.setOutputData(0, false);\n          this.setOutputData(1, true);\n        }\n        if (inMsg <= risingEdge) {\n          this.setOutputData(0, true);\n          this.setOutputData(1, false);\n        }\n      }\n    } else {\n      this.setOutputData(0, false);\n      this.setOutputData(1, true);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('compare/hysteresis', HysteresisNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass TypeCheckNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Type Check (string)';\n    this.description =\n      \"'output' is 'true' when 'input' type matches 'Type to check' setting.  'isType' outputs the type of the 'input' value.\";\n\n    this.addInput('input', Type.ANY);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('isType', Type.STRING);\n\n    this.settings['type'] = {\n      description: 'Type to check',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: Type.STRING, text: Type.STRING },\n          { value: Type.NUMBER, text: Type.NUMBER },\n          { value: Type.BOOLEAN, text: Type.BOOLEAN },\n          { value: Type.JSON, text: Type.JSON },\n        ],\n      },\n      value: Type.STRING,\n    };\n  }\n\n  onAdded() {\n \n    this.updateTitle();\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let data = this.getInputData(0);\n    if (data === undefined) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n    }\n    const type = this.settings['type'].value;\n    const dataType = typeof data;\n    this.setOutputData(1, dataType);\n    switch (type) {\n      case Type.STRING:\n        this.setOutputData(0, typeof data === Type.STRING);\n        break;\n      case Type.NUMBER:\n        this.setOutputData(0, typeof data === Type.NUMBER);\n        break;\n      case Type.BOOLEAN:\n        this.setOutputData(0, typeof data === Type.BOOLEAN);\n        break;\n      case Type.JSON:\n        if (typeof data === 'string') {\n          try {\n            JSON.parse(data);\n            this.setOutputData(0, true);\n          } catch (e) {\n            this.setOutputData(0, false);\n          }\n        } else if (typeof data === 'object') {\n          try {\n            JSON.parse(JSON.stringify(data));\n            this.setOutputData(0, true);\n          } catch (e) {\n            this.setOutputData(0, false);\n          }\n        }\n        this.setOutputData(0, data === null);\n        break;\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.updateTitle();\n    this.onInputUpdated();\n  }\n\n  updateTitle() {\n    const type = this.settings['type'].value;\n    switch (type) {\n      case Type.STRING:\n        this.title = 'Type Check (string)';\n        break;\n      case Type.NUMBER:\n        this.title = 'Type Check (number)';\n        break;\n      case Type.BOOLEAN:\n        this.title = 'Type Check (boolean)';\n        break;\n      case Type.JSON:\n        this.title = 'Type Check (json)';\n        break;\n    }\n  }\n}\n\nContainer.registerNodeType('compare/type-check', TypeCheckNode);\n","import { Container, Side } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport Icons from '../../node-icons';\nimport { Type } from '../../node-io';\n\nconst icon = Icons.aiIcon;\nexport class ConnectionLocalTransmitterNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Link Transmitter Single';\n    this.description =\n      \"This node works in conjunction with link-receiver node, and provides a connection of nodes without the graphical wires. 'in #' inputs will be sent to the corresponding 'out #' output on link-receiver nodes with matching 'Channel Number' settings. The number of inputs is configurable from settings.\";\n    this.iconImageUrl = icon;\n    this.addInput('input', Type.ANY);\n    this.addInputWithSettings('channel', Type.STRING, '1', 'Topic Name', false);\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.settings['ifNew'] = {\n      description: 'Only transmit on COV',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  init() {\n    if (!this.properties['channel']) {\n      // we are persisting channel input just because, we don't have getInputData(1) on frontend to update title\n      this.properties['channel'] = null;\n    }\n  }\n\n  onAdded() {\n    this.onAfterSettingsChange();\n    this.updateTitle();\n  }\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return;\n\n    this.properties['channel'] = this.getInputData(1);\n    this.persistProperties(false, true);\n\n    const receivers = this.getReceivers();\n    if (this.inputs[1].updated) {\n      this.updateTransmitterTopics();\n    }\n    if (!this.isEnable()) return;\n    const val = this.getInputData(0);\n    const channel = this.getInputData(1);\n    const ifNew = this.settings['ifNew'].value\n    receivers.forEach(receiver => {\n      if (receiver.settings['channel'].value === channel) {\n        const blockNull = receiver.settings['blockNull'].value;\n        if (receiver.getInputData(0) === true && ((blockNull && val != null) || !blockNull)) {\n          receiver.properties['val'] = val;\n          receiver.persistProperties(false, true);\n          receiver.setOutputData(0, receiver.properties['val'], ifNew);\n        }\n      }\n    });\n    this.updateTitle();\n  }\n\n  onAfterSettingsChange() {\n    this.updateTransmitterTopics();\n    this.onInputUpdated();\n  }\n\n  onRemoved() {\n    this.updateTransmitterTopics();\n  }\n\n  updateTransmitterTopics() {\n    if (this.side !== Side.server) return;\n    setTimeout(() => {\n      const receivers = this.getReceivers();\n      receivers.forEach(receiver => {\n        receiver['triggerTransmitterTopicUpdate']();\n      });\n    }, 100); // waiting for this node deletion and hence, receiver will not discover this node\n  }\n\n  getReceivers(): Array<Node> {\n    return Container.containers[0].getNodesByType('connection/link-receiver-single', true);\n  }\n\n  isEnable() {\n    return this.getInputData(2);\n  }\n\n  updateTitle() {\n    this.title = `Link Transmitter Single [${this.properties['channel'] || this.getInputData(1)}]`;\n    this.broadcastTitleToClients();\n  }\n}\n\nContainer.registerNodeType('connection/link-transmitter-single', ConnectionLocalTransmitterNode);\n","import { Node, SettingType } from '../../node';\nimport { Container, Side } from '../../container';\nimport Icons from '../../node-icons';\nimport { Type } from '../../node-io';\nimport { isNull } from '../../../utils/helper';\n\nconst icon = Icons.aiIcon;\n\nexport class ConnectionLocalReceiverNode extends Node {\n  topicList: any = [];\n\n  constructor() {\n    super();\n    this.title = 'Link Receiver Topic';\n    this.description =\n      \"This node works in conjunction with link-transmitter node and provides a connection of nodes without the graphical wires. 'out #' outputs will match the corresponding 'in #' input from link-transmitter nodes with matching 'Channel Number' settings.  The number of outputs is configurable from settings.\";\n    this.iconImageUrl = icon;\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addOutput('output', Type.ANY);\n    this.addOutput('topic-id', Type.STRING);\n    this.settings['channel'] = {\n      description: 'Topic Name',\n      config: { items: [] },\n      value: '',\n      type: SettingType.DROPDOWN,\n    };\n    this.settings['blockNull'] = {\n      description: 'Block Null',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  init() {\n    if (!this.properties['val']) {\n      this.properties['val'] = null;\n    }\n  }\n\n  onAdded() {\n    this.onAfterSettingsChange();\n    this.setOutputData(0, this.properties['val']);\n  }\n\n  onCreated() {\n    if (isNull(this.settings['channel'].value)) {\n      this.onAfterSettingsChange();\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.updateTitle();\n    if (this.side !== Side.server) return;\n    this.transmitterTopic();\n    this.updateChannel();\n  }\n\n  pushSettings() {\n    const unitCategory = this.topicList.map((point: any) => {\n      return { value: point, text: point };\n    });\n    this.settings['channel'].config = {\n      items: unitCategory,\n    };\n    this.persistProperties(true);\n    this.updateTitle();\n    this.updateChannel();\n    this.broadcastSettingsToClients(false);\n    this.broadcastTitleToClients(false);\n    this.broadcastOutputsToClients(false);\n  }\n\n  transmitterTopic() {\n    const transmitters = Container.containers[0].getNodesByType('connection/link-transmitter-single', true);\n    this.topicList = [];\n    transmitters.forEach(transmitter => {\n      this.topicList.push(transmitter.getInputData(1));\n      if (this.settings['channel'].value === transmitter.getInputData(1)) {\n        this.setOutputData(0, transmitter.getInputData(0));\n      }\n    });\n    this.pushSettings();\n  }\n\n  updateTitle() {\n    this.title = 'Link Receiver Single [' + this.settings['channel'].value + ']';\n  }\n\n  updateChannel() {\n    this.setOutputData(1, this.settings['channel'].value);\n  }\n\n  // @Link: Triggers from transmitter on addition and on remove\n  triggerTransmitterTopicUpdate() {\n    if (this.side !== Side.server) return;\n    this.transmitterTopic();\n  }\n}\nContainer.registerNodeType('connection/link-receiver-single', ConnectionLocalReceiverNode);\n","import { Container, Side } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nexport class ConnectionLocalTransmitterNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Link Transmitter';\n    this.description =\n      \"This node works in conjunction with link-receiver node, and provides a connection of nodes without the graphical wires.  'in #' inputs will be sent to the corresponding 'out #' output on link-receiver nodes with matching 'Channel Number' settings.  The number of inputs is configurable from settings.\";\n\n    this.settings['channel'] = {\n      description: 'Channel Number',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['inputsCount'] = {\n      description: 'Inputs Count',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n  }\n\n  init() {\n    this.properties['inputsCount'] = 0;\n    this.changeTopicsCount(this.settings['inputsCount'].value);\n  }\n\n  onAdded() {\n    this.onAfterSettingsChange();\n  }\n\n  onInputUpdated() {\n    for (let i in this.inputs) {\n      let val = this.inputs[i].data;\n      if (val == undefined) val = null;\n      let receivers = Container.containers[0].getNodesByType('connection/link-receiver', true);\n      receivers.forEach(receiver => {\n        if (receiver.settings['channel'].value == this.settings['channel'].value) {\n          if (receiver.outputs.hasOwnProperty(i)) {\n            receiver.setOutputData(+i, val);\n            if (this.inputs[i].name !== '') receiver.outputs[i].name = this.inputs[i].name;\n          }\n        }\n      });\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.updateTitle();\n    let inputCount = this.settings['inputsCount'].value;\n    inputCount = Utils.clamp(inputCount, 1, 100);\n    if (inputCount !== this.properties['inputsCount']) this.changeTopicsCount(inputCount);\n    this.renameInputs();\n    this.persistProperties(true, true, true);\n    this.onInputUpdated();\n  }\n\n  changeTopicsCount(target_count) {\n    let diff = target_count - this.properties['inputsCount'];\n    if (diff == 0) return;\n\n    //add inputs, outputs\n    this.changeInputsCount(target_count, Type.ANY);\n\n    //change settings for topics\n    if (diff > 0) {\n      for (let i = this.properties['inputsCount'] + 1; i <= target_count; i++) {\n        this.settings['in' + i] = {\n          description: 'Input ' + i,\n          value: '',\n          type: SettingType.STRING,\n        };\n      }\n    } else if (diff < 0) {\n      for (let i = this.properties['inputsCount']; i > target_count; i--) {\n        delete this.settings['in' + i];\n      }\n    }\n    this.properties['inputsCount'] = target_count;\n  }\n\n  renameInputs() {\n    for (let i = 0; i <= this.properties['inputsCount'] - 1; i++) {\n      let topic = this.settings['in' + (i + 1)]?.value;\n      if (topic?.length > 20) topic = '...' + topic.substr(topic.length - 20, 20);\n      this.inputs[String(i)].name = '' + (i + 1) + ' | ' + topic;\n    }\n\n    if (this.side == Side.editor) {\n      for (let i = 0; i <= this.properties['inputsCount'] - 1; i++) {\n        this.inputs[String(i)].label = this.inputs[String(i)].name;\n      }\n      this.setDirtyCanvas(true, true);\n    }\n  }\n\n  updateTitle() {\n    this.title = 'Link Transmitter [' + this.settings['channel'].value + ']';\n  }\n}\nContainer.registerNodeType('connection/link-transmitter', ConnectionLocalTransmitterNode);\n","import { SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\n\nexport class ConnectionLocalReceiverNode extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicOutputsExist = true;\n    this.dynamicInputsExist = false;\n    this.dynamicSettingsExist = false;\n    this.dynamicDefaultOutputs = 1;\n    this.dynamicMinOutputs = 1;\n    this.title = 'Link Receiver';\n    this.description =\n      \"This node works in conjunction with link-transmitter node and provides a connection of nodes without the graphical wires.  'out #' outputs will match the corresponding 'in #' input from link-transmitter nodes with matching 'Channel Number' settings.  The number of outputs is configurable from settings.\";\n    this.settings['channel'] = {\n      description: 'Channel Number',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n  }\n\n  onCreated() {\n    this.properties['channel'] = 1;\n  }\n\n  onAdded() {\n    this.updateTitle();\n    this.onAfterSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.updateTitle();\n    if (this.properties['channel'] !== this.settings['channel'].value) this.resetOutputs();\n    this.triggerTransmitterNodeUpdate();\n  }\n\n  triggerTransmitterNodeUpdate() {\n    let transmitters = Container.containers[0].getNodesByType('connection/link-transmitter', true);\n    transmitters.forEach(transmitter => {\n      if (transmitter.settings['channel'].value == this.settings['channel'].value) {\n        transmitter['onInputUpdated']();\n      }\n    });\n  }\n\n  resetOutputs() {\n    for (let i in this.outputs) {\n      this.setOutputData(+i, null);\n    }\n  }\n\n  updateTitle() {\n    this.title = 'Link Receiver [' + this.settings['channel'].value + ']';\n  }\n}\nContainer.registerNodeType('connection/link-receiver', ConnectionLocalReceiverNode);\n","\n// THIS NODE IS A COPY OF THE STREAM-MERGE NODE.  \n// IT SHOULD BE REMOVED ONCE NODES ARE DUPLICATED TO MULTIPLE CATEGORIES\n\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport { FlexibleNode } from '../../flexible-node';\n\nclass HubNode extends FlexibleNode {\n  val: number;\n  lastReset: boolean;\n\n  constructor() {\n    super();\n    this.dynamicSettingsExist = false;\n    this.dynamicInputsType = Type.ANY;\n    this.title = 'Hub';\n    this.description =\n      \"This node merges multiple inputs into a single stream/output.  Any new 'input' ('in #') value will be passed to 'output'.  The number of inputs can be modified from settings.\";\n    this.addOutput('output', Type.ANY);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n    this.size = this.computeSize();\n  }\n\n  onInputUpdated() {\n    const inputs = this.getInputsCount();\n    for (let i = this.dynamicInputStartPosition; i < inputs; i++) {\n      let inputValue = this.getInputData(i);\n      if (Utils.hasInput(inputValue)) {\n        if (this.inputs[i].updated) {\n          this.setOutputData(0, this.inputs[i].data);\n          return;\n        }\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('connection/hub', HubNode);\n","import { isNull } from '../../../utils/helper';\nimport { Container } from '../../container';\nimport { Node} from '../../node';\nimport { NodeIO, Type } from '../../node-io';\nimport Registry from '../../registry';\nimport { AbstractFolderIONode } from './abstract-folder-io';\n\nclass ContainerInputNode extends AbstractFolderIONode {\n  constructor(container) {\n    super(container, 'Folder Input', 'Input of the container');\n    this.addOutput('input', null);\n  }\n\n  onCreated() {\n    if (!this.isUnderContainer()) return;\n    let containerNode = this.container.container_node;\n    const id = containerNode.addInput(this.name, Type.ANY, undefined, undefined, { subNodeId: this.id });\n    this.name = containerNode.inputs[id].name;\n    this.linkHandler.recomputeInputLinks(Registry.getId(containerNode.cid, containerNode.id));\n  }\n\n  onRemoved() {\n    if (!this.isUnderContainer()) return;\n    let containerNode = this.container.container_node;\n    let [inputId, _] = this.findParentOutputById(this.container.container_node, 'inputs');\n    if (isNull(inputId)) {\n      return;\n    }\n    containerNode.removeInput(+inputId);\n    this.linkHandler.recomputeInputLinks(Registry.getId(containerNode.cid, containerNode.id));\n    this.emitChange(containerNode, 'size');\n  }\n\n  onAfterSettingsChange() {\n    if (!this.isUnderContainer()) return;\n    const containerNode = this.container.container_node;\n    let [inputId, _] = this.findParentOutputById(this.container.container_node, 'inputs');\n    if (isNull(inputId)) {\n      return;\n    }\n    containerNode.inputs[inputId].name = this.name;\n    this.emitChange(containerNode, 'inputs');\n  }\n\n  onExecute() {\n    if (!this.isUnderContainer()) return;\n    let [_, i] = this.findParentOutputById(this.container.container_node, 'inputs');\n    let input = <NodeIO>i;\n    if (input?.updated) this.setOutputData(0, input.data);\n  }\n\n  protected correctParentIO(containerNode: Node, slot: number) {\n    let input = containerNode.inputs[slot];\n    if (isNull(input)) {\n      return;\n    }\n    input.subNodeId = this.id;\n    this.emitChange(containerNode, 'inputs');\n  }\n\n}\n\nContainer.registerNodeType('container/folder-input', ContainerInputNode, null, true, false, true);\n","import { isNull } from '../../../utils/helper';\nimport { Container } from '../../container';\nimport { Node} from '../../node';\nimport { Type } from '../../node-io';\nimport Registry from '../../registry';\nimport { AbstractFolderIONode } from './abstract-folder-io';\n\nclass ContainerOutputNode extends AbstractFolderIONode {\n  constructor(container) {\n    super(container, 'Folder Output', 'Output of the container');\n    this.addInput('output', null);\n  }\n\n  onCreated() {\n    if (!this.isUnderContainer()) return;\n    let containerNode = this.container.container_node;\n    const id = containerNode.addOutput(this.name, Type.ANY, undefined, { subNodeId: this.id });\n    this.name = containerNode.outputs[id].name;\n    this.linkHandler.recomputeOutputLinks(Registry.getId(containerNode.cid, containerNode.id));\n  }\n\n  onRemoved() {\n    if (!this.isUnderContainer()) return;\n    let containerNode = this.container.container_node;\n    let [outputId, _] = this.findParentOutputById(this.container.container_node, 'outputs');\n    if (isNull(outputId)) {\n      return;\n    }\n    containerNode.removeOutput(+outputId);\n    this.linkHandler.recomputeOutputLinks(Registry.getId(containerNode.cid, containerNode.id));\n    this.emitChange(containerNode, 'size');\n  }\n\n  onAfterSettingsChange() {\n    if (!this.isUnderContainer()) return;\n    const containerNode = this.container.container_node;\n    let [outputId, _] = this.findParentOutputById(containerNode, 'outputs');\n    if (isNull(outputId)) {\n      return;\n    }\n    containerNode.outputs[outputId].name = this.name;\n    this.emitChange(containerNode, 'outputs');\n  }\n\n  onInputUpdated() {\n    if (!this.isUnderContainer()) return;\n    let [outputId, _] = this.findParentOutputById(this.container.container_node, 'outputs');\n    if (isNull(outputId)) {\n      return;\n    }\n    this.isRecentlyActive = true;\n    this.container.container_node.setOutputData(+outputId, this.getInputData(0));\n  }\n\n  protected correctParentIO(containerNode: Node, slot: number) {\n    let output = containerNode.outputs[slot];\n    if (isNull(output)) {\n      return;\n    }\n    output.subNodeId = this.id;\n    this.emitChange(containerNode, 'outputs');\n  }\n\n}\n\nContainer.registerNodeType('container/folder-output', ContainerOutputNode, null, true, false, true);\n","import { Container } from '../../container';\nimport { Node} from '../../node';\nimport { Type } from '../../node-io';\n\nclass BoolToIntNode extends Node {\n    constructor() {\n        super();\n        this.title = 'Bool-to-Int Conversion';\n        this.description = 'This node converts a Boolean to a Number.';\n        this.addInput('input', Type.BOOLEAN);\n        this.addOutput('output', Type.NUMBER);\n    }\n    onInputUpdated() {\n        this.setOutputData(0, this.inputs[0].data ? 1 : 0);\n    }\n}\n\nContainer.registerNodeType('conversion/bool-to-int', BoolToIntNode);\n\nclass IntToBoolNode extends Node {\n    constructor() {\n        super();\n        this.title = 'Int-to-Bool Conversion';\n        this.description = 'This node converts a Number to a Boolean.';\n        this.addInput('input', Type.NUMBER);\n        this.addOutput('output', Type.BOOLEAN);\n    }\n    onInputUpdated() {\n        this.setOutputData(0, !!this.inputs[0].data);\n    }\n}\nContainer.registerNodeType('conversion/int-to-bool', IntToBoolNode);\n\n\nclass StringToBool extends Node {\n    constructor() {\n        super();\n        this.title = 'String-to-Bool Conversion';\n        this.description = 'This node converts a Number to a Boolean.';\n        this.addInput('input', Type.STRING);\n        this.addOutput('output', Type.BOOLEAN);\n    }\n    onInputUpdated() {\n        const val = this.getInputData(0)\n        if (val === \"0\" || val === 'false') {\n            this.setOutputData(0, false, true);\n        } else if (val === \"1\" || val === 'true') {\n            this.setOutputData(0, true, true);\n        }\n    }\n}\nContainer.registerNodeType('conversion/string-to-bool', StringToBool);\n","import { Container } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass BitMaskSingle extends Node {\n  constructor() {\n    super();\n    this.title = 'Bit Mask Single';\n    this.description = 'A node to mask a single bit of a byte';\n\n    this.settings['bit'] = {\n      description: 'bit index (0-7)',\n      type: SettingType.NUMBER,\n      value: 0,\n    };\n\n    this.settings['byte'] = {\n      description: 'Byte to read if Array',\n      type: SettingType.NUMBER,\n      value: 0,\n    };\n\n    this.addInput('input', Type.ANY);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let input = this.getInputData(0);\n    if (input === undefined || input === null) {\n      return;\n    }\n\n    const BIT = this.settings['bit'].value;\n    const BYTE = this.settings['byte'].value;\n\n    if (typeof input === 'object') {\n      if (!input || !input.length || input.length < BYTE + 1) {\n        return;\n      }\n      input = input[BYTE];\n    }\n\n    this.setOutputData(0, (input >> BIT) & 0x01);\n  }\n\n  onAfterSettingsChange() {\n    this.settings['bit'].value = Utils.clamp(this.settings['bit'].value, 0, 7);\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('conversion/bit-mask-single', BitMaskSingle);\n\nclass BitMaskMultiple extends Node {\n  mask: number = 0;\n\n  constructor() {\n    super();\n    this.title = 'Bit Mask Multiple';\n    this.description = 'A node to mask certain bits of a byte';\n\n    this.settings['bitStart'] = {\n      description: 'Lowest bit to start (0-7)',\n      type: SettingType.NUMBER,\n      value: 0,\n    };\n\n    this.settings['maskLen'] = {\n      description: 'Mask length (1-8)',\n      type: SettingType.NUMBER,\n      value: 1,\n    };\n\n    this.settings['byte'] = {\n      description: 'Byte to read if Array',\n      type: SettingType.NUMBER,\n      value: 0,\n    };\n\n    this.addInput('input', Type.ANY);\n    this.addOutput('output', Type.NUMBER);\n    this.addOutput('error', Type.STRING);\n  }\n\n  init() {\n    this.updateMask();\n  }\n\n  onAdded() {\n    this.updateMask();\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let input = this.getInputData(0);\n    if (input === undefined || input === null) {\n      return;\n    }\n\n    const BIT_START = this.settings['bitStart'].value;\n    const BYTE = this.settings['byte'].value;\n\n    if (typeof input === 'object') {\n      if (!input || !input.length || input.length < BYTE + 1) {\n        return;\n      }\n      input = input[BYTE];\n    }\n\n    this.setOutputData(0, (input & this.mask) >> BIT_START);\n  }\n\n  onAfterSettingsChange() {\n    this.settings['bitStart'].value = Utils.clamp(this.settings['bitStart'].value, 0, 7);\n    this.settings['maskLen'].value = Utils.clamp(\n      this.settings['maskLen'].value,\n      1,\n      8 - this.settings['bitStart'].value,\n    );\n    this.updateMask();\n    this.onInputUpdated();\n  }\n\n  private updateMask() {\n    this.mask = 0;\n    for (let i = 0; i < this.settings['maskLen'].value; i++) {\n      this.mask |= 1 << i;\n    }\n    this.mask <<= this.settings['bitStart'].value;\n  }\n}\nContainer.registerNodeType('conversion/bit-mask-multiple', BitMaskMultiple);\n","import { Container } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\n\nclass IntToBits extends Node {\n  constructor() {\n    super();\n    this.title = 'Bit Split';\n    this.description =\n      'A node to split an Int (or Int array) into all individual bits\\nAssuming all Ints are 8 bits (UINT8)';\n\n    this.settings['start'] = {\n      description: 'Start index if Array',\n      type: SettingType.NUMBER,\n      value: 0,\n    };\n\n    this.settings['bytes'] = {\n      description: 'Bytes to read if Array',\n      type: SettingType.NUMBER,\n      value: 1,\n    };\n\n    this.addInput('input', Type.ANY);\n  }\n\n  init() {\n    this.setNewOutputs();\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let input = this.getInputData(0);\n    if (input === undefined || input === null) {\n      return;\n    }\n\n    if (typeof input === 'number') {\n      input = [input];\n    }\n\n    const START = this.settings['start'].value;\n    const BYTES = this.settings['bytes'].value;\n\n    if (!input || !input.length || input.length < BYTES) {\n      return;\n    }\n\n    let outputIndex = 0;\n    for (let i = 0; i < BYTES; i++) {\n      for (let j = 0; j < 8; j++) {\n        this.setOutputData(outputIndex++, (input[START + i] >> j) & 0x01);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.setNewOutputs();\n    this.onInputUpdated();\n  }\n\n  private setNewOutputs() {\n    let outputsLen = this.getOutputsCount();\n    for (let i = 0; i < outputsLen; i++) {\n      this.removeOutput(i);\n    }\n    outputsLen = this.settings['bytes'].value * 8;\n    for (let i = 0; i < outputsLen; i++) {\n      this.addOutput(i.toString(), Type.NUMBER);\n    }\n    this.updateNodeOutput();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('conversion/int-to-bits', IntToBits);\n","import { Container } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport ModbusByteOrder from '../protocols/modbus/modbus-fc/modbus-point-byte-order';\n\nclass ByteArrayToIntNode extends Node {\n  value = null;\n  constructor() {\n    super();\n    this.title = 'Byte Array To Int';\n    this.description =\n      'A node to convert an 4 and 8 (long) byte array to an int with Big-endian And Little-endian format. Example [0,0,0,5,11,88,37,12] = 190326028';\n    this.addInput('in 1', Type.ANY);\n    this.addOutput('out', Type.JSON);\n    this.addOutput('out buffer', Type.JSON);\n    this.settings['dataType'] = {\n      description: 'Set data type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'na' }, // use reg length from setting\n          { value: 1, text: 'INT-16' }, // 1 reg\n          { value: 2, text: `UINT-16` }, // 1 reg\n          { value: 3, text: 'INT-32' }, // 2 reg\n          { value: 4, text: 'UINT-32' }, // 2 reg\n          { value: 5, text: 'FLOAT-32' }, // 2 reg\n          { value: 8, text: 'DOUBLE-64' }, // 4 reg\n        ],\n      },\n      value: 0,\n    };\n    this.settings['dataEndian'] = {\n      description: 'Set byte order',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'LE-Byte BE-Word' },\n          { value: 1, text: 'LE-Byte LE-Word' },\n          { value: 2, text: 'BE-Byte LE-Word' },\n          { value: 3, text: 'BE-Byte BE-Word' },\n        ],\n      },\n      value: 0,\n    };\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    try {\n      const buffer = Buffer.from(input);\n      const dataEndian = this.settings['dataEndian'].value;\n      const dataType = this.settings['dataType'].value;\n      const out = ModbusByteOrder.readByteOrder(buffer, 0, dataType, dataEndian);\n      this.setOutputData(0, JSON.stringify(out));\n      this.setOutputData(1, JSON.stringify(buffer));\n    } catch (error) {}\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('conversion/buffer-array-to-int', ByteArrayToIntNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport * as convert from 'convert-units';\nimport { get } from 'lodash';\n\nclass UnitConversionNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Unit converter';\n    this.description = 'This node converts units.';\n\n    this.addInput('in');\n    this.addOutput('converted');\n\n    this.settings['from-to'] = {\n      description: 'From / To unit',\n      type: SettingType.TREE_SELECT,\n      config: { items: [] },\n    };\n    this.ensureFromToConfig();\n  }\n\n  onAdded() {\n    this.updateTitle();\n    this.ensureFromToConfig();\n  }\n\n  // the from-to config is excluded from JSON serialization, we need to maintain it conditionally\n  ensureFromToConfig() {\n    // settings['from-to'].config is omitted from serialization / deserialization\n    if (!get(this, \"settings['from-to'].config.items.length\", 0))\n      this.settings['from-to'].config = { items: this.createTreeSelectItems() };\n    // ensure config exclusion from JSON serialization\n    this.settings['from-to'].toJSON = function() {\n      const { config = null, ...withoutConfig } = { ...this };\n      return withoutConfig;\n    };\n  }\n\n  createTreeSelectItems() {\n    const asItem = unit => ({ value: unit, text: unit });\n    // higher-order function:\n    const addAsChildren = (categoryName: string, units: { value: any; text: any }[]) => from => ({\n      ...from,\n      items: units.map(to => ({\n        ...to,\n        value: { type: categoryName, from: from.value, to: to.value },\n      })),\n    });\n    return convert()\n      .measures()\n      .map(unitType => ({\n        text: unitType,\n        items: convert()\n          .possibilities(unitType)\n          .map(asItem),\n      }))\n      .map(category => ({\n        ...category,\n        items: category.items.map(addAsChildren(category.text, category.items)),\n      }));\n  }\n\n  onInputUpdated() {\n    if (!this.settings['from-to'].value) return;\n    const { from, to } = this.settings['from-to'].value;\n    const value = parseFloat(this.inputs[0].data);\n    this.setOutputData(\n      0,\n      convert(value)\n        .from(from)\n        .to(to),\n    );\n  }\n\n  onAfterSettingsChange() {\n    this.ensureFromToConfig();\n    this.onInputUpdated();\n    this.updateTitle();\n  }\n\n  updateTitle() {\n    if (!this.settings['from-to'].value) return;\n    const { from, to } = this.settings['from-to'].value;\n    this.title = 'Unit converter' + ' ' + '(' + from + '/' + to + ')';\n  }\n}\nContainer.registerNodeType('conversion/convert-units', UnitConversionNode);\n","module.exports = require(\"convert-units\");","import { Container } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport ModbusByteOrder from '../protocols/modbus/modbus-fc/modbus-point-byte-order';\n\nclass IntToFourByteArrayNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Int to Buffer';\n    this.description =\n      'A node to convert an int to a buffer array to an int with Big-endian And Little-endian format. This node is used for testing data types';\n    this.addInput('in 1', Type.ANY);\n    this.addOutput('out', Type.JSON);\n    this.addOutput('out data', Type.JSON);\n    this.settings['dataType'] = {\n      description: 'Set data type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'na' }, // use reg length from setting\n          { value: 1, text: 'INT-16' }, // 1 reg\n          { value: 2, text: `UINT-16` }, // 1 reg\n          { value: 3, text: 'INT-32' }, // 2 reg\n          { value: 4, text: 'UINT-32' }, // 2 reg\n          { value: 5, text: 'FLOAT-32' }, // 2 reg\n          { value: 8, text: 'DOUBLE-64' }, // 4 reg\n        ],\n      },\n      value: 0,\n    };\n    this.settings['dataEndian'] = {\n      description: 'Set byte order',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'LE-Byte BE-Word' },\n          { value: 1, text: 'LE-Byte LE-Word' },\n          { value: 2, text: 'BE-Byte LE-Word' },\n          { value: 3, text: 'BE-Byte BE-Word' },\n        ],\n      },\n      value: 0,\n    };\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    const dataEndian = this.settings['dataEndian'].value;\n    const dataType = this.settings['dataType'].value;\n    const out = ModbusByteOrder.writeValue(input, dataType, dataEndian);\n    this.setOutputData(0, JSON.stringify(out));\n    this.setOutputData(1, JSON.parse(JSON.stringify(out)).data);\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('conversion/int-to-buffer', IntToFourByteArrayNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { isNull } from '../../../utils/helper';\nimport { Type } from '../../node-io';\n\nclass EventCounterNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Any Event Counter';\n    this.description =\n      \"count' increases by 1 every time an event occurs at 'input'. Any incoming value, including null, will be taken. 'count' will be reset to 0 when 'reset' transitions from 'false' to 'true.  toggle will alternate between true and false, changing each time count increases. \";\n    this.addInput('input');\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('count', Type.NUMBER);\n    this.addOutput('toggle', Type.NUMBER);\n    this.setOutputData(0, 0);\n    this.setOutputData(1, false);\n    this.settings['null'] = {\n      description: 'Stop count if input is null',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.properties['count'] = 0;\n  }\n\n  onAdded(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const inputUpdated = this.inputs[0].updated;\n    const inputData = this.inputs[0].data;\n    const reset = this.inputs[1].data\n    if (reset && reset == true) this.properties['count'] = 0; //reset count\n    if (this.settings['null'].value && this.isNull(inputData)) return\n     if (inputUpdated) {\n        this.properties['count']++;\n        this.setOutputData(1, !this.outputs[1].data); // toggle\n      }\n    if (this.properties['count'] !== inputData) {\n      this.setOutputData(0, this.properties['count']);\n      this.persistProperties(false, true);\n    }\n  }\n\n  isNull(message: any) {\n    return isNull(message)\n  }\n}\nContainer.registerNodeType('count/any-event-counter', EventCounterNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass CounterNode extends Node {\n  lastUp:boolean;\n  lastDown:boolean;\n  lastReset:boolean;\n\n\n  constructor() {\n    super();\n\n    this.title = 'Counter';\n    this.description =\n      \"'count' increases by 1 every time 'countUp' transitions from 'false' to 'true.  'count' decreases by 1 every time 'countDown' transitions from 'false' to 'true.  'count' will be set to 'set value' when 'reset' transitions from 'false' to 'true.\";\n\n    this.addInputWithSettings('set value', Type.NUMBER, 0, 'Set Value');\n    this.addInput('count up', Type.BOOLEAN);\n    this.addInput('count down', Type.BOOLEAN);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('count', Type.NUMBER);\n    this.properties['pointVal'] = 0;\n  }\n\n  onCreated() {\n    this.setOutputData(1, false);\n    this.setOutputData(2, false);\n    this.lastUp = false;\n    this.lastDown = false;\n    this.lastReset = false;\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const old = this.outputs[0].data;\n    const up = this.getInputData(1) || false;\n    const down = this.getInputData(2) || false;\n    const reset = this.getInputData(3) || false;\n\n    if (this.inputs[1].updated && up && !this.lastUp) this.properties['pointVal']++;\n    this.lastUp = up;\n\n    if (this.inputs[2].updated && down && !this.lastDown) this.properties['pointVal']--;\n    this.lastDown = down;\n\n    const setValue = this.getInputData(0);\n\n    if (this.inputs[3].updated && reset && !this.lastReset) this.properties['pointVal'] = setValue;\n    this.lastReset = reset;\n\n    if (this.properties['pointVal'] !== old) {\n      this.setOutputData(0, this.properties['pointVal']);\n      this.properties['pointVal'] = this.properties['pointVal'];\n      this.persistProperties(false, true);\n    }\n\n    this.setOutputData(0, this.outputs[0].data);\n  }\n}\nContainer.registerNodeType('count/counter', CounterNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass TriggeredRamp extends Node {\n  countUp: boolean;\n  lastTrigger: boolean;\n  lastReset: boolean;\n  currentVal: number;\n\n  constructor() {\n    super();\n    this.title = 'Triggered Ramp';\n    this.description =\n      \"'output' changes on every time 'trigger' transitions from 'false' to 'true'. If 'count on true->false?' setting is enabled, 'output' will also change on 'false' to 'true' transition.   'output' will change by the 'step' value on each change (if a full 'step' would cause the output to be greater than 'max', or less than 'min' it will be limited by 'max' or 'min' respectively).  'output' will first ramp up to 'max' then it will change directions and ramp down to 'min'.  'output' will be reset to 'min' when 'reset' transitions from 'false' to 'true. \";\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInputWithSettings('min', Type.NUMBER, 0, 'min', false);\n    this.addInputWithSettings('max', Type.NUMBER, 10, 'max', false);\n    this.addInputWithSettings('step', Type.NUMBER, 1, 'Step Size', false);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n    this.settings['countOnFalse'] = {\n      description: 'Also count on true->false?',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.countUp = false;\n    this.lastTrigger = false;\n    this.lastReset = false;\n    this.currentVal = 0;\n    this.settings['rampUpOnly'] = {\n      description: 'Ramp Up Only',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const min = this.getInputData(1);\n    const max = this.getInputData(2);\n\n    this.currentVal = Number(this.currentVal);\n    if (this.currentVal < min) this.currentVal = min;\n    else if (this.currentVal > max) this.currentVal = max;\n\n    const reset = this.getInputData(4);\n    if (reset && !this.lastReset) this.currentVal = min;\n    this.lastReset = reset;\n\n    const trigger = this.getInputData(0);\n    if (trigger != this.lastTrigger) {\n      if (this.settings['countOnFalse'].value || trigger) {\n        const step = this.getInputData(3);\n        if (this.countUp && this.currentVal + step > max) {\n          if (this.settings['rampUpOnly'].value) {\n            this.countUp = true;\n            this.currentVal = min - step;\n          } else this.countUp = false;\n        } else if (!this.countUp && this.currentVal - step < min) this.countUp = true;\n        if (this.countUp) this.currentVal += step;\n        else this.currentVal -= step;\n      }\n      this.lastTrigger = trigger;\n    }\n\n    this.setOutputData(0, this.currentVal, true); //out\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('count/triggered-ramp', TriggeredRamp);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass IntervalRampNode extends Node {\n  countUp: boolean;\n  lastInterval: number;\n  lastReset: boolean;\n  lastEnable: boolean;\n  currentVal: number;\n  timeoutFunc;\n\n  constructor() {\n    super();\n    this.title = 'Interval Ramp';\n    this.description =\n      \"output' changes at every 'interval' period, while 'enable' is set to 'true'. 'output' will change by the 'step' value on each change (if a full 'step' would cause the output to be greater than 'max', or less than 'min' it will be limited by 'max' or 'min' respectively). 'output' will first ramp up to 'max' then it will change directions and ramp down to 'min'. 'output' will be reset to 'min' when 'reset' transitions from 'false' to 'true. If Ramp Up Only setting is ticked, the ramp down stage will be bypassed and output will be reset back to min value when it reaches the max value. 'interval units can be configured from settings.  Maximum interval setting is 587 hours.\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, 0, 'Enable', false);\n    this.addInputWithSettings('min', Type.NUMBER, 0, 'min', false);\n    this.addInputWithSettings('max', Type.NUMBER, 10, 'max', false);\n    this.addInputWithSettings('step', Type.NUMBER, 1, 'Step Size', false);\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Count Interval', false);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('out', Type.NUMBER);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n\n    this.settings['rampUpOnly'] = {\n      description: 'Ramp Up Only',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n\n    this.countUp = true;\n    this.lastInterval = 1000;\n    this.lastReset = false;\n    this.lastEnable = true;\n    this.currentVal = 0;\n  }\n\n  onAdded() {\n    this.timeoutFunc = setInterval(() => {\n      const min = this.getInputData(1);\n      const max = this.getInputData(2);\n      this.count(min, max);\n      this.setOutputData(0, this.currentVal, true);\n    }, this.lastInterval);\n    this.inputs[4]['name'] = `[interval] (${this.settings['time'].value})`;\n  }\n\n  onInputUpdated() {\n    const min = this.getInputData(1);\n    const max = this.getInputData(2);\n\n    this.currentVal = Number(this.currentVal);\n    if (this.currentVal < min) this.currentVal = min;\n    else if (this.currentVal > max) this.currentVal = max;\n\n    const reset = Boolean(this.getInputData(5));\n    if (reset && !this.lastReset) this.currentVal = min;\n    this.countUp = true;\n    this.lastReset = reset;\n\n    let interval = this.getInputData(4);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    const enable = this.getInputData(0);\n    if (enable && !this.lastEnable) {\n      this.timeoutFunc = setInterval(() => {\n        this.count(min, max);\n        this.setOutputData(0, this.currentVal, true);\n      }, interval);\n    } else if (!enable && this.lastEnable) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, null);\n    } else if (enable && this.lastEnable && interval !== this.lastInterval) {\n      clearInterval(this.timeoutFunc);\n      this.timeoutFunc = setInterval(() => {\n        this.count(min, max);\n        this.setOutputData(0, this.currentVal, true);\n      }, interval);\n    }\n    this.lastInterval = interval;\n    this.lastEnable = enable;\n  }\n\n  count(min, max) {\n    const step = this.getInputData(3);\n    if (this.countUp && this.currentVal + step > max) {\n      if (this.settings['rampUpOnly'].value) {\n        this.countUp = true;\n        this.currentVal = min - step;\n      } else this.countUp = false;\n    } else if (!this.countUp && this.currentVal - step < min) this.countUp = true;\n    if (this.countUp) this.currentVal += step;\n    else this.currentVal -= step;\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[4]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('count/interval-ramp', IntervalRampNode);\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 07.03.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass WaveformNode extends Node {\n  lastTime: number;\n  startTime: number;\n  lastReset: boolean;\n  constructor() {\n    super();\n    this.title = 'Waveform';\n    this.description =\n      \"This node generates a sequence of numbers based on the selected settings; these sequences (waveforms) are of the form 'Ramp', 'Sine', 'Square', 'Triangle', and 'Sawtooth'. While 'enable' is 'true', 'output' will produce the next number in the sequence after every 'interval' duration. The period (how often the waveform pattern repeats) is defined by 'period'. The amplitude of the waveform is defined by 'amplitude'. The waveform can be inverted by setting 'Invert Output' to 'true' in settings. The waveform will reset to its starting position if 'reset' transitions from 'false' to 'true'.  'interval' and period units can be configured from settings.  Maximum 'interval' and period setting is 587 hours.\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, 0, 'min', false);\n    this.settings['signalType'] = {\n      description: 'Signal Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'Ramp', text: 'Ramp' },\n          { value: 'Sine', text: 'Sine' },\n          { value: 'Square', text: 'Square' },\n          { value: 'Triangle', text: 'Triangle' },\n          { value: 'Sawtooth', text: 'Sawtooth' },\n        ],\n      },\n      value: 'Ramp',\n    };\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Interval', false);\n    this.addInputWithSettings('period', Type.NUMBER, 10, 'Period', false);\n    this.addInputWithSettings('amplitude', Type.NUMBER, 1, 'Amplitude', false);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.settings['intervalTime'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.settings['periodTime'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [\n        { interval: { weight: 2 }, intervalTime: {} },\n        { period: { weight: 2 }, periodTime: {} },\n        { amplitude: {} },\n      ],\n    });\n    this.settings['enable'] = { description: 'Enable', value: true, type: SettingType.BOOLEAN };\n    this.settings['invert'] = {\n      description: 'Invert Output',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.lastReset = false;\n    this.startTime = Date.now();\n  }\n\n  onAdded() {\n    this.updateTitle();\n    this.inputs[1]['name'] = `[interval] (${this.settings['intervalTime'].value})`;\n    this.inputs[2]['name'] = `[period] (${this.settings['periodTime'].value})`;\n    this.onInputUpdated();\n  }\n\n  onExecute() {\n    if (!this.getInputData(0)) return;\n    let interval = this.getInputData(1);\n    interval = TimeUtils.timeConvert(interval, this.settings['intervalTime'].value);\n    const now = Date.now();\n    if (!this.lastTime) {\n      this.lastTime = now;\n    }\n    if (now - this.lastTime >= interval) {\n      this.recalculate();\n    }\n  }\n  onInputUpdated() {\n    const reset = this.getInputData(4);\n    if (reset && !this.lastReset) {\n      this.setOutputData(0, 0, false);\n      this.startTime = Date.now();\n    }\n    this.lastReset = reset;\n\n    if (!this.getInputData(0)) {\n      return;\n    }\n    this.recalculate();\n  }\n\n  recalculate() {\n    const now = Date.now();\n    const signalType = this.settings['signalType'].value || 'Ramp';\n    let period = this.getInputData(2);\n    period = TimeUtils.timeConvert(period, this.settings['periodTime'].value) / 1000;\n    const amplitude = this.getInputData(3);\n    const invert = this.settings['invert'].value ? -1 : 1;\n    let time = (now - this.startTime) / 1000;\n    let t = (time % period) / period;\n    let value = 0;\n    switch (signalType) {\n      case 'Sine':\n        value = Math.sin(2 * Math.PI * t);\n        break;\n      case 'Square':\n        value = Math.sign(Math.sin(2 * Math.PI * t));\n        if (value === -1) {\n          value = 0;\n        }\n        break;\n      case 'Triangle':\n        value = 1 - 4 * Math.abs(Math.round(t - 0.25) - (t - 0.25));\n        break;\n      case 'Sawtooth':\n        value = t;\n        break;\n      case 'Ramp':\n        value = 2 * Math.abs(Math.round(t) - t);\n        break;\n    }\n    value = invert * amplitude * value;\n    this.lastTime = now;\n    this.setOutputData(0, value);\n  }\n\n  onAfterSettingsChange() {\n    this.updateTitle();\n    this.inputs[1]['name'] = `[interval] (${this.settings['intervalTime'].value})`;\n    this.inputs[2]['name'] = `[period] (${this.settings['periodTime'].value})`;\n  }\n\n  updateTitle() {\n    if (!this.settings['signalType'].value) return;\n    const signalType = this.settings['signalType'].value;\n    this.title = 'Waveform' + ' ' + '(' + signalType + ')';\n  }\n}\nContainer.registerNodeType('count/waveform', WaveformNode);\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nlet moment = require('moment-timezone');\n\n//https://github.com/travishorn/csval\n//https://github.com/C2FO/fast-csv\n\nclass CSVMergeRowsNode extends Node {\n  obj = [];\n  constructor() {\n    super();\n    this.title = 'CSV Merge Rows';\n    this.description =\n      'This node merges the rows of properly formatted CSV strings.  merge CSV string will be joined with the original CSV string.  The merge CSV rows will be added below the original CSV rows.  Only the original header titles will be kept.  No error checking.';\n    this.addInput('original', Type.STRING);\n    this.addInput('merge', Type.STRING);\n    this.addOutput('output', Type.STRING);\n  }\n\n  onAdded() {\n    this.setOutputData(0, '');\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return; // only execute on server\n    if (!this.getInputData(0) || !this.getInputData(1)) return;\n    let outputCSV = this.getInputData(0).slice(0, this.getInputData(0).length - 1);\n    let addCSV = this.getInputData(1);\n    addCSV = addCSV.slice(addCSV.indexOf('\\n'), addCSV.length - 1);\n    outputCSV += addCSV;\n\n    this.setOutputData(0, outputCSV);\n  }\n}\nContainer.registerNodeType('csv/csv-merge-rows', CSVMergeRowsNode);\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nlet moment = require('moment-timezone');\n\n//https://github.com/travishorn/csval\n//https://github.com/C2FO/fast-csv\n\nclass CSVMergeColumnsNode extends Node {\n  obj = [];\n  constructor() {\n    super();\n    this.title = 'CSV Merge Columns';\n    this.description =\n      'This node merges the columns of properly formatted CSV strings.  merge CSV string will be joined with the original CSV string.  The merge CSV columns will be added to the right of the original CSV columns.  null will be added to rows where no value exists for that column.  No error checking.';\n    this.addInput('original', Type.STRING);\n    this.addInput('merge', Type.STRING);\n    this.addOutput('output', Type.STRING);\n  }\n\n  onAdded() {\n    this.setOutputData(0, '');\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return; // only execute on server\n    if (!this.getInputData(0) || !this.getInputData(1)) return;\n\n    let originalColumnsArray = this.getInputData(0).split('\\n');\n    let mergeColumnsArray = this.getInputData(1).split('\\n');\n    let outputCSV = '';\n    const originalColumnsCount = originalColumnsArray[0].split(',').length;\n    const mergeColumnsCount = mergeColumnsArray[0].split(',').length;\n\n    var i = 0;\n    for (i = 0; i < Math.min(mergeColumnsArray.length, originalColumnsArray.length) - 1; i++) {\n      outputCSV += originalColumnsArray[i] + ', ' + mergeColumnsArray[i] + '\\n';\n    }\n    //if(i < originalColumnsArray.length){\n    var x = 0;\n    while (i < originalColumnsArray.length - 1) {\n      outputCSV += originalColumnsArray[i];\n      x = originalColumnsCount;\n      while (x < originalColumnsCount + mergeColumnsCount) {\n        outputCSV += ', ';\n        x++;\n      }\n      outputCSV += '\\n';\n      i++;\n    }\n    while (i < mergeColumnsArray.length - 1) {\n      x = mergeColumnsCount;\n      while (x < originalColumnsCount + mergeColumnsCount) {\n        outputCSV += ', ';\n        x++;\n      }\n      outputCSV += mergeColumnsArray[i];\n      outputCSV += '\\n';\n      i++;\n    }\n    this.setOutputData(0, outputCSV);\n  }\n}\nContainer.registerNodeType('csv/csv-merge-columns', CSVMergeColumnsNode);\n","import { Container } from '../../container';\nimport { BaseFunctionNode } from './base-function-node';\n\nexport class FunctionNode extends BaseFunctionNode {\n\n  constructor() {\n    super('Function',\n          'Evaluates a code block upon message reception. ' +\n          'The incoming value is accessible through the variable named \"message\". ' +\n          'The \"return\" value will be emitted through the outlet. Null values are ignored.');\n    this.mixinScriptSetting('// message is the received value\\nreturn message;');\n  }\n\n  protected getScriptInput() {\n    return this.getInputData(0);\n  }\n}\n\nContainer.registerNodeType('custom-function/function', FunctionNode);\n","import { NodeVM } from 'vm2';\nimport { isEmpty } from '../../../utils/helper';\nimport { Side } from '../../container';\nimport { Node, SettingType } from '../../node';\n\nexport abstract class BaseFunctionNode extends Node {\n\n  protected constructor(title: string, description: string) {\n    super();\n    this.title = title;\n    this.description = description;\n\n    this.addInput('message');\n    this.addOutput('output');\n    this.addOutput('error');\n  }\n\n  onCreated() {\n  }\n\n  onAdded() {\n  }\n\n  onInputUpdated() {\n    try {\n      this.executeConfiguredScript(this.getScriptInput())\n          .then(result => this.emitResult(result))\n          .catch(e => this.emitError(e));\n    } catch (e) {\n      this.emitError(e);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n\n  protected abstract getScriptInput();\n\n  protected executeConfiguredScript(...variables): Promise<any> {\n    const code = this.settings['script'].value;\n    if (this.side !== Side.server || isEmpty(code)) return;\n    const vm = new NodeVM({ timeout: 1000, sandbox: {} });\n    let func = vm.run(`module.exports = function(message, ...args) {\\n${code}\\n};`);\n    return Promise.resolve(func(...variables));\n  }\n\n  protected emitResult(result: any) {\n    this.setOutputData(0, result);\n    this.setOutputData(1, null); // reset error\n  }\n\n  protected emitError(error: Error) {\n    this.setOutputData(0, null); // reset result\n    this.debugErr(`Error when executing function node ${error.stack}`);\n    this.setOutputData(1, error);\n  }\n\n  protected mixinScriptSetting(defaultScript: string) {\n    this.settings['script'] = { description: 'Function Code', value: defaultScript, type: SettingType.CODE_AREA };\n  }\n}\n","module.exports = require(\"vm2\");","/**\n * Created by Derwish (derwish.pro@gmail.com) on 25.02.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { UiNode } from './ui-node';\nimport { Container } from '../../container';\nimport Utils from '../../utils';\n\nexport class UiLabelNode extends UiNode {\n  constructor(container?: Container, id?: number, properties?: any) {\n    super('Label', 'UiLabelNode', properties);\n    this.description = 'Dashboard node which displays inputed values on the dashboard.';\n    this.title = 'Label';\n    this.addInput('input');\n    this.UPDATE_INPUTS_INTERVAL = 100;\n  }\n\n  onInputUpdated() {\n    const state = Utils.formatValue(this.getInputData(0));\n    this.setState(state);\n    this.isRecentlyActive = true;\n  }\n}\n\nContainer.registerNodeType('dashboard/label', UiLabelNode);\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 26.02.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport { UiNode } from './ui-node';\nimport { SettingType} from '../../node';\n\nexport class UiButtonNode extends UiNode {\n  interval = null;\n\n  constructor(container?: Container, id?: number, properties?: any) {\n    super('Button', 'UiButtonNode', properties);\n    this.description =\n      \"Dashboard node which displays a push button on the dashboard.  When clicked it will send 'true' from the node 'output'.\";\n    this.title = 'Button';\n    this.addOutput('output', Type.BOOLEAN);\n    this.settings['button-text'] = {\n      description: 'Button Text',\n      value: 'ON',\n      type: SettingType.STRING,\n    };\n    this.setState({ buttonText: 'ON' });\n  }\n\n  onAfterSettingsChange() {\n    if (this.side !== Side.server) return;\n  }\n\n  onRemoved() {\n    super.onRemoved();\n  }\n\n  onGetMessageToServerSide() {\n    this.setOutputData(0, true);\n    this.sendIOValuesToEditor();\n  }\n}\n\nContainer.registerNodeType('dashboard/button', UiButtonNode);\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 02.03.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport { UiNode } from './ui-node';\n\nexport class UiSwitchNode extends UiNode {\n  constructor(container?: Container, id?: number, properties?: any) {\n    super('Switch', 'UiSwitchNode', properties);\n\n    this.description =\n      \"Dashboard node which displays a toggle switchon the dashboard.  When clicked it will switch the node 'output' between 'true' and 'false'.  The button text can be edited in settings.  The button can be overridden by wiring a Boolean into the node 'input'. \";\n    this.title = 'Switch';\n    this.setState(false);\n\n    this.addInput('input', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n  }\n\n  onAdded() {\n    super.onAdded();\n    if (this.side == Side.server) this.setOutputData(0, this.getState());\n  }\n\n  onGetMessageToServerSide(data) {\n    this.setValue(data.state);\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    this.setValue(val);\n  }\n\n  setValue(val) {\n    this.setOutputData(0, val);\n    this.sendIOValuesToEditor();\n    this.isRecentlyActive = true;\n\n    if (this.getState() != val)\n      //prevent loop sending\n      this.setState(val);\n  }\n}\n\nContainer.registerNodeType('dashboard/switch', UiSwitchNode);\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 02.03.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Type } from '../../node-io';\nimport { UiNode } from './ui-node';\nimport { Container } from '../../container';\n\nexport class UiProgressNode extends UiNode {\n  constructor(container?: Container, id?: number, properties?: any) {\n    super('Progress', 'UiProgressNode', properties);\n    this.description =\n      \"Dashboard node which displays 'input' value from 0-100 on a progress bar on the dashboard.\";\n    this.title = 'Progress';\n    this.addInput('input', Type.NUMBER);\n    this.UPDATE_INPUTS_INTERVAL = 100;\n    this.setState(0);\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n\n    if (val > 100) val = 100;\n    if (val < 0) val = 0;\n\n    this.setState(val);\n    this.isRecentlyActive = true;\n  }\n}\n\nContainer.registerNodeType('dashboard/progress', UiProgressNode);\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 02.03.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Type } from '../../node-io';\nimport { UiNode } from './ui-node';\nimport { Container, Side } from '../../container';\n\nexport class UiSliderNode extends UiNode {\n  constructor(container?: Container, id?: number, properties?: any) {\n    super('Slider', 'UiSliderNode', properties);\n\n    this.description =\n      \"Dashboard node which displays an input slider bar on the dashboard.  The user can move the slider bar knob to adjust the output between 0 and 100.  The slider can be overridden by wiring a Numeric into the node 'input'. \";\n    this.title = 'Slider';\n    this.addInput('input', Type.NUMBER);\n    this.addOutput('output', Type.NUMBER);\n    this.UPDATE_INPUTS_INTERVAL = 100;\n    this.setState(0);\n  }\n\n  onAdded() {\n    super.onAdded();\n    if (this.side == Side.server) this.setOutputData(0, this.getState());\n  }\n\n  onGetMessageToServerSide(data) {\n    this.setValue(data.state);\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    this.setValue(val);\n  }\n\n  setValue(val) {\n    if (val > 100) val = 100;\n    if (val < 0) val = 0;\n\n    this.setOutputData(0, val);\n    this.sendIOValuesToEditor();\n    this.isRecentlyActive = true;\n\n    if (this.getState() != val)\n      //prevent loop sending\n      this.setState(val);\n  }\n}\n\nContainer.registerNodeType('dashboard/slider', UiSliderNode);\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 02.03.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport { UiNode } from './ui-node';\n\nexport class UiTextBoxNode extends UiNode {\n  constructor(container?: Container, id?: number, properties?: any) {\n    super('TextBox', 'UiTextBoxNode', properties);\n\n    this.description =\n      \"Dashboard node which provides a user input text box on the dashboard.  The entered string is sent from the node 'output'.  The text-box can be overridden by wiring a String into the node 'input'. \";\n    this.title = 'Text-Box';\n    this.setState('');\n\n    this.addInput('input', Type.STRING);\n    this.addOutput('output', Type.STRING);\n  }\n\n  onAdded() {\n    super.onAdded();\n    if (this.side == Side.server) this.setOutputData(0, this.getState());\n  }\n\n  onGetMessageToServerSide(data) {\n    this.setValue(data.state);\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    this.setValue(val);\n  }\n\n  setValue(val) {\n    this.setOutputData(0, val);\n    this.sendIOValuesToEditor();\n    this.isRecentlyActive = true;\n\n    if (this.getState() != val)\n      //prevent loop sending\n      this.setState(val);\n  }\n}\n\nContainer.registerNodeType('dashboard/text-box', UiTextBoxNode);\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 02.03.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\nimport { Container, Side } from '../../container';\nimport { UiNode } from './ui-node';\nimport { SettingType } from '../../node';\n\nexport class UiLogNode extends UiNode {\n  messagesPerSec = 0;\n\n  constructor(container?: Container, id?: number, properties?: any) {\n    super('Log', 'UiLogNode', properties);\n\n    this.description =\n      \"Dashboard node which displays a log of the values wired into 'input', these log entries have timestamps attached.  There is an option in settings to save the log entries to the Wires Database (DB). \";\n    this.title = 'Log';\n    this.properties['log'] = [];\n    this.settings['maxRecords'] = {\n      description: 'Max Records',\n      value: 10,\n      type: SettingType.NUMBER,\n    };\n    this.settings['maxRecordsPerSec'] = {\n      description: 'Max records/sec limit',\n      value: 11,\n      type: SettingType.NUMBER,\n    };\n    this.settings['saveToDb'] = {\n      description: 'Save log to DB',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n\n    this.addInput('input');\n  }\n\n  onAdded() {\n    super.onAdded();\n    if (this.side == Side.server) this.updateMessPerSec();\n  }\n\n  onAfterSettingsChange(oldSettings) {\n    if (this.side == Side.server) {\n      if (oldSettings.maxRecords != this.settings.maxRecords) {\n        this.removeOldRecords();\n\n        this.sendMessageToDashboardSide({\n          maxRecords: this.settings['maxRecords'].value,\n        });\n      }\n    }\n  }\n\n  onDbReaded() {\n    // invert log\n    let log = [];\n    this.properties['log'].forEach(rec => log.unshift(rec));\n    this.properties['log'] = log;\n  }\n\n  removeOldRecords() {\n    let records = this.properties['log'] || [];\n    let max = this.settings['maxRecords'].value;\n    let del = records.length - max;\n    records.splice(records.length - del, del);\n  }\n\n  updateMessPerSec() {\n    setInterval(() => {\n      if (this.messagesPerSec > this.settings['maxRecordsPerSec'].value) {\n        let dropped = this.messagesPerSec - this.settings['maxRecordsPerSec'].value;\n        let record = { date: Date.now(), value: 'Dropped ' + dropped + ' records (rec/sec limit)' };\n        this.properties['log'].unshift(record);\n        this.sendMessageToDashboardSide({ record: record });\n      }\n\n      this.messagesPerSec = 0;\n    }, 1000);\n  }\n\n  onInputUpdated() {\n    if (!this.inputs[0].link) return;\n\n    let val = this.getInputData(0);\n    this.isRecentlyActive = true;\n\n    this.messagesPerSec++;\n    if (this.messagesPerSec <= this.settings['maxRecordsPerSec'].value) {\n      let record = { date: Date.now(), value: val };\n      if (this.properties['log']) this.properties['log'].unshift(record);\n\n      this.removeOldRecords();\n\n      this.sendMessageToDashboardSide({ record: record });\n\n      // update in db\n      let max = this.settings['maxRecords'].value;\n      if (this.container.db && this.settings['saveToDb'].value) {\n        this.container.db.updateNode(this.id, this.container.id, {\n          $push: { 'properties.log': { $each: [record], $slice: -max } },\n        });\n      }\n    }\n  }\n\n  onGetMessageToServerSide(message) {\n    if (message == 'getLog') {\n      this.sendMessageToDashboardSide({\n        log: this.properties['log'],\n        maxRecords: this.settings['maxRecords'].value,\n      });\n    } else if (message == 'clearLog') {\n      // clear log\n      this.isRecentlyActive = true;\n      this.properties['log'] = [];\n\n      this.sendMessageToDashboardSide({ log: [] });\n\n      // update in db\n      if (this.container.db) {\n        this.container.db.updateNode(this.id, this.container.id, {\n          $unset: { 'properties.log': true },\n        });\n      }\n    }\n  }\n}\n\nContainer.registerNodeType('dashboard/log', UiLogNode);\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 03.03.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { UiNode } from './ui-node';\n\n// declare let vis;\n// declare let moment;\n// declare let DataSet;\n\nexport class UiChartNode extends UiNode {\n  dataset;\n\n  constructor(container?: Container, id?: number, properties?: any) {\n    super('Chart', 'UiChartNode', properties);\n\n    this.UPDATE_INPUTS_INTERVAL = 100;\n    this.title = 'Button';\n    this.description =\n      \"Dashboard node which displays a chart of the values wired into 'input'.  Chart properties and types can be modified in settings.  There is an option in settings to save the chart entries to the Wires Database (DB). \";\n    this.properties['log'] = [];\n    this.settings['maxRecords'] = {\n      description: 'Max Records',\n      value: 100,\n      type: SettingType.NUMBER,\n    };\n    this.settings['saveToDb'] = {\n      description: 'Save data to DB',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['style'] = { description: 'Style', value: 'bars', type: SettingType.STRING };\n    this.settings['autoscroll'] = {\n      description: 'Auto scroll',\n      value: 'continuous',\n      type: SettingType.STRING,\n    };\n\n    this.addInput('input');\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n\n    // this.sendIOValuesToEditor();\n    // this.isRecentlyActive = true;\n\n    //add to log\n    let records = this.properties['log'];\n    let record = { x: Date.now(), y: val };\n    records.push(record);\n\n    let max = this.settings['maxRecords'].value;\n    records.splice(0, records.length - max);\n\n    //send to dashboard\n    this.sendMessageToDashboardSide({ record: record });\n\n    //update in db\n    if (this.container.db && this.settings['saveToDb'].value) {\n      this.container.db.updateNode(this.id, this.container.id, {\n        $push: { 'properties.log': { $each: [record], $slice: -max } },\n      });\n    }\n  }\n\n  onGetMessageToServerSide(data) {\n    if (data == 'clear') {\n      this.isRecentlyActive = true;\n      this.properties['log'] = [];\n      this.sendMessageToDashboardSide({ log: [] });\n\n      //update in db\n      if (this.container.db && this.settings['saveToDb'].value) {\n        this.container.db.updateNode(this.id, this.container.id, {\n          $unset: { 'properties.log': true },\n        });\n      }\n    }\n\n    if (data.style) {\n      this.settings['style'].value = data.style;\n      this.sendMessageToDashboardSide({ style: data.style });\n    }\n\n    if (data == 'getLog') {\n      this.sendMessageToDashboardSide({\n        log: this.properties['log'],\n        maxRecords: this.settings['maxRecords'].value,\n      });\n    }\n  }\n\n  // createChart() {\n  //     let that = this;\n\n  //     $('#chart-clear-' + this.id).click(function () {\n  //         that.sendMessageToServerSide({ clear: true });\n  //     });\n\n  //     $('#chart-now-' + this.id).click(function () {\n  //         that.showNow();\n  //     });\n\n  //     $('#chart-all-' + this.id).click(function () {\n  //         that.showAll();\n  //     });\n\n  //     $('#chart-style-' + this.id).click(function () {\n  //         that.changeStyle();\n  //         that.sendMessageToServerSide({ style: that.settings['style'].value });\n  //     });\n\n  //     this.body = document.getElementById('chart-body-' + this.id);\n\n  //     this.options = {\n  //         height: this.CHART_HEIGHT,\n  //         style: 'bar',\n  //         drawPoints: false,\n  //         barChart: { width: 50, align: 'right', sideBySide: false }\n  //     };\n\n  //     this.dataset = new vis.DataSet();\n  //     this.graph2d = new (<any>vis).Graph2d(this.body, this.dataset, this.options);\n\n  //     this.updateChartStyle();\n\n  //     this.showNow();\n\n  //     if (this.properties['log'].length > 0) {\n  //         this.addChartData(this.properties['log']);\n  //     }\n\n  //     this.renderStep();\n\n  // }\n\n  // addChartData(data) {\n  //     this.dataset.add(data);\n\n  //     let max = this.settings['maxRecords'].value;\n  //     let unwanted = this.dataset.length - max;\n  //     if (unwanted > 0) {\n  //         let items = this.dataset.get();\n  //         for (let i = 0; i < unwanted; i++) {\n  //             this.dataset.remove(items[i]);\n  //         }\n  //     }\n  // }\n\n  // renderStep() {\n  //     // move the window (you can think of different strategies).\n  //     let now = vis.moment();\n  //     let range = this.graph2d.getWindow();\n  //     let interval = range.end - range.start;\n  //     let that = this;\n  //     switch (this.settings['autoscroll'].value) {\n  //         case 'continuous':\n  //             // continuously move the window\n  //             this.graph2d.setWindow(now - interval, now, { animation: false });\n  //             requestAnimationFrame(that.renderStep.bind(that));\n  //             break;\n\n  //         case 'discrete':\n  //             this.graph2d.setWindow(now - interval, now, { animation: false });\n  //             setTimeout(that.renderStep.bind(that), 1000);\n  //             break;\n\n  //         case 'none': // 'static'\n  //             // move the window 90% to the left when now is larger than the end of the window\n  //             // if (now > range.end) {\n  //             //     this.graph2d.setWindow(now - 0.1 * interval, now + 0.9 * interval);\n  //             // }\n  //             setTimeout(that.renderStep.bind(that), 1000);\n  //             break;\n  //     }\n  // }\n\n  //     //setOptions cause a bug when switching to dots!!!\n  //     this.graph2d.setOptions(this.options);\n  //     //thats why we need redraw:\n  //     //redrawChart(options);\n\n  // }\n\n  // redrawChart(options, ) {\n  //     let window = this.graph2d.getWindow();\n  //     options.start = window.start;\n  //     options.end = window.end;\n  //     this.graph2d.destroy();\n  //     this.graph2d = new (<any>vis).Graph2d(this.body, this.dataset, options);\n  // }\n\n  // onDashboardGetRequest(req, res) {\n  //     //render log page\n  //     if (req.params[0] == \"/log\") {\n  //         res.render('dashboard/nodes/chart/log', {\n  //             node: this,\n  //             records: this.properties['log'],\n  //             max_records: this.settings['maxRecords'].value\n  //         });\n  //     }\n\n  //     //render chart page\n  //     res.render('dashboard/nodes/chart/index', {\n  //         node: this,\n  //         range_start: req.query.start || Date.now() - 30000,\n  //         range_end: req.query.end || Date.now(),\n  //         autoscroll: req.query.autoscroll || this.settings['autoscroll'].value,\n  //         style: req.query.style || this.settings['style'].value,\n  //         max_records: this.settings['maxRecords'].value\n  //     });\n  // }\n\n  // onEditorApiGetRequest(req, res) {\n  //     //ajax get log\n  //     if (req.params[0] == \"/log\") {\n  //         res.json(this.properties['log']);\n  //     }\n  // }\n\n  // onEditorApiPostRequest(req, res) {\n  //     //ajax get log\n  //     if (req.params[0] == \"/style\") {\n  //         this.settings['style'].value = req.body.style;\n  //         this.sendMessageToDashboardSide({ style: req.body.style });\n  //         res.json(\"ok\");\n  //     }\n  //     if (req.params[0] == \"/clear\") {\n  //         this.isRecentlyActive = true;\n  //         this.properties['log'] = [];\n  //         this.sendMessageToDashboardSide({ clear: true });\n  //         res.json(\"ok\");\n  //     }\n  // }\n}\n\nContainer.registerNodeType('dashboard/chart', UiChartNode);\n","import { Node} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\n\nconst log = require('logplease').create('node', { color: 5 });\n\n// TODO: we don't need this all logic, background does this job\n// Show value inside the debug console\nexport class ConsoleNode extends Node {\n  MAX_MESS_PER_SEC = 11;\n  messagesPerSec = 0;\n  timer: any;\n\n  constructor() {\n    super();\n    this.title = 'Console';\n    this.description = 'Show value inside the console';\n    this.addInput('input', Type.ANY);\n  }\n\n  onAdded() {\n    if (this.side == Side.server) this.updateMessPerSec();\n  }\n\n  updateMessPerSec() {\n    let that = this;\n    this.timer = setInterval(function() {\n      if (that.messagesPerSec > that.MAX_MESS_PER_SEC) {\n        let dropped = that.messagesPerSec - that.MAX_MESS_PER_SEC;\n        log.info(\n          'CONSOLE NODE [' +\n            that.container.id +\n            '/' +\n            that.id +\n            ']: dropped ' +\n            dropped +\n            ' messages (data rate limitation)',\n        );\n        that.sendMessageToEditorSide({ dropped: dropped });\n      }\n\n      that.messagesPerSec = 0;\n    }, 1000);\n  }\n\n  onInputUpdated() {\n    if (!this.inputs[0].link) return;\n\n    let val = this.getInputData(0);\n    this.isRecentlyActive = true;\n\n    this.messagesPerSec++;\n    if (this.messagesPerSec <= this.MAX_MESS_PER_SEC) {\n      log.info('CONSOLE NODE [' + this.container.id + '/' + this.id + ']: ' + val);\n      this.sendMessageToEditorSide({ value: val });\n    }\n  }\n\n  onRemoved() {\n    if (this.timer) clearInterval(this.timer);\n  }\n\n  onGetMessageToEditorSide(data) {\n    if (data.value != null) log.info('CONSOLE NODE [' + this.container.id + '/' + this.id + ']: ' + data.value);\n\n    if (data.dropped)\n      log.info(\n        'CONSOLE NODE [' +\n          this.container.id +\n          '/' +\n          this.id +\n          ']: dropped ' +\n          data.dropped +\n          ' messages (data rate limitation)',\n      );\n  }\n}\nContainer.registerNodeType('debug/console', ConsoleNode);\n","import { Node, NodeState } from '../../node';\nimport { Container } from '../../container';\n\nclass NotesNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Comments';\n    this.description = 'This node is simply for adding some code comments';\n  }\n\n  onAdded() {\n    this.nodeColour();\n  }\n\n  nodeColour() {\n    this.setNodeState(NodeState.INFO);\n  }\n}\nContainer.registerNodeType('debug/comments', NotesNode);\n","import { Node} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\n\n// TODO: we don't need this all logic, background does this job\n// Watch a value in the editor\nexport class WatchNode extends Node {\n\n  UPDATE_INTERVAL: number\n  timer: any;\n  lastData: any;\n  dataUpdated = false;\n\n  constructor() {\n    super();\n\n    this.UPDATE_INTERVAL = 300;\n\n    this.title = 'Watch';\n    this.description = 'Show value of input';\n    this.addInput('input', Type.ANY);\n  }\n\n  onAdded() {\n    if (this.side == Side.server) this.startSending();\n  }\n\n  startSending() {\n    let that = this;\n    this.timer = setInterval(function() {\n      if (that.dataUpdated) {\n        that.dataUpdated = false;\n        that.sendMessageToEditorSide({ value: that.lastData });\n      }\n    }, this.UPDATE_INTERVAL);\n  }\n\n  onInputUpdated() {\n    this.lastData = this.getInputData(0);\n    this.dataUpdated = true;\n  }\n\n  onRemoved() {\n    if (this.timer) clearInterval(this.timer);\n  }\n\n  onGetMessageToEditorSide(data) {\n    this.lastData = data.value;\n    this.showValueOnInput(data.value);\n  }\n\n  showValueOnInput(value: any) {\n    // show the current value\n    this.inputs[0].label = value;\n    this.setDirtyCanvas(true, false);\n  }\n\n  updateInputsLabels() {\n    this.showValueOnInput(this.lastData);\n  }\n}\nContainer.registerNodeType('debug/watch', WatchNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass FiltersOnlyTrueNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Only True';\n    this.description =\n      \"This node filters 'input' values.  Only 'true' values are passed to 'output'.\";\n\n    this.addInput('input', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n  }\n\n  onAdded(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    if (this.getInputData(0) === true) this.setOutputData(0, true);\n  }\n}\nContainer.registerNodeType('filter/only-true', FiltersOnlyTrueNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass FiltersOnlyFalseNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Only False';\n    this.description =\n      \"This node filters 'input' values.  Only 'false' values are passed to 'output'.\";\n\n    this.addInput('input', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n  }\n\n  onAdded(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    if (this.getInputData(0) === false) this.setOutputData(0, false);\n  }\n}\nContainer.registerNodeType('filter/only-false', FiltersOnlyFalseNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass FiltersOnlyFromRangeNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Only Between';\n    this.description =\n      \"This node filters 'input' values.  Only Numeric 'input' values between 'min' and 'max' are passed to 'output'.\";\n\n    this.addInput('value', Type.NUMBER);\n    this.addInputWithSettings('min', Type.NUMBER, 0, 'min', false);\n    this.addInputWithSettings('max', Type.NUMBER, 10, 'max', false);\n    this.addOutput('value', Type.NUMBER);\n    this.properties['value'];\n  }\n\n  onAdded(){\n    this.setOutputData(0, this.properties['value']);\n    this.onInputUpdated();\n  }\n\n  onAfterSettingsChange(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const val = this.getInputData(0);\n    const min = this.getInputData(1);\n    const max = this.getInputData(2);\n\n    if (val == null || min == null || max == null) {\n      this.setOutputData(0, null);\n    } else if (val >= min && val <= max) {\n      this.setOutputData(0, val);\n      this.properties['value'] = val;\n      this.persistProperties(false, true);\n    }\n  }\n}\nContainer.registerNodeType('filter/only-between', FiltersOnlyFromRangeNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass FiltersOnlyGreaterNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Only Greater';\n    this.description =\n      \"This node filters 'input' values.  Only Numeric 'input' values greater than 'threshold' are passed to 'output'.\";\n\n    this.addInput('input', Type.NUMBER);\n    this.addInputWithSettings('threshold', Type.NUMBER, 0, 'threshold', false);\n    this.addOutput('output', Type.NUMBER);\n    this.properties['value'];\n  }\n\n  onAdded(){\n    this.setOutputData(0, this.properties['value']);\n    this.onInputUpdated();\n  }\n\n  onAfterSettingsChange(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    let threshold = this.getInputData(1);\n    if (val == null || threshold == null) {\n      this.setOutputData(0, null);\n    } else if (val > threshold) {\n      this.setOutputData(0, val);\n      this.properties['value'] = val;\n      this.persistProperties(false, true);\n    }\n  }\n}\nContainer.registerNodeType('filter/only-greater', FiltersOnlyGreaterNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass FiltersOnlyLowerNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Only Lower';\n    this.description =\n      \"This node filters 'input' values.  Only Numeric 'input' values less than 'threshold' are passed to 'output'.\";\n\n    this.addInput('input', Type.NUMBER);\n    this.addInputWithSettings('threshold', Type.NUMBER, 0, 'threshold', false);\n    this.addOutput('output', Type.NUMBER);\n    this.properties['value'];\n  }\n\n  onAdded(){\n    this.setOutputData(0, this.properties['value']);\n    this.onInputUpdated();\n  }\n\n  onAfterSettingsChange(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    let threshold = this.getInputData(1);\n    if (val == null || threshold == null) {\n      this.setOutputData(0, null);\n    } else if (val < threshold) {\n      this.setOutputData(0, val);\n      this.properties['value'] = val;\n      this.persistProperties(false, true);\n    }\n  }\n}\nContainer.registerNodeType('filter/only-lower', FiltersOnlyLowerNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass FiltersOnlyEqualNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Only Equal';\n    this.description =\n      \"This node filters 'input' values.  Only 'input' values equal to 'match' are passed to 'output'.\";\n\n    this.addInput('input', Type.ANY);\n    this.addInputWithSettings('match', Type.ANY, '', 'Match Value');\n    this.addOutput('output', Type.ANY);\n    this.properties['value'];\n  }\n\n  onAdded(){\n    this.setOutputData(0, this.properties['value']);\n    this.onInputUpdated();\n  }\n\n  onAfterSettingsChange(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    val = (val || '').toString(); // making string null i.e `''` and other `null` same\n    if (val == 'false') val = false;\n    else if (val == 'true') val = true;\n\n    let match = (this.getInputData(1) || '').toString();\n    if (match == 'false') match = false;\n    else if (match == 'true') match = true;\n\n    if (val == match) {\n      this.setOutputData(0, val);\n      this.properties['value'] = val;\n      this.persistProperties(false, true);\n    }\n  }\n}\nContainer.registerNodeType('filter/only-equal', FiltersOnlyEqualNode);\n","import { Node } from '../../node';\nimport { Container } from '../../container';\nimport { isNotNull } from '../../../utils/helper';\n\nclass FiltersPreventNullNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Prevent Null';\n    this.description = \"This node filters 'input' values.  All 'input' values are passed to 'output' EXCEPT 'null'.\";\n\n    this.addInput('input');\n    this.addOutput('output');\n    this.properties['value'];\n  }\n\n  onAdded(){\n    this.setOutputData(0, this.properties['value']);\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n\n    if (isNotNull(val) && val !== '') {\n      this.setOutputData(0, val);\n      this.properties['value'] = val;\n      this.persistProperties(false, true);\n    }\n  }\n}\nContainer.registerNodeType('filter/prevent-null', FiltersPreventNullNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass FiltersPreventEqualNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Prevent Equal';\n    this.description =\n      \"This node filters 'input' values.  All 'input' values are passed to 'output' EXCEPT 'input' values which are equal to 'match'.\";\n\n    this.addInput('input', Type.ANY);\n    this.addInputWithSettings('match', Type.ANY, null, 'Match Value');\n    this.addOutput('output', Type.ANY);\n    this.properties['value'];\n  }\n\n  onAdded(){\n    this.setOutputData(0, this.properties['value']);\n    this.onInputUpdated();\n  }\n\n  onAfterSettingsChange(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    val = (val || '').toString(); // making string null i.e `''` and other `null` same\n\n    let match = (this.getInputData(1) || '').toString();\n    if (match == 'false') match = false;\n    else if (match == 'true') match = true;\n\n    if (val != match) {\n      this.setOutputData(0, val);\n      this.properties['value'] = val;\n      this.persistProperties(false, true);\n    }\n  }\n}\nContainer.registerNodeType('filter/prevent-equal', FiltersPreventEqualNode);\n","import { Node } from '../../node';\nimport { Container } from '../../container';\n\nclass FiltersPreventDuplicatesNode extends Node {\n  lastVal: any;\n\n  constructor() {\n    super();\n\n    this.title = 'Prevent Duplicates';\n    this.description =\n      \"This node filters 'input' values.  All 'input' values are passed to 'output' EXCEPT 'input' values which are equal to the previous 'input' value.\";\n\n    this.addInput('input');\n    this.addOutput('output');\n    this.properties['value'];\n  }\n\n  onAdded(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val === '') val = null;\n\n    if (this.lastVal == val) return;\n\n    this.lastVal = val;\n    this.setOutputData(0, val, true);\n    this.properties['value'] = val;\n    this.persistProperties(false, true);\n  }\n}\nContainer.registerNodeType('filter/prevent-duplicates', FiltersPreventDuplicatesNode);\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport TimeUtils from '../../utils/time-utils';\n\nconst moment = require('moment-timezone');\n\nclass AnyDataStoreNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Data Store';\n    this.description =\n      'The data-store node is used to store history log data locally.  The data-store node has limited memory so the capacity is limited to 50 log entries; beware of using too many data-store nodes as it could affect the operation of Wires.  The history logs can be configured to log in UTC or local timezone, and the output format can be set to Array, CSV, or JSON.  If Round up in increments of setting is used (not zero), then the timestamp will be rounded up to the nearest increment value step.';\n    this.addInput('input', Type.ANY);\n    this.addInput('clear', Type.BOOLEAN);\n    this.addOutput('output', Type.ANY);\n    this.addOutput('storedCount', Type.NUMBER);\n\n    this.settings['time-conversation-enable'] = {\n      description: 'Timestamp in system timezone?',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['storage-limit'] = {\n      description: 'Storage Limit (Max 50)',\n      value: 25,\n      type: SettingType.NUMBER,\n    };\n    this.settings['date-iso'] = {\n      description: 'Typestamp Format',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'YYYY-MM-DD HH:mm:ss TZ (ISO8601)' },\n          { value: 1, text: 'YYYY-MM-DD HH:mm:ss' },\n          { value: 2, text: 'MM-DD-YYYY HH:mm:ss' },\n          { value: 3, text: 'DD-MM-YYYY HH:mm:ss' },\n          { value: 4, text: 'DAY, Month DD, YYYY HH:MM AM/PM' },\n          { value: 5, text: 'Month DD, YYYY HH:MM AM/PM' },\n          { value: 6, text: 'Unix timestamp in Milliseconds' },\n        ],\n      },\n      value: 0,\n    };\n    this.settings['outputFormat'] = {\n      description: 'Output Format',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'Array', text: 'Array' },\n          { value: 'CSV', text: 'CSV' },\n          { value: 'JSON', text: 'JSON' },\n        ],\n      },\n      value: 'Array',\n    };\n    this.settings['pointName'] = {\n      description: 'Point Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n    this.settings['minuteRoundValue'] = {\n      description: 'Round minutes up in increments of',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    //this.settings['inputs'] = { description: 'Tag Count', value: 0, type: SettingType.NUMBER };\n    this.setSettingsConfig({\n      conditions: {\n        pointName: setting => {\n          return setting['outputFormat'].value != 'Array';\n        },\n      },\n    });\n  }\n\n  onCreated() {\n    this.properties['historyLog'] = [];\n  }\n\n  onAdded() {\n    this.setOutputData(0, this.properties['historyLog']);\n    this.setOutputData(1, this.properties['historyLog'] ? this.properties['historyLog'].length : 0);\n  }\n\n  nearestFutureMinutes(interval, someMoment) {\n    const roundedMinutes = Math.ceil(someMoment.minute() / interval) * interval;\n    return someMoment\n      .clone()\n      .minute(roundedMinutes)\n      .second(0);\n  }\n\n  formatOutputs() {\n    // Format Output based on settings\n    // System Timezone or UTC based on settings\n    const timezone = this.settings['time-conversation-enable'].value\n      ? Intl.DateTimeFormat().resolvedOptions().timeZone\n      : 'Etc/UTC';\n    let dateTz = null;\n    const pointName = this.settings['pointName'].value;\n    let timeFormatedArray = this.properties['historyLog'].map(entry => {\n      return entry;\n    });\n    timeFormatedArray = timeFormatedArray.reverse().map(entry => {\n      switch (this.settings['date-iso'].value) {\n        case 0:\n          dateTz = moment(entry.timestamp)\n            .tz(timezone)\n            .format();\n          break;\n        case 1:\n          dateTz = moment(entry.timestamp)\n            .tz(timezone)\n            .format('YYYY-MM-DD HH:mm:ss');\n          break;\n        case 2:\n          dateTz = moment(entry.timestamp)\n            .tz(timezone)\n            .format('MM-DD-YYYY HH:mm:ss');\n          break;\n        case 3:\n          dateTz = moment(entry.timestamp)\n            .tz(timezone)\n            .format('DD-MM-YYYY HH:mm:ss');\n          break;\n        case 4:\n          dateTz = moment(entry.timestamp)\n            .tz(timezone)\n            .format('LLLL');\n          break;\n        case 5:\n          dateTz = moment(entry.timestamp)\n            .tz(timezone)\n            .format('LLL');\n          break;\n        case 6:\n          dateTz = moment(entry.timestamp)\n            .tz(timezone)\n            .valueOf();\n          break;\n        default:\n          dateTz = moment(entry.timestamp)\n            .tz(timezone)\n            .format();\n      }\n      return {\n        payload: entry.payload,\n        timestamp: dateTz,\n      };\n    });\n    switch (this.settings['outputFormat'].value) {\n      case 'Array':\n        return timeFormatedArray;\n      case 'CSV':\n        let csvString = `name, timestamp, payload\\n`;\n        timeFormatedArray.forEach(log => {\n          csvString += `${pointName}, ${log.timestamp}, ${log.payload} \\n`;\n        });\n        return csvString;\n      case 'JSON':\n        return JSON.stringify({ [pointName]: timeFormatedArray });\n    }\n  }\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return; // only execute on server\n    if (this.getInputData(1) && this.inputs[1].updated) {\n      this.properties['historyLog'] = []; // clear data if required\n      this.setOutputData(0, this.properties['historyLog'].reverse());\n      this.setOutputData(1, this.properties['historyLog'].length);\n    }\n    if (this.getInputData(0) == null || !this.inputs[0].updated) return;\n    // cap the amount of data that can be stored\n    const storageLimit = Utils.clamp(this.settings['storage-limit'].value, 0, 50);\n    // round the time to the nearest min. For example 15min. 1:00, 1:15\n    const minuteRound = Utils.clamp(this.settings['minuteRoundValue'].value, 0, 60);\n    const now = minuteRound ? TimeUtils.nearestFutureMinutes(minuteRound, moment()) : moment();\n\n    // object data\n    let msg = {\n      payload: this.getInputData(0),\n      timestamp: now._d,\n    };\n    // build an object\n    this.properties['historyLog'].push(msg);\n    while (this.properties['historyLog'].length > storageLimit) {\n      this.properties['historyLog'].shift();\n    }\n\n    this.persistProperties(true, true);\n\n    // Format Output based on settings\n    const newObj = this.formatOutputs() || [];\n    this.setOutputData(0, newObj);\n    this.setOutputData(1, this.properties['historyLog'].length);\n  }\n\n  onAfterSettingsChange() {\n    this.outputs[0].name = `output (${this.settings['outputFormat'].value})`;\n    this.broadcastOutputsToClients();\n    const newObj = this.formatOutputs() || [];\n    this.setOutputData(0, newObj);\n    this.setOutputData(1, this.properties['historyLog'].length);\n  }\n}\nContainer.registerNodeType('history/data-store', AnyDataStoreNode);\n","import { Node, SettingType } from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport { isJSON, isNull } from '../../../utils/helper';\nlet moment = require('moment-timezone');\nconst Influx = require('influx');\nimport config from '../../../config';\n\nclass InfluxDBNode extends Node {\n  selectedTags;\n  client\n  constructor() {\n    super();\n    this.title = 'Influx-DB';\n    this.description = 'A node for sending data to influxDB';\n    this.addInput('[name]', Type.STRING);\n    this.addInput('json-input', Type.JSON);\n    this.addOutput('error', Type.BOOLEAN);\n    this.addOutput('lastExport', Type.STRING);\n    this.settings['enable'] = { description: 'Enable', value: false, type: SettingType.BOOLEAN };\n    this.settings['useEnv'] = { description: 'Dont use env settings', value: false, type: SettingType.BOOLEAN };\n    this.settings['host'] = { description: 'Host', value: '0.0.0.0', type: SettingType.STRING };\n    this.settings['port'] = { description: 'Port', value: '8086', type: SettingType.STRING };\n    this.settings['authentication'] = {\n      description: 'Use Authentication',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['user'] = { description: 'Username', value: '', type: SettingType.STRING };\n    this.settings['password'] = { description: 'Password', value: '', type: SettingType.STRING };\n    this.settings['databaseName'] = {\n      description: 'Database Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n    this.setSettingsConfig({\n      groups: [\n        { host: { weight: 3 }, port: { weight: 1 } },\n        { user: {}, password: {} },\n        { period: { weight: 2 }, periodUnits: {} },\n      ],\n      conditions: {\n        host: setting => {\n          return !!setting['useEnv'].value;\n        },\n        port: setting => {\n          return !!setting['useEnv'].value;\n        },\n        authentication: setting => {\n          return !!setting['useEnv'].value;\n        },\n        databaseName: setting => {\n          return !!setting['useEnv'].value;\n        },\n        user: setting => {\n          return !!setting['authentication'].value;\n        },\n        password: setting => {\n          return !!setting['authentication'].value;\n        },\n      },\n    });\n  }\n  onAdded() {\n    this.createClient();\n  }\n\n  async createClient() {\n    let { protocol, host, port, databaseName, username, password } = config.influxDb;\n    if (this.settings['useEnv'].value) {  //dont use env\n      host = this.settings['host'].value;\n      port = this.settings['port'].value;\n      this.client = new Influx.InfluxDB({\n        host: this.settings['host'].value || 'localhost',\n        port: this.settings['port'].value || 8086,\n        protocol: 'http', //this.influxdbConfig.usetls ? \"https\" : \"http\",\n        database: this.settings['databaseName'].value || 'undefined',\n        username: this.settings['authentication'].value ? this.settings['user'].value : '',\n        password: this.settings['authentication'].value ? this.settings['password'].value : '',\n      });\n    } else { //use use env\n      this.client = new Influx.InfluxDB({\n        host,\n        port,\n        protocol: protocol === 'https' ? 'https' : 'http',\n        database: databaseName,\n        username,\n        password,\n      });\n    }\n  };\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return; // only execute on server\n    if (!this.client) return;\n    if (!this.settings['enable'].value) return;\n\n    //update node name\n    if (this.inputs[0].updated) {\n      let nodeName = this.getInputData(0)\n      if (!isNull(nodeName)) {\n        this.name = nodeName;\n        this.broadcastNameToClients()\n      };\n    }\n\n    const input = this.getInputData(1);\n    if (isNull(input)) return;\n    const measurementHas = input.hasOwnProperty('measurement')\n    const measurementTags = input.hasOwnProperty('tags')\n    const measurementFields = input.hasOwnProperty('fields')\n    if (!input) return;\n    if (input === !isJSON) {\n      this.debugInfo(`INFLUX-DB NODE: input isn't JSON`);\n      return\n    };\n    let tagObj: any;\n    try {\n      if (isNull(input)) return;\n      tagObj = JSON.parse(input.tags);\n    } catch (err) {\n      this.debugInfo(`INFLUX-DB NODE: try/catch  json parse of tags, ${err}`);\n    };\n    if (isNull(input)) return;\n    if (measurementHas && measurementTags && measurementFields) {\n      this.setOutputData(0, false)\n      this.setOutputData(1, moment().format())\n      this.client.writePoints([\n        {\n          measurement: input.measurement,\n          tags: tagObj,\n          fields: input.fields\n        }]).catch(err => {\n          this.debugInfo(`INFLUX-DB NODE: error on influx write, ${err}`);\n          this.setOutputData(0, true)\n        });\n    }\n  };\n\n  onAfterSettingsChange() {\n    if (this.side !== Side.server) return; // only execute on server\n    this.createClient();\n    this.onInputUpdated();\n  };\n\n}\nContainer.registerNodeType('history/influx-db', InfluxDBNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport HistoryBase from './HistoryBase';\n\nclass HistoryNode extends HistoryBase {\n  constructor() {\n    super();\n    this.title = 'History';\n    this.description =\n      'The History node is used to store values to an external database.   History logs (when enabled) are pushed to either the Nube DB or an Influx DB instance.  A Point Name should be entered (under History settings) to identify the history by name. History logging options are Change Of Value (COV), Periodic, and Trigger Only.  When set to COV, a log will be saved when the value changes by the COV Threshold from the last saved history value.  When set to Periodic a log will be saved at every Logging Interval period. When set to either COV or Periodic a log entry can be saved by transitioning the histTrigger input from false to true.  If only the histTrigger action is required, set the History Logging Mode to Trigger Only.   If the history/history node is unable to send the history logs to the configured database (network connection issues, or incorrect configuration) then they will be stored locally, and storedHistCount will increase.  Currently the local storage limit is set to 50 logs. The history/history node has limited memory so the capacity is limited to 50 log entries; beware of using too many history/history nodes as it could affect the operation of Wires.  If Round up in increments of setting is used (not zero), then the timestamp will be rounded up to the nearest increment value step.  If the input value is a Number, the Decimal Places setting will round the input value to the specified number of decimal places.';\n    this.addInput('input', Type.ANY);\n    this.addHistorySettingsConfig();\n  }\n}\nContainer.registerNodeType('history/history', HistoryNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\nimport { isNull } from '../../../utils/helper';\n\n\nexport class PointPersistence extends Node {\n  lastInterval = 1000;\n  runState: boolean = true;\n  timeoutFunc;\n  lastTrigger;\n\n  constructor() {\n    super();\n    this.title = 'Point Persistance';\n    this.description =\n      \"This node is used when you want to store the node output on a restart and also to not pass to the output any null values. While 'enable' is 'true', output will send 'input' value at every 'interval' period. When 'enable' is 'false', output will be 'null'.  interval units can be configured from settings. Maximum interval setting is 587 hours. On a trigger input the output will be sent even if the enable is set to false\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addInput('input', Type.ANY);\n    this.addInputWithSettings('interval', Type.NUMBER, 30, 'Interval');\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('output', Type.ANY);\n    this.properties['output'] = null;\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n  }\n\n  onAdded() {\n    clearInterval(this.timeoutFunc);\n    this.inputs[2]['name'] = `[interval] (${this.settings['time'].value})`;\n    const enable = this.getInputData(0);\n    if (!enable) {\n      this.setOutputData(0, this.properties['output']);\n      this.runState = false;\n      return;\n    }\n    let interval = this.getInputData(2);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    this.timeoutFunc = setInterval(() => {\n      const message = this.getInputData(1);\n      this.setOutputData(0, this.properties['output']);\n    }, interval);\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    // trigger\n    let trigger = this.getInputData(3);\n    const message = this.getInputData(1); //data input\n    if (message !== undefined && message !== null && message.length) {\n      this.properties['output'] = message;\n      this.setOutputData(0, this.properties['output']);\n    }\n\n    if (trigger) {\n      if (\n        this.properties['output'] !== undefined &&\n        this.properties['output'] !== null &&\n        this.properties['output'].length\n      ) {\n        this.setOutputData(0, this.properties['output']);\n      }\n    }\n\n    //pass data on input updated\n    if (this.inputs[1].updated) {\n      if(!isNull(message)){\n        this.properties['output'] = message;\n        this.setOutputData(0, this.properties['output']);\n      }\n    }\n\n    // interval\n    const enable = this.getInputData(0);\n    if (!enable && this.runState) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, this.properties['output']);\n      this.runState = false;\n      return;\n    } else if (!enable && !this.runState) {\n      this.setOutputData(0, this.properties['output']);\n      this.runState = false;\n      return;\n    } else if (enable) {\n      let interval = this.getInputData(2);\n      interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n      if (this.runState) {\n        if (interval != this.lastInterval) {\n          this.lastInterval = interval;\n          clearInterval(this.timeoutFunc);\n          this.timeoutFunc = setInterval(() => {\n            this.setOutputData(0, this.properties['output']);\n          }, interval);\n        }\n        return;\n      } else if (!this.runState) {\n        this.runState = true;\n        this.timeoutFunc = setInterval(() => {\n          this.setOutputData(0, this.properties['output']);\n        }, interval);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[2]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('history/persistence', PointPersistence);\n","import { Node, SettingType } from '../../node';\nimport { Type } from '../../node-io';\nimport { Container, Side } from '../../container';\nimport tagRefs from '../../utils/points/point-ref-utils';\nimport { isNull } from '../../../utils/helper';\n\nclass PointTagNode extends Node {\n  deviceId = 0;\n  pointId = 1;\n  clientId = 2;\n  siteId = 3;\n  clientName = 4;\n  siteName = 5;\n  siteAddress = 6;\n  equipRef = 7;\n  \n  constructor() {\n    super();\n    this.title = 'Point Tag Node';\n    this.description = 'A node generating HVAC tags';\n    this.addInputWithSettings('deviceId', Type.STRING, 'device id', 'device id', false);\n    this.addInputWithSettings('pointId', Type.STRING, 'point id', 'point id/name', false);\n    this.addInputWithSettings('clientId', Type.STRING, 'client id', 'client id', false);\n    this.addInputWithSettings('clientName', Type.STRING, 'client name', 'Client Name', false);\n    this.addInputWithSettings('siteId', Type.STRING, 'site id', 'site id', false);\n    this.addInputWithSettings('siteName', Type.STRING, 'site name', 'Site/Building Name', false);\n    this.addInputWithSettings('siteAddress', Type.STRING, '123 my street', 'Site/Building Address', false);\n    this.addInputWithSettings('equipRef', Type.STRING, 'FCU123', 'Equipment Reference', false);\n    this.addOutput('output', Type.JSON);\n    this.settings['equipType'] = {\n      description: 'Equipment Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: tagRefs.tagCategory,\n      },\n    };\n    this.settings['tags'] = {\n      description: 'Point Type',\n      value: null,\n      type: SettingType.DROPDOWN,\n    };\n    this.settings['tags_values'] = {\n      description: 'Auto generated tags values',\n      value: null,\n      type: SettingType.READONLY,\n    };\n  }\n\n\n  onAdded() {\n    this.onAfterSettingsChange();\n  }\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return; // only execute on server\n    const deviceId = this.getInputData(this.deviceId);\n    const pointId = this.getInputData(this.pointId);\n    const clientId = this.getInputData(this.clientId);\n    const clientName = this.getInputData(this.clientName);\n    const siteId = this.getInputData(this.siteId);\n    const siteName = this.getInputData(this.siteName);\n    const siteAddress = this.getInputData(this.siteAddress);\n    const equipRef = this.getInputData(this.equipRef);\n    const equipType = this.settings['equipType'].value;\n    let tagSetting = tagRefs.tagType(equipType)\n    if (isNull(tagSetting)) return;\n    this.settings['tags'].config = {\n      items: Object.keys(tagSetting),\n    };\n    let pointType = this.settings['tags'].value\n    let tags: any;\n    for (var key in tagSetting) {\n      if (key == pointType) {\n        tags = tagSetting[key]\n      }\n    };\n    let pointArr = {pointType:pointType, equipRef:equipRef, equipType: equipType, deviceId: deviceId, pointId: pointId, clientId: clientId, clientName: clientName, siteId: siteId, siteName: siteName, siteAddress: siteAddress }\n\n    if (tags) {\n      this.settings['tags_values'].value = tags.tags\n      this.broadcastSettingsToClients();\n      tags = tags.tags\n      let pointTags = {}\n      tags.forEach(x => { pointTags[x] = x })\n      const out = { ...pointArr, ...pointTags }\n      this.setOutputData(0, out);\n    }\n  }\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n\n\n}\nContainer.registerNodeType('history/point-tags', PointTagNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass DeadbandNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Deadband';\n    this.description =\n      \"This node applies a Hysteresis function (see hysteresis node), with a deadband centered at 'setpoint'.  The ON direction can be reversed from settings.\";\n    this.addInput('input', Type.NUMBER);\n    this.addInputWithSettings('setpoint', Type.NUMBER, 0, 'Setpoint');\n    this.addInputWithSettings('deadband', Type.NUMBER, 0, 'Deadband');\n    this.addOutput('out', Type.BOOLEAN);\n    this.addOutput('out not', Type.BOOLEAN);\n    this.settings['invert'] = {\n      description: 'Reverses ON direction when true',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  onAdded() {\n    this.setOutputData(0, false);\n  }\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    const setpoint = this.getInputData(1);\n    let deadband = this.getInputData(2);\n\n    const invert = this.settings['invert'].value;\n    if (invert == true) deadband = deadband * -1;\n\n    const risingEdge = setpoint + deadband / 2;\n    const fallingEdge = setpoint - deadband / 2;\n\n    if (risingEdge > fallingEdge) {\n      if (input <= fallingEdge) {\n        this.setOutputData(0, false, true);\n      }\n      if (input >= risingEdge) {\n        this.setOutputData(0, true, true);\n      }\n    } else if (risingEdge < fallingEdge) {\n      if (input >= fallingEdge) {\n        this.setOutputData(0, false, true);\n      }\n      if (input <= risingEdge) {\n        this.setOutputData(0, true, true);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('hvac/deadband', DeadbandNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass ThermostatNode extends Node {\n  clgMode: boolean;\n  htgMode: boolean;\n\n\n  constructor() {\n    super();\n\n    this.title = 'Heat/Cool Thermostat';\n    this.description =\n      \"This node functions as a Heat/Cool thermostat. While 'enable' is set to 'true', the node will function as follows: 'CLG Mode' will be set to 'true' if 'input' is greater than 'setpoint' + 'CLG offset', 'CLG Mode' will be set to 'false' if 'input' is less than 'setpoint'.  'HTG Mode' will be set to 'true' if 'input' is less than 'setpoint' - 'HTG offset', 'HTG Mode' will be set to 'false' if 'input' is greater than 'setpoint'.  If 'enable' is 'false', 'CLG Mode' and 'HTG Mode' will both be set to 'false'. \";\n    this.addInput('input', Type.NUMBER);\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addInputWithSettings('setpoint', Type.NUMBER, 20, 'Setpoint');\n    this.addInputWithSettings('CLG offset', Type.NUMBER, 1, 'CLG offset');\n    this.addInputWithSettings('HTG offset', Type.NUMBER, 1, 'HTG offset');\n    this.addOutput('CLG Mode', Type.BOOLEAN);\n    this.addOutput('HTG Mode', Type.BOOLEAN);\n    this.setOutputData(0, false);\n    this.setOutputData(1, false);\n    this.clgMode = false;\n    this.htgMode = false;\n  }\n\n  onAdded() {\n \n    this.setOutputData(0, false);\n    this.setOutputData(1, false);\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let enable = this.getInputData(1);\n    if (!enable) {\n      this.setOutputData(0, false);\n      this.setOutputData(1, false);\n      this.clgMode = false;\n      this.htgMode = false;\n      return;\n    }\n    const input = this.getInputData(0);\n    const setpoint = this.getInputData(2);\n    const clgOffset = this.getInputData(3);\n    const htgOffset = this.getInputData(4);\n\n    const clgSP = setpoint + clgOffset;\n    const htgSP = setpoint - htgOffset;\n\n    if (input < htgSP) {\n      this.setOutputData(0, false);\n      this.setOutputData(1, true);\n      this.htgMode = true;\n      this.clgMode = false;\n    } else if (input > clgSP) {\n      this.setOutputData(0, true);\n      this.setOutputData(1, false);\n      this.clgMode = true;\n      this.htgMode = false;\n    } else if ((this.clgMode && input < setpoint) || (this.htgMode && input > setpoint)) {\n      this.setOutputData(0, false);\n      this.setOutputData(1, false);\n      this.clgMode = false;\n      this.htgMode = false;\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('hvac/thermostat', ThermostatNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nconst PID = require('../../lib/pid-controller');\n\nclass PIDFunctionNode extends Node {\n  lastTime: number;\n  startTime: number;\n  lastResetVal: boolean = false;\n  pid = new PID(1, 1, 1, 0, 0, 'reverse');\n\n  constructor() {\n    super();\n    this.title = 'PID';\n    this.description =\n      \"This node generates a PID output based on input parameter settings. Inputs: Enable, Setpoint, Process Variable, inP (Proportional), inI (Integral), inD (Derivative), Direction, Interval, MaxOut, MinOut, Manual, and Bias. If 'direction' is 'true' the PID will be a Direct loop ('output' increases when 'processVariable' > 'setpoint'), if 'direction' is 'false' the PID will be a Reverse loop ('output' increases when 'processVariable' < 'setpoint'). 'interval' is the period that the PID output is re-calculated. 'bias' value is added to 'output'. 'manual' will be the 'output' value when 'enable' is 'false'. PID integral factor will be reset to 0 when 'reset' transitions from 'false' to 'true'.  'interval units can be configured from settings.  Maximum interval setting is 587 hours.\";\n\n    this.addInput('enable', Type.BOOLEAN); // 0\n    this.addInput('processVariable', Type.NUMBER); // 1\n    this.addInputWithSettings('setpoint', Type.NUMBER, 1, 'setpoint'); // 2\n    this.addInputWithSettings('minOut', Type.NUMBER, 0, 'minOut'); // 3\n    this.addInputWithSettings('maxOut', Type.NUMBER, 100, 'maxOut'); // 4\n    this.addInputWithSettings('inP', Type.NUMBER, 1, 'P'); // 5\n    this.addInputWithSettings('inI', Type.NUMBER, 0, 'I'); // 6\n    this.addInputWithSettings('inD', Type.NUMBER, 0, 'D'); // 7\n    //this.addInputWithSettings('direction', Type.BOOLEAN, true, 'Direction (OFF = Reverse, ON = Direct)'); // Direct or Reverse // 8\n    this.addInputWithSettings(\n      'direction',\n      Type.BOOLEAN,\n      true,\n      'Direction (OFF = Reverse, ON = Direct)',\n    ); // Direct or Reverse // 8\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Interval (min 500ms)'); // 9\n    this.addInputWithSettings('bias', Type.NUMBER, 0, 'Bias'); // 10\n    this.addInputWithSettings('manual', Type.NUMBER, 0, \"Manual ('output' value on disabled)\"); // 11\n    this.addInput('reset', Type.BOOLEAN); // 12\n    this.addOutput('output', Type.NUMBER); // 0\n    this.settings['time'] = {\n      description: 'Time',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [\n        { minOut: {}, maxOut: {} },\n        { inP: {}, inI: {}, inD: {} },\n        { time: {}, interval: { weight: 2 } },\n      ],\n    });\n    this.startTime = Date.now();\n    this.pid.setSampleTime(1000);\n    this.pid.setOutputLimits(0, 100);\n    this.pid.setMode('MANUAL');\n    this.pid.setOutput(0);\n    this.pid.setBias(0);\n  }\n\n  onAdded() {\n    this.inputs[9]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n\n  onExecute() {\n    if (this.pid.compute()) this.setOutputData(0, this.pid.getOutput().toFixed(1), true);\n  }\n\n  onInputUpdated() {\n    const reset = this.getInputData(12);\n    if (reset && !this.lastResetVal) this.pid.initialize();\n    this.lastResetVal = reset;\n\n    let enable = this.getInputData(0);\n    if (!enable) {\n      this.pid.setMode('MANUAL');\n      const manual = this.getInputData(11) || 0;\n      this.setOutputData(0, manual.toFixed(1));\n      this.pid.setOutput(manual);\n      return;\n    }\n\n    let processVariable = this.getInputData(1);\n    if (\n      processVariable === null ||\n      processVariable === undefined ||\n      typeof processVariable !== Type.NUMBER\n    ) {\n      this.pid.setMode('MANUAL');\n      const manual = this.getInputData(11) || 0;\n      this.setOutputData(0, manual.toFixed(1), true);\n      this.pid.setOutput(manual);\n      return;\n    }\n\n    const setpoint = this.getInputData(2);\n    const minOut = this.getInputData(3);\n    const maxOut = this.getInputData(4);\n    const inP = this.getInputData(5);\n    const inI = this.getInputData(6);\n    const inD = this.getInputData(7);\n    let direction = this.getInputData(8);\n    if (direction == true) direction = 'direct';\n    else direction = 'reverse';\n    let interval = this.getInputData(9);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    interval = Math.max(500, interval);\n    const bias = this.getInputData(10);\n\n    this.pid.setBias(bias);\n    this.pid.setSampleTime(interval);\n    this.pid.setOutputLimits(minOut, maxOut);\n    this.pid.setPoint(setpoint);\n    this.pid.setTunings(inP, inI, inD);\n    this.pid.setControllerDirection(direction);\n    this.pid.setMode('auto');\n    this.pid.setInput(processVariable);\n    this.pid.compute();\n    this.setOutputData(0, this.calculatePidOutput(), true);\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[9]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n\n  private calculatePidOutput(): number {\n    return this.pid.getOutput().toFixed(1);\n  }\n}\nContainer.registerNodeType('hvac/PID', PIDFunctionNode);\n","/**\n * pid-controller -  A node advanced PID controller based on the Arduino PID library\n * github@wilberforce.co.nz Rhys Williams\n * Based on:\n * Arduino PID Library - Version 1.0.1\n * by Brett Beauregard <br3ttb@gmail.com> brettbeauregard.com\n *\n * This Library is licensed under a GPL-3.0 License\n */\n\n'use strict';\nvar PID = function(Input, Setpoint, Kp, Ki, Kd, ControllerDirection) {\n  this.input = Input;\n  this.mySetpoint = Setpoint;\n  this.inAuto = false;\n  this.setOutputLimits(0, 255); // default output limits\n  this.SampleTime = 100; // default Controller Sample Time is 0.1 seconds\n  this.setTunings(Kp, Ki, Kd);\n  this.setControllerDirection(ControllerDirection);\n  this.lastTime = this.millis() - this.SampleTime;\n\n  this.myBias = 0;\n  this.ITerm = 0;\n  this.myOutput = 0;\n};\n\n// Constants for backward compatibility\n// PID.AUTOMATIC = 1;\n// PID.MANUAL = 0;\n// PID.DIRECT = 0;\n// PID.REVERSE = 1;\n\nPID.prototype.setInput = function(current_value) {\n  this.input = Number(current_value);\n};\n\nPID.prototype.setPoint = function(current_value) {\n  this.mySetpoint = Number(current_value);\n};\n\nPID.prototype.setBias = function(current_value) {\n  if (current_value > this.outMax) {\n    current_value = this.outMax; // POSSIBLY INCORRECT\n  } else if (current_value < this.outMin) {\n    current_value = this.outMin;\n  }\n  this.myBias = Number(current_value);\n};\n\nPID.prototype.millis = function() {\n  var d = new Date();\n  return d.getTime();\n};\n\n/**\n * Compute()\n * This, as they say, is where the magic happens.  this function should be called\n * every time \"void loop()\" executes.  the function will decide for itself whether a new\n * pid Output needs to be computed.  returns true when the output is computed,\n * false when nothing has been done.\n */\n\nPID.prototype.compute = function() {\n  if (!this.inAuto) {\n    return false;\n  }\n\n  var now = this.millis();\n  var timeChange = now - this.lastTime;\n  if (timeChange >= this.SampleTime) {\n    // Compute all the working error variables\n    var input = this.input;\n\n    //var error = this.mySetpoint - input;\n    var error = input - this.mySetpoint; // above setpoint = positive error\n    error = error * this.setDirection;\n\n    this.ITerm += this.ki * error;\n    if (this.ITerm > this.outMax - this.myBias) {\n      this.ITerm = this.outMax - this.myBias;\n    } else if (this.ITerm < this.outMin - this.myBias) {\n      this.ITerm = this.outMin - this.myBias;\n    }\n\n    var dInput = input - this.lastInput;\n\n    // Compute PID Output\n    //var output = ((this.kp * error) + this.ITerm - (this.kd * dInput)) * this.setDirection;\n    var output = this.kp * error + this.ITerm - this.kd * dInput + this.myBias;\n    //var output = ((this.kp * error) + this.ITerm - (this.kd * dInput));\n\n    if (output > this.outMax) {\n      output = this.outMax;\n    } else if (output < this.outMin) {\n      output = this.outMin;\n    }\n    this.myOutput = output;\n\n    // Remember some variables for next time\n    this.lastInput = input;\n    this.lastTime = now;\n    return true;\n  } else {\n    return false;\n  }\n};\n\n/**\n * SetTunings(...)\n * This function allows the controller's dynamic performance to be adjusted.\n * it's called automatically from the constructor, but tunings can also\n * be adjusted on the fly during normal operation\n */\nPID.prototype.setTunings = function(Kp, Ki, Kd) {\n  if (Kp < 0 || Ki < 0 || Kd < 0) {\n    return;\n  }\n\n  this.dispKp = Kp;\n  this.dispKi = Ki;\n  this.dispKd = Kd;\n\n  this.SampleTimeInSec = this.SampleTime / 1000;\n  this.kp = Kp;\n  this.ki = Ki * this.SampleTimeInSec;\n  this.kd = Kd / this.SampleTimeInSec;\n};\n\n/**\n * SetSampleTime(...)\n * sets the period, in Milliseconds, at which the calculation is performed\n */\nPID.prototype.setSampleTime = function(NewSampleTime) {\n  if (NewSampleTime > 0) {\n    var ratio = NewSampleTime / (1.0 * this.SampleTime);\n    this.ki *= ratio;\n    this.kd /= ratio;\n    this.SampleTime = Math.round(NewSampleTime);\n  }\n};\n\n/**\n * SetOutput( )\n * Set output level if in manual mode\n */\nPID.prototype.setOutput = function(val) {\n  if (val > this.outMax) {\n    val = this.outMax; // POSSIBLY INCORRECT\n  } else if (val < this.outMin) {\n    val = this.outMin;\n  }\n  this.myOutput = val;\n};\n\n/**\n * SetOutputLimits(...)\n * This function will be used far more often than SetInputLimits.  while\n * the input to the controller will generally be in the 0-1023 range (which is\n * the default already,)  the output will be a little different.  maybe they'll\n * be doing a time window and will need 0-8000 or something.  or maybe they'll\n * want to clamp it from 0-125.  who knows.  at any rate, that can all be done here.\n */\nPID.prototype.setOutputLimits = function(Min, Max) {\n  if (Min >= Max) {\n    return;\n  }\n  this.outMin = Min;\n  this.outMax = Max;\n\n  if (this.inAuto) {\n    if (this.myOutput > this.outMax) {\n      this.myOutput = this.outMax;\n    } else if (this.myOutput < this.outMin) {\n      this.myOutput = this.outMin;\n    }\n\n    if (this.ITerm > this.outMax - this.myBias) {\n      this.ITerm = this.outMax - this.myBias;\n    } else if (this.ITerm < this.outMin - this.myBias) {\n      this.ITerm = this.outMin - this.myBias;\n    }\n  }\n};\n\n/**\n * SetMode(...)\n * Allows the controller Mode to be set to manual (0) or Automatic (non-zero)\n * when the transition from manual to auto occurs, the controller is\n * automatically initialized\n */\nPID.prototype.setMode = function(Mode) {\n  var newAuto;\n  if (\n    Mode == 0 ||\n    Mode.toString().toLowerCase() == 'automatic' ||\n    Mode.toString().toLowerCase() == 'auto'\n  ) {\n    newAuto = 1;\n  } else if (Mode == 1 || Mode.toString().toLowerCase() == 'manual') {\n    newAuto = 0;\n  } else {\n    throw new Error('Incorrect Mode Chosen');\n  }\n  /*  Removed in favor of manually triggered 'Reset'(using Initialize()).\n  if (newAuto == !this.inAuto) {\n    //we just went from manual to auto\n    this.initialize();   \n  }\n  */\n  this.inAuto = newAuto;\n};\n\n/**\n * Initialize()\n * does all the things that need to happen to ensure a bumpless transfer\n * from manual to automatic mode.\n */\nPID.prototype.initialize = function() {\n  //this.ITerm = this.myOutput;\n  this.ITerm = 0;\n  this.myOutput = this.myBias;\n  this.lastInput = this.input;\n  /*\n  if (this.ITerm > this.outMax) {\n    this.ITerm = this.outMax;\n  } else if (this.ITerm < this.outMin) {\n    this.ITerm = this.outMin;\n  }\n  */\n};\n\n/**\n * SetControllerDirection(...)\n * The PID will either be connected to a DIRECT acting process (+Output leads\n * to +Input) or a REVERSE acting process(+Output leads to -Input.)  we need to\n * know which one, because otherwise we may increase the output when we should\n * be decreasing.  This is called from the constructor.\n */\nPID.prototype.setControllerDirection = function(ControllerDirection) {\n  if (ControllerDirection == 0 || ControllerDirection.toString().toLowerCase() == 'direct') {\n    this.setDirection = 1;\n  } else if (\n    ControllerDirection == 1 ||\n    ControllerDirection.toString().toLowerCase() == 'reverse'\n  ) {\n    this.setDirection = -1;\n  } else {\n    throw new Error('Incorrect Controller Direction Chosen');\n  }\n};\n\n/**\n * Status Functions\n * Just because you set the Kp=-1 doesn't mean it actually happened.  these\n * functions query the internal state of the PID.  they're here for display\n * purposes.  this are the functions the PID Front-end uses for example\n */\nPID.prototype.getKp = function() {\n  return this.dispKp;\n};\n\nPID.prototype.getKd = function() {\n  return this.dispKd;\n};\n\nPID.prototype.getKi = function() {\n  return this.dispKi;\n};\n\nPID.prototype.getMode = function() {\n  return this.inAuto ? 'Auto' : 'Manual';\n};\n\nPID.prototype.getDirection = function() {\n  return this.controllerDirection;\n};\n\nPID.prototype.getOutput = function() {\n  return this.myOutput;\n};\n\nPID.prototype.getInput = function() {\n  return this.input;\n};\n\nPID.prototype.getSetPoint = function() {\n  return this.mySetpoint;\n};\n\nPID.prototype.getBias = function() {\n  return this.myBias;\n};\n\nmodule.exports = PID;\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass ToggleDurationNode extends Node {\n  startTime;\n  lastTrigger;\n  runState;\n  runtimeVal;\n\n  constructor() {\n    super();\n    this.title = 'Toggle Duration';\n    this.description =\n      \"This node accepts a 'pushButton' input which triggers 'output' to 'true' for the 'runtime', or until 'pushButton' transitions from 'false' to 'true' within the 'runtime' period\";\n    this.addInput('pushButton', Type.BOOLEAN);\n    this.addInputWithSettings('runtime', Type.NUMBER, 120, 'Runtime');\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('remainingRuntime', Type.NUMBER);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'minutes',\n    };\n    this.setSettingsConfig({\n      groups: [{ runtime: { weight: 2 }, time: {} }],\n    });\n  }\n\n  onCreated() {\n    this.setOutputData(0, false);\n    this.lastTrigger = false;\n    this.onAfterSettingsChange();\n  }\n\n  onAdded() {\n    this.inputs[1]['name'] = `[runtime] (${this.settings['time'].value})`;\n    this.EXECUTE_INTERVAL = 10000;\n    this.onAfterSettingsChange();\n  }\n\n  onExecute() {\n    if (this.runState) {\n      const remainingMins = (this.runtimeVal - (new Date().valueOf() - this.startTime)) * 1.6667e-5;\n      this.setOutputData(1, remainingMins.toFixed(1));\n      if (remainingMins <= 0) this.stop();\n    }\n  }\n\n  onInputUpdated() {\n    let trigger = this.getInputData(0);\n    if (trigger == null) this.lastTrigger = false;\n    else if (trigger && !this.lastTrigger) {\n      let runtime = this.getInputData(1);\n      runtime = TimeUtils.timeConvert(runtime, this.settings['time'].value);\n      if (this.runState) this.stop();\n      else this.start(runtime);\n    }\n    this.lastTrigger = trigger;\n  }\n\n  start(runtime) {\n    this.runState = true;\n    this.runtimeVal = runtime;\n    this.EXECUTE_INTERVAL = Math.max(Math.min(10000, runtime / 10), 250);\n    this.startTime = new Date().valueOf();\n    this.setOutputData(0, true);\n    this.onExecute();\n  }\n\n  stop() {\n    this.runState = false;\n    this.setOutputData(0, false);\n    this.setOutputData(1, 0);\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[1]['name'] = `[runtime] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('hvac/toggle-duration', ToggleDurationNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nconst psychrolib = require('../../lib/psychrolib');\n\nclass PsychrometricCalculationsNode extends Node {\n  psychro = new psychrolib();\n  conversionFunction;\n\n  constructor() {\n    super();\n    this.title = 'Psychrometric Calcs (Metric/SI)';\n    this.description =\n      'This node provides psychrometric calculations based on a selection of: Dry Bulb Temp, Wet Bulb Temp, Dew Point, Relative Humidity, and Pressure.  Inputs and Outputs as follows: (i) Dry bulb temperature in F [IP] or C [SI]; (i) Wet bulb temperature in F [IP] or C [SI];  (i) Atmospheric pressure in Psi [IP] or Pa [SI];  (o) Humidity ratio in lb_HO lb_Air [IP] or kg_HO kg_Air [SI];  (o) Dew point temperature in F [IP] or C [SI]; \\n (o) Relative humidity [0-1];  (o) Partial pressure of water vapor in moist air in Psi [IP] or Pa [SI];  (o) Moist air enthalpy in Btu lb [IP] or J kg [SI];  (o) Specific volume ft lb [IP] or in m kg [SI].  Input types can be selected from settings. Outputs will change based on selected input type.   Unit system can be set from settings to be in:  Metric/SI or Imperial/IP.';\n\n    this.addInput('DryBulb', Type.NUMBER);\n    this.addInput('RelHum(0-1)', Type.NUMBER);\n    this.addInput('Pressure', Type.NUMBER);\n    this.addOutput('HumRatio', Type.NUMBER);\n    this.addOutput('TWetBulb', Type.NUMBER);\n    this.addOutput('TDewPoint', Type.NUMBER);\n    this.addOutput('VapPres', Type.NUMBER);\n    this.addOutput('MoistAirEnthalpy', Type.NUMBER);\n    this.addOutput('MoistAirVolume', Type.NUMBER);\n    this.addOutput('DegreeOfSaturation', Type.NUMBER);\n    this.addOutput('error', Type.STRING);\n    this.settings['units'] = {\n      description: 'Select Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'SI', text: 'Metric/SI' },\n          { value: 'IP', text: 'Imperial/IP' },\n        ],\n      },\n      value: 'SI',\n    };\n    this.settings['inputsSelect'] = {\n      description: 'Select Inputs',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'DB_RH_P', text: 'Dry Bulb, Rel. Humidity, Pressure' },\n          { value: 'DB_WB_P', text: 'Dry Bulb, Wet Bulb, Pressure' },\n          { value: 'DB_DP_P', text: 'Dry Bulb, Dew Point, Pressure ' },\n        ],\n      },\n      value: 'DB_RH_P',\n    };\n    this.settings['precision'] = { description: 'Precision', type: SettingType.NUMBER, value: 4 };\n    this.psychro.SetUnitSystem(this.psychro.SI);\n  }\n\n  onAdded() {\n    this.setConversionFunction();\n  }\n\n  onInputUpdated() {\n    this.onInputOrSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.setConversionFunction();\n    this.onInputOrSettingsChange();\n  }\n\n  private onInputOrSettingsChange() {\n    const input1 = this.getInputData(0);\n    const input2 = this.getInputData(1);\n    const input3 = this.getInputData(2);\n\n    if (!Utils.hasInput(input1) || !Utils.hasInput(input2) || !Utils.hasInput(input3)) {\n      this.clearOutputs();\n      this.setOutputData(7, null);\n      return;\n    }\n\n    let outputArray: number[];\n    try {\n      outputArray = this.conversionFunction(input1, input2, input3);\n    } catch (error) {\n      this.clearOutputs();\n      this.setOutputData(7, String(error));\n      return;\n    }\n    const precision = Math.abs(this.settings['precision'].value);\n    this.setOutputData(0, Number(outputArray[0]).toFixed(precision));\n    this.setOutputData(1, Number(outputArray[1]).toFixed(precision));\n    this.setOutputData(2, Number(outputArray[2]).toFixed(precision));\n    this.setOutputData(3, Number(outputArray[3]).toFixed(precision));\n    this.setOutputData(4, Number(outputArray[4]).toFixed(precision));\n    this.setOutputData(5, Number(outputArray[5]).toFixed(precision));\n    this.setOutputData(6, Number(outputArray[6]).toFixed(precision));\n    this.setOutputData(7, null);\n  }\n\n  private clearOutputs() {\n    this.setOutputData(0, null);\n    this.setOutputData(1, null);\n    this.setOutputData(2, null);\n    this.setOutputData(3, null);\n    this.setOutputData(4, null);\n    this.setOutputData(5, null);\n    this.setOutputData(6, null);\n  }\n\n  private setConversionFunction() {\n    const units = this.settings['units'].value;\n    if (units == 'IP') {\n      this.psychro.SetUnitSystem(this.psychro.IP);\n      this.title = 'Psychrometric Calcs (Imperial/IP)';\n    } else {\n      this.psychro.SetUnitSystem(this.psychro.SI);\n      this.title = 'Psychrometric Calcs (Metric/SI)';\n    }\n\n    const conversion = this.settings['inputsSelect'].value;\n    switch (conversion) {\n      case 'DB_RH_P':\n        this.inputs[0].name = 'DryBulb';\n        this.inputs[1].name = 'RelHum(0-1)';\n        this.inputs[2].name = 'Pressure';\n        this.outputs[0].name = 'HumRatio';\n        this.outputs[1].name = 'TWetBulb';\n        this.outputs[2].name = 'TDewPoint';\n        this.conversionFunction = (in1, in2, in3) => {\n          return this.psychro.CalcPsychrometricsFromRelHum(in1, in2, in3);\n        };\n        break;\n      case 'DB_WB_P':\n        this.inputs[0].name = 'DryBulb';\n        this.inputs[1].name = 'TWetBulb';\n        this.inputs[2].name = 'Pressure';\n        this.outputs[0].name = 'HumRatio';\n        this.outputs[1].name = 'TDewPoint';\n        this.outputs[2].name = 'RelHum';\n        this.conversionFunction = (in1, in2, in3) => {\n          return this.psychro.CalcPsychrometricsFromTWetBulb(in1, in2, in3);\n        };\n        break;\n      case 'DB_DP_P':\n        this.inputs[0].name = 'DryBulb';\n        this.inputs[1].name = 'TDewPoint';\n        this.inputs[2].name = 'Pressure';\n        this.outputs[0].name = 'HumRatio';\n        this.outputs[1].name = 'TWetBulb';\n        this.outputs[2].name = 'RelHum';\n        this.conversionFunction = (in1, in2, in3) => {\n          return this.psychro.CalcPsychrometricsFromTDewPoint(in1, in2, in3);\n        };\n        break;\n      default:\n        this.inputs[0].name = 'DryBulb';\n        this.inputs[1].name = 'RelHum(0-1)';\n        this.inputs[2].name = 'Pressure';\n        this.outputs[0].name = 'HumRatio';\n        this.outputs[1].name = 'TWetBulb';\n        this.outputs[2].name = 'TDewPoint';\n        this.conversionFunction = (in1, in2, in3) => {\n          return this.psychro.CalcPsychrometricsFromRelHum(in1, in2, in3);\n        };\n    }\n  }\n}\nContainer.registerNodeType('hvac/psychrometrics', PsychrometricCalculationsNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass EnergyUnitConversionNode extends Node {\n  conversionFunction;\n\n  constructor() {\n    super();\n    this.title = 'Energy Conversion (Wh)';\n    this.description =\n      'This node converts between Energy units watt-hour (Wh), kilowatt-hour (kWh), British Thermal Unit (Btu), calorie (cal), joule(J), and joule(kJ).  Input type can be selected from settings. Outputs will change based on selected input type.';\n    this.addInput('Wh', Type.NUMBER);\n    this.addOutput('kWh', Type.NUMBER);\n    this.addOutput('Btu', Type.NUMBER);\n    this.addOutput('cal', Type.NUMBER);\n    this.addOutput('J', Type.NUMBER);\n    this.addOutput('kJ', Type.NUMBER);\n    this.settings['inputType'] = {\n      description: 'Input Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'Wh', text: 'watt-hour (Wh)' },\n          { value: 'kWh', text: 'kilowatt-hour (kWh)' },\n          { value: 'Btu', text: 'British Thermal Unit (Btu)' },\n          { value: 'cal', text: 'calorie (cal)' },\n          { value: 'J', text: 'joule(J)' },\n          { value: 'kJ', text: 'kilojoule(kJ)' },\n        ],\n      },\n      value: 'Wh',\n    };\n    this.settings['precision'] = { description: 'Precision', type: SettingType.NUMBER, value: '4' };\n  }\n\n  onAdded() {\n    this.setConversionFunction();\n  }\n\n  onInputUpdated() {\n    this.onInputOrSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.setConversionFunction();\n    this.onInputOrSettingsChange();\n  }\n\n  private onInputOrSettingsChange() {\n    const input = this.getInputData(0);\n    if (!Utils.hasInput(input)) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n      this.setOutputData(2, null);\n      this.setOutputData(3, null);\n      this.setOutputData(4, null);\n      return;\n    }\n    const output = this.conversionFunction(input);\n    const precision = Math.abs(this.settings['precision'].value);\n    this.setOutputData(0, Number(output[0]).toFixed(precision));\n    this.setOutputData(1, Number(output[1]).toFixed(precision));\n    this.setOutputData(2, Number(output[2]).toFixed(precision));\n    this.setOutputData(3, Number(output[3]).toFixed(precision));\n    this.setOutputData(4, Number(output[4]).toFixed(precision));\n  }\n\n  setConversionFunction() {\n    const inputType = this.settings['inputType'].value;\n    switch (inputType) {\n      case 'Wh':\n        this.title = 'Energy Conversion (Wh)';\n        this.inputs[0].name = 'Wh';\n        this.outputs[0].name = 'kWh';\n        this.outputs[1].name = 'Btu';\n        this.outputs[2].name = 'cal';\n        this.outputs[3].name = 'J';\n        this.outputs[4].name = 'kJ';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null, null];\n          outputArray[0] = input * 0.001;\n          outputArray[1] = input * 3.4121416331;\n          outputArray[2] = input * 859.8456;\n          outputArray[3] = input * 3600;\n          outputArray[4] = input * 3.6;\n          return outputArray;\n        };\n        break;\n      case 'kWh':\n        this.title = 'Energy Conversion (kWh)';\n        this.inputs[0].name = 'kWh';\n        this.outputs[0].name = 'Wh';\n        this.outputs[1].name = 'Btu';\n        this.outputs[2].name = 'cal';\n        this.outputs[3].name = 'J';\n        this.outputs[4].name = 'kJ';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null, null];\n          outputArray[0] = input * 1000;\n          outputArray[1] = input * 3412.1416331279;\n          outputArray[2] = input * 859845.6;\n          outputArray[3] = input * 3600000;\n          outputArray[4] = input * 3600;\n          return outputArray;\n        };\n        break;\n      case 'Btu':\n        this.title = 'Energy Conversion (Btu)';\n        this.inputs[0].name = 'Btu';\n        this.outputs[0].name = 'Wh';\n        this.outputs[1].name = 'kWh';\n        this.outputs[2].name = 'cal';\n        this.outputs[3].name = 'J';\n        this.outputs[4].name = 'kJ';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null, null];\n          outputArray[0] = input * 0.2930710702;\n          outputArray[1] = input * 0.0002930711;\n          outputArray[2] = input * 251.99587;\n          outputArray[3] = input * 1055.05585262;\n          outputArray[4] = input * 1.0550558526;\n          return outputArray;\n        };\n        break;\n      case 'cal':\n        this.title = 'Energy Conversion (cal)';\n        this.inputs[0].name = 'cal';\n        this.outputs[0].name = 'Wh';\n        this.outputs[1].name = 'kWh';\n        this.outputs[2].name = 'Btu';\n        this.outputs[3].name = 'J';\n        this.outputs[4].name = 'kJ';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null, null];\n          outputArray[0] = input * 0.0011629995;\n          outputArray[1] = input * 0.000001163;\n          outputArray[2] = input * 0.003968319;\n          outputArray[3] = input * 4.1867982;\n          outputArray[4] = input * 0.0041867982;\n          return outputArray;\n        };\n        break;\n      case 'J':\n        this.title = 'Energy Conversion (J)';\n        this.inputs[0].name = 'J';\n        this.outputs[0].name = 'Wh';\n        this.outputs[1].name = 'kWh';\n        this.outputs[2].name = 'Btu';\n        this.outputs[3].name = 'cal';\n        this.outputs[4].name = 'kJ';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null, null];\n          outputArray[0] = input * 0.0002777778;\n          outputArray[1] = input * 0.0000002777778;\n          outputArray[2] = input * 0.0009478171;\n          outputArray[3] = input * 0.238846;\n          outputArray[4] = input * 0.001;\n          return outputArray;\n        };\n        break;\n      case 'kJ':\n        this.title = 'Energy Conversion (kJ)';\n        this.inputs[0].name = 'kJ';\n        this.outputs[0].name = 'Wh';\n        this.outputs[1].name = 'kWh';\n        this.outputs[2].name = 'Btu';\n        this.outputs[3].name = 'cal';\n        this.outputs[4].name = 'J';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null, null];\n          outputArray[0] = input * 0.2777777778;\n          outputArray[1] = input * 0.0002777778;\n          outputArray[2] = input * 0.9478171203;\n          outputArray[3] = input * 238.846;\n          outputArray[4] = input * 1000;\n          return outputArray;\n        };\n        break;\n      default:\n        this.title = 'Energy Conversion (Wh)';\n        this.inputs[0].name = 'Wh';\n        this.outputs[0].name = 'kWh';\n        this.outputs[1].name = 'Btu';\n        this.outputs[2].name = 'cal';\n        this.outputs[3].name = 'J';\n        this.outputs[4].name = 'kJ';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null, null];\n          outputArray[0] = input * 0.001;\n          outputArray[1] = input * 3.4121416331;\n          outputArray[2] = input * 859.8456;\n          outputArray[3] = input * 3600;\n          outputArray[4] = input * 3.6;\n          return outputArray;\n        };\n    }\n  }\n}\nContainer.registerNodeType('hvac/energy-conversion', EnergyUnitConversionNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass PowerUnitConversionNode extends Node {\n  conversionFunction;\n\n  constructor() {\n    super();\n    this.title = 'Power Conversion (kW)';\n    this.description =\n      'This node converts between Power units kilowatt (kW), Tons of Refrigeration (tons),  British Thermal Unit per hour (Btu/h), and Electrical Horsepower (hp).  Input type can be selected from settings. Outputs will change based on selected input type.';\n\n    this.addInput('kW', Type.NUMBER);\n    this.addOutput('tons', Type.NUMBER);\n    this.addOutput('Btu/h', Type.NUMBER);\n    this.addOutput('hp', Type.NUMBER);\n    this.settings['inputType'] = {\n      description: 'Input Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'kW', text: 'kilowatt (kW)' },\n          { value: 'tons', text: 'Tons of Refrigeration (tons)' },\n          { value: 'Btu/h', text: 'British Thermal Unit per hour (Btu/h)' },\n          { value: 'hp', text: 'Electrical Horsepower (hp)' },\n        ],\n      },\n      value: 'kW',\n    };\n    this.settings['precision'] = { description: 'Precision', type: SettingType.NUMBER, value: '4' };\n  }\n\n  onAdded() {\n    this.setConversionFunction();\n  }\n\n  onInputUpdated() {\n    this.onInputOrSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.setConversionFunction();\n    this.onInputOrSettingsChange();\n  }\n\n  private onInputOrSettingsChange() {\n    const input = this.getInputData(0);\n    if (!Utils.hasInput(input)) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n      this.setOutputData(2, null);\n\n      return;\n    }\n    const output = this.conversionFunction(input);\n    const precision = Math.abs(this.settings['precision'].value);\n    this.setOutputData(0, Number(output[0]).toFixed(precision));\n    this.setOutputData(1, Number(output[1]).toFixed(precision));\n    this.setOutputData(2, Number(output[2]).toFixed(precision));\n  }\n\n  setConversionFunction() {\n    const inputType = this.settings['inputType'].value;\n    switch (inputType) {\n      case 'kW':\n        this.title = 'Power Conversion (kW)';\n        this.inputs[0].name = 'kW';\n        this.outputs[0].name = 'tons';\n        this.outputs[1].name = 'Btu/h';\n        this.outputs[2].name = 'hp';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 0.284345;\n          outputArray[1] = input * 3412.141635133076;\n          outputArray[2] = input * 1.340482573727;\n          return outputArray;\n        };\n        break;\n      case 'tons':\n        this.title = 'Power Conversion (tons)';\n        this.inputs[0].name = 'tons';\n        this.outputs[0].name = 'kW';\n        this.outputs[1].name = 'Btu/h';\n        this.outputs[2].name = 'hp';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 3.51685;\n          outputArray[1] = input * 12000;\n          outputArray[2] = input * 4.71427613941;\n          return outputArray;\n        };\n        break;\n      case 'Btu/h':\n        this.title = 'Power Conversion (Btu/h)';\n        this.inputs[0].name = 'Btu/h';\n        this.outputs[0].name = 'kW';\n        this.outputs[1].name = 'tons';\n        this.outputs[2].name = 'hp';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 0.00029307107;\n          outputArray[1] = input * 8.33333332843549e-5;\n          outputArray[2] = input * 0.000392856662;\n          return outputArray;\n        };\n        break;\n      case 'hp':\n        this.title = 'Power Conversion (hp)';\n        this.inputs[0].name = 'hp';\n        this.outputs[0].name = 'kW';\n        this.outputs[1].name = 'tons';\n        this.outputs[2].name = 'Btu/h';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 0.746;\n          outputArray[1] = input * 2545.457659809275;\n          outputArray[2] = input * 0.21212147;\n          return outputArray;\n        };\n        break;\n      default:\n        this.title = 'Power Conversion (kW)';\n        this.inputs[0].name = 'kW';\n        this.outputs[0].name = 'tons';\n        this.outputs[1].name = 'Btu/h';\n        this.outputs[2].name = 'hp';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 0.284345;\n          outputArray[1] = input * 3412.141635133076;\n          outputArray[2] = input * 1.340482573727;\n          return outputArray;\n        };\n    }\n  }\n}\nContainer.registerNodeType('hvac/power-conversion', PowerUnitConversionNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass VolumeUnitConversionNode extends Node {\n  conversionFunction;\n\n  constructor() {\n    super();\n    this.title = 'Volume Conversion (L)';\n    this.description =\n      'This node converts between Volume units Litre (L), Cubic Metre (m), Cubic Foot (ft), and Gallon (gal).  Input type can be selected from settings. Outputs will change based on selected input type.';\n    this.addInput('L', Type.NUMBER);\n    this.addOutput('M', Type.NUMBER);\n    this.addOutput('ft', Type.NUMBER);\n    this.addOutput('gal', Type.NUMBER);\n    this.settings['inputType'] = {\n      description: 'Input Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'L', text: 'Litre (L)' },\n          { value: 'm', text: 'Cubic Metre (m)' },\n          { value: 'ft', text: 'Cubic Foot (ft)' },\n          { value: 'gal', text: 'Gallon (gal)' },\n        ],\n      },\n      value: 'L',\n    };\n    this.settings['precision'] = { description: 'Precision', type: SettingType.NUMBER, value: '4' };\n  }\n\n  onAdded() {\n    this.setConversionFunction();\n  }\n\n  onInputUpdated() {\n    this.onInputOrSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.setConversionFunction();\n    this.onInputOrSettingsChange();\n  }\n\n  private onInputOrSettingsChange() {\n    const input = this.getInputData(0);\n    if (!Utils.hasInput(input)) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n      this.setOutputData(2, null);\n\n      return;\n    }\n    const output = this.conversionFunction(input);\n    const precision = Math.abs(this.settings['precision'].value);\n    this.setOutputData(0, Number(output[0]).toFixed(precision));\n    this.setOutputData(1, Number(output[1]).toFixed(precision));\n    this.setOutputData(2, Number(output[2]).toFixed(precision));\n  }\n\n  private setConversionFunction() {\n    const inputType = this.settings['inputType'].value;\n    switch (inputType) {\n      case 'L':\n        this.title = 'Volume Conversion (L)';\n        this.inputs[0].name = 'L';\n        this.outputs[0].name = 'm';\n        this.outputs[1].name = 'ft';\n        this.outputs[2].name = 'gal';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 0.001;\n          outputArray[1] = input * 0.0353147;\n          outputArray[2] = input * 0.2642;\n          return outputArray;\n        };\n        break;\n      case 'm':\n        this.title = 'Volume Conversion (m)';\n        this.inputs[0].name = 'm';\n        this.outputs[0].name = 'L';\n        this.outputs[1].name = 'ft';\n        this.outputs[2].name = 'gal';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 1000;\n          outputArray[1] = input * 35.3147;\n          outputArray[2] = input * 264.2;\n          return outputArray;\n        };\n        break;\n      case 'ft':\n        this.title = 'Volume Conversion (ft)';\n        this.inputs[0].name = 'ft';\n        this.outputs[0].name = 'm';\n        this.outputs[1].name = 'L';\n        this.outputs[2].name = 'gal';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 0.0283168;\n          outputArray[1] = input * 28.3168;\n          outputArray[2] = input * 7.481;\n          return outputArray;\n        };\n        break;\n      case 'gal':\n        this.title = 'Volume Conversion (gal)';\n        this.inputs[0].name = 'gal';\n        this.outputs[0].name = 'm';\n        this.outputs[1].name = 'L';\n        this.outputs[2].name = 'ft';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 0.00378541;\n          outputArray[1] = input * 3.78541;\n          outputArray[2] = input * 0.133681;\n          return outputArray;\n        };\n        break;\n      default:\n        this.title = 'Volume Conversion (L)';\n        this.inputs[0].name = 'L';\n        this.outputs[0].name = 'm';\n        this.outputs[1].name = 'ft';\n        this.outputs[2].name = 'gal';\n        this.conversionFunction = input => {\n          const outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 0.001;\n          outputArray[1] = input * 0.0353147;\n          outputArray[2] = input * 0.2642;\n          return outputArray;\n        };\n    }\n  }\n}\nContainer.registerNodeType('hvac/volume-conversion', VolumeUnitConversionNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nconst psychrolib = require('../../lib/psychrolib');\n\nclass TempConvertNode extends Node {\n  conversionFunction;\n  psychro = new psychrolib();\n\n  constructor() {\n    super();\n    this.title = 'Temperature Conversion (C-> F)';\n    this.description =\n      'This node converts between Temperature units: Celsius, Fahrenheit, Kelvin, and Rankine .  Input type can be selected from settings. Outputs will change based on selected input type.';\n\n    this.addInput('input', Type.NUMBER);\n    this.addOutput('output', Type.NUMBER);\n    this.settings['convertType'] = {\n      description: 'Conversion Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'C_to_F', text: 'Celsius to Fahrenheit' },\n          { value: 'C_to_K', text: 'Celsius to Kelvin' },\n          { value: 'C_to_R', text: 'Celsius to Rankine' },\n          { value: 'F_to_C', text: 'Fahrenheit to Celsius' },\n          { value: 'F_to_K', text: 'Fahrenheit to Kelvin' },\n          { value: 'F_to_R', text: 'Fahrenheit to Rankine' },\n          { value: 'K_to_C', text: 'Kelvin to Celsius' },\n          { value: 'K_to_F', text: 'Kelvin to Fahrenheit' },\n          { value: 'K_to_R', text: 'Kelvin to Rankine' },\n          { value: 'R_to_C', text: 'Rankine to Celsius' },\n          { value: 'R_to_F', text: 'Rankine to Fahrenheit' },\n          { value: 'R_to_K', text: 'Rankine to Kelvin' },\n        ],\n      },\n      value: 'C_to_F',\n    };\n    this.settings['precision'] = { description: 'Precision', type: SettingType.NUMBER, value: 2 };\n  }\n\n  onAdded() {\n    this.setConversionFunction();\n  }\n\n  onInputUpdated() {\n    this.onInputOrSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.setConversionFunction();\n    this.onInputOrSettingsChange();\n  }\n\n  private onInputOrSettingsChange() {\n    const input = Number(this.getInputData(0));\n    if (!Utils.hasInput(input)) {\n      this.setOutputData(0, null);\n      return;\n    }\n    const precision = Math.abs(this.settings['precision'].value);\n    const output = Number(this.conversionFunction(input)).toFixed(precision);\n    this.setOutputData(0, output);\n  }\n\n  private setConversionFunction() {\n    const conversion = this.settings['convertType'].value;\n    console.log(conversion, ': converstion');\n    switch (conversion) {\n      case 'C_to_F':\n        this.title = 'Temperature Conversion (C-> F)';\n        this.conversionFunction = this.psychro.GetTFahrenheitFromTCelsius;\n        break;\n      case 'C_to_K':\n        this.title = 'Temperature Conversion (C-> K)';\n        console.log('C_to_K');\n        this.conversionFunction = this.psychro.GetTKelvinFromTCelsius;\n        break;\n      case 'C_to_R':\n        this.title = 'Temperature Conversion (C-> R)';\n        this.conversionFunction = this.psychro.GetTRankineFromTCelsius;\n        break;\n      case 'F_to_C':\n        this.title = 'Temperature Conversion (F-> C)';\n        this.conversionFunction = this.psychro.GetTCelsiusFromTFahrenheit;\n        break;\n      case 'F_to_K':\n        this.title = 'Temperature Conversion (F-> K)';\n        this.conversionFunction = this.psychro.GetTKelvinFromTFahrenheit;\n        break;\n      case 'F_to_R':\n        this.title = 'Temperature Conversion (F-> R)';\n        this.conversionFunction = this.psychro.GetTRankineFromTFahrenheit;\n        break;\n      case 'K_to_C':\n        this.title = 'Temperature Conversion (K-> C)';\n        this.conversionFunction = this.psychro.GetTCelsiusFromTKelvin;\n        break;\n      case 'K_to_F':\n        this.title = 'Temperature Conversion (K-> F)';\n        this.conversionFunction = this.psychro.GetTFahrenheitFromTKelvin;\n        break;\n      case 'K_to_R':\n        this.title = 'Temperature Conversion (K-> R)';\n        this.conversionFunction = this.psychro.GetTRankineFromTKelvin;\n        break;\n      case 'R_to_C':\n        this.title = 'Temperature Conversion (R-> C)';\n        this.conversionFunction = this.psychro.GetTCelsiusFromTRankine;\n        break;\n      case 'R_to_F':\n        this.title = 'Temperature Conversion (R-> F)';\n        this.conversionFunction = this.psychro.GetTFahrenheitFromTRankine;\n        break;\n      case 'R_to_K':\n        this.title = 'Temperature Conversion (R-> K)';\n        this.conversionFunction = this.psychro.GetTKelvinFromTRankine;\n        break;\n      default:\n        this.title = 'Temperature Conversion (C-> F)';\n        this.conversionFunction = this.psychro.GetTFahrenheitFromTCelsius;\n    }\n  }\n}\nContainer.registerNodeType('hvac/temperature-conversion', TempConvertNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nconst psychrolib = require('../../lib/psychrolib');\n\nclass AtmosphericPressureNode extends Node {\n  psychro = new psychrolib();\n\n  constructor() {\n    super();\n    this.title = 'Atmospheric Pressure (Meters-> Pa)';\n    this.description =\n      \"This node converts 'altitude' to Atmospheric Pressure in various units: Pascal (Pa), Standard Atmosphere (atm), Bar (bar), and Pound-force per square inch (lbf/in2) . 'altitude' units can be set from settings to be in:  Metric/SI (Meters-> Pa),  or Imperial/IP (Feet-> Psi).\";\n\n    this.addInput('altitude', Type.NUMBER);\n    this.addOutput('pressure', Type.NUMBER);\n    this.settings['units'] = {\n      description: 'Select Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'SI', text: 'Metric/SI (Meters-> Pa)' },\n          { value: 'IP', text: 'Imperial/IP (Feet-> Psi)' },\n        ],\n      },\n      value: 'SI',\n    };\n    this.settings['precision'] = { description: 'Precision', type: SettingType.NUMBER, value: 2 };\n    this.psychro.SetUnitSystem(this.psychro.SI);\n  }\n\n  onAdded() {\n    this.updateTitleAndFunction();\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    this.onInputOrSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.updateTitleAndFunction();\n    this.onInputOrSettingsChange();\n  }\n\n  private updateTitleAndFunction() {\n    const units = this.settings['units'].value;\n    if (units == 'IP') {\n      this.title = 'Atmospheric Pressure (Feet-> Psi)';\n      this.psychro.SetUnitSystem(this.psychro.IP);\n    } else {\n      this.title = 'Atmospheric Pressure (Meters-> Pa)';\n      this.psychro.SetUnitSystem(this.psychro.SI);\n    }\n  }\n\n  private onInputOrSettingsChange() {\n    const altitude = this.getInputData(0);\n    if (!Utils.hasInput(altitude)) {\n      this.setOutputData(0, null);\n      return;\n    }\n    const pressure = this.psychro.GetStandardAtmPressure(altitude);\n    const precision = Math.abs(this.settings['precision'].value);\n    this.setOutputData(0, Number(pressure).toFixed(precision));\n  }\n}\nContainer.registerNodeType('hvac/atmospheric-pressure', AtmosphericPressureNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass PressureConvertNode extends Node {\n  conversionFunction;\n  constructor() {\n    super();\n    this.title = 'Pressure Conversion (Pa)';\n    this.description =\n      'This node converts between Pressure units: Pascal (Pa), Standard Atmosphere (atm), Bar (bar), and Pound-force per square inch (lbf/in2) .  Input type can be selected from settings. Outputs will change based on selected input type.';\n    this.addInput('Pa', Type.NUMBER);\n    this.addOutput('atm', Type.NUMBER);\n    this.addOutput('bar', Type.NUMBER);\n    this.addOutput('lbf/in2', Type.NUMBER);\n    this.settings['inputType'] = {\n      description: 'Input Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'Pa', text: 'Pascal (Pa)' },\n          { value: 'atm', text: 'Standard Atmosphere (atm)' },\n          { value: 'bar', text: 'Bar (bar)' },\n          { value: 'lbf/in2', text: 'Pound-force per square inch (lbf/in2)' },\n        ],\n      },\n      value: 'Pa',\n    };\n    this.settings['precision'] = { description: 'Precision', type: SettingType.NUMBER, value: '2' };\n  }\n\n  onAdded() {\n    this.setConversionFunction();\n  }\n\n  onInputUpdated() {\n    this.onInputOrSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.setConversionFunction();\n    this.onInputOrSettingsChange();\n  }\n\n  private onInputOrSettingsChange() {\n    const input = this.getInputData(0);\n    if (!Utils.hasInput(input)) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n      this.setOutputData(2, null);\n      return;\n    }\n    const output = this.conversionFunction(input);\n    const precision = Math.abs(this.settings['precision'].value);\n    this.setOutputData(0, Number(output[0]).toFixed(precision));\n    this.setOutputData(1, Number(output[1]).toFixed(precision));\n    this.setOutputData(2, Number(output[2]).toFixed(precision));\n  }\n\n  setConversionFunction() {\n    const inputType = this.settings['inputType'].value;\n    switch (inputType) {\n      case 'Pa':\n        this.title = 'Pressure Conversion (Pa)';\n        this.inputs[0].name = 'Pa';\n        this.outputs[0].name = 'atm';\n        this.outputs[1].name = 'bar';\n        this.outputs[2].name = 'lbf/in2';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 9.8692e-6;\n          outputArray[1] = input * 1e-5;\n          outputArray[2] = input * 0.000145038;\n          return outputArray;\n        };\n        break;\n      case 'atm':\n        this.title = 'Pressure Conversion (atm)';\n        this.inputs[0].name = 'atm';\n        this.outputs[0].name = 'Pa';\n        this.outputs[1].name = 'bar';\n        this.outputs[2].name = 'lbf/in2';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 101325;\n          outputArray[1] = input * 1.01325;\n          outputArray[2] = input * 14.6959;\n          return outputArray;\n        };\n        break;\n      case 'bar':\n        this.title = 'Pressure Conversion (bar)';\n        this.inputs[0].name = 'bar';\n        this.outputs[0].name = 'Pa';\n        this.outputs[1].name = 'atm';\n        this.outputs[2].name = 'lbf/in2';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 100000;\n          outputArray[1] = input * 0.986923;\n          outputArray[2] = input * 14.5038;\n          return outputArray;\n        };\n        break;\n      case 'lbf/in2':\n        this.title = 'Pressure Conversion (lbf/in2)';\n        this.inputs[0].name = 'lbf/in2';\n        this.outputs[0].name = 'Pa';\n        this.outputs[1].name = 'atm';\n        this.outputs[2].name = 'bar';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 6894.76;\n          outputArray[1] = input * 0.068046;\n          outputArray[2] = input * 0.0689476;\n          return outputArray;\n        };\n        break;\n      default:\n        this.title = 'Pressure Conversion (Pa)';\n        this.inputs[0].name = 'Pa';\n        this.outputs[0].name = 'atm';\n        this.outputs[1].name = 'bar';\n        this.outputs[2].name = 'lbf/in2';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null];\n          outputArray[0] = input * 9.8692e-6;\n          outputArray[1] = input * 1e-5;\n          outputArray[2] = input * 0.000145038;\n          return outputArray;\n        };\n    }\n  }\n}\nContainer.registerNodeType('hvac/pressure-conversion', PressureConvertNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass ArrayBuilderNode extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.STRING;\n    this.title = 'Array Builder';\n    this.description =\n      \"Outputs an array of values based on the input values\";\n    this.addOutput('out', Type.STRING);\n  }\n\n  onAdded() {\n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let out = []\n    for (let i = this.dynamicInputStartPosition; i < this.getInputsCount(); i++) {\n      out.push(this.getInputData(i))\n    }\n    this.setOutputData(0, out);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('json/array-builder', ArrayBuilderNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport * as _ from 'lodash';\nimport { Type } from '../../node-io';\n\nexport class JSONBuilderNode extends Node {\n  filterKeys = [];\n\n  constructor() {\n    super();\n    this.title = `JSON builder`;\n    this.description = 'JSON builder';\n    this.settings['definition'] = {\n      description: 'payload definition (JSON)',\n      type: SettingType.STRING,\n      value: '',\n    };\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('output', Type.JSON);\n  }\n\n  init() {\n    this.addInputs();\n  }\n\n  onAdded() {\n    this.filterKeys = this.getFilterKeys();\n  }\n\n  onInputUpdated() {\n    let out = {};\n    for (let i = this.dynamicOutputStartPosition(); i < this.getInputsCount(); i++) {\n      out = { ...out, ...{ [this.filterKeys[i - 1]]: this.inputs[i].data } };\n    }\n    this.setOutputData(0, out);\n  }\n\n  onAfterSettingsChange() {\n    this.updateInputs();\n    this.onInputUpdated();\n  }\n\n  private updateInputs() {\n    const filterKeys = this.getFilterKeys();\n    if (_.isEqual(_.sortBy(filterKeys), _.sortBy(this.filterKeys))) {\n      return;\n    }\n    const inputsCount = this.getInputsCount();\n    for (let i = this.dynamicOutputStartPosition(); i < inputsCount; i++) {\n      this.removeInput(i);\n    }\n    this.addInputs();\n  }\n\n  private addInputs() {\n    this.filterKeys = this.getFilterKeys();\n    for (let i = 0; i < this.filterKeys.length; i++) {\n      let name = this.filterKeys[i];\n      this.addInput(name.toString(), Type.ANY);\n    }\n  }\n\n  private getFilterKeys() {\n    return this.settings['definition'].value\n      .replace(/\\s+/g, '')\n      .split(',')\n      .filter(x => !!x);\n  }\n\n  private dynamicOutputStartPosition() {\n    return 1;\n  }\n}\nContainer.registerNodeType('json/json-builder', JSONBuilderNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport { isNull, isJSON, isEmpty } from '../../../utils/helper';\n\nexport class JSONEnumBuilderNode extends Node {\n  filterKeys = [];\n\n  constructor() {\n    super();\n    this.title = `JSON enum builder`;\n    this.description = 'JSON ENUM builder';\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInputWithSettings('definition', Type.JSON, '{\"pointOne\":22, \"pointTwo\":33}', 'JSON value');\n    this.addOutput('output', Type.ANY);\n    this.addOutput('valid-json', Type.BOOLEAN);\n    this.settings['json'] = {\n      description: 'Select output',\n      type: SettingType.DROPDOWN,\n      value: '',\n    };\n  }\n\n  onAdded() {\n    this.onAfterSettingsChange()\n  }\n\n  onInputUpdated() {\n    this.getInputData(0);\n    this.onAfterSettingsChange()\n  }\n\n  onAfterSettingsChange() {\n    const input = this.getInputData(1);\n    if (isNull(input)) return;\n    if (isJSON(input) && !isEmpty(input)) {\n      const definition = Object.entries(input).map(\n        e => {\n          return { value: e[1], text: e[0] };\n        },\n      );\n      if (definition) {\n        this.settings['json'].config = {\n          items: definition,\n        };\n        const out = this.settings['json'].value\n        this.setOutputData(0, out);\n        this.setOutputData(1, true);\n        this.broadcastSettingsToClients();\n      }\n    } else this.setOutputData(1, false);\n  }\n\n\n\n\n}\nContainer.registerNodeType('json/json-enum-builder', JSONEnumBuilderNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport jsonStringCompare from '../../utils/string-json-compare-utils';\nclass JsonFilter extends Node {\n  constructor() {\n    super();\n    this.title = 'Json Filter';\n    this.description = 'Filter a json object Example: msg.myKey';\n    this.addInput('input', Type.STRING);\n    this.addOutput('output', Type.STRING);\n    this.addOutput('output-key', Type.STRING);\n    this.settings['filter'] = {\n      description: 'Example: msg.myKey',\n      value: 'myKey',\n      type: SettingType.STRING,\n    };\n  }\n\n\n  onInputUpdated() {\n    let input = this.getInputData(0);\n    if (input === null) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n      return;\n    }\n\n    try {\n      const jsonCheck = JSON.parse(input);\n      const filter = this.settings['filter'].value;\n      let out = jsonStringCompare.findVal(jsonCheck, filter);\n      this.setOutputData(0, out.value);\n      this.setOutputData(1, out.valueWithKey);\n    } catch (e) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('json/json-filter', JsonFilter);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport jsonStringCompare from '../../utils/string-json-compare-utils';\n\nenum compareType {\n  Equals = 'Equals',\n  NotEquals = 'Not Equal',\n  GreaterThanEqual = 'Greater Than Equal',\n  GreaterThan = 'Greater Than',\n  LessThanEqual = 'Less Than Equal',\n  LessThan = 'Less Than',\n  Includes = 'Includes',\n  startsWith = 'Starts With',\n  endsWith = 'Ends With'\n}\n\nclass JsonFilterCompare extends Node {\n  conversionFunction;\n  constructor() {\n    super();\n    this.title = 'Json Filter';\n    this.description =\n      \"This node provides several functions to compare a JSON object input, with a Boolean 'output'.  Available comparison functions are: Equals, Includes, Starts With, and Ends With.  The comparison function is selected from settings.\";\n\n    this.addInput('input', Type.STRING);\n    this.addInputWithSettings('comparison-to', Type.STRING, '', 'Comparison Value');\n    this.addOutput('output', Type.STRING);\n    this.addOutput('output-key', Type.STRING);\n    this.addOutput('match', Type.BOOLEAN);\n    this.settings['filter'] = {\n      description: 'Example: msg.myKey',\n      value: 'myKey',\n      type: SettingType.STRING,\n    };\n    this.settings['function'] = {\n      description: 'Comparison Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: compareType.Equals, text: compareType.Equals },\n          { value: compareType.NotEquals, text: compareType.NotEquals },\n          { value: compareType.GreaterThanEqual, text: compareType.GreaterThanEqual },\n          { value: compareType.GreaterThan, text: compareType.GreaterThan },\n          { value: compareType.LessThanEqual, text: compareType.LessThanEqual },\n          { value: compareType.LessThan, text: compareType.LessThan },\n          { value: compareType.Includes, text: compareType.Includes },\n          { value: compareType.startsWith, text: compareType.startsWith },\n          { value: compareType.endsWith, text: compareType.endsWith },\n        ],\n      },\n      value: compareType.Equals,\n    };\n    this.settings['isNumber'] = {\n      description: 'Comparison value is a number',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['passNull'] = {\n      description: 'Send null if not a match',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  onAdded() {\n  this.onAfterSettingsChange()\n  }\n\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    if (input === null || input === undefined) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n      this.setOutputData(2, null);\n      return;\n    }\n    try {\n      const jsonCheck = JSON.parse(input);\n      const filter = this.settings['filter'].value;\n      let out = jsonStringCompare.findVal(jsonCheck, filter);\n      const string2 = this.getInputData(1);\n      if (jsonStringCompare.compare(this, out.value, string2)) {\n        this.setOutputData(0, out.value);\n        this.setOutputData(1, out.valueWithKey);\n        this.setOutputData(2, true);\n      } else if (this.settings['passNull'].value === true) {\n        this.setOutputData(0, null);\n        this.setOutputData(1, null);\n        this.setOutputData(2, false);\n      } else this.setOutputData(2, false);\n    } catch (e) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n      this.setOutputData(2, true);\n    }\n  }\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n    const inputType = this.settings['function'].value\n    const title = \"Json Comparison\"\n    this.title = `${title} Compare (${inputType})`;\n    this.broadcastTitleToClients();\n  }\n\n}\nContainer.registerNodeType('json/json-filter-compare', JsonFilterCompare);\n","import * as _ from 'lodash';\n\nimport { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass JsonFilterMultiple extends Node {\n  filterKeys: Array<string> = [];\n\n  constructor() {\n    super();\n    this.title = 'Json Filter Multiple';\n    this.description =\n      'Filter a json object to multiple outputs. There are two Output Update options for whether ' +\n      'you want to update all keys or not (ALL: update as `null` when the key value will not be on the JSON, FOUND: ' +\n      \"don't update values and leave as is when key key value doesn't exist\";\n\n    this.addInput('input', Type.STRING);\n    this.addOutput('error', Type.STRING);\n    this.settings['filter'] = {\n      description: 'Example: key1.innerKey1, key2, key2.innerKey2',\n      value: '',\n      type: SettingType.STRING,\n    };\n    this.settings['outputsUpdate'] = {\n      description: 'Outputs Update',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'ALL', text: 'ALL' },\n          { value: 'FOUND', text: 'FOUND' },\n        ],\n      },\n      value: 'ALL',\n    };\n  }\n\n  init() {\n    this.addOutputs();\n  }\n\n  onAdded() {\n    this.filterKeys = this.getFilterKeys();\n    this.onAfterSettingsChange();\n  }\n\n  onInputUpdated() {\n    let input = this.getInputData(0);\n    if (input == null) {\n      this.setOutputData(0, null);\n      return;\n    }\n    try {\n      input = JSON.parse(input);\n      for (let i = 0; i < this.filterKeys.length; i++) {\n        let out = _.get(input, this.filterKeys[i]);\n        if (out !== undefined) {\n          this.setOutputData(i + this.dynamicOutputStartPosition(), out);\n        } else if (this.settings['outputsUpdate'].value === 'ALL') {\n          this.setOutputData(i + this.dynamicOutputStartPosition(), null);\n        }\n      }\n      this.setOutputData(0, null);\n    } catch (e) {\n      this.setOutputData(0, e.toString());\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.updateOutputs();\n    this.updateNodeOutput();\n    this.updateOutputsLabels();\n    this.broadcastOutputsToClients();\n\n    this.onInputUpdated();\n  }\n\n  private updateOutputs() {\n    const filterKeys = this.getFilterKeys();\n    if (_.isEqual(_.sortBy(filterKeys), _.sortBy(this.filterKeys))) {\n      return;\n    }\n    const outputsCount = this.getOutputsCount();\n    for (let i = this.dynamicOutputStartPosition(); i < outputsCount; i++) {\n      this.removeOutput(i);\n    }\n    this.addOutputs();\n  }\n\n  private addOutputs() {\n    this.filterKeys = this.getFilterKeys();\n    for (let i = 0; i < this.filterKeys.length; i++) {\n      this.addOutput(this.filterKeys[i], Type.ANY);\n    }\n  }\n\n  private getFilterKeys() {\n    return this.settings['filter'].value\n      .replace(/\\s+/g, '')\n      .split(',')\n      .filter(x => !!x);\n  }\n\n  private dynamicOutputStartPosition() {\n    return 1;\n  }\n}\nContainer.registerNodeType('json/json-filter-multiple', JsonFilterMultiple);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass JsonCheckerNode extends Node {\n  constructor() {\n    super();\n    this.title = 'JSON Checker';\n    this.description = `Checks 'input' for valid JSON format string.`;\n    this.addInput('input', Type.STRING)\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('msg', Type.STRING);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  isJson(item: any): boolean {\n    item = typeof item !== 'string' ? JSON.stringify(item) : item;\n\n    try {\n      item = JSON.parse(item);\n    } catch (e) {\n      return false;\n    }\n\n    if (typeof item === 'object' && item !== null) {\n      return true;\n    }\n\n    return false;\n  }\n\n  onInputUpdated() {\n    const val = this.getInputData(0);\n    try {\n      if (this.isJson(val)) {\n        this.setOutputData(0, true);\n        this.setOutputData(1, 'valid JSON');\n      } else { \n        this.setOutputData(0, false);\n        this.setOutputData(1, 'invalid JSON');\n      }\n    } catch (err) {\n      this.setOutputData(0, false);\n      this.setOutputData(1, err);\n    }\n  }\n}\nContainer.registerNodeType('json/json-checker', JsonCheckerNode);\n","import { Node } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport { isNull } from '../../../utils/helper';\n\nclass JsonParse extends Node {\n  constructor() {\n    super();\n    this.title = 'Json Parse';\n    this.description = 'Return JSON.stringify or a JSON.parse';\n    this.addInput('json-input', Type.JSON);\n    this.addOutput('output', Type.JSON);\n  }\n\n  onInputUpdated() {\n    let input = this.getInputData(0);\n    if (isNull(input)) return;\n    try {\n      this.setOutputData(0, input);\n    } catch (err) {\n      this.debugInfo(`JSON PARSE: try/catch , ${err}`);\n    };\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('json/json-parse', JsonParse);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass AnyLatchNode extends Node {\n  lastLatchValue: boolean;\n\n\n  constructor() {\n    super();\n    this.title = 'Any data type Latch';\n    this.description =\n      \"The 'input' value (Input value can be any data type) is passed to 'output' when 'latch' transitions from 'false' to 'true'; The 'output' value is maintained until the next 'false' to 'true' transition.\";\n\n    this.addInput('input', Type.ANY);\n    this.addInput('latch', Type.BOOLEAN);\n    this.addOutput('output', Type.ANY);\n    this.settings['passOnly'] = {\n      description: 'Only if input value is updated',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const passOnly = this.settings['passOnly'].value\n    let latch = this.getInputData(1);\n    if (latch == null) {\n      if (passOnly) {\n        this.setOutputData(0, null);\n      } else this.setOutputData(0, null);\n      return;\n    }\n    if (latch == this.lastLatchValue) return;\n    this.lastLatchValue = latch;\n    if (latch == true) {\n      let input = this.getInputData(0);\n      if (!Utils.hasInput(input)) {\n        if (passOnly) {\n          this.setOutputData(0, null);\n        } else this.setOutputData(0, null);\n        return;\n      }\n      if (input === '') input = null;\n      if (passOnly) {\n        this.setOutputData(0, input);\n      } else this.setOutputData(0, input);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('latch/any-latch', AnyLatchNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass BoolLatchNode extends Node {\n  lastLatchValue: boolean;\n\n\n  constructor() {\n    super();\n    this.title = 'Boolean Latch';\n    this.description =\n      \"The Boolean 'input' value is passed to 'output' when 'latch' transitions from 'false' to 'true'; The 'output' value is maintained until the next 'false' to 'true' transition.\";\n\n    this.addInput('input', Type.BOOLEAN);\n    this.addInput('latch', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.setOutputData(0, false);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n  \n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let latch = this.getInputData(1);\n    if (latch == null) {\n      this.setOutputData(0, null);\n      return;\n    }\n    if (latch == this.lastLatchValue) return;\n    this.lastLatchValue = latch;\n    if (latch == true) {\n      let input = this.getInputData(0);\n      if (!Utils.hasInput(input)) {\n        this.setOutputData(0, null);\n        return;\n      }\n      this.setOutputData(0, input);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('latch/bool-latch', BoolLatchNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass NumLatchNode extends Node {\n  lastLatchValue: boolean;\n\n\n  constructor() {\n    super();\n    this.title = 'Numeric Latch';\n    this.description =\n      \"The Numeric 'input' value is passed to 'output' when 'latch' transitions from 'false' to 'true'; The 'output' value is maintained until the next 'false' to 'true' transition.\";\n\n    this.addInput('input', Type.NUMBER);\n    this.addInput('latch', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let latch = this.getInputData(1);\n    if (latch == null) {\n      this.setOutputData(0, null);\n      return;\n    }\n    if (latch == this.lastLatchValue) return;\n    this.lastLatchValue = latch;\n    if (latch == true) {\n      let input = this.getInputData(0);\n      if (!Utils.hasInput(input)) {\n        this.setOutputData(0, null);\n        return;\n      }\n      if (input === '') input = null;\n      this.setOutputData(0, input);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('latch/num-latch', NumLatchNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass StringLatchNode extends Node {\n  lastLatchValue: boolean;\n\n\n  constructor() {\n    super();\n    this.title = 'String Latch';\n    this.description =\n      \"The String 'input' value is passed to 'output' when 'latch' transitions from 'false' to 'true'; The 'output' value is maintained until the next 'false' to 'true' transition.\";\n\n    this.addInput('input', Type.STRING);\n    this.addInput('latch', Type.BOOLEAN);\n    this.addOutput('output', Type.STRING);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let latch = this.getInputData(1);\n    if (latch == null) {\n      this.setOutputData(0, null);\n      return;\n    }\n    if (latch == this.lastLatchValue) return;\n    this.lastLatchValue = latch;\n    if (latch == true) {\n      let input = this.getInputData(0);\n      if (!Utils.hasInput(input)) {\n        this.setOutputData(0, null);\n        return;\n      }\n      if (input === '') input = null;\n      this.setOutputData(0, input);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('latch/string-latch', StringLatchNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass SetResetNode extends Node {\n  out = null;\n\n\n  constructor() {\n    super();\n\n    this.title = 'Set Reset';\n    this.description =\n      \"'output' will change to 'true' when 'set' is 'true', and 'reset' is 'false'.  There are 2 cases when 'output' will change to 'false': 1) 'reset' is 'true', and 'set is 'false'.  2) If the 'Reset when set=true' setting is turned ON (Default), and 'reset' and 'set' are both 'true' .  If this setting is turned OFF, 'output' will only change to 'false' under Case 1) conditions. \";\n\n    this.addInput('set', Type.BOOLEAN);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.settings['lock'] = {\n      description: 'Reset when set=true',\n      value: true,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  onAdded() {\n \n    this.setOutputData(0, false);\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let set = this.inputs[0].data;\n    let reset = this.inputs[1].data;\n    let lock = this.settings['lock'].value;\n    let out = this.out;\n    if (set && !reset) {\n      this.setOutputData(0, true);\n      this.out = true;\n    } else if (lock && reset && out && set) {\n      //when lock = true\n      this.setOutputData(0, false);\n      this.out = false;\n    } else if (!set && out && reset) {\n      //when lock = false\n      this.setOutputData(0, false);\n      this.out = false;\n    }\n  }\n}\nContainer.registerNodeType('latch/set-reset', SetResetNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass AddNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    this.title = 'Add';\n    this.description =\n      \"('output' = 'in 1' + 'in 2' + ...) 'output' is the result of adding of all Numeric inputs. Input values can be set from settings. The number of inputs is configurable from settings.\";\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const inputCount = this.getInputsCount();\n    let total = 0;\n    for (let i = this.dynamicInputStartPosition; i < inputCount; i++) {\n      total = total + this.getInputData(i);\n    }\n    this.setOutputData(0, total);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('math/add', AddNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass MathSubNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    this.title = 'Subtract';\n    this.description =\n      \"('output' = 'in 1' - 'in 2' - ...)  'output' is the result of subtracting each Numeric input in order. Input values can be set from settings. The number of inputs is configurable from settings.\";\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const inputCount = this.getInputsCount();\n    let total = this.getInputData(0);\n    for (let i = this.dynamicInputStartPosition + 1; i < inputCount; i++) {\n      total = total - this.getInputData(i);\n    }\n    this.setOutputData(0, total);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('math/subtract', MathSubNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass MathMultiplyNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    this.title = 'Multiply';\n    this.description =\n      \"('output' = 'in 1' * 'in 2' * ...)  'output' is the result of multiplying each Numeric input in order. Input values can be set from settings. The number of inputs is configurable from settings.\";\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const inputCount = this.getInputsCount();\n    let total = 1;\n    for (let i = this.dynamicInputStartPosition; i < inputCount; i++) {\n      total = total * this.getInputData(i);\n    }\n    this.setOutputData(0, total);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('math/multiply', MathMultiplyNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass MathDivideNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    this.title = 'Divide';\n    this.description =\n      \"('output' = 'in 1' / 'in 2' / ...)  'output' is the result of dividing each Numeric input in order. Input values can be set from settings. The number of inputs is configurable from settings.\";\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const inputCount = this.getInputsCount();\n    let total = 1;\n    let div = 0;\n    for (let i = this.dynamicInputStartPosition; i < inputCount; i++) {\n      div = this.getInputData(i);\n      if (!div) {\n        // when it's 0 or null\n        this.setOutputData(0, 0);\n        return;\n      }\n      if (i === this.dynamicInputStartPosition) {\n        total = div;\n      } else {\n        total = total / div;\n      }\n    }\n    this.setOutputData(0, total);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('math/divide', MathDivideNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport Icons from '../../node-icons';\nimport { Type } from '../../node-io';\n\nlet uiMainIcon = Icons.uiMainIcon;\nlet uiMainColour = Icons.uiMainColour;\n\nclass MathAbsNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Absolute';\n    this.description =\n      \"('output' = |'in 1'|) 'output' is the absolute value (positive) of the Numeric input.\";\n    //this.headerColor = uiMainIcon;\n    //this.iconImageUrl = uiMainIcon;\n\n    this.addInput('input', Type.NUMBER);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val != null) this.setOutputData(0, Math.abs(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math/absolute', MathAbsNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathModulusNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Modulus';\n    this.description =\n      \"('output' = 'in 1' % 'in 2') 'output' is the modulus of the Numeric inputs. Input values can be set from settings.\";\n    this.addInputWithSettings('in 1', Type.NUMBER, 0, 'in 1');\n    this.addInputWithSettings('in 2', Type.NUMBER, 1, 'in 2');\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const a = this.getInputData(0);\n    const b = this.getInputData(1);\n\n    if (a != null && b != null) this.setOutputData(0, a % b);\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math/modulus', MathModulusNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathPowNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Power';\n    this.description =\n      \"('output' = 'in 1' ^ 'in 2') 'output' is the result of 'in 1' to the power of 'in 2'. Input values can be set from settings.\";\n\n    this.addInputWithSettings('in 1', Type.NUMBER, 0, 'in 1');\n    this.addInputWithSettings('in 2', Type.NUMBER, 1, 'in 2');\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let x = this.getInputData(0);\n    let y = this.getInputData(1);\n    if (x != null && y != null) this.setOutputData(0, Math.pow(x, y));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math/power', MathPowNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathAcosNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Acos';\n    this.description =\n      \"'acos(x)' is the result of arccos('x').  The Inverse Cosine function of input 'x'.\";\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('acos(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n\n    if (val != null) this.setOutputData(0, Math.acos(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/acos', MathAcosNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathAsinNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Asin';\n    this.description =\n      \"'asin(x)' is the result of arcsin('x').  The Inverse Sine function of input 'x'.\";\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('asin(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n\n    if (val != null) this.setOutputData(0, Math.asin(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/asin', MathAsinNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathAtanNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Atan';\n    this.description =\n      \"'atan(x)' is the result of arctan('x').  The Inverse Tangent function of input 'x'.\";\n\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('atan(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n\n    if (val != null) this.setOutputData(0, Math.atan(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/atan', MathAtanNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathCbrtNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Cbrt';\n    this.description = \"'cbrt(x)' is the Cubic Root of input 'x'.\";\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('cbrt(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n\n    if (val != null) this.setOutputData(0, Math.cbrt(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/cbrt', MathCbrtNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathCosNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Cos';\n    this.description = \"'cos(x)' is the result of cos('x').  The Cosine function of input 'x'.\";\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('cos(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val != null) this.setOutputData(0, Math.cos(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/cos', MathCosNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathExpNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Exp';\n    this.description =\n      \"('exp(x)' = E^'x') 'exp(x)' is the result of raising E (Euler's Number 2.71828) to the power of 'x'.  The Natural Exponential function.\";\n\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('exp(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val != null) this.setOutputData(0, Math.exp(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/exp', MathExpNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathLogarithmNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Logarithm (Base E)';\n    this.description =\n      \"'log(x)' is the result of log('x') with base E (Euler's Number 2.71828).  The Natural Logarithmic function of input 'x'.\";\n\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('log(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val != null) this.setOutputData(0, Math.log(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/log', MathLogarithmNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathLogarithmNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Logarithm (Base 10)';\n    this.description = \"'log10(x)' is the result of log('x') with base 10.\";\n\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('log10(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val != null) this.setOutputData(0, Math.log10(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/log10', MathLogarithmNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathSinNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Sin';\n    this.description = \"'sin(x)' is the result of sin('x').  The Sine function of input 'x'.\";\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('sin(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val != null) this.setOutputData(0, Math.sin(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/sin', MathSinNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathSqrtNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Sqrt';\n    this.description = \"'sqrt(x)' is the Square Root of input 'x'.\";\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('sqrt(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val != null) this.setOutputData(0, Math.sqrt(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/sqrt', MathSqrtNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathTanNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Tan';\n    this.description = \"'tan(x)' is the result of tan('x').  The Tangent function of input 'x'.\";\n    this.addInput('x', Type.NUMBER);\n    this.addOutput('tan(x)', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val != null) this.setOutputData(0, Math.tan(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('math-advanced/tan', MathTanNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass TriggerAddNode extends FlexibleNode {\n  lastTrigger: boolean;\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    super.dynamicInputStartPosition = 1;\n    this.title = 'Trigger Add';\n    this.description =\n      \"When 'trigger' transitions from 'false' to 'true', 'output' is updated with the result of the addition of all inputs ('in 1' + 'in 2' + ...). Input values can be set from settings. The number of inputs is configurable from settings.\";\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.size = this.computeSize();\n    this.lastTrigger = false;\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const trigger = this.getInputData(0);\n    if (trigger && !this.lastTrigger) {\n      const inputCount = this.getInputsCount();\n      let total = 0;\n      for (let i = this.dynamicInputStartPosition; i < inputCount; i++) {\n        total += this.getInputData(i);\n      }\n      this.setOutputData(0, total);\n    }\n    this.lastTrigger = trigger;\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('math-trigger/trigger-add', TriggerAddNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass MathTriggerSubNode extends FlexibleNode {\n  lastTrigger: boolean;\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    super.dynamicInputStartPosition = 1;\n    this.title = 'Trigger Subtract';\n    this.description =\n      \"When 'trigger' transitions from 'false' to 'true', 'output' is updated with the result of the subtraction of all inputs ('in 1' - 'in 2' - ...). Input values can be set from settings. The number of inputs is configurable from settings.\";\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.lastTrigger = false;\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const trigger = this.getInputData(0);\n    if (trigger && !this.lastTrigger) {\n      const inputCount = this.getInputsCount();\n      let total = this.getInputData(1);\n      for (let i = this.dynamicInputStartPosition + 1; i < inputCount; i++) {\n        total -= this.getInputData(i);\n      }\n      this.setOutputData(0, total);\n    }\n    this.lastTrigger = trigger;\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('math-trigger/trigger-subtract', MathTriggerSubNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass MathTriggerMultiplyNode extends FlexibleNode {\n  lastTrigger: boolean;\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    super.dynamicInputStartPosition = 1;\n    this.title = 'Trigger Multiply';\n    this.description =\n      \"When 'trigger' transitions from 'false' to 'true', 'output' is updated with the result of the multiplication of all inputs ('in 1' * 'in 2' * ...). Input values can be set from settings. The number of inputs is configurable from settings.\";\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.size = this.computeSize();\n    this.lastTrigger = false;\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const trigger = this.getInputData(0);\n    if (trigger && !this.lastTrigger) {\n      const inputCount = this.getInputsCount();\n      let total = 1;\n      for (let i = this.dynamicInputStartPosition; i < inputCount; i++) {\n        total *= this.getInputData(i);\n      }\n      this.setOutputData(0, total);\n    }\n    this.lastTrigger = trigger;\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('math-trigger/trigger-multiply', MathTriggerMultiplyNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass MathTriggerDivideNode extends FlexibleNode {\n  lastTrigger: boolean;\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    super.dynamicInputStartPosition = 1;\n    this.title = 'Trigger Divide';\n    this.description =\n      \"When 'trigger' transitions from 'false' to 'true', 'output' is updated with the result of the division of all inputs ('in 1' / 'in 2' / ...). Input values can be set from settings. The number of inputs is configurable from settings.\";\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.size = this.computeSize();\n    this.lastTrigger = false;\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const trigger = this.getInputData(0);\n    if (trigger && !this.lastTrigger) {\n      const inputCount = this.getInputsCount();\n      let total = 1;\n      let div = 0;\n      for (let i = this.dynamicInputStartPosition; i < inputCount; i++) {\n        div = this.getInputData(i);\n        if (div === 0) {\n          this.setOutputData(0, 0);\n          return;\n        }\n        if (i === this.dynamicInputStartPosition) {\n          total = div;\n        } else {\n          total = total / div;\n        }\n      }\n      this.setOutputData(0, total);\n    }\n    this.lastTrigger = trigger;\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('math-trigger/trigger-divide', MathTriggerDivideNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathTriggerModulusNode extends Node {\n  lastTrigger: boolean;\n  constructor() {\n    super();\n\n    this.title = 'Trigger Modulus';\n    this.description =\n      \"When 'trigger' transitions from 'false' to 'true', 'output' is updated with the result of the modulus of the inputs ('in 1' % 'in 2'). Input values can be set from settings. \";\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInputWithSettings('in 1', Type.NUMBER, 0, 'in 1');\n    this.addInputWithSettings('in 2', Type.NUMBER, 2, 'in 2');\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.lastTrigger = false;\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const trigger = this.getInputData(0);\n    if (trigger && !this.lastTrigger) {\n      let a = this.getInputData(1);\n      let b = this.getInputData(2);\n\n      if (a != null && b != null) this.setOutputData(0, a % b);\n      else this.setOutputData(0, null);\n    }\n    this.lastTrigger = trigger;\n  }\n\n  dynamicInputStartPosition(): number {\n    return 1;\n  }\n}\nContainer.registerNodeType('math-trigger/trigger-modulus', MathTriggerModulusNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n//import Icons from '../../node-icons';\n\n//let uiMainIcon = Icons.uiMainIcon;\n//let uiMainColour = Icons.uiMainColour;\n\nclass MathTriggerPowNode extends Node {\n  lastTrigger: boolean;\n  constructor() {\n    super();\n\n    this.title = 'Trigger Power';\n    this.description =\n      \"When 'trigger' transitions from 'false' to 'true', 'output' is updated with the result of 'in1' to the power of 'in2' ('in 1' ^ 'in 2'). Input values can be set from settings. \";\n\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInputWithSettings('in 1', Type.NUMBER, 0, 'in 1');\n    this.addInputWithSettings('in 2', Type.NUMBER, 2, 'in 2');\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.lastTrigger = false;\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const trigger = this.getInputData(0);\n    if (trigger && !this.lastTrigger) {\n      const x = this.getInputData(1);\n      const y = this.getInputData(2);\n\n      if (x != null && y != null) this.setOutputData(0, Math.pow(x, y));\n      else this.setOutputData(0, null);\n    }\n    this.lastTrigger = trigger;\n  }\n\n  dynamicInputStartPosition(): number {\n    return 1;\n  }\n}\nContainer.registerNodeType('math-trigger/trigger-power', MathTriggerPowNode);\n","import { SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nexport class NumSeriesGenerator extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicOutputsExist = true;\n    this.dynamicInputsExist = false;\n    this.dynamicSettingsExist = true;\n    super.dynamicOutputsType = Type.NUMBER;\n    this.title = 'Numeric Series Generator';\n    this.description = \"\";\n    this.addInputWithSettings('startVal', Type.NUMBER, 0, 'Start Value');\n    this.addInputWithSettings('addVal', Type.NUMBER, 1, 'Added Value ');\n    this.settings['factor'] = {\n      description: 'Multiply factor',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n  }\n\n  onInputUpdated() {\n    let input = this.getInputData(0);\n    let factor = this.settings['factor'].value; \n    if (typeof input === 'undefined') return;\n    if (typeof input === 'number') {\n      const len = this.getOutputsCount();\n      let diff = this.getInputData(1);\n      if (typeof diff !== 'number') diff = 1;\n      for (let i = 0; i < len; i++) {\n        this.setOutputData(i, i + (input * diff) + (i * factor));\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated()\n  }\n}\nContainer.registerNodeType('miscellaneous/num-series-generator', NumSeriesGenerator);\n","import { Container } from '../../container';\nimport { Node, SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass AddressHelperString extends Node {\n  client: any;\n  outputsCount = 0;\n  constructor() {\n    super();\n    this.title = 'Append To Strings';\n    this.description =\n      \"\";\n\n    this.addInputWithSettings('prepend', Type.STRING, '', 'Prepend Value');\n    this.addInputWithSettings('append', Type.STRING, '', 'Append Value');\n\n    this.settings['outputs_count'] = {\n      description: 'Number of Outputs',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n\n    this.setSettingsConfig({\n      groups: [{ outputs_count: {} }],\n    });\n  }\n\n  init() {\n    this.changeOutputsAndSettings();\n  }\n\n  onCreated() {\n    this.renameInputsOutputs();\n  }\n\n  onAdded() {\n    this.outputsCount = this.settings['outputs_count'].value;\n    this.onAfterSettingsChange()\n  }\n\n  onInputUpdated(){\n    this.renameInputsOutputs();\n  }\n\n  onAfterSettingsChange() {\n    this.changeOutputsAndSettings();\n    this.renameInputsOutputs();\n    //update db\n    if (this.container.db)\n      this.container.db.updateNode(this.id, this.container.id, {\n        $set: { outputs: this.outputs, settings: this.settings },\n      });\n  }\n\n  private changeOutputsAndSettings() {\n    let outputs = this.settings['outputs_count'].value;\n    outputs = Utils.clamp(outputs, 1, 100);\n    this.settings['outputs_count'].value = outputs;\n    // change outputs count\n    if (this.outputsCount != outputs) this.changeMyOutputsCount(outputs);\n  }\n\n  changeMyOutputsCount(target_count) {\n    const diff = target_count - this.outputsCount;\n    if (diff == 0) return;\n\n    // add inputs, outputs\n    this.changeOutputsCount(target_count + 1, Type.STRING);\n\n    // change settings for outputs\n    if (diff > 0) {\n      for (let i = this.outputsCount + 1; i <= target_count; i++) {\n        this.settings['output' + i] = {\n          description: 'Output ' + i,\n          value: '',\n          type: SettingType.STRING,\n        };\n        for (let i = this.outputsCount + 1; i <= target_count; i++) {\n          this.settingConfigs.groups.push({\n            [`output${i}`]: { weight: 5 },\n          });\n        }\n      }\n    } else if (diff < 0) {\n      for (let i = this.outputsCount; i > target_count; i--) {\n        delete this.settings['output' + i];\n        this.settingConfigs.groups.pop();\n      }\n    }\n\n    this.outputsCount = target_count;\n  }\n\n  renameInputsOutputs() {\n    const prepend = this.getInputData(0);\n    const append = this.getInputData(1);\n    for (let i = 1; i <= this.outputsCount; i++) {\n      const output = this.settings['output' + i].value || '';\n      this.outputs[i].name = '' + i + ' | ' + output;\n      this.setOutputData(i, '' + prepend + output + append);\n    }\n  }\n}\nContainer.registerNodeType('miscellaneous/append-to-strings', AddressHelperString);\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport axios from 'axios';\nimport CryptoUtils from '../../utils/crypto-utils';\nimport TimeUtils from '../../utils/time-utils';\n\nclass NubeLoginNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Login';\n    this.description =\n      \"This node is used to authenticate with Nube devices.  Once successfully authenticated, the other Nube-API nodes will have their settings updated with values from the connected Nube devices. Host setting is the IP address of the Nube controller to connect to.  Port setting is the port at Host (standard port is 4000). Username setting is the username for the Host (standard is admin).  Password setting is the password for the Host; this password is supplied with each Nube controller.  Interval is the authentication frequency (minimum 10 mins). 'interval units can be configured from settings.  Maximum interval setting is 587 hours.\";\n\n    this.settings['host'] = { description: 'Host', value: '', type: SettingType.STRING };\n    this.settings['port'] = { description: 'Port', value: '', type: SettingType.STRING };\n    this.settings['username'] = { description: 'Username', value: '', type: SettingType.STRING };\n    this.settings['password'] = { description: 'Password', value: '', type: SettingType.PASSWORD };\n\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInputWithSettings('interval', Type.NUMBER, 10, 'Interval(minimum 10 minutes)', false);\n    this.addOutput('jwt', Type.STRING);\n    this.addOutput('error', Type.STRING);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'minutes',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n  }\n\n  onAdded() {\n    this.setExecuteInterval();\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n  }\n\n  async onInputUpdated() {\n    this.setExecuteInterval();\n    let trigger = this.getInputData(0);\n    if (trigger && this.inputs[0].updated) {\n      await this.getJwtToken();\n    }\n  }\n\n  async onExecute() {\n    if (this.side !== Side.server) return;\n    await this.getJwtToken();\n  }\n\n  async onAfterSettingsChange() {\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.setExecuteInterval();\n    await this.getJwtToken();\n  }\n\n  setExecuteInterval() {\n    let interval = this.getInputData(1);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    interval = Math.max(interval, 600000);\n    this.EXECUTE_INTERVAL = interval;\n  }\n\n  onRemoved() {\n    if (this.side !== Side.server) return; // only execute on server\n    return new Promise((resolve, reject) => {\n      this.container &&\n        this.container.db.removeUser({ nodeId: this.id }, err => {\n          if (err) {\n            reject(err);\n          } else {\n            resolve();\n          }\n        });\n    });\n  }\n\n  private async getJwtToken(): Promise<any> {\n    if (this.side !== Side.server) return;\n    const host = this.settings['host'].value;\n    const port = this.settings['port'].value;\n    const url = `${Utils.buildUrl(host, port)}/user/login`;\n\n    const username = this.settings['username'].value;\n    const password = this.settings['password'].value;\n    const body = { username, password: CryptoUtils.decrypt(password) };\n    try {\n      const res = await axios.post(url, body);\n      const query = { nodeId: this.id };\n      const user = {\n        jwt: res.data.token,\n        host,\n        port,\n        nodeId: this.id,\n      };\n      await this.container.db.addOrUpdateUser(query, user);\n      this.setOutputData(0, res.data.token);\n      this.setOutputData(1, null);\n    } catch (e) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, e.message);\n      await this.onRemoved();\n    }\n    return;\n  }\n}\n\nContainer.registerNodeType('nube/login', NubeLoginNode);\n","module.exports = require(\"crypto-js\");","import { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport BasePointNode from './base-point';\nimport { SettingType} from '../../node';\nimport { User } from '../../../database/models/user';\nimport TimeUtils from '../../utils/time-utils';\n\nclass NubeAPIInputPoint extends BasePointNode {\n  constructor() {\n    super();\n    this.dynamicInputsExist = false;\n    this.dynamicOutputsExist = false;\n    this.dynamicSettingsExist = false;\n    this.title = 'Nube API Input';\n    this.description =\n      \"This node is used to fetch point values from Nube devices.  Once the nube/login node is successfully authenticated, the API-Input nodes will have their settings updated with values from the connected Nube devices. Connected Nube devices can be selected from the Select URL setting dropdown.  Select Point setting dropdown will be populated with the available points from the selected URL.  Ticking the Show Advanced Options setting will add outputs to the node with extra information about the selected point.   Interval is the update frequency (minimum 1 second). 'interval units can be configured from settings.  Maximum interval setting is 587 hours.\";\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInputWithSettings('interval', Type.NUMBER, 5, 'Interval (minimum 1 second)', false);\n    this.addOutput('name', Type.STRING);\n    this.addOutput('value', Type.STRING);\n    this.addOutput('lastUpdate', Type.STRING);\n    this.addOutput('error', Type.STRING);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n    this.settings['advancedSetting'] = {\n      description: 'Show Advanced Options',\n      value: this.advancedSetting,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  init() {\n    super.init();\n    this.updateNodeOutputs();\n  }\n\n  onAdded() {\n    super.onAdded();\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.setExecuteInterval();\n  }\n\n  async reload(): Promise<any> {\n    try {\n      const user: User = await this.fetchConnection();\n      const point = await this.fetchPoints(user);\n      const data = await this.fetchPointValue(user, point);\n      this.setOutputs(data);\n    } catch (e) {\n      this.setErrorOutputs(e.message);\n    }\n    return null;\n  }\n\n  async onExecute() {\n    if (this.side !== Side.server) return;\n    await this.reload();\n  }\n\n  async onAfterSettingsChange() {\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    if (this.side !== Side.server) {\n      return;\n    }\n    this.setExecuteInterval();\n    this.updateNodeOutputs();\n    this.updateNodeOutput();\n    this.broadcastOutputsToClients();\n    await super.onInputUpdated();\n  }\n\n  async onInputUpdated() {\n    if (this.side !== Side.server) return;\n    this.setExecuteInterval();\n    let trigger = this.getInputData(0);\n    if (trigger && this.inputs[0].updated) {\n      await this.reload();\n    }\n    // are these next 2 lines useful?\n    this.updateTitle();\n    this.broadcastTitleToClients();\n  }\n\n  setExecuteInterval() {\n    let interval = this.getInputData(1);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    interval = Math.max(interval, 1000);\n    this.EXECUTE_INTERVAL = interval;\n  }\n\n  updateTitle() {\n    if (this.settings['point'].value)\n      this.title = `Nube API Input (${this.settings['point'].value})`;\n    else this.title = 'Nube API Input (unconfigured)';\n  }\n\n  updateNodeOutputs() {\n    this.advancedSetting = this.settings['advancedSetting'].value;\n    if (this.advancedSetting && !this.previousAdvancedSetting) {\n      this.removeOutput(3);\n      this.addOutput('unit', Type.STRING);\n      this.addOutput('kind', Type.STRING);\n      this.addOutput('type', Type.STRING);\n      this.addOutput('scale', Type.STRING);\n      this.addOutput('historyType', Type.STRING);\n      this.addOutput('asObject', Type.JSON);\n      this.addOutput('error', Type.STRING);\n    } else if (!this.advancedSetting && this.previousAdvancedSetting) {\n      this.removeOutput(3);\n      this.removeOutput(4);\n      this.removeOutput(5);\n      this.removeOutput(6);\n      this.removeOutput(7);\n      this.removeOutput(8);\n      this.removeOutput(9);\n      this.addOutput('error', Type.STRING);\n    }\n    this.previousAdvancedSetting = this.advancedSetting;\n  }\n\n  setOutputs(data) {\n    if (this.advancedSetting) {\n      this.setOutputData(0, data.name, true);\n      this.setOutputData(1, data.value, true);\n      this.setOutputData(2, this.formattedExecutionTime());\n      this.setOutputData(3, data.unit, true);\n      this.setOutputData(4, data.kind, true);\n      this.setOutputData(5, data.type, true);\n      this.setOutputData(6, data.scale, true);\n      this.setOutputData(7, data.historySettings.type, true);\n      this.setOutputData(8, data, true);\n      this.setOutputData(9, null, true);\n    } else {\n      this.setOutputData(0, data.name, true);\n      this.setOutputData(1, data.value, true);\n      this.setOutputData(2, this.formattedExecutionTime());\n      this.setOutputData(3, null, true);\n    }\n  }\n\n  setErrorOutputs(message) {\n    if (this.advancedSetting) {\n      this.setOutputData(0, null, true);\n      this.setOutputData(1, null, true);\n      this.setOutputData(2, this.formattedExecutionTime());\n      this.setOutputData(3, null, true);\n      this.setOutputData(4, null, true);\n      this.setOutputData(5, null, true);\n      this.setOutputData(6, null, true);\n      this.setOutputData(7, null, true);\n      this.setOutputData(8, null, true);\n      this.setOutputData(9, message);\n    } else {\n      this.setOutputData(0, null, true);\n      this.setOutputData(1, null, true);\n      this.setOutputData(2, this.formattedExecutionTime());\n      this.setOutputData(3, message);\n    }\n  }\n}\n\nContainer.registerNodeType('nube/api-input', NubeAPIInputPoint);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport axios from 'axios';\nimport BasePointNode from './base-point';\nimport { SettingType} from '../../node';\nimport { User } from '../../../database/models/user';\n\nclass NubeAPIOutputPoint extends BasePointNode {\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.STRING;\n    this.title = 'Nube API Output';\n    this.description =\n      'This node is used to write to points on connected Nube devices.  Once the nube/login node is successfully authenticated, the API-Output nodes will have their settings updated with values from the connected Nube devices. Connected Nube devices can be selected from the Select URL setting dropdown.  Select Point setting dropdown will be populated with the available points from the selected URL.  Nube points have 16 priority levels to write to.  The Priority Level setting is the priority that the node will write on.  The in # inputs act as a separate priority array; the highest non-null in # input will be written to the Nube point on the Priority Level setting.  The number of inputs can be modified from the Inputs Count setting. Ticking the Show Advanced Options setting will add outputs to the node with extra information about the selected point.';\n    this.addOutput('outValue', Type.STRING);\n    this.addOutput('lastUpdate', Type.STRING);\n    this.addOutput('error', Type.STRING);\n\n    this.settings['priorityLevel'] = {\n      description: 'Priority Level',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: this.getConfigItems(),\n      },\n      value: 16,\n    };\n    this.settings['advancedSetting'] = {\n      description: 'Show Advanced Options',\n      value: this.advancedSetting,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  init() {\n    super.init();\n    this.updateNodeOutputs();\n  }\n\n  async reload() {\n    try {\n      const user: User = await this.fetchConnection();\n      const point = await this.fetchPoints(user);\n      await this.writePointValue(user);\n      const data = await this.fetchPointValue(user, point);\n      this.setOutputs(data);\n    } catch (e) {\n      this.setErrorOutputs(e.message);\n    }\n    return null;\n  }\n\n  async onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    await this.onInputUpdated();\n    this.updateNodeOutputs();\n    this.updateNodeOutput();\n    this.broadcastOutputsToClients();\n    await super.onInputUpdated();\n  }\n\n  updateTitle() {\n    if (this.settings['point'].value)\n      this.title = `Nube API Output (${this.settings['point'].value})`;\n    else this.title = 'Nube API Output (unconfigured)';\n  }\n\n  protected filterPoint(points) {\n    return points.filter(point => !new RegExp('^DI|UI').test(point));\n  }\n\n  setOutputs(body) {\n    if (this.advancedSetting) {\n      this.setOutputData(0, body.value);\n      this.setOutputData(1, this.formattedExecutionTime());\n      this.setOutputData(2, body);\n      this.setOutputData(3, null);\n    } else {\n      this.setOutputData(0, body.value);\n      this.setOutputData(1, this.formattedExecutionTime());\n      this.setOutputData(2, null);\n    }\n  }\n\n  setErrorOutputs(message) {\n    if (this.advancedSetting) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, this.formattedExecutionTime());\n      this.setOutputData(2, null);\n      this.setOutputData(3, message);\n    } else {\n      this.setOutputData(0, null);\n      this.setOutputData(1, this.formattedExecutionTime());\n      this.setOutputData(2, message);\n    }\n  }\n\n  private getConfigItems() {\n    const configItems = [];\n    Array(16)\n      .fill(null)\n      .map((_, i) => configItems.push({ value: i + 1, text: (i + 1).toString() }));\n    return configItems;\n  }\n\n  private updateNodeOutputs() {\n    this.advancedSetting = this.settings['advancedSetting'].value;\n    if (this.advancedSetting && !this.previousAdvancedSetting) {\n      this.removeOutput(2);\n      this.addOutput('asObject', Type.JSON);\n      this.addOutput('error', Type.STRING);\n    } else if (!this.advancedSetting && this.previousAdvancedSetting) {\n      this.removeOutput(3);\n      this.removeOutput(2);\n      this.addOutput('error', Type.STRING);\n    }\n    this.previousAdvancedSetting = this.advancedSetting;\n  }\n\n  private async writePointValue({ jwt, host, port }): Promise<any> {\n    const point = this.settings['point'].value;\n    const url = `${Utils.buildUrl(host, port)}/points/${point}/value`;\n    const body = this.getInputAsJsonString();\n    await axios.put(url, body, {\n      headers: { 'Authorization': jwt, 'Content-Type': 'application/json' },\n    });\n    return null;\n  }\n\n  private getInputAsJsonString(): object {\n    const priorityLevel = this.settings['priorityLevel'].value;\n    for (let i = 0; i < this.getInputsCount(); i++) {\n      let input = this.getInputData(i);\n      if (input != null && input !== '') {\n        return { value: input, priority: priorityLevel };\n      }\n    }\n    return { value: null, priority: priorityLevel };\n  }\n}\nContainer.registerNodeType('nube/api-output', NubeAPIOutputPoint);\n","import { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport { BaseEdge } from './base-edge';\nimport Utils from '../../utils';\nimport axios from 'axios';\nimport { SettingType } from '../../node';\nimport TimeUtils from '../../utils/time-utils';\n\nclass ApiSchedules extends BaseEdge {\n  suffixApi = '/schedules';\n\n  constructor() {\n    super();\n    this.title = 'Api Schedule';\n    this.description =\n      \"This node is used to fetch schedules from Nube devices.  Once the nube/login node is successfully authenticated, the API-Schedule nodes will have their settings updated with values from the connected Nube devices.  API-Schedule node will output all schedules from the device; Specific schedule selection is done on the Schedule-Checker node.  interval is how often the node will re-check for schedule changes (minimum 30 seconds).  It is recommended that the API-Schedule node is used in conjunction with a filter/prevent-null node to maintain the last successful schedule read in the case that the API-Login node becomes disconnected. 'interval units can be configured from settings.  Maximum interval setting is 587 hours.\";\n\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInputWithSettings('interval', Type.NUMBER, 60, 'Interval (minimum 30 seconds)', false);\n    this.addOutput('data', Type.JSON);\n    this.addOutput('error', Type.STRING);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n  }\n\n  onAdded() {\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.setExecuteInterval();\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.setExecuteInterval();\n  }\n\n  async onInputUpdated() {\n    if (this.side !== Side.server) return;\n    this.setExecuteInterval();\n    let trigger = this.getInputData(0);\n    if (trigger && this.inputs[0].updated) {\n      await this.onExecute();\n    }\n  }\n\n  async onExecute() {\n    try {\n      const user = await this.fetchConnection(this.suffixApi);\n      const data = await this.fetchSchedules(user);\n      this.setOutputData(0, data);\n      this.setOutputData(1, null);\n    } catch (e) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, e.message);\n    }\n  }\n\n  setExecuteInterval() {\n    let interval = this.getInputData(1);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    interval = Math.max(interval, 60000);\n    this.EXECUTE_INTERVAL = interval;\n  }\n\n  protected async fetchSchedules({ jwt, host, port }): Promise<string> {\n    const url = `${Utils.buildUrl(host, port)}${this.suffixApi}`;\n    const response = await axios.get(url, { headers: { Authorization: jwt } });\n    return response.data;\n  }\n}\n\nContainer.registerNodeType('nube/api-schedules', ApiSchedules);\n","import { Node, SettingType } from '../../node';\nimport { User } from '../../../database/models/user';\nimport Utils from '../../utils';\n\nexport class BaseEdge extends Node {\n  protected constructor() {\n    super();\n    this.settings['url'] = {\n      description: 'Select Url',\n      value: '',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [],\n      },\n    };\n  }\n\n  protected async fetchConnection(suffixApi: string): Promise<User> {\n    let user = null;\n\n    const users = await this.container.db.getAsyncUsers();\n    const urls = users.map(user => {\n      return {\n        value: JSON.stringify(user),\n        text: `${Utils.buildUrl(user.host, user.port)}${suffixApi} (${user.nodeId})`,\n      };\n    });\n    this.settings['url'].config.items = urls;\n    const url = this.settings['url'].value;\n    if (url && urls.map(x => x.value).includes(url)) {\n      user = this.settings['url'].value;\n    } else {\n      user = urls.length && urls[0].value;\n      this.settings['url'].value = user;\n    }\n    this.broadcastSettingsToClients();\n\n    return (user && JSON.parse(user)) || null;\n  }\n}\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 12.03.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils, { TIME_TYPE } from '../../utils/time-utils';\nimport axios from 'axios';\nimport SystemUtils from '../system/system-utils';\nimport config from '../../../config';\n\nconst btoa = require('btoa');\n\nclass GetSchedulesNode extends Node {\n  enable;\n\n  constructor() {\n    super();\n    this.title = 'Get-Schedules';\n    this.description =\n      \"This node is used to fetch schedules from the Nube dashboard.  The Get-Schedules node will output all schedules from the device; Specific schedule selection is done on the Schedule-Checker node.  Interval (set from settings) is how often the node will re-check for schedule changes (minimum 10 seconds).  In order for the get-schedules node to work, there must be a `system/platform node in the main container (default editor pane) and there must be a deviceID in the system/platform node settings, It is recommended that the API-Schedule node is used in conjunction with a filter/prevent-null node to maintain the last successful schedule read in the case that the API-Login node becomes disconnected. 'interval units can be configured from settings.  Maximum interval setting is 587 hours.\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addOutput('data', Type.JSON);\n    this.addOutput('error', Type.BOOLEAN);\n\n    this.settings['interval'] = {\n      description: 'Update Interval (min 10 seconds)',\n      type: SettingType.NUMBER,\n      value: 60,\n    };\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: TIME_TYPE.SECONDS, text: 'Seconds' },\n          { value: TIME_TYPE.MINUTES, text: 'Minutes' },\n          { value: TIME_TYPE.HOURS, text: 'Hours' },\n        ],\n      },\n      value: TIME_TYPE.SECONDS,\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n  }\n\n  async onAdded() {\n    if (this.properties['scheduleData']) this.setOutputData(0, this.properties['scheduleData']);\n    await this.onAfterSettingsChange();\n  }\n\n  async onAfterSettingsChange() {\n    this.setExecuteInterval();\n    await this.onInputUpdated();\n  }\n\n  async onInputUpdated() {\n    await this.getDittoSchedules();\n  }\n\n  async onExecute() {\n    await this.getDittoSchedules();\n  }\n \n  async getDittoSchedules() {\n    if (this.side !== Side.server || !this.getInputData(0)) return;\n    try {\n      const deviceIdFromPlat = await SystemUtils.getDeviceID(this);\n      const { username, password } = config.ditto;\n      const dittoUrl =  config.ditto.baseURL\n      const response = await axios({\n        method: 'get',\n        url:\n        dittoUrl + deviceIdFromPlat + '/features/schedules/properties',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Basic ${btoa(`${username}:${password}`)}`,\n        },\n      });\n      this.setOutputData(0, response.data, false);\n      this.setOutputData(1, false);\n      this.properties['scheduleData'] = response.data;\n      this.persistProperties(false, true);\n    } catch (error) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, error);\n      this.debugErr(error);\n      return;\n    }\n  }\n\n  setExecuteInterval() {\n    let interval = this.settings['interval'].value;\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    interval = Math.max(interval, 10000);\n    this.EXECUTE_INTERVAL = interval;\n  }\n}\nContainer.registerNodeType('nube/get-schedules', GetSchedulesNode);\n","module.exports = require(\"btoa\");","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass MathDecimalPlaceNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Round (Decimal Place)';\n    this.description =\n      \"'output' is the 'input' value rounded to the configured number of decimal places.  The number of decimal places can be configured from settings (limited to 5 decimal places).\";\n    this.addInput('input', Type.NUMBER);\n    this.addOutput('output', Type.NUMBER);\n    this.settings['decimals'] = {\n      description: 'Decimal Places (Limit 5)',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let decimals = this.settings['decimals'].value;\n    if (decimals > 5) decimals = 5;\n    this.emitTransformedInput(x => x.toFixed(decimals));\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('num-transform/round', MathDecimalPlaceNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass MathFloorNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Floor';\n    this.description = \"'output' is the 'input' value rounded DOWN to the nearest integer.\";\n\n    this.addInput('input', Type.NUMBER);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    this.emitTransformedInput(x => Math.floor(x));\n  }\n}\nContainer.registerNodeType('num-transform/floor', MathFloorNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass MathCeilNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Ceil';\n    this.description = \"'output' is the 'input' value rounded UP to the nearest integer.\";\n\n    this.addInput('input', Type.NUMBER);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    this.emitTransformedInput(x => Math.ceil(x));\n  }\n}\nContainer.registerNodeType('num-transform/ceil', MathCeilNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass LimitNode extends Node {\n\n  constructor() {\n    super();\n\n    this.title = 'Limit';\n    this.description =\n      \"'output' follows the 'input' value when it is between the 'min' and 'max' values.  If 'input' is greater than the 'max' value, 'output' will be the 'max' value.  If 'input' is less than the 'min' value, 'output' will be the 'min' value.  'max' and 'min' values can be configured from settings.\";\n\n    this.addInput('input', Type.NUMBER);\n    this.addInputWithSettings('min', Type.NUMBER, 0, 'min', false);\n    this.addInputWithSettings('max', Type.NUMBER, 5, 'max', false);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onCreated() {\n    this.setOutputData(0, this.settings['min'].value);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const val = this.getInputData(0);\n\n    const min = this.getInputData(1);\n    const max = this.getInputData(2);\n\n    if (val >= max) {\n      this.setOutputData(0, max);\n    } else if (val <= min) {\n      this.setOutputData(0, min);\n    } else {\n      this.setOutputData(0, val);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('num-transform/limit', LimitNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass ScaleNode extends Node {\n  lastTime: number;\n  interval: number = 250;\n\n  constructor() {\n    super();\n    this.title = 'Scale';\n    this.description =\n      \"Performs a linear interpolation of the 'input' value based configured settings.  When 'input' value is between 'in-min' and 'in-max' it is linearly interpolated between 'out-min' and 'out-max'.  If 'input' is greater than the 'in-max' value, 'output' will be the 'out-max' value.  If 'input' is less than the 'in-min' value, 'output' will be the 'out-min' value.  'in-max', 'in-min', 'out-max', and 'out-min' values can be configured from settings.\";\n\n    this.addInput('input', Type.NUMBER);\n    this.addInputWithSettings('in-min', Type.NUMBER, 0, 'Minimum Input', false);\n    this.addInputWithSettings('in-max', Type.NUMBER, 100, 'Maximum Input', false);\n    this.addInputWithSettings('out-min', Type.NUMBER, 0, 'Minimum Output', false);\n    this.addInputWithSettings('out-max', Type.NUMBER, 10, 'Maximum Output', false);\n    this.addOutput('output', Type.NUMBER);\n    this.lastTime = Date.now();\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onAfterSettingsChange(){\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let now = Date.now();\n    if (now - this.lastTime >= this.interval) {\n      this.lastTime = now;\n      let val = this.getInputData(0);\n      const inMin = this.getInputData(1);\n      const inMax = this.getInputData(2);\n      const outMin = this.getInputData(3);\n      const outMax = this.getInputData(4);\n\n      if (val == null) {\n        this.setOutputData(0, 0);\n      } else {\n        val = Utils.remap(val, inMin, inMax, outMin, outMax);\n        this.setOutputData(0, val.toFixed(1));\n      }\n    }\n  }\n}\nContainer.registerNodeType('num-transform/scale', ScaleNode);\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass LinearShaperNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Linear shaper';\n    this.description =\n      \"Performs a linear interpolation of the 'input' value between configured inflection points.  The number of inflection points can be configured in settings.  The inflection points will be evenly distributed from 0-100.  Values for each inflection point can be wired in, or set from settings.  When the 'input' value is between 0 and 100 the 'output' value will be the linear interpolation of the 'input' value between the surrounding inflection point values. \";\n\n    this.addInput('input', Type.NUMBER);\n    this.settings['inputs'] = {\n      description: 'Inflection Points Count',\n      value: 3,\n      type: SettingType.NUMBER,\n    };\n    this.settings['in1'] = {\n      description: 'output value @ input = 0',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.settings['in2'] = {\n      description: 'output value @ input = 50',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.settings['in3'] = {\n      description: 'output value @ input = 100',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.addInput('[0]', Type.NUMBER);\n    this.addInput('[50]', Type.NUMBER);\n    this.addInput('[100]', Type.NUMBER);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAfterSettingsChange() {\n    const inputCountBefore = this.getInputsCount();\n    let inputs = this.settings['inputs'].value;\n    inputs = Utils.clamp(inputs, 3, 100);\n    inputs = inputs + 1;\n    if (inputs == inputCountBefore) return;\n    this.changeInputsCount(inputs, Type.NUMBER);\n\n    if (inputs > 4) {\n      for (let i = 4; i < inputs; i++) {\n        if (!this.settings['in' + i]) {\n          this.settings['in' + i] = {\n            description: 'in ' + i,\n            value: 0,\n            type: SettingType.NUMBER,\n          };\n        }\n      }\n    }\n    for (let j = inputs; j < inputCountBefore; j++) {\n      delete this.settings['in' + j];\n    }\n    this.renameInputsAndSettings(inputs);\n\n    if (this.side == Side.editor) this.updateInputsLabels();\n    this.onInputUpdated();\n  }\n\n  renameInputsAndSettings(count) {\n    count = count - 1;\n    this.inputs[1].name = '[0]';\n    for (let i = 1; i < count; i++) {\n      let point = (100.0 / (count - 1)) * i;\n      let pointFormatted = point.toFixed(2).replace(/[.,]00$/, '');\n      this.inputs[i + 1].name = '[' + pointFormatted + ']';\n      this.settings['in' + (i + 1)] = {\n        description: 'output value @ input = ' + pointFormatted,\n        value: 0,\n        type: SettingType.NUMBER,\n      };\n    }\n    this.updateNodeInput();\n  }\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    if (input == null) {\n      this.setOutputData(0, null, true);\n      return;\n    }\n    const position = Utils.clamp(input, 0, 100);\n    const pointsCount = this.getInputsCount() - 1;\n    const stepSize = 100.0 / (pointsCount - 1);\n    const stepIndex = position / stepSize;\n    if (position % stepSize == 0) {\n      let valueAtPosition = this.getInputData(stepIndex + 1);\n      if (!Utils.hasInput(valueAtPosition)) {\n        valueAtPosition = this.settings['in' + (stepIndex + 1)].value;\n      }\n      valueAtPosition = Number(valueAtPosition);\n      this.setOutputData(0, valueAtPosition);\n      return;\n    }\n    const positionInStep = stepIndex - Math.floor(stepIndex);\n    const startValueIndex = Math.floor(stepIndex);\n    console.log(stepIndex, 'stepIndex');\n    console.log(startValueIndex, 'startValueIndex');\n    console.log('in' + (startValueIndex + 1), \"'in' + (startValueIndex + 1)\");\n    let startValue = this.getInputData(startValueIndex + 1);\n    if (!Utils.hasInput(startValue)) startValue = this.settings['in' + (startValueIndex + 1)].value;\n    let endValue = this.getInputData(startValueIndex + 2);\n    if (!Utils.hasInput(endValue)) endValue = this.settings['in' + (startValueIndex + 2)].value;\n    let output = Utils.remap(positionInStep, 0, 1, startValue, endValue);\n    this.setOutputData(0, output, true);\n  }\n}\nContainer.registerNodeType('num-transform/linear-shaper', LinearShaperNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass TimeFadeNode extends Node {\n  updateInterval: number = 500;\n  stepSize: number;\n  lastEnable: boolean;\n  timerFinished: boolean;\n  currentVal: number;\n  timeoutFunc;\n\n\n  constructor() {\n    super();\n    this.title = 'Fade';\n    this.description =\n      \"This node makes a smooth transition from 'from' to 'to' over the 'interval' period when 'enable' transitions from 'false' to 'true'; after this 'interval' period 'output' will match the 'to' value while 'enable' is 'true'.  During the 'interval' period, the rate of 'output' change cannot be changed.  Once the 'interval' period is complete 'out=to' becomes 'true' until 'enable' becomes 'false' again.\";\n    this.addInput('enable', Type.BOOLEAN);\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Interval', false);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n    this.addInputWithSettings('from', Type.NUMBER, 0, 'To Value', false);\n    this.addInputWithSettings('to', Type.NUMBER, 100, 'From Value', false);\n    this.addOutput('output');\n    this.addOutput('out=to');\n\n    this.updateInterval = 250;\n  }\n\n  onAdded() {\n \n    this.lastEnable = false;\n    this.timerFinished = false;\n    this.setOutputData(1, false);\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n  }\n\n  onInputUpdated() {\n    const enable = this.getInputData(0);\n    if (!enable && this.lastEnable) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, 0);\n      this.setOutputData(1, false);\n      this.timerFinished = false;\n      this.lastEnable = enable;\n      return;\n    } else if (!enable) {\n      this.setOutputData(0, 0);\n      this.setOutputData(1, false);\n      return;\n    }\n    const to = this.getInputData(3);\n    if (enable && this.timerFinished) {\n      this.setOutputData(0, to);\n      this.setOutputData(1, true);\n      return;\n    }\n\n    const from = this.getInputData(2);\n    let interval = this.getInputData(1);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    if (enable && !this.lastEnable) {\n      this.stepSize = (to - from) / (interval / this.updateInterval);\n      this.currentVal = from;\n      this.timeoutFunc = setInterval(() => {\n        this.update();\n      }, this.updateInterval);\n    } else if (!enable && this.lastEnable) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, 0);\n      this.timerFinished = false;\n    }\n    this.lastEnable = enable;\n  }\n\n  update() {\n    let to = this.getInputData(3);\n    const val = this.currentVal + this.stepSize;\n    if (val >= to) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, to);\n      this.setOutputData(1, true);\n      this.timerFinished = true;\n      this.currentVal = 0;\n      return;\n    } else {\n      this.currentVal = val;\n      this.setOutputData(0, val);\n    }\n  }\n}\nContainer.registerNodeType('num-transform/fade', TimeFadeNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass RateLimitNode extends Node {\n  lastEnable: boolean;\n  lastInterval: number;\n  currentVal: number;\n  timeoutFunc;\n\n\n  constructor() {\n    super();\n    this.title = 'Rate-Limit';\n    this.description =\n      'This node makes a rate limited transition from its current output value to the input value.  When enable is true,  output is permitted to change towards the input value based on settings values.  output can change by step size every interval period.  output will be null when enable is false.';\n    this.addInput('input', Type.NUMBER);\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable', false);\n    this.addInputWithSettings('step', Type.NUMBER, 1, 'Step Size', false);\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Update Interval', false);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n    this.addOutput('output', Type.NUMBER);\n    this.lastInterval = 1000;\n    this.lastEnable = true;\n    this.currentVal = 0;\n  }\n\n  onAdded() {\n \n    this.lastInterval = 1000;\n    this.lastEnable = true;\n    this.currentVal = 0;\n    this.setOutputData(0, null);\n    this.inputs[3]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.timeoutFunc = setInterval(() => {\n      this.step();\n    }, this.lastInterval);\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let input = this.getInputData(0);\n    if (input == null) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, null);\n      this.lastEnable = false;\n      return;\n    }\n    let interval = this.getInputData(3);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    const enable = this.getInputData(1);\n    if (enable && !this.lastEnable) {\n      this.currentVal = 0;\n      this.timeoutFunc = setInterval(() => {\n        this.step();\n      }, interval);\n    } else if (!enable && this.lastEnable) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, null);\n    } else if (enable && this.lastEnable && interval !== this.lastInterval) {\n      clearInterval(this.timeoutFunc);\n      this.timeoutFunc = setInterval(() => {\n        this.step();\n      }, interval);\n    }\n    this.lastInterval = interval;\n    this.lastEnable = enable;\n  }\n\n  step() {\n    const step = this.getInputData(2);\n    let input = this.getInputData(0);\n    if (input >= this.currentVal) {\n      this.currentVal = this.currentVal + step;\n      if (this.currentVal > input) this.currentVal = input;\n      this.setOutputData(0, this.currentVal);\n    } else if (input < this.currentVal) {\n      this.currentVal = this.currentVal - step;\n      if (this.currentVal < input) this.currentVal = input;\n      this.setOutputData(0, this.currentVal);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[3]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('num-transform/rate-limit', RateLimitNode);\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\n\n//Bool Constant\nclass BoolConstantNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Boolean Constant';\n    this.description = 'Outputs a Boolean value set from settings.  Can also output null.';\n\n    this.settings['value'] = {\n      description: 'Payload',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: false, text: 'false' },\n          { value: true, text: 'true' },\n          { value: null, text: 'null' },\n        ],\n      },\n      value: null,\n    };\n\n    this.addOutput('output', Type.BOOLEAN);\n  }\n\n  onAdded() {\n \n    if (this.side != Side.server) return;\n    let val = this.settings['value'].value;\n    this.setOutputData(0, val);\n  }\n\n  onExecute(){\n    // this.onAfterSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    let val = this.settings['value'].value;\n    this.setOutputData(0, val);\n  }\n}\nContainer.registerNodeType('point/bool-constant', BoolConstantNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\n//Numeric Constant\nclass NumConstantNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Numeric Constant';\n    this.description =\n      'Outputs a Numeric value set from settings. Can also output null by leaving the settings field blank.';\n\n    this.settings['value'] = { description: 'Value', value: null, type: SettingType.NUMBER };\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onAfterSettingsChange();\n  }\n\n  onExecute(){\n    // this.onAfterSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    const val = this.settings['value'].value;\n    this.setOutputData(0, Utils.parseValue(val, Type.NUMBER));\n  }\n}\nContainer.registerNodeType('point/num-constant', NumConstantNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\n//String\nclass StringConstantNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'String Constant';\n    this.description =\n      'Outputs a String value set from settings. Can also output null by leaving the settings field blank.';\n\n    this.settings['value'] = { description: 'Value', value: '', type: SettingType.STRING };\n    this.addOutput('output', Type.STRING);\n  }\n\n  onAdded() {\n \n    this.onAfterSettingsChange();\n  }\n\n  onExecute(){\n    // this.onAfterSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    const val = this.settings['value'].value;\n    this.setOutputData(0, Utils.parseValue(val, Type.STRING));\n  }\n}\nContainer.registerNodeType('point/string-constant', StringConstantNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport { isJSON, isEmpty } from '../../../utils/helper';\nclass JsonConstantNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Json Constant';\n    this.description = `Outputs a JSON value set from settings. Can also output null by leaving the settings field blank. Example {\"name\":\"John Hill\", \"age\":31} or [1,2,3,4]`;\n    this.addInputWithSettings('value', Type.JSON, '{ \"measurement\": 22 }', 'JSON value');\n    this.settings['passNull'] = {\n      description: 'Send null if not a match',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.addOutput('output', Type.JSON);\n    this.addOutput('valid-json', Type.BOOLEAN);\n    this.addOutput('msg', Type.STRING);\n  }\n\n  onAdded() {\n    this.onAfterSettingsChange();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    const passNull = this.settings['passNull'].value;\n    try {\n      if (isJSON(val) && !isEmpty(val)) {\n        this.setOutputData(0, val);\n        this.setOutputData(1, true);\n        this.setOutputData(2, 'valid JSON');\n      } else if(passNull) {\n        this.setOutputData(0, null);\n        this.setOutputData(1, false);\n        this.setOutputData(2, 'invalid JSON');\n      } else {\n        this.setOutputData(1, false);\n        this.setOutputData(2, 'invalid JSON');\n      }\n    } catch (err) {\n      this.setOutputData(1, false);\n      this.setOutputData(2, err);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated()\n  }\n}\nContainer.registerNodeType('point/json-constant', JsonConstantNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass BoolPriorityNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.BOOLEAN;\n    this.title = 'Boolean Writable (Priority)';\n    this.description =\n      \"Outputs the highest priority, non-null, Boolean input. Highest priority is 'in 1' then 'in 2' and so on. Input values can also be wired in, or set from settings. The number of inputs can be modified from settings.\";\n\n    this.addOutput('out', Type.BOOLEAN);\n  }\n\n  onAdded() {\n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const inputs = this.getInputsCount();\n    for (let i = this.dynamicInputStartPosition; i < inputs; i++) {\n      let inputValue = this.getInputData(i);\n      if (inputValue != null) {\n        this.setOutputData(0, inputValue);\n        return;\n      }\n    }\n    this.setOutputData(0, null);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('point/bool-writable', BoolPriorityNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass NumWritableNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    this.title = 'Numeric Writable (Priority)';\n    this.description =\n      \"Outputs the highest priority, non-null, Numeric input.  Highest priority is 'in 1' then 'in 2' and so on.  Input values can also be wired in, or set from settings. The number of inputs can be modified from settings.\";\n    this.addOutput('out', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n    this.size = this.computeSize();\n  }\n\n  onInputUpdated() {\n    const inputs = this.getInputsCount();\n    for (let i = this.dynamicInputStartPosition; i < inputs; i++) {\n      let inputValue = this.getInputData(i);\n      if (inputValue != null) {\n        this.setOutputData(0, inputValue);\n        return;\n      }\n    }\n    this.setOutputData(0, null);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\n\nContainer.registerNodeType('point/num-writable', NumWritableNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass StringPriorityNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.STRING;\n    this.title = 'String Writable (Priority)';\n    this.description =\n      \"Outputs the highest priority, non-null, String input.  Highest priority is 'in 1' then 'in 2' and so on.   Input values can also be wired in, or set from settings. The number of inputs can be modified from settings.\";\n    this.addOutput('out', Type.STRING);\n  }\n\n  onAdded() {\n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    for (let i = this.dynamicInputStartPosition; i < this.getInputsCount(); i++) {\n      let inputValue = this.getInputData(i);\n      if (inputValue) {\n        this.setOutputData(0, inputValue);\n        return;\n      }\n    }\n    this.setOutputData(0, '');\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('point/string-writable', StringPriorityNode);\n","import { Container, Side } from '../../container';\nimport { Node } from '../../node';\nimport HistoryConfig from '../../utils/points/history-config';\nimport PriorityConfig from '../../utils/points/priority-config';\n\n// TODO change history config to HistoryBase\nclass GenericNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Generic Point';\n    this.description = 'This node is to test the generic point input types';\n\n    PriorityConfig.addPrioritySettings(this);\n    HistoryConfig.addHistorySettings(this);\n    this.setSettingsConfig({ groups: [], conditions: {} });\n    PriorityConfig.addPrioritySettingsConfig(this);\n    HistoryConfig.addHistorySettingsConfig(this, 0, false);\n  }\n\n  onCreated() {\n    PriorityConfig.priorityOnCreated(this);\n    HistoryConfig.historyOnCreated(this);\n  }\n\n  onAdded() {\n    //this.size = this.computeSize();\n    this.onAfterSettingsChange();\n  }\n\n  onInputUpdated() {\n    PriorityConfig.doPriorityFunctions(this);\n    if (this.side !== Side.server) return; // only execute on server\n    HistoryConfig.doHistoryFunctions(this);\n  }\n\n  onAfterSettingsChange() {\n    PriorityConfig.priorityFunctionsForAfterSettingsChange(this);\n    HistoryConfig.historyFunctionsForAfterSettingsChange(this, this.settings['pointName'].value);\n    PriorityConfig.doPriorityFunctions(this);\n    if (this.side !== Side.server) return; // only execute on server\n    HistoryConfig.doHistoryFunctions(this);\n    /*\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n    */\n  }\n}\n\nContainer.registerNodeType('point/generic-point', GenericNode);\n","/******************************************************\n *\n * Node Constructor should include the following:\n * Add this line in the settings setup, where the history settings should appear:\n *      HistoryConfig.addHistorySettings(this);\n *\n * Add this line at the end after this.setSettingsConfig() has been called,\n * or if this.setSettingsConfig() has not been used, then add this line after settings setup in Node Constructor:\n *      HistoryConfig.addHistorySettingsConfig(this);\n *\n *\n * Node Functions should include the following:\n *     async onInputUpdated() {\n *       if (this.side !== Side.server) return; // only execute on server\n *       HistoryConfig.doHistoryFunctions(this, 0, this.settings['pointName'].value);\n *     }\n *\n *     onAfterSettingsChange() {\n *       HistoryConfig.historyFunctionsForAfterSettingsChange(this, this.settings['pointName'].value);\n *       this.onInputUpdated();\n *       if (this.side !== Side.server) return; // HISTORY FUNCTONS MUST BE DONE ON BOTH SIDES\n *     }\n *\n */\n\nimport { SettingType} from '../../node';\nimport { Side } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport TimeUtils from '../time-utils';\nimport SettingUtils from '../setting-utils';\nimport CryptoUtils from '../crypto-utils';\nimport NodeUtils from '../../utils/node-utils';\nimport axios from 'axios';\nimport config from '../../../config';\nconst Influx = require('influx');\nconst moment = require('moment-timezone');\n\n/**\n * @Deprecated: Use HistoryBase instead of this one\n */\nexport default class HistoryConfig {\n  static addHistorySettings(self) {\n    self.addInput('histTrigger', Type.BOOLEAN);\n    self.addOutput('histError', Type.ANY);\n    self.addOutput('storedHistCount', Type.NUMBER);\n    self.addOutput('lastHistExport', Type.STRING);\n    for (let input in self.inputs) {\n      if (self.inputs.hasOwnProperty(input)) {\n        if (self.inputs[input].name == 'histTrigger') self.histTriggerInput = input;\n      }\n    }\n\n    for (let output in self.outputs) {\n      if (self.outputs.hasOwnProperty(output)) {\n        if (self.outputs[output].name == 'histError') self.histErrorOutput = output;\n        else if (self.outputs[output].name == 'storedHistCount') self.storedHistCountOutput = output;\n        else if (self.outputs[output].name == 'lastHistExport') self.lastHistExportOutput = output;\n      }\n    }\n\n    /**\n     * History settings\n     */\n    self.settings['history_group'] = {\n      description: 'History Settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n\n    self.settings['databaseType'] = {\n      description: 'Database Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'Nube DB (Postgres)' },\n          { value: 1, text: 'InfluxDB' },\n        ],\n      },\n      value: 0,\n    };\n\n    // THESE SETTINGS FOR INFLUX HISTORY STORAGE\n\n    self.settings['enable'] = {\n      description: 'History Enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['host'] = { description: 'Host', value: '', type: SettingType.STRING };\n    self.settings['port'] = { description: 'Port', value: '', type: SettingType.STRING };\n\n    self.settings['authentication'] = {\n      description: 'Use Authentication',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['user'] = { description: 'Username', value: '', type: SettingType.STRING };\n    self.settings['password'] = { description: 'Password', value: '', type: SettingType.STRING };\n\n    self.settings['databaseName'] = {\n      description: 'Database Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    self.settings['tableName'] = {\n      description: 'Measurement Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    // END OF INFLUX SPECIFIC SETTINGS\n\n    self.settings['pointName'] = {\n      description: 'Point Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    self.settings['historyMode'] = {\n      description: 'History Logging Mode',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'Change Of Value (COV)' },\n          { value: 1, text: 'Periodic' },\n          { value: 2, text: 'Trigger Only' },\n        ],\n      },\n      value: 0,\n    };\n\n    self.settings['threshold'] = {\n      description: 'COV Threshold',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n\n    self.settings['period'] = {\n      description: 'Logging Interval',\n      value: 15,\n      type: SettingType.NUMBER,\n    };\n    self.settings['periodUnits'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'minutes',\n    };\n\n    self.settings['storage-limit'] = {\n      description: 'Local Storage Limit (Max 50)',\n      value: 25,\n      type: SettingType.NUMBER,\n    };\n    self.settings['minuteRoundValue'] = {\n      description: 'Round minutes up in increments of',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n\n    self.settings['decimals'] = {\n      description: 'Decimal Places (Limit 5)',\n      value: 3,\n      type: SettingType.NUMBER,\n    };\n\n    self.settings['timeAsString'] = {\n      description: 'Display Timestamp as:',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: false, text: 'Numeric' },\n          { value: true, text: 'String' },\n        ],\n      },\n      value: true,\n    };\n\n    /**\n     * Alarm settings\n     */\n    self.settings['alarm_group'] = {\n      description: 'Alarm Settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n\n    self.settings['alarms_count'] = {\n      description: 'Alarms Count (Max 10)',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n\n    /**\n     * Tag settings\n     */\n    self.settings['tags_group'] = {\n      description: 'Tag Settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n\n    self.settings['tags_count'] = {\n      description: 'Tag Count (Max 10)',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n  }\n\n  static addHistorySettingsConfig(self, valueInput: number = 0, isOutput: boolean = true) {\n    if (!self.settingConfigs.hasOwnProperty('groups') && !self.settingConfigs.hasOwnProperty('conditions'))\n      self.setSettingsConfig({ groups: [], conditions: {} });\n    self.settingConfigs.groups.push({ history_group: {} });\n    self.settingConfigs.groups.push({ databaseType: {} });\n    self.settingConfigs.groups.push({ host: { weight: 3 }, port: { weight: 1 } });\n    self.settingConfigs.groups.push({ user: {}, password: {} });\n    self.settingConfigs.groups.push({ period: { weight: 2 }, periodUnits: {} });\n    self.settingConfigs.conditions['authentication'] = setting => {\n      return setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['host'] = setting => {\n      return setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['port'] = setting => {\n      return setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['databaseName'] = setting => {\n      return setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['tableName'] = setting => {\n      return setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['user'] = setting => {\n      return !!setting['authentication'].value && setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['password'] = setting => {\n      return !!setting['authentication'].value && setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['threshold'] = setting => {\n      return !setting['historyMode'].value;\n    };\n    self.settingConfigs.conditions['period'] = setting => {\n      return setting['historyMode'].value == 1;\n    };\n    self.settingConfigs.conditions['periodUnits'] = setting => {\n      return setting['historyMode'].value == 1;\n    };\n    self.settingConfigs.conditions['alarm_group'] = setting => {\n      return setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['alarms_count'] = setting => {\n      return setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['tags_group'] = setting => {\n      return setting['databaseType'].value == 1;\n    };\n    self.settingConfigs.conditions['tags_count'] = setting => {\n      return setting['databaseType'].value == 1;\n    };\n    if (self.settings['authentication']) {\n      self.settingConfigs.groups.push({ host: { weight: 3 }, port: { weight: 1 } });\n      self.settingConfigs.groups.push({ user: {}, password: {} });\n      self.settingConfigs.conditions['user'] = setting => {\n        return !!setting['authentication'].value;\n      };\n      self.settingConfigs.conditions['password'] = setting => {\n        return !!setting['authentication'].value;\n      };\n    }\n\n    self.properties['alarmsCount'] = self.settings['alarms_count'].value;\n    self.properties['tagsCount'] = self.settings['tags_count'].value;\n    self.properties['valueInput'] = valueInput || 0;\n    self.properties['isOutput'] = isOutput;\n  }\n\n  static historyOnCreated(self) {\n    self.useInterval = false;\n    self.properties['alarmsCount'] = 0;\n    self.properties['tagsCount'] = 0;\n    self.properties['valueInput'] = 0;\n    self.properties['isOutput'] = true;\n    self.properties['pointName'] = 'undefined';\n    self.properties['obj'] = [];\n    self.properties['lastHistoryValue'] = null;\n    self.properties['dynamicInputStartPosition'] = 2;\n  }\n\n  //static async doHistoryFunctions(self, valueInput:number, histTrigger:number, histErrorOutput:number, storedHistCountOutput:number, lastHistExportOutput:number) {\n  static async doHistoryFunctions(self) {\n    let input = null;\n    if (self.properties['isOutput']) input = self.getInputData(self.properties['valueInput']);\n    else input = self.outputs[self.properties['valueInput']].data;\n    if (self.getInputData(self.histTriggerInput) && self.inputs[self.histTriggerInput].updated)\n      await HistoryConfig.storeLogEntry(self, input);\n    else if (input != null && (await HistoryConfig.checkCOV(self, input))) {\n      await HistoryConfig.storeLogEntry(self, input);\n    }\n    if (self.properties['obj'].length > 0) await HistoryConfig.trySendStoredData(self);\n    self.setOutputData(self.storedHistCountOutput, self.properties['obj'].length);\n  }\n\n  static async trySendStoredData(self) {\n    let decimals = self.settings['decimals'].value;\n    if (decimals > 5) decimals = 5;\n\n    var points = [];\n    self.properties['obj'].forEach(log => {\n      if (typeof log.payload == 'number') log.payload = log.payload.toFixed(decimals);\n      var tagList = {};\n      tagList['point'] = self.properties['pointName'] || 'undefined';\n      for (var j = 2; j < Object.keys(log).length - 1; j++) {\n        var key = Object.keys(log)[j];\n        tagList[key] = log[key];\n      }\n      for (var i = 0; i < 10; i++) {\n        tagList['tag' + (i + 1)] = log['tags'][i] || null;\n      }\n      // this.getInputData(2), //tableName\n      points.push({\n        measurement: self.getInputData(2),\n        fields: {\n          val: log.payload,\n          //ts: log.timestamp.valueOf(), // check that self is the correct DATE format.\n        },\n        tags: tagList,\n        time: log.timestamp, // check that self is the correct DATE format.\n      });\n      /* \n        measurement: self.settings['tableName'].value,\n        fields: {\n          val: log.payload,\n          //ts: log.timestamp.valueOf(), // check that self is the correct DATE format.\n        },\n        alarms: {\n          point: pointName || 'undefined',\n        },\n        time: log.timestamp.valueOf(), // check that self is the correct DATE format.\n      });\n      */\n    });\n    var errorFlag = false;\n\n    /////////////////////////////////////////////////////////////\n    // This section should be replaced with the history storage mode of choice.\n\n    // FOR POSTGRESQL DB (NUBE DATABASE)\n    if (self.settings['databaseType'].value == 0) {\n      //USING AXIOS\n      // For Multiple points in 1 push\n      var multiPointPost = [];\n      const clientIDfromPlat = await HistoryConfig.getClientID(self);\n      const deviceIDfromPlat = await HistoryConfig.getDeviceID(self);\n      let foundDeviceID = false;\n      let foundClientID = false;\n      typeof deviceIDfromPlat == 'string' ? (foundDeviceID = true) : null;\n      typeof deviceIDfromPlat == 'string' ? (foundClientID = true) : null;\n      var inputVal;\n      var typeOfVal;\n      var valAsNum;\n      const pgUrl = config.pg.baseURL;\n      points.forEach(point => {\n        inputVal = point['fields']['val'];\n        typeOfVal = typeof inputVal;\n        if (typeOfVal === 'string' || typeOfVal === 'boolean') valAsNum = Number(point['fields']['val']);\n        else valAsNum = inputVal;\n        multiPointPost.push({\n          deviceid: foundDeviceID ? deviceIDfromPlat : 'unknownDeviceID',\n          clientid: foundClientID ? clientIDfromPlat : 'unknownClientID',\n          val: valAsNum,\n          point: point['tags']['point'],\n          ts: moment(point['time'])._d,\n        });\n      });\n\n      axios({\n        method: 'post',\n        url: pgUrl,\n        data: multiPointPost,\n      })\n        .then(function() {})\n        .catch(function(error) {\n          self.setOutputData(self.histErrorOutput, String(error));\n          errorFlag = true;\n        });\n    }\n\n    // FOR INFLUX DB\n    if (self.settings['databaseType'].value == 1) {\n      const host = self.settings['host'].value || 'localhost';\n      const port = self.settings['port'].value || 8086;\n      var writeOptions = {};\n\n      var client = new Influx.InfluxDB({\n        host: self.settings['host'].value || 'localhost',\n        port: self.settings['port'].value || 8086,\n        protocol: 'http', //self.influxdbConfig.usetls ? \"https\" : \"http\",\n        database: self.settings['databaseName'].value || 'undefined',\n        username: self.settings['authentication'].value ? self.settings['user'].value : '',\n        password: self.settings['authentication'].value ? CryptoUtils.decrypt(self.settings['password'].value) : '',\n        /*\n      schema: [\n        {\n          measurement: self.settings['tableName'].value,\n          fields: {\n            point: Influx.FieldType.STRING,\n            val: Influx.FieldType.ANY,\n            ts: Influx.FieldType.TIMESTAMP\n          },\n          tags: [],\n        }\n      ]\n      */\n      });\n      await client.writePoints(points, writeOptions).catch(err => {\n        self.setOutputData(self.histErrorOutput, String(err.code));\n        errorFlag = true;\n        //console.log('err', err);\n      });\n    }\n\n    /////////////////////////////////////////////////////////////\n\n    if (!errorFlag) {\n      self.properties['obj'] = [];\n      self.setOutputData(self.histErrorOutput, '');\n      self.settings['timeAsString'].value\n        ? self.setOutputData(self.lastHistExportOutput, moment().format(), true)\n        : self.setOutputData(self.lastHistExportOutput, moment().valueOf(), true);\n    }\n  }\n\n  static historyFunctionsForAfterSettingsChange(self, pointName: string, save: boolean = true) {\n    self.properties['pointName'] = pointName;\n    if (self.settings['databaseType'].value == 0) {\n      self.settings['alarms_count'].value = 0;\n      self.settings['tags_count'].value = 0;\n    }\n    HistoryConfig.changeAlarmsCount(self, self.settings['alarms_count'].value);\n    // Alarms settings values gets inserted after certain time -- Container.setSettings(properties, node);\n    setTimeout(() => {\n      HistoryConfig.renameAlarmInputs(self);\n    }, 100);\n    HistoryConfig.changeTagsCount(self, self.settings['tags_count'].value);\n    HistoryConfig.setPeriodicLogging(self);\n    if (save) {\n      NodeUtils.persistProperties(self, true, true, true);\n    }\n    if (self.properties['isOutput']) self.onInputUpdated();\n  }\n\n  static async storeLogEntry(self, input) {\n    if (input == null) return -1;\n    // cap the amount of data that can be stored\n    const storageLimit = Utils.clamp(self.settings['storage-limit'].value, 0, 50);\n    // round the time to the nearest min. For example 15min. 1:00, 1:15\n    const minuteRound = Utils.clamp(self.settings['minuteRoundValue'].value, 0, 60);\n    const now = minuteRound ? await self.nearestFutureMinutes(minuteRound, moment()) : moment();\n\n    // object data\n    let msg = {\n      payload: input,\n      timestamp: now._d,\n    };\n    // add alarm values\n    for (\n      var i = self.properties['dynamicInputStartPosition'];\n      i < self.properties['dynamicInputStartPosition'] + Number(self.properties['alarmsCount']);\n      i++\n    ) {\n      let alarmNum = i - self.properties['dynamicInputStartPosition'] + 1;\n      let alarmName = self.settings['alarm' + alarmNum].value || 'alarm' + alarmNum;\n      msg[alarmName] = self.getInputData(i) || 'null';\n    }\n    // add tags\n    var tags = [];\n    var j = 1;\n    while (j <= Number(self.properties['tagsCount'])) {\n      if (self.settings['tag' + j].value) tags.push(self.settings['tag' + j].value);\n      j++;\n    }\n    msg['tags'] = tags;\n\n    // build an object\n    self.properties['obj'].push(msg);\n    while (self.properties['obj'].length > storageLimit) {\n      self.properties['obj'].shift();\n    }\n    self.properties['lastHistoryValue'] = input;\n    NodeUtils.persistProperties(self, true, true, true);\n    //HistoryConfig.persistProperties(self);\n    return self.properties['obj'].length;\n  }\n\n  static async checkCOV(self, input) {\n    if (!self.settings['historyMode'].value) {\n      // if COV mode\n      const threshold = self.settings['threshold'].value;\n      if (threshold === 0 && input !== self.properties['lastHistoryValue']) return true;\n      const isNumber = typeof input === 'number';\n      if (input !== self.properties['lastHistoryValue']) {\n        if (\n          typeof self.properties['lastHistoryValue'] !== 'number' ||\n          !isNumber ||\n          (isNumber && Math.abs(input - self.properties['lastHistoryValue']) >= self.settings['threshold'].value)\n        )\n          return true;\n      }\n    }\n    return false;\n  }\n\n  static setPeriodicLogging(self) {\n    if (self.settings['historyMode'].value == 1 && !self.useInterval) {\n      self.useInterval = true;\n      let interval = self.settings['period'].value;\n      interval = TimeUtils.timeConvert(interval, self.settings['periodUnits'].value);\n      self.timeoutFunc = setInterval(async () => {\n        let input = null;\n        if (self.properties['isOutput']) input = self.getInputData(self.properties['valueInput']);\n        else input = self.outputs[self.properties['valueInput']].data;\n        await HistoryConfig.storeLogEntry(self, input);\n        if (self.properties['obj'].length > 0) await HistoryConfig.trySendStoredData(self);\n        self.setOutputData(self.storedHistCountOutput, self.properties['obj'].length);\n        // add status output\n      }, interval);\n    } else if (self.settings['historyMode'].value != 1 && self.useInterval) {\n      self.useInterval = false;\n      clearInterval(self.timeoutFunc);\n    }\n  }\n\n  static nearestFutureMinutes(interval, someMoment) {\n    const roundedMinutes = Math.ceil(someMoment.minute() / interval) * interval;\n    return someMoment\n      .clone()\n      .minute(roundedMinutes)\n      .second(0);\n  }\n\n  static changeAlarmsCount(self, target_count) {\n    if (target_count > 10) {\n      target_count = 10;\n      self.settings['alarms_count'].value = 10;\n    } else if (target_count < 0) {\n      target_count = 0;\n      self.settings['alarms_count'].value = 0;\n    }\n    self.properties['alarmsCount'] = Number(self.properties['alarmsCount']);\n    let diff = target_count - self.properties['alarmsCount'];\n    if (diff == 0) return;\n\n    //add inputs\n    self.changeInputsCount(target_count + self.properties['dynamicInputStartPosition'], Type.STRING);\n\n    //change settings for topics\n    var alarmsToAdd = {};\n    if (diff > 0) {\n      for (let i = self.properties['alarmsCount'] + 1; i <= target_count; i++) {\n        alarmsToAdd['alarm' + i] = {\n          description: 'Alarm ' + i,\n          value: '',\n          type: SettingType.STRING,\n        };\n      }\n      if (self.properties['alarmsCount'] <= 0)\n        self.settings = SettingUtils.insertIntoObjectAtPosition(self.settings, alarmsToAdd, 'alarms_count');\n      else\n        self.settings = SettingUtils.insertIntoObjectAtPosition(\n          self.settings,\n          alarmsToAdd,\n          'alarm' + self.properties['alarmsCount'],\n        );\n    } else if (diff < 0) {\n      for (let i = self.properties['alarmsCount']; i > target_count; i--) {\n        delete self.settings['alarm' + i];\n      }\n    }\n    self.properties['alarmsCount'] = target_count;\n  }\n\n  static renameAlarmInputs(self) {\n    for (let i = 1; i <= self.properties['alarmsCount']; i++) {\n      //this.inputs[i].name = '[' + i + ']';\n      let alarm = self.settings['alarm' + i].value;\n      if (alarm.length > 20) alarm = '...' + alarm.substr(alarm.length - 20, 20);\n      self.inputs[self.properties['dynamicInputStartPosition'] + i - 1].name = 'alarm' + i + ' | ' + alarm;\n    }\n\n    if (self.side == Side.editor) {\n      for (let i = 1; i <= self.properties['alarmsCount']; i++) {\n        self.inputs[self.properties['dynamicInputStartPosition'] + i - 1].label =\n          self.inputs[self.properties['dynamicInputStartPosition'] + i - 1].name;\n      }\n      self.setDirtyCanvas(true, true);\n    }\n  }\n\n  static changeTagsCount(self, target_count) {\n    if (target_count > 10) {\n      target_count = 10;\n      self.settings['tags_count'].value = 10;\n    } else if (target_count < 0) {\n      target_count = 0;\n      self.settings['tags_count'].value = 0;\n    }\n    self.properties['tagsCount'] = Number(self.properties['tagsCount']);\n    let diff = target_count - self.properties['tagsCount'];\n    if (diff == 0) return;\n\n    //change settings for topics\n    var tagsToAdd = {};\n    if (diff > 0) {\n      for (let i = self.properties['tagsCount'] + 1; i <= target_count; i++) {\n        tagsToAdd['tag' + i] = {\n          description: 'Tag ' + i,\n          value: '',\n          type: SettingType.STRING,\n        };\n      }\n      if (self.properties['tagsCount'] == 0)\n        self.settings = SettingUtils.insertIntoObjectAtPosition(self.settings, tagsToAdd, 'tags_count');\n      else\n        self.settings = SettingUtils.insertIntoObjectAtPosition(\n          self.settings,\n          tagsToAdd,\n          'tag' + self.properties['tagsCount'],\n        );\n    } else if (diff < 0) {\n      for (let i = self.properties['tagsCount']; i > target_count; i--) {\n        delete self.settings['tag' + i];\n      }\n    }\n    self.properties['tagsCount'] = target_count;\n  }\n\n  static getDeviceID(self): Promise<Array<any>> {\n    return new Promise((resolve, reject) => {\n      try {\n        HistoryConfig.findMainContainer(self).db.getNodeType('system/platform', (err, docs) => {\n          if (!err) {\n            let output = [];\n            output.push(docs);\n            if (output[0] && output[0][0] && output[0][0].properties) {\n              resolve(output[0][0].properties['deviceID'].trim());\n              return output[0][0].properties['deviceID'].trim();\n            } else {\n            }\n            resolve(output);\n            return output;\n          } else {\n            console.log(err);\n            reject(err);\n          }\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    });\n  }\n\n  static getClientID(self): Promise<Array<any>> {\n    return new Promise((resolve, reject) => {\n      try {\n        HistoryConfig.findMainContainer(self).db.getNodeType('system/platform', (err, docs) => {\n          if (!err) {\n            let output = [];\n            output.push(docs);\n            if (output[0] && output[0][0] && output[0][0].settings) {\n              resolve(output[0][0].settings['clientID'].value.trim());\n              return output[0][0].settings['clientID'].value.trim();\n            } else {\n            }\n            resolve(output);\n            return output;\n          } else {\n            console.log(err);\n            reject(err);\n          }\n        });\n      } catch (error) {\n        console.log(error);\n      }\n    });\n  }\n\n  static findMainContainer(self) {\n    if (self.hasOwnProperty('container')) return HistoryConfig.findMainContainer(self.container);\n    else return self;\n  }\n\n  static persistProperties(self) {\n    if (!self.container.db) return;\n    self.container.db.updateNode(self.id, self.container.id, {\n      $set: {\n        properties: self.properties,\n        inputs: self.inputs,\n        settings: self.settings,\n      },\n    });\n  }\n}\n","/******************************************************\n *\n * Node Constructor should include the following:\n * Add this line in the settings setup, where the history settings should appear:\n *      PriorityConfig.addPrioritySettings(this);\n *\n * Add this line at the end after this.setSettingsConfig() has been called,\n * or if this.setSettingsConfig() has not been used, then add this line after settings setup in Node Constructor:\n *      PriorityConfig.addPrioritySettingsConfig(this);\n *\n *\n * Node Functions should include the following:\n *     async onInputUpdated() {\n *       if (this.side !== Side.server) return; // only execute on server\n *       PriorityConfig.doPriorityFunctions(this);\n *     }\n *\n *     onAfterSettingsChange() {\n *       PriorityConfig.priorityFunctionsForAfterSettingsChange(this);\n         PriorityConfig.doPriorityFunctions(this);\n *       if (this.side !== Side.server) return; // HISTORY FUNCTONS MUST BE DONE ON BOTH SIDES\n *     }\n *\n */\n\nimport { SettingType} from '../../node';\nimport { Type } from '../../node-io';\nimport NodeUtils from '../../utils/node-utils';\n//import { tagsAll } from './tags';\n\nexport default class PriorityConfig {\n  static addPrioritySettings(self) {\n    self.properties['priorityStartInput'] = self.getFreeInputId();\n    self.properties['priorityStartOutput'] = self.getFreeOutputId();\n    self.addInput('inputValue', Type.ANY);\n    self.addInput('inputPriority', Type.NUMBER);\n    self.addOutput('outputValue', Type.ANY);\n    self.addOutput('outputPriority', Type.NUMBER);\n    self.addOutput('outputJSON', Type.STRING);\n\n    for (let input in self.inputs) {\n      if (self.inputs[input].name == 'inputValue') {\n        self.properties['valueInput'] = input;\n      } else if (self.inputs[input].name == 'inputPriority') self.properties['priorityInput'] = input;\n    }\n\n    for (let output in self.outputs) {\n      if (self.outputs[output].name == 'outputValue') {\n        self.properties['valueOutput'] = output;\n      } else if (self.outputs[output].name == 'outputPriority') {\n        self.properties['priorityOutput'] = output;\n      } else if (self.outputs[output].name == 'outputJSON') self.properties['jsonOutput'] = output;\n    }\n\n    /**\n     Point settings\n     */\n    self.settings['input_group'] = {\n      description: 'Input Settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n\n    self.settings['decimals'] = {\n      description: 'Decimal Places (Limit 5)',\n      value: 3,\n      type: SettingType.NUMBER,\n    };\n\n    self.settings['inputMethod'] = {\n      description: 'Input Method',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'Value and Priority' },\n          { value: 1, text: 'Priority Array' },\n          { value: 2, text: 'JSON' },\n        ],\n      },\n      value: 0,\n    };\n\n    // SETTINGS FOR \"VALUE AND PRIORITY\"\n    self.properties['priorityLevelItems'] = Array(16)\n      .fill(null)\n      .map((_, i) => ({ value: i + 1, text: (i + 1).toString() }));\n\n    self.settings['priorityLevel'] = {\n      description: 'Write Priority Level',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: self.properties['priorityLevelItems'],\n      },\n      value: 16,\n    };\n\n    // SETTINGS FOR \"PRIORITY ARRAY\"\n    self.settings['in1'] = {\n      description: 'in1',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in2'] = {\n      description: 'in2',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in3'] = {\n      description: 'in3',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in4'] = {\n      description: 'in4',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in5'] = {\n      description: 'in5',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in6'] = {\n      description: 'in6',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in7'] = {\n      description: 'in7',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in8'] = {\n      description: 'in8',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in9'] = {\n      description: 'in9',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in10'] = {\n      description: 'in10',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in11'] = {\n      description: 'in11',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in12'] = {\n      description: 'in12',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in13'] = {\n      description: 'in13',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in14'] = {\n      description: 'in14',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in15'] = {\n      description: 'in15',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    self.settings['in16'] = {\n      description: 'in16',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  static addPrioritySettingsConfig(self) {\n    if (!self.settingConfigs.hasOwnProperty('groups') && !self.settingConfigs.hasOwnProperty('conditions')) {\n      self.setSettingsConfig({ groups: [], conditions: {} });\n    }\n    self.settingConfigs.groups.push({ input_group: {} });\n    self.settingConfigs.conditions['priorityLevel'] = setting => {\n      return setting['inputMethod'].value == 0;\n    };\n    self.settingConfigs.conditions['in1'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in2'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in3'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in4'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in5'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in6'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in7'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in8'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in9'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in10'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in11'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in12'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in13'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in14'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in15'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n    self.settingConfigs.conditions['in16'] = setting => {\n      return setting['inputMethod'].value == 1;\n    };\n\n    //self.properties['priorityArray'] = new Array<Object>(16).fill(null);\n    self.properties['priorityArray'] = {};\n    for (var i = 1; i < 16; i++) {\n      self.properties['priorityArray'][String(i)] = null;\n    }\n    self.properties['inputMethod'] = self.settings['inputMethod'].value;\n    self.properties['prioritySettingsArray'] = new Array<Object>(16).fill(false);\n  }\n\n  static priorityOnCreated(self) {\n    self.properties['dynamicInputStartPosition'] = self.getInputsCount();\n    NodeUtils.persistProperties(self, true, true, true, true);\n  }\n\n  static async doPriorityFunctions(self) {\n    let input = null;\n    let priority = null;\n    switch (self.properties['inputMethod']) {\n      case 0:\n        input = self.getInputData(self.properties['priorityStartInput']);\n        if (input == undefined) input = null;\n        priority = self.getInputData(self.properties['priorityStartInput'] + 1) || 16;\n        if (priority > 16 || priority == null) priority = 16;\n        //self.properties['priorityArray'][`${priority-1}`] = input;\n        self.properties['priorityArray'][String(priority)] = input;\n        break;\n      case 1:\n        var inputsCount = 0;\n        self.properties['prioritySettingsArray'].forEach(setting => {\n          if (setting) inputsCount++;\n        });\n        for (var i = 0; i < inputsCount; i++) {\n          input = self.getInputData(self.properties['priorityStartInput'] + i);\n          if (input == undefined) input = null;\n          const inputName = self.inputs[self.properties['priorityStartInput'] + i].name;\n          if (inputName.startsWith('in')) {\n            const inputNumber = Number(inputName.replace(/\\D/g, ''));\n            if (!isNaN(inputNumber)) {\n              self.properties['priorityArray'][`${inputNumber}`] = input;\n            }\n          }\n        }\n        break;\n      case 2:\n        input = self.getInputData(self.properties['priorityStartInput']);\n        if (typeof input === 'string') {\n          try {\n            self.properties['priorityArray'] = JSON.parse(input);\n          } catch (e) {\n            console.log('PRIORITY ARRAY JSON ERROR: ', e);\n          }\n        }\n        break;\n    }\n\n    // CODE FOR A FUTURE INPUT METHOD\n    /*\n    if (payload.hasOwnProperty('priority') && payload.hasOwnProperty('value')) {\n      const priority = parseInt(payload['priority']);\n      if (isNaN(priority) || priority < 1 || priority > 16) {\n        this.debugErr('Invalid priority');\n        return;\n      }\n      // Release override\n      if (payload.value === '' || payload.value === null) {\n        this.priorityArray[priority - 1] = {}; // 1 priority on 0 position, 2 on 1 and so on...\n      } else {\n        this.priorityArray[priority - 1] = payload;\n      }\n    }\n    */\n\n    //const highestPriorityIndex = self.properties['priorityArray'].findIndex(\n    const highestPriorityIndex =\n      Object.values(self.properties['priorityArray']).findIndex(element => element != null) + 1;\n\n    if (highestPriorityIndex <= 0) {\n      self.setOutputData(self.properties['priorityStartOutput'], null);\n      self.setOutputData(self.properties['priorityStartOutput'] + 1, null);\n      self.setOutputData(self.properties['priorityStartOutput'] + 2, null);\n    } else {\n      self.setOutputData(\n        self.properties['priorityStartOutput'],\n        self.properties['priorityArray'][String(highestPriorityIndex)],\n      );\n      self.setOutputData(self.properties['priorityStartOutput'] + 1, highestPriorityIndex);\n      self.setOutputData(self.properties['priorityStartOutput'] + 2, self.properties['priorityArray']);\n    }\n  }\n\n  static async priorityFunctionsForAfterSettingsChange(self) {\n    if (self.properties['inputMethod'] !== self.settings['inputMethod'].value) {\n      PriorityConfig.initializePriorityArray(self);\n      switch (self.settings['inputMethod'].value) {\n        case 0:\n          if (self.properties['inputMethod'] == 2) {\n            self.removeInputAtPosition(self.properties['priorityStartInput']);\n          } else if (self.properties['inputMethod'] == 1) {\n            PriorityConfig.updatePriorityInputsFromSettings(self, true);\n          }\n          self.addInputAtPosition(self.properties['priorityStartInput'], 'inputValue', Type.ANY);\n          self.addInputAtPosition(self.properties['priorityStartInput'] + 1, 'inputPriority', Type.NUMBER);\n          break;\n        case 1:\n          if (self.properties['inputMethod'] == 2) {\n            self.removeInputAtPosition(self.properties['priorityStartInput']);\n          } else if (self.properties['inputMethod'] == 0) {\n            self.removeInputAtPosition(self.properties['priorityStartInput']);\n            self.removeInputAtPosition(self.properties['priorityStartInput']);\n          }\n          PriorityConfig.updatePriorityInputsFromSettings(self);\n          break;\n        case 2:\n          if (self.properties['inputMethod'] == 1) {\n            PriorityConfig.updatePriorityInputsFromSettings(self, true);\n          } else if (self.properties['inputMethod'] == 0) {\n            self.removeInputAtPosition(self.properties['priorityStartInput']);\n            self.removeInputAtPosition(self.properties['priorityStartInput']);\n          }\n          self.addInputAtPosition(self.properties['priorityStartInput'], 'inputJSON', Type.ANY);\n          break;\n      }\n    } else if (self.properties['inputMethod'] == 1) PriorityConfig.updatePriorityInputsFromSettings(self);\n    self.properties['inputMethod'] = self.settings['inputMethod'].value;\n    NodeUtils.persistProperties(self, true, true, true);\n  }\n\n  static async updatePriorityInputsFromSettings(self, removeAll = false) {\n    const startPosition = self.properties['priorityStartInput'];\n    var settingsArray = new Array(16).fill(false);\n    var inputsArray = new Array(16).fill(-1);\n    //console.log('INPUTS BEFORE', self.inputs)\n\n    for (var i = 0; i < 16; i++) {\n      removeAll ? (settingsArray[i] = false) : (settingsArray[i] = self.settings['in' + (i + 1)].value);\n      if (self.inputs.hasOwnProperty(`${startPosition + i}`)) {\n        const inputName = self.inputs[`${startPosition + i}`].name;\n        if (inputName.startsWith('in')) {\n          const inputNumber = Number(inputName.replace(/\\D/g, ''));\n          if (!isNaN(inputNumber)) {\n            inputsArray[i] = inputNumber;\n          }\n        }\n      }\n      self.properties['prioritySettingsArray'] = settingsArray;\n    }\n    //console.log('settingsArray', settingsArray)\n    //console.log('inputsArray', inputsArray)\n\n    for (var j = 0; j < 16; j++) {\n      //console.log('J', j)\n      if (settingsArray[j]) {\n        for (var y = 0; y <= j; y++) {\n          //console.log('Y', y)\n          const inputArrayatY = inputsArray[y];\n          //console.log('inputArrayatY', inputArrayatY)\n          if (inputArrayatY == j + 1) break;\n          //console.log('pastBreak')\n          if (inputArrayatY == -1 || inputArrayatY > j + 1) {\n            self.addInputAtPosition(startPosition + y, 'in' + (j + 1), Type.ANY);\n            inputsArray.splice(y, 0, j + 1);\n            inputsArray.pop();\n            //console.log('inputsArray', inputsArray);\n            //console.log('INPUTS', self.inputs)\n            break;\n          }\n        }\n      } else if (!settingsArray[j]) {\n        for (var x = 0; x <= j; x++) {\n          //console.log('X', x)\n          const inputArrayatX = inputsArray[x];\n          if (inputArrayatX == -1 || inputArrayatX > j + 1) {\n            break;\n          } else if (inputsArray[x] == j + 1) {\n            self.removeInputAtPosition(startPosition + x);\n            inputsArray.splice(x, 1);\n            inputsArray.push(-1);\n            //console.log('inputsArray', inputsArray)\n            //console.log('INPUTS', self.inputs)\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  static async initializePriorityArray(self) {\n    self.properties['priorityArray'] = {};\n    for (var i = 1; i < 16; i++) {\n      self.properties['priorityArray'][String(i)] = null;\n    }\n  }\n}\n","import { Node, SettingType} from '../../../node';\nimport { Container, Side } from '../../../container';\nimport * as nodemailer from 'nodemailer';\nimport { Type } from '../../../node-io';\nimport CryptoUtils from '../../../utils/crypto-utils';\nimport Utils from '../../../utils';\n\nclass EmailNode extends Node {\n  lastTrigger: boolean;\n  // Supported services: https://github.com/nodemailer/nodemailer/blob/master/lib/well-known/services.json\n  services = ['Gmail', 'Hotmail', 'Outlook365', 'Yahoo'].map(service => {\n    return { value: service, text: service };\n  });\n  constructor() {\n    super();\n    this.title = 'Email';\n    this.description =\n      \"Once configured (in settings) with the sender email server details ('email' and 'password') for Gmail, Hotmail, Outlook365, or Yahoo accounts: This node will attempt to send a new email when 'trigger' transitions from 'false' to 'true'.   The String 'recipient' value will be the to: email address; The String 'subject' value will be the email subject; and the String 'message' value will be the email body.  The 'response' output will be 'true' if the email is sent successfully.  The 'error' output will be an error message String if there is an error sending the email. \";\n    this.settings['service'] = {\n      description: 'Service',\n      value: this.services[0].value,\n      type: SettingType.DROPDOWN,\n      config: {\n        items: this.services,\n      },\n    };\n    this.settings['user'] = { description: 'Email', value: '', type: SettingType.STRING };\n    this.settings['pass'] = { description: 'Password', value: '', type: SettingType.PASSWORD };\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInputWithSettings('recipient', Type.STRING, '', 'To', false);\n    this.addInputWithSettings('subject', Type.STRING, '', 'Subject', false);\n    this.addInputWithSettings('message', Type.STRING, '', 'Message', false);\n    this.addOutput('response', Type.STRING);\n    this.addOutput('error', Type.STRING);\n  }\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return; // only execute on server\n\n    let trigger = this.getInputData(0);\n    if (!Utils.hasInput(trigger)) trigger = false;\n    if (trigger == this.lastTrigger) return;\n    else this.lastTrigger = trigger;\n    if (trigger == false) return;\n\n    const service = this.settings['service'].value;\n    const user = this.settings['user'].value;\n    const from = user;\n    const pass = this.settings['pass'].value;\n    const to = this.getInputData(1);\n    const subject = this.getInputData(2);\n    const text = this.getInputData(3);\n\n    const transporter = nodemailer.createTransport({\n      service,\n      auth: { user, pass: CryptoUtils.decrypt(pass) },\n    });\n\n    transporter.sendMail({ from, to, subject, text }, error => {\n      if (error) {\n        this.emitError(error.message);\n      } else {\n        this.emitResult(true);\n      }\n    });\n  }\n\n  emitResult(result) {\n    this.setOutputData(0, result);\n    this.setOutputData(1, null);\n  }\n\n  emitError(body) {\n    this.setOutputData(0, null);\n    this.setOutputData(1, body);\n  }\n}\n\nContainer.registerNodeType('protocols/misc/email', EmailNode);\n","module.exports = require(\"nodemailer\");","import axios from 'axios';\nimport Icons from '../../../node-icons';\nimport { EDGE_28_NETWORK } from '../../../constants';\nimport { Container, Side } from '../../../container';\nimport { ContainerNode } from '../../../container-node';\nimport { Node, SettingType } from '../../../node';\nimport { Type } from '../../../node-io';\nimport Utils from '../../../utils';\nimport EdgeHelp from '../../../utils/help/protocols/edge-28';\nimport TimeUtils from '../../../utils/time-utils';\nimport { ADD_POINT, edgeApiVer, edgeIp, edgePort, REMOVE_POINT } from './edge-constant';\nimport Edge28Utils from './edge-utils';\n\nclass Edge28ApiNode extends ContainerNode {\n  // point object\n  pointNodes: Array<Node> = [];\n  edgeReadDI_Store: {};\n  edgeReadUI_Store: {};\n\n  // node inputs\n  inAlarmTrigger = 0;\n  inHistoryTrigger = 1;\n  inInput = 2;\n\n  // node outputs\n  outVal = 0;\n  outError = 1;\n  outMessageJson = 2;\n  outAlarm = 3;\n\n  lastInterval = 1000;\n  runState: boolean = true;\n  UI_timeoutFunc;\n  DI_timeoutFunc;\n  _ui = 'ui';\n  _di = 'di';\n\n  constructor(container) {\n    super(container);\n    this.title = 'Edge 28 Network';\n    this.description = EdgeHelp.NetworkDesc;\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addInputWithSettings('interval', Type.NUMBER, 2, 'Polling Interval');\n    this.addOutput('connected', Type.BOOLEAN);\n    this.addOutput('error', Type.STRING);\n    if (this.side !== Side.server) {\n      this.iconImageUrl = Icons.frog;\n    }\n    this.headerColor = '#184840';\n    this.settings['time'] = {\n      description: 'Polling Interval Time Setting',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          // { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n  }\n\n  async fetchPointValue(host: string, port: number, apiVer: string, pointType: string): Promise<any> {\n    const url = `${Utils.buildUrl(host, port)}/api/${apiVer}/read/all/${pointType}`;\n    const pointValue = await axios.get(url);\n    return pointValue.data;\n  }\n\n  async onAdded() {\n    super.onAdded();\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    clearInterval(this.UI_timeoutFunc);\n    clearInterval(this.DI_timeoutFunc);\n    let enable = this.getInputData(0);\n    if (!enable) {\n      this.setOutputData(0, false); //connected\n      this.runState = false;\n      return;\n    }\n    let interval = this.getInputData(1);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    this.startInputPolling(interval);\n    await this.onInputUpdated();\n  }\n\n  async onRemoved() {\n    super.onRemoved();\n    clearInterval(this.UI_timeoutFunc);\n    clearInterval(this.DI_timeoutFunc);\n  }\n\n  startInputPolling(interval: number) {\n    if (this.side !== Side.server) return;\n    this.UI_timeoutFunc = setInterval(async () => {\n      // get UIs\n      await this.pollUIs();\n      this.sendPayloadToPointNodesFunc();\n    }, interval);\n    this.DI_timeoutFunc = setInterval(async () => {\n      // get DIs\n      await this.pollDIs();\n      this.sendPayloadToPointNodesFunc();\n    }, interval + 5);\n  }\n\n  async pollUIs() {\n    try {\n      this.edgeReadUI_Store = await this.fetchPointValue(edgeIp, edgePort, edgeApiVer, this._ui);\n      this.setOutputData(0, true); //connected\n      this.setOutputData(1, false); //error\n      // NodeColours.nodeColourChange(this, NodeState.ONLINE);\n    } catch (err) {\n      this.debugInfo(`ERROR: getting edge point type: ${this._ui} ${err}`);\n      this.setOutputData(0, false); //connected\n      this.setOutputData(1, true); //error\n      // NodeColours.nodeColourChange(this, NodeState.OFFLINE);\n    }\n  }\n\n  async pollDIs() {\n    try {\n      this.edgeReadDI_Store = await this.fetchPointValue(edgeIp, edgePort, edgeApiVer, this._di);\n      this.setOutputData(0, true); //connected\n      this.setOutputData(1, false); //error\n      // NodeColours.nodeColourChange(this, NodeState.ONLINE);\n    } catch (err) {\n      this.debugInfo(`ERROR: getting edge point type: ${this._di} ${err}`);\n      this.setOutputData(0, false); //connected\n      this.setOutputData(1, true); //error\n      // NodeColours.nodeColourChange(this, NodeState.OFFLINE);\n    }\n  }\n\n  async pollInputsAndSend() {\n    if (this.side !== Side.server) return;\n    await this.pollUIs();\n    await this.pollDIs();\n    this.sendPayloadToPointNodesFunc();\n  }\n\n  sendPayloadToPointNodesFunc() {\n    if (this.side !== Side.server) return;\n    for (let pointNode of this.pointNodes) {\n      Edge28Utils.sendPayloadToChild(pointNode, {\n        pointsDI: this.edgeReadDI_Store,\n        pointsUI: this.edgeReadUI_Store,\n      });\n    }\n  }\n\n  subscribe({ action, payload }) {\n    switch (action) {\n      case ADD_POINT:\n        this.pointNodes.push(payload);\n        break;\n      case REMOVE_POINT:\n        this.pointNodes = this.pointNodes.filter(pointNode => pointNode.id !== payload.id);\n        break;\n      default:\n        this.debugWarn(\"Request action doesn't match\");\n    }\n  }\n\n  async onInputUpdated() {\n    if (this.side !== Side.server) return;\n    let enable = this.getInputData(0);\n    if (!enable && this.runState) {\n      clearInterval(this.UI_timeoutFunc);\n      clearInterval(this.DI_timeoutFunc);\n      this.setOutputData(0, false, true); //connected\n      this.runState = false;\n      return;\n    } else if (!enable && !this.runState) {\n      this.setOutputData(0, false, true); //connected\n      this.runState = false;\n      return;\n    } else if (enable) {\n      let interval = this.getInputData(1);\n      interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n      if (this.runState) {\n        if (interval != this.lastInterval) {\n          this.lastInterval = interval;\n          clearInterval(this.UI_timeoutFunc);\n          clearInterval(this.DI_timeoutFunc);\n          this.startInputPolling(interval);\n        }\n        return;\n      } else if (!this.runState) {\n        this.runState = true;\n        this.startInputPolling(interval);\n        return;\n      }\n      await this.pollInputsAndSend();\n    }\n  }\n\n  async onAfterSettingsChange(oldSettings: any) {\n    super.onAfterSettingsChange(oldSettings);\n    if (this.side !== Side.server) return;\n    await this.onInputUpdated();\n  }\n}\n\nContainer.registerNodeType(EDGE_28_NETWORK, Edge28ApiNode);\n","import { SettingType, NodeState } from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { Type } from '../../../node-io';\nimport { SEND_PAYLOAD_TO_CHILD } from './edge-constant';\nimport Edge28Utils from './edge-utils';\nimport EdgeGPIOUtils from './edge-gpio-utils';\nimport Edge10kSensorUtils from './edge-10k-sensor-calc';\nimport BACnetEnumsUnits from '../../../utils/points/BACnet-enums-units';\nimport Utils from '../../../utils';\nimport { EDGE_28_INPUT, EDGE_28_NETWORK } from '../../../constants';\nimport MathUtils, { MATH_FUNC_TYPE } from '../../../utils/MathUtils';\nimport HistoryBase from '../../history/HistoryBase';\nimport EdgeHelp from '../../../utils/help/protocols/edge-28';\n\nenum POINT_TYPE {\n  DIGITAL = 1,\n  UI_DIGITAL = 2,\n  _0_10DC = 3,\n  _0_20MA = 4,\n  _4_20MA = 5,\n  _10K_THERMISTOR = 6,\n}\n\nenum POINT_TYPE_TEXT {\n  DIGITAL = 'Digital',\n  UI_DIGITAL = `UI-Digital`,\n  _0_10DC = `0-10dc`,\n  _0_20MA = `0-20ma`,\n  _4_20MA = `4-20ma`,\n  _10K_THERMISTOR = `10k-thermistor`,\n}\n\nclass Edge28InputPointNode extends HistoryBase {\n  out: any;\n  constructor() {\n    super();\n    this.title = 'Edge IO 28 Input';\n    this.description = EdgeHelp.inputsDesc;\n    this.addOutput('output', Type.NUMBER);\n    this.addOutput('output-json', Type.STRING);\n    this.addOutput('error', Type.STRING);\n\n    /**\n      Default point Settings (Will be in point class)\n   */\n    this.settings['pointEnable'] = {\n      description: 'Point enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['pointDebug'] = {\n      description: 'Point Debug',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['pointNumber'] = {\n      description: 'Point',\n      value: 'DI1',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'DI1', text: `DI1` },\n          { value: 'DI2', text: `DI2` },\n          { value: 'DI3', text: `DI3` },\n          { value: 'DI4', text: `DI4` },\n          { value: 'DI5', text: `DI5` },\n          { value: 'DI6', text: `DI6` },\n          { value: 'DI7', text: `DI7` },\n          { value: 'UI1', text: `UI1` },\n          { value: 'UI2', text: `UI2` },\n          { value: 'UI3', text: `UI3` },\n          { value: 'UI4', text: `UI4` },\n          { value: 'UI5', text: `UI5` },\n          { value: 'UI6', text: `UI6` },\n          { value: 'UI7', text: `UI7` },\n        ],\n      },\n    };\n    this.settings['pointType'] = {\n      description: 'Point Type',\n      value: 1,\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: POINT_TYPE.DIGITAL, text: `Digital` },\n          { value: POINT_TYPE.UI_DIGITAL, text: `UI-Digital` },\n          { value: POINT_TYPE._0_10DC, text: `0-10dc` },\n          { value: POINT_TYPE._0_20MA, text: `0-20ma` },\n          { value: POINT_TYPE._4_20MA, text: `4-20ma` },\n          { value: POINT_TYPE._10K_THERMISTOR, text: `10k-thermistor` },\n        ],\n        value: POINT_TYPE.DIGITAL,\n      },\n    };\n\n    this.settings['value_group'] = {\n      description: 'Point Settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['lowScale'] = {\n      description: 'Low scale',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.settings['highScale'] = {\n      description: 'High scale',\n      value: 100,\n      type: SettingType.NUMBER,\n    };\n    this.settings['decimals'] = {\n      description: 'Out value precision',\n      value: 2,\n      type: SettingType.NUMBER,\n    };\n    this.settings['offset'] = {\n      description: 'Out value offset',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    /**\n        Point Math settings\n     */\n    this.settings['mathFunc'] = {\n      description: 'Math on output value (optional)',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: MATH_FUNC_TYPE.NA, text: 'na' },\n          { value: MATH_FUNC_TYPE.ADD, text: 'add' },\n          { value: MATH_FUNC_TYPE.SUBTRACT, text: 'subtract' },\n          { value: MATH_FUNC_TYPE.MULTIPLY, text: 'multiply' },\n          { value: MATH_FUNC_TYPE.DIVIDE, text: 'divide' },\n          { value: MATH_FUNC_TYPE.NUMBER_INVERT, text: 'invert' },\n        ],\n      },\n      value: MATH_FUNC_TYPE.NA,\n    };\n    this.settings['mathValue'] = {\n      description: 'Enter a value',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['units_group'] = {\n      description: 'Units (Save to get units)',\n      type: SettingType.GROUP,\n    };\n    this.settings['unitsType'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: BACnetEnumsUnits.unitCategory,\n      },\n    };\n    this.settings['units'] = {\n      description: 'Units',\n      value: BACnetEnumsUnits.COMMON_METRIC.NO_UNITS,\n      type: SettingType.DROPDOWN,\n    };\n\n    const isDigitalType = [POINT_TYPE.DIGITAL, POINT_TYPE.UI_DIGITAL];\n\n    this.setSettingsConfig({\n      groups: [\n        { pointEnable: {}, pointDebug: {} },\n        { pointNumber: {}, pointType: {} },\n        { decimals: {}, offset: {} },\n        { lowScale: {}, highScale: {} },\n        { mathFunc: {}, mathValue: {} },\n        { unitsType: {}, units: {} },\n      ],\n      conditions: {\n        decimals: setting => {\n          const val = setting['pointType'].value;\n          return !isDigitalType.includes(val);\n        },\n        offset: setting => {\n          const val = setting['pointType'].value;\n          return !isDigitalType.includes(val);\n        },\n        lowScale: setting => {\n          const val = setting['pointType'].value;\n          return !isDigitalType.includes(val);\n        },\n        highScale: setting => {\n          const val = setting['pointType'].value;\n          return !isDigitalType.includes(val);\n        },\n        mathValue: setting => {\n          const val = setting['mathFunc'].value;\n          return ![MATH_FUNC_TYPE.NUMBER_INVERT, MATH_FUNC_TYPE.NA].includes(val);\n        },\n      },\n    });\n    this.addHistorySettingsConfig(0, false);\n  }\n\n  async onAdded() {\n    this.updateTitle();\n    super.onAdded();\n    if (this.side !== Side.server) return;\n    await Utils.sleep(1000); // TODO: Since this node should start after network, import may shows issue if we don't have this\n    Edge28Utils.addPoint(this.getParentNode(), this);\n  }\n\n  async onAfterSettingsChange() {\n    await super.onAfterSettingsChange();\n    if (this.side !== Side.server) return;\n    this.updateTitle();\n    // this.nodeColour();\n    const unitsType = this.settings['unitsType'].value;\n    this.settings['units'].config = {\n      items: BACnetEnumsUnits.unitType(unitsType),\n    };\n    this.sendPointValue(this.out);\n    this.broadcastSettingsToClients();\n\n    setTimeout(() => {\n      this.settings['pointDebug'].value = false;\n      // this.broadcastSettingsToClients(); // TODO is not updating the settings to false.. fuck knows why\n    }, 120 * 1000); // stop debug after 120 sec\n  }\n\n  onRemoved() {\n    super.onRemoved();\n    Edge28Utils.removePoint(this.getParentNode(), this);\n  }\n\n  sendJson() {\n    return {\n      name: this.name,\n      pointValue: this.out,\n      enable: this.settings['pointEnable'].value,\n      units: this.settings['units'].value,\n      pointNumber: this.settings['pointNumber'].value,\n      pointType: this.settings['pointType'].value,\n      pointOffset: this.settings['offset'].value,\n    };\n  }\n\n  nodeColour() {\n    if (this.settings['pointEnable'].value === false) {\n      this.setNodeState(NodeState.INFO);\n    } else this.setNodeState(NodeState.NORMAL);\n  }\n\n  sendPointValue(val) {\n    const debug = this.settings['pointDebug'].value;\n    if (debug) {\n      this.setOutputData(0, val);\n      this.setOutputData(1, this.sendJson());\n    } else {\n      this.setOutputData(0, val);\n      this.setOutputData(1, this.sendJson());\n    }\n  }\n\n  pointOffset(val: any) {\n    let offset = this.settings['offset'].value;\n    if (offset === null) {\n      offset = 0;\n    }\n    return parseFloat(val) + parseFloat(offset);\n  }\n\n  pointTypeText(type) {\n    switch (type) {\n      case POINT_TYPE.DIGITAL:\n        return POINT_TYPE_TEXT.DIGITAL;\n      case POINT_TYPE.UI_DIGITAL:\n        return POINT_TYPE_TEXT.UI_DIGITAL;\n      case POINT_TYPE._0_10DC:\n        return POINT_TYPE_TEXT._0_10DC;\n      case POINT_TYPE._0_20MA:\n        return POINT_TYPE_TEXT._0_20MA;\n      case POINT_TYPE._4_20MA:\n        return POINT_TYPE_TEXT._4_20MA;\n      case POINT_TYPE._10K_THERMISTOR:\n        return POINT_TYPE_TEXT._10K_THERMISTOR;\n\n      default:\n        this.debugWarn('Unknown type of object');\n    }\n  }\n\n  updateTitle() {\n    const pointNumber = this.settings['pointNumber'].value;\n    this.title = `Edge-28-Input: (${pointNumber} as ${this.pointTypeText(this.settings['pointType'].value)})`;\n    this.broadcastTitleToClients();\n  }\n\n  pointCalcs(val: number) {\n    const mathFunc = this.settings['mathFunc'].value;\n    const mathValue = this.settings['mathValue'].value;\n    const decimals = this.settings['decimals'].value;\n    const pointType = this.settings['pointType'].value;\n    const isDigitalType = [POINT_TYPE.DIGITAL, POINT_TYPE.UI_DIGITAL];\n    if (MathUtils.validateNumbers(val, mathValue)) {\n      if (mathFunc !== MATH_FUNC_TYPE.NA) {\n        if (!isDigitalType.includes(pointType)) {\n          this.out = MathUtils.mathSwitch(mathFunc, val, mathValue);\n          this.out = MathUtils.decimals(this.out, decimals);\n          this.out = this.pointOffset(this.out);\n          this.sendPointValue(this.out);\n        } else {\n          this.out = MathUtils.mathSwitch(mathFunc, val, mathValue);\n          this.out = this.pointOffset(this.out);\n          this.sendPointValue(this.out);\n        }\n      } else {\n        if (!isDigitalType.includes(pointType)) {\n          this.out = MathUtils.decimals(val, decimals);\n          this.out = this.pointOffset(this.out);\n        } else {\n          this.out = val;\n        }\n        this.sendPointValue(this.out);\n      }\n    }\n  }\n\n  uiType(type: number, val: number, min_range?: number, max_range?: number) {\n    const lowScale = this.settings['lowScale'].value;\n    const highScale = this.settings['highScale'].value;\n    switch (type) {\n      case POINT_TYPE.DIGITAL:\n        this.pointCalcs(EdgeGPIOUtils.diInvert(val));\n        break;\n      case POINT_TYPE.UI_DIGITAL:\n        this.pointCalcs(EdgeGPIOUtils.uiAsDI(val));\n        break;\n      case POINT_TYPE._0_10DC:\n        const limitValDc = Utils.clamp(val, 0, highScale);\n        this.pointCalcs(EdgeGPIOUtils.scaleFromGPIOValue(limitValDc, lowScale, highScale));\n        break;\n      case POINT_TYPE._0_20MA:\n        const limitValMaZero = Utils.clamp(val, 0, highScale);\n        this.pointCalcs(EdgeGPIOUtils.scaleFromGPIOValue(limitValMaZero, lowScale, highScale));\n        break;\n      case POINT_TYPE._4_20MA:\n        const limitValMaFour = EdgeGPIOUtils.scaleUI420ma(val, min_range, max_range);\n        this.pointCalcs(EdgeGPIOUtils.scale420maToRange(limitValMaFour, lowScale, highScale));\n        break;\n      case POINT_TYPE._10K_THERMISTOR:\n        this.pointCalcs(Edge10kSensorUtils.calc10kThermistor(val));\n        break;\n    }\n  }\n\n  subscribe({ action, payload }) {\n    switch (action) {\n      case SEND_PAYLOAD_TO_CHILD:\n        if (this.settings['pointEnable'].value === false) return;\n        const pointType = this.settings['pointType'].value;\n        const pointNumber = this.settings['pointNumber'].value;\n        let out: number;\n        let min_range: number;\n        let max_range: number;\n        if (pointType === POINT_TYPE.DIGITAL) {\n          if (!['DI1', 'DI2', 'DI3', 'DI4', 'DI5', 'DI6', 'DI7'].includes(pointNumber)) return;\n          try {\n            for (let val of [payload]) {\n              out = val.pointsDI['4_val'][this.settings['pointNumber'].value].val;\n            }\n            this.uiType(pointType, out, payload);\n          } catch (err) {\n            this.debugErr(err);\n          }\n        } else {\n          if (!['UI1', 'UI2', 'UI3', 'UI4', 'UI5', 'UI6', 'UI7'].includes(pointNumber)) return;\n          try {\n            for (let val of [payload]) {\n              out = val.pointsUI['4_val'][this.settings['pointNumber'].value].val;\n              min_range = val.pointsUI['6_min_range'][this.settings['pointNumber'].value];\n              max_range = val.pointsUI['7_max_range'][this.settings['pointNumber'].value];\n            }\n            this.uiType(pointType, out, min_range, max_range);\n          } catch (err) {\n            this.debugErr(err);\n          }\n        }\n        break;\n      default:\n        this.debugWarn(\"Request action doesn't match\");\n    }\n  }\n}\n\nContainer.registerNodeType(EDGE_28_INPUT, Edge28InputPointNode, EDGE_28_NETWORK);\n","export default class Edge10kSensorUtils {\n  /*\n    used for scaling a UO from a float to a 10K temp reading\n    */\n  static calc10kThermistor = (val: number): number => {\n    const raw10K = [\n      0.9556905617,\n      0.9540427367,\n      0.9523006917,\n      0.9504602339,\n      0.9485172744,\n      0.946467535,\n      0.944306865,\n      0.9420290739,\n      0.9396319594,\n      0.9371093311,\n      0.9344568928,\n      0.9316708217,\n      0.9287447039,\n      0.9256742939,\n      0.9224557261,\n      0.91908403,\n      0.9155539628,\n      0.9118616967,\n      0.9080003267,\n      0.9039690867,\n      0.8997620283,\n      0.8953731717,\n      0.8908015628,\n      0.8860418194,\n      0.8810918183,\n      0.8759457717,\n      0.8706035044,\n      0.8650596894,\n      0.8593146611,\n      0.8533643761,\n      0.8472041872,\n      0.8408402328,\n      0.8342674089,\n      0.8274824028,\n      0.8204910228,\n      0.8132897394,\n      0.8058858472,\n      0.7982715539,\n      0.7904548383,\n      0.7824349294,\n      0.7742229339,\n      0.7658146322,\n      0.7572185678,\n      0.7484302572,\n      0.7394743383,\n      0.73033582,\n      0.7210303644,\n      0.7115748456,\n      0.7019597739,\n      0.6922074256,\n      0.6823111222,\n      0.6722912061,\n      0.6621575094,\n      0.6519178717,\n      0.6415775039,\n      0.6311526306,\n      0.6206437806,\n      0.6100630156,\n      0.5994548717,\n      0.588779615,\n      0.5780593139,\n      0.5673369194,\n      0.5565970278,\n      0.5458604304,\n      0.5351246092,\n      0.5244065761,\n      0.513722581,\n      0.5030878249,\n      0.4924882451,\n      0.4819615594,\n      0.4714876446,\n      0.4611024332,\n      0.450811465,\n      0.4405833684,\n      0.4304850415,\n      0.4204801987,\n      0.4106001113,\n      0.4008382911,\n      0.3912252038,\n      0.3817085907,\n      0.3723569356,\n      0.3631557389,\n      0.3540861978,\n      0.3451724444,\n      0.3363907538,\n      0.3277628108,\n      0.3193109318,\n      0.3110054108,\n      0.3028656927,\n      0.2949116408,\n      0.2871070734,\n      0.2794687028,\n      0.272013505,\n      0.264698569,\n      0.2575375869,\n      0.2505444204,\n      0.2437330494,\n      0.2370527064,\n      0.2305799944,\n      0.2242619327,\n      0.2180410733,\n      0.2119941474,\n      0.2061319159,\n      0.2003937116,\n      0.1948594611,\n      0.1893929343,\n      0.1841473882,\n      0.1789825137,\n      0.1739791116,\n      0.1691445094,\n      0.1644078283,\n      0.1597735289,\n      0.1553259162,\n      0.1509105486,\n      0.1466923378,\n      0.1425957094,\n      0.1386248913,\n      0.1347001575,\n      0.1309926256,\n      0.1273378137,\n      0.1237375067,\n      0.1202802759,\n      0.116969961,\n      0.1137221844,\n      0.1105386486,\n      0.107421042,\n      0.1044610471,\n      0.1015715166,\n      0.09875404639,\n      0.09610194494,\n      0.09343384,\n      0.09084241711,\n      0.0884225005,\n      0.08598938206,\n      0.08363729444,\n      0.08136762256,\n      0.07918171356,\n      0.07698514917,\n      0.07497021833,\n      0.07294627961,\n      0.07091327239,\n      0.06906601989,\n      0.06721124833,\n      0.06544711883,\n      0.06367616028,\n      0.061997282,\n      0.06041153422,\n      0.05882030111,\n      0.05722355406,\n      0.05572157039,\n      0.05431530289,\n      0.05290475159,\n      0.05148989689,\n      0.05017223272,\n      0.04895260508,\n      0.04762772774,\n      0.04640141447,\n      0.045274458,\n      0.04414477874,\n      0.04301236682,\n      0.04187721228,\n      0.04084286529,\n      0.03980623591,\n      0.03887131178,\n      0.03793452726,\n      0.03699587678,\n      0.03605535477,\n      0.03511295563,\n      0.03427368709,\n      0.03343292697,\n      0.03269603518,\n      0.03185246761,\n      0.03111311315,\n      0.03037260522,\n      0.02963094111,\n      0.02888811812,\n      0.02825048826,\n      0.02761200327,\n      0.02697266141,\n      0.02633246097,\n      0.02569140021,\n      0.02504947741,\n      0.02451388196,\n      0.02397768566,\n      0.02333345552,\n      0.02279593374,\n      0.02236548142,\n      0.02182687151,\n      0.02128765566,\n      0.02085584601,\n      0.02042364737,\n    ];\n    const temps10K = [\n      -40,\n      -39,\n      -38,\n      -37,\n      -36,\n      -35,\n      -34,\n      -33,\n      -32,\n      -31,\n      -30,\n      -29,\n      -28,\n      -27,\n      -26,\n      -25,\n      -24,\n      -23,\n      -22,\n      -21,\n      -20,\n      -19,\n      -18,\n      -17,\n      -16,\n      -15,\n      -14,\n      -13,\n      -12,\n      -11,\n      -10,\n      -9,\n      -8,\n      -7,\n      -6,\n      -5,\n      -4,\n      -3,\n      -2,\n      -1,\n      0,\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8,\n      9,\n      10,\n      11,\n      12,\n      13,\n      14,\n      15,\n      16,\n      17,\n      18,\n      19,\n      20,\n      21,\n      22,\n      23,\n      24,\n      25,\n      26,\n      27,\n      28,\n      29,\n      30,\n      31,\n      32,\n      33,\n      34,\n      35,\n      36,\n      37,\n      38,\n      39,\n      40,\n      41,\n      42,\n      43,\n      44,\n      45,\n      46,\n      47,\n      48,\n      49,\n      50,\n      51,\n      52,\n      53,\n      54,\n      55,\n      56,\n      57,\n      58,\n      59,\n      60,\n      61,\n      62,\n      63,\n      64,\n      65,\n      66,\n      67,\n      68,\n      69,\n      70,\n      71,\n      72,\n      73,\n      74,\n      75,\n      76,\n      77,\n      78,\n      79,\n      80,\n      81,\n      82,\n      83,\n      84,\n      85,\n      86,\n      87,\n      88,\n      89,\n      90,\n      91,\n      92,\n      93,\n      94,\n      95,\n      96,\n      97,\n      98,\n      99,\n      100,\n      101,\n      102,\n      103,\n      104,\n      105,\n      106,\n      107,\n      108,\n      109,\n      110,\n      111,\n      112,\n      113,\n      114,\n      115,\n      116,\n      117,\n      118,\n      119,\n      120,\n      121,\n      122,\n      123,\n      124,\n      125,\n      126,\n      127,\n      128,\n      129,\n      130,\n      131,\n      132,\n      133,\n      134,\n      135,\n      136,\n      137,\n      138,\n      139,\n      140,\n      141,\n      142,\n      143,\n      144,\n      145,\n      146,\n      147,\n      148,\n      149,\n      150,\n    ];\n    let value = val;\n    for (let i = 0; i < 190; i++) {\n      if (value <= raw10K[i] && value > raw10K[i + 1]) {\n        value = temps10K[i + 1] - (value - raw10K[i + 1]) / (raw10K[i] - raw10K[i + 1]);\n        break;\n      }\n    }\n    return value;\n  };\n}\n","import { SettingType} from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { Type } from '../../../node-io';\n\nimport Edge28Utils from './edge-utils';\nimport EdgeGPIOUtils from './edge-gpio-utils';\nimport BACnetEnumsUnits from '../../../utils/points/BACnet-enums-units';\nimport { edgeIp, edgePort, edgeApiVer } from './edge-constant';\nimport { EDGE_28_NETWORK, EDGE_28_OUTPUT } from '../../../constants';\nimport HistoryBase from '../../history/HistoryBase';\nimport EdgeHelp from '../../../utils/help/protocols/edge-28';\nimport { isNull } from '../../../../utils/helper';\nenum OUTPUT_POINT_TYPE {\n  DO = 1,\n  UO_AS_DIGITAL = 2,\n  UO_AS_0_10DC = 3,\n}\n\nenum OUTPUT_POINT_TYPE_TEXT {\n  DO = 'DO',\n  UO_AS_DIGITAL = 'UO As Digital',\n  UO_AS_0_10DC = 'UO As 0-10dc',\n}\n\nclass Edge28OutputPointNode extends HistoryBase {\n  uuid: Number = null;\n  deviceContainerID: Number = null;\n  topic: string = null;\n  newSetting = false;\n  lastSendTime;\n\n  // node inputs\n  inInput: number = 0;\n  inAlarmTrigger: number = 1;\n  inHistoryTrigger: number = 2;\n\n  constructor(container) {\n    super(container);\n    this.title = 'Edge IO 28 Output';\n    this.description = EdgeHelp.NetworkDesc;\n\n    this.addInput('input', Type.ANY);\n    this.addOutput('output', Type.NUMBER);\n    this.addOutput('output-json', Type.JSON);\n    this.properties['pointVal'] = null;\n\n    // Default point Settings (Will be in point class)\n    this.settings['pointEnable'] = {\n      description: 'Point enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['pointType'] = {\n      description: 'Point Type',\n      value: OUTPUT_POINT_TYPE.DO,\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: OUTPUT_POINT_TYPE.DO, text: OUTPUT_POINT_TYPE_TEXT.DO },\n          { value: OUTPUT_POINT_TYPE.UO_AS_DIGITAL, text: OUTPUT_POINT_TYPE_TEXT.UO_AS_DIGITAL },\n          { value: OUTPUT_POINT_TYPE.UO_AS_0_10DC, text: OUTPUT_POINT_TYPE_TEXT.UO_AS_0_10DC },\n        ],\n      },\n    };\n    this.settings['pointNumber'] = {\n      description: 'Point',\n      value: 'UO1',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'UO1', text: `UO1` },\n          { value: 'UO2', text: `UO2` },\n          { value: 'UO3', text: `UO3` },\n          { value: 'UO4', text: `UO4` },\n          { value: 'UO5', text: `UO5` },\n          { value: 'UO6', text: `UO6` },\n          { value: 'UO7', text: `UO7` },\n          { value: 'DO1', text: `DO1` },\n          { value: 'DO2', text: `DO2` },\n          { value: 'DO3', text: `DO3` },\n          { value: 'DO4', text: `DO4` },\n          { value: 'DO5', text: `DO5` },\n          { value: 'R1', text: `R1` },\n          { value: 'R2', text: `R2` },\n        ],\n      },\n    };\n    this.settings['units_group'] = {\n      description: 'Units (Save to get units)',\n      type: SettingType.GROUP,\n    };\n    this.settings['unitsType'] = {\n      description: 'Units Category',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: BACnetEnumsUnits.unitCategory,\n      },\n    };\n    this.settings['units'] = {\n      description: 'Units Type',\n      value: BACnetEnumsUnits.COMMON_METRIC.NO_UNITS,\n      type: SettingType.DROPDOWN,\n    };\n\n    this.setSettingsConfig({\n      groups: [\n        { pointNumber: {}, pointType: {} },\n        { mathFunc: {}, mathValue: {} },\n        { unitsType: {}, units: {} },\n      ],\n      conditions: {\n        mathValue: setting => {\n          const val = setting['mathFunc'].value;\n          return ![10, 0].includes(val);\n        },\n      },\n    });\n\n    this.addHistorySettingsConfig();\n  }\n\n  onAdded() {\n    super.onAdded();\n    this.updateTitle();\n    if (this.side !== Side.server) return;\n    this.EXECUTE_INTERVAL = 60000;\n    this.lastSendTime = new Date().valueOf();\n    this.inputChange();\n  }\n\n  async onExecute() {\n    if (this.side !== Side.server) return;\n    if (new Date().valueOf() - 1000 > this.lastSendTime) await this.onInputUpdated();\n  }\n\n  pointType(type) {\n    switch (type) {\n      case OUTPUT_POINT_TYPE.DO:\n        return 'do';\n      case OUTPUT_POINT_TYPE.UO_AS_DIGITAL:\n        return 'uo';\n      case OUTPUT_POINT_TYPE.UO_AS_0_10DC:\n        return 'uo';\n      default:\n        this.debugWarn('Unknown type of object');\n    }\n  }\n\n  pointTypeText(type) {\n    switch (type) {\n      case OUTPUT_POINT_TYPE.DO:\n        return OUTPUT_POINT_TYPE_TEXT.DO;\n      case OUTPUT_POINT_TYPE.UO_AS_DIGITAL:\n        return OUTPUT_POINT_TYPE_TEXT.UO_AS_DIGITAL;\n      case OUTPUT_POINT_TYPE.UO_AS_0_10DC:\n        return OUTPUT_POINT_TYPE_TEXT.UO_AS_0_10DC;\n      default:\n        this.debugWarn('Unknown type of object');\n    }\n  }\n\n  async onInputUpdated() {\n    await super.onInputUpdated();\n    this.inputChange();\n  }\n\n  onRemoved() {\n    super.onRemoved();\n  }\n\n  async onAfterSettingsChange() {\n    await super.onAfterSettingsChange();\n    this.updateTitle();\n    const unitsType = this.settings['unitsType'].value;\n    this.settings['units'].config = {\n      items: BACnetEnumsUnits.unitType(unitsType),\n    };\n    this.broadcastSettingsToClients();\n    this.inputChange();\n  }\n\n  inputChange() {\n    if (this.side !== Side.server) return;\n    const inputVal: number = this.getInputData(this.inInput);\n    this.apiCall(inputVal);\n  }\n\n  updateTitle() {\n    const pointNumber = this.settings['pointNumber'].value;\n    this.title = `Edge-28-Output: (${pointNumber} as ${this.pointTypeText(this.settings['pointType'].value)})`;\n    this.broadcastTitleToClients();\n  }\n\n  sendJson() {\n    return {\n      name: this.name,\n      pointValue: this.properties['pointVal'],\n      enable: this.settings['pointEnable'].value,\n      units: this.settings['units'].value,\n      pointNumber: this.settings['pointNumber'].value,\n      pointType: this.settings['pointType'].value,\n    };\n  }\n\n  apiCall(inputVal: number) {\n    if (this.side !== Side.server) return;\n    if (this.settings['pointEnable'].value === false) return;\n    const pointNumber = this.settings['pointNumber'].value;\n    let outVal: number = null;\n    const nodeVal = inputVal;\n    if (inputVal === undefined || inputVal === null) return;\n\n    if (this.settings['pointType'].value === OUTPUT_POINT_TYPE.DO) {\n      // if type = DO 0 is off 1 is on\n      if (typeof inputVal === 'boolean') {\n        outVal = inputVal ? 1 : 0;\n      } else if (typeof inputVal === 'string') {\n        if (inputVal === '1' || inputVal === 'true') {\n          outVal = 1;\n        } else if (inputVal === '0' || inputVal === 'false') {\n          outVal = 0;\n        }\n      } else if (typeof inputVal === 'number') {\n        if (inputVal >= 1) {\n          outVal = 1;\n        } else if (inputVal < 1) outVal = 0; // drive to 0vdc\n      } else this.debugInfo(`ERROR: input value must be a int 1 or 0 or a bool`);\n    } else if (this.settings['pointType'].value === OUTPUT_POINT_TYPE.UO_AS_DIGITAL) {\n      // UO as a DO\n      // if type = DO\n      if (typeof inputVal === 'boolean') {\n        if (inputVal) {\n          outVal = 0;\n        } else outVal = 100;\n      } else if (typeof inputVal === 'string') {\n        if (inputVal === '1' || inputVal === 'true') {\n          outVal = 0;\n        } else if (inputVal === '0' || inputVal === 'false') {\n          outVal = 100;\n        }\n      } else if (typeof inputVal === 'number') {\n        if (inputVal >= 1) {\n          outVal = 0; // drive to 12vdc\n        } else if (inputVal < 1) outVal = 100; // drive to 0vdc\n      } else this.debugInfo(`ERROR: input value must be a int 1 or 0 or a bool`);\n    } else if (this.settings['pointType'].value === OUTPUT_POINT_TYPE.UO_AS_0_10DC) {\n      // if type = UO\n      if (typeof inputVal === 'number') {\n        if (inputVal >= 100) outVal = EdgeGPIOUtils.scaleToGPIOValue(100, 0, 100);\n        // this is to cap writing a value > 12vdc\n        else {\n          inputVal = inputVal * 0.9839; // * 0.9839 this is to software cal the UOs\n          outVal = EdgeGPIOUtils.scaleToGPIOValue(inputVal, 0, 100);\n        }\n      } else if (typeof inputVal === 'string') {\n        this.debugInfo(`ERROR: input value must be a float`);\n      }\n    }\n\n    if (isNull(outVal)) return;\n    const pointType = this.pointType(this.settings['pointType'].value);\n    Edge28Utils.writePointValue(edgeIp, edgePort, edgeApiVer, pointType, pointNumber, outVal, 16)\n      .then(e => {\n        this.properties['pointVal'] = nodeVal;\n        this.setOutputData(0, nodeVal);\n        this.setOutputData(1, this.sendJson()); // json\n        this.lastSendTime = new Date().valueOf();\n      })\n      .catch(err => {\n        this.debugInfo(`ERROR: getting edge point type: ${pointType} ${err}`);\n      });\n  }\n}\n\nContainer.registerNodeType(EDGE_28_OUTPUT, Edge28OutputPointNode, EDGE_28_NETWORK);\n","import { SettingType, Node } from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { Type } from '../../../node-io';\nimport Utils from '../../../utils';\nimport axios from 'axios';\nimport TimeUtils from '../../../utils/time-utils';\nimport Edge28Utils from './edge-utils';\nimport { edgeIp, edgePort, edgeApiVer } from './edge-constant';\n\nexport class Edge28LORAResetNode extends Node {\n  lastSendTime;\n  lastTrigger;\n  timeoutFunc;\n\n  constructor() {\n    super();\n    this.title = 'Edge IO 28 LORA Connect Reset';\n    this.description =\n    `## Description\\n ` +\n    ` The is node is used in conjunction with the ***edge-io-28*** when using the ***lora-connect***. This node uses an internal rest-api to rest a ***LORA Connect gateway*** connected to an ***edge-io-28*** controller\\n ` +\n    `   \\n ` +\n    `## Description\\n ` +\n    `   \\n ` +\n    ` The reason for this nodes is to give the user more control over the nube hardware\\n ` +\n    ` When a ***trigger*** is activated on the node input or the ***interval*** timer is triggered the lora-modules will be reset\\n ` +\n    ` The reboot of the module only takes ***1000ms*** to restart\\n ` +\n\n    this.addInputWithSettings('enableInterval', Type.BOOLEAN, false, 'Enable Interval Reset');\n    this.addInputWithSettings('interval', Type.NUMBER, 15, 'Interval');\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('lastReset');\n\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'minutes',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n  }\n\n  async writePointValue(\n    host: string,\n    port: number,\n    apiVer: string,\n    pointType: string,\n    pointId: string,\n    val: number,\n    priority: number,\n  ): Promise<any> {\n    const url = `${Utils.buildUrl(host, port)}/api/${apiVer}/write/${pointType}/${pointId}/${val}/${priority}`;\n    //console.log(url);\n    const pointValue = await axios.get(url);\n    //console.log('writePointValue()', pointValue)\n    return pointValue.data;\n  }\n\n  onAdded() {\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    if (this.side !== Side.server) return;\n    let interval = this.getInputData(1);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    this.EXECUTE_INTERVAL = interval;\n    try {\n      Edge28Utils.addPoint(this.getParentNode(), this);\n    } catch (error) {}\n  }\n\n  onExecute() {\n    if (this.side !== Side.server) return;\n    if (!this.getInputData(0)) return;\n    this.resetLORAConnect();\n  }\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return;\n    let interval = this.getInputData(1);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    this.EXECUTE_INTERVAL = interval;\n    let trigger = this.getInputData(2);\n    //if (trigger && this.inputs[2].updated) {\n    if (trigger && !this.lastTrigger) this.resetLORAConnect();\n    this.lastTrigger = trigger;\n  }\n\n  resetLORAConnect() {\n    if (this.side !== Side.server) return;\n    const pointType = 'do';\n    const pointNumber = 'lc';\n    this.writePointValue(edgeIp, edgePort, edgeApiVer, pointType, pointNumber, 0, 16)\n      .then(e => {\n        this.setOutputData(0, new Date().valueOf(), true);\n        this.timeoutFunc = setTimeout(() => {\n          this.writePointValue(edgeIp, edgePort, edgeApiVer, pointType, pointNumber, 1, 16);\n        }, 2000);\n      })\n      .catch(err => this.debugInfo(`ERROR: LoRa Edge-28 Reset - ${err}`));\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n    if (this.side !== Side.server) return;\n    this.onInputUpdated();\n  }\n}\n\nContainer.registerNodeType('protocols/nube/edge-28-lora-reset', Edge28LORAResetNode);\n","import * as Bacnet from 'node-bacnet';\nimport { Node, SettingType} from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { ContainerNode } from '../../../container-node';\nimport { Type } from '../../../node-io';\nimport { ADD_DEVICE, GET_BACNET_CLIENT, GET_NETWORK_SETTINGS, REMOVE_DEVICE } from './bacnet-constant';\nimport BacnetUtils from './bacnet-utils';\nimport { BACNET_NETWORK } from '../../../constants';\n\nexport class BACnetNetwork extends ContainerNode {\n  bacnetClient: Bacnet = null;\n  inputWhoIs: number = 0;\n  deviceNodes: Array<Node> = [];\n\n  // node outputs\n  outputOut: number = 0;\n  outputMsg: number = 1;\n  outputError: number = 2;\n\n  constructor(ContainerNode) {\n    super(ContainerNode);\n    this.title = 'BACnet Network';\n    this.description =\n      'This node acts as a container for bacnet-device nodes. All bacnet-device nodes should be added within the bacnet-network container.  IP configuration for the BACnet network connection are set from settings.  The bacnet-network node can also be used to perform a BACnet Discover (WhoIs).';\n    this.addInput('discover', Type.BOOLEAN);\n    this.addOutput('out', Type.STRING);\n    this.addOutput('out msg', Type.STRING);\n    this.addOutput('error', Type.BOOLEAN);\n    this.settings['networkEnable'] = {\n      description: 'Network enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['interface'] = {\n      description: 'interface',\n      value: '0.0.0.0',\n      type: SettingType.STRING,\n    };\n    this.settings['port'] = {\n      description: 'port',\n      value: 47808,\n      type: SettingType.NUMBER,\n    };\n    this.settings['broadcastAddress'] = {\n      description: 'broadcastAddress',\n      value: '255.255.255.255',\n      type: SettingType.STRING,\n    };\n    this.settings['apduTimeout'] = {\n      description: 'BACnet apduTimeout',\n      value: 6000,\n      type: SettingType.NUMBER,\n    };\n    this.settings['networkNumber'] = {\n      description: 'BACnet network Number (Set to -1 to disable)',\n      value: -1,\n      type: SettingType.NUMBER,\n    };\n    this.settings['networkNumberWhoIs'] = {\n      description: 'BACnet Network Number for Discover',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'This network number' },\n          { value: 1, text: 'Global (0xFFFF)' },\n          { value: 2, text: 'Blank' },\n        ],\n      },\n      value: 0,\n    };\n    this.settings['devicePolling'] = {\n      description: 'Polling time setting in ms',\n      value: 2000, // TODO add validation range later\n      type: SettingType.NUMBER,\n    };\n  }\n\n  onAdded() {\n    super.onAdded();\n    // this.name = `BACnet Network:  cid_${this.container.id.toString()}_sid_${this.sub_container.id.toString()}_id${this.id.toString()}`; //set default node name\n    this.initializeBacnetClient();\n  }\n\n  onAfterSettingsChange(oldSettings: any) {\n    super.onAfterSettingsChange(oldSettings);\n    if (this.side !== Side.server) return;\n    this.initializeBacnetClient();\n  }\n\n  onInputUpdated() {\n    this.iAm();\n    this.whoIs();\n  }\n\n  whoIs() {\n    if (this.side !== Side.server) return;\n    const iface = this.settings['interface'].value;\n    const networkNumber = this.settings['networkNumber'].value;\n    const networkNumberWhoIs = this.settings['networkNumberWhoIs'].value;\n    if (this.bacnetClient) {\n      if (networkNumberWhoIs === 0) {\n        this.bacnetClient.whoIs({ net: networkNumber, interface: iface });\n        this.setOutputData(this.outputMsg, `INFO: Send a WhoIs on net: ${networkNumber} interface: ${iface}`);\n      } else if (networkNumberWhoIs === 1) {\n        this.bacnetClient.whoIs({ net: 0xffff, interface: iface });\n        this.setOutputData(this.outputMsg, `INFO: Send a WhoIs on net: ${0xffff} interface: ${iface}`);\n      } else if (networkNumberWhoIs === 2) {\n        this.bacnetClient.whoIs({ interface: iface });\n        this.setOutputData(this.outputMsg, `INFO: Send a WhoIs on net: BLANK interface: ${iface}`);\n      }\n    } else this.setOutputData(this.outputMsg, `ERROR: Failed to send whoIs`);\n  }\n\n  iAm() {\n    if (this.side !== Side.server) return;\n    this.setOutputData(this.outputMsg, `INFO: On iAm replay`);\n    this.bacnetClient.on('iAm', device => {\n      this.setOutputData(this.outputMsg, `INFO: On iAm replay from device: ${device.payload.deviceId}`);\n    });\n  }\n\n  subscribe({ action, payload }) {\n    switch (action) {\n      case ADD_DEVICE:\n        this.deviceNodes.push(payload);\n        break;\n      case REMOVE_DEVICE:\n        this.deviceNodes = this.deviceNodes.filter(pointNode => pointNode.id !== payload.id);\n        break;\n      case GET_BACNET_CLIENT:\n        return this.bacnetClient;\n      case GET_NETWORK_SETTINGS:\n        return this.settings;\n      default:\n        this.debugWarn(\"Request action doesn't match\");\n    }\n  }\n\n  onRemoved() {\n    super.onRemoved();\n    this.closeBacnetClient();\n  }\n\n  private closeBacnetClient() {\n    if (this.bacnetClient) {\n      this.setOutputData(this.outputMsg, `INFO: Closing BACnet client...`);\n      this.bacnetClient.close();\n    }\n  }\n\n  initializeBacnetClient() {\n    if (this.side !== Side.server) return; // only execute on server\n    this.closeBacnetClient();\n    this.setOutputData(this.outputMsg, `INFO: Initializing BACnet...`);\n    this.bacnetClient = new Bacnet({\n      apduTimeout: this.settings['apduTimeout'].value,\n      interface: this.settings['interface'].value,\n      port: this.settings['port'].value,\n      broadcastAddress: this.settings['broadcastAddress'].value,\n    });\n    if (this.bacnetClient) {\n      this.setOutputData(this.outputMsg, `INFO: Started BACnet Stack :)`);\n    } else this.setOutputData(this.outputMsg, `ERROR: Failed to started BACnet Stack :(`);\n\n    for (let deviceNode of this.deviceNodes) {\n      BacnetUtils.sendPayloadToChild(deviceNode, {\n        bacnetClient: this.bacnetClient,\n        networkSettings: this.settings,\n      });\n    }\n  }\n\n  emitResult(id, out) {\n    this.setOutputData(id, out);\n  }\n}\nContainer.registerNodeType(BACNET_NETWORK, BACnetNetwork);\n","import * as Bacnet from 'node-bacnet';\nimport { Type } from '../../../node-io';\nimport BacnetUtils, { singleton as actor } from './bacnet-utils';\nimport { DeviceObject } from './interface';\nimport { BACNET_DEVICE, BACNET_NETWORK } from '../../../constants';\nimport { Container, Side } from '../../../container';\nimport { ContainerNode } from '../../../container-node';\nimport { Node, SettingType} from '../../../node';\nimport Utils from '../../../utils';\nimport {\n  ADD_POINT,\n  GET_NETWORK_SETTINGS,\n  GET_POINTS,\n  GET_PRESENT_VALUE,\n  REMOVE_POINT,\n  SEND_PAYLOAD_TO_CHILD,\n  WRITE_PRESENT_VALUE,\n} from './bacnet-constant';\n\nenum Poll {\n  STOP = 0,\n  START = 1,\n}\n\nclass BACnetDevice extends ContainerNode {\n  bacnetClient: Bacnet = null;\n  networkSettings: any = {};\n  points: Array<DeviceObject> = [];\n  pointNodes: Array<Node> = [];\n  isFirst: boolean = true;\n  isPolling: boolean = false;\n  shouldPoll: boolean = true;\n  delayBetweenDevice: number = 100;\n  delayBetweenPoint: number = 30;\n  outputMsg: 1;\n  networkNumber: number = null;\n  constructor(ContainerNode) {\n    super(ContainerNode);\n    this.title = 'BACnet Device';\n    this.description =\n      'This node acts as a container for bacnet-point nodes. All bacnet-device nodes should be added within the bacnet-network container.  All bacnet-point nodes should be added within a bacnet-device container node.  Configuration of BACnet device connections are set from settings.  Both IP and MSTP BACnet devices can be configured from the bacnet-device settings.';\n    this.addInput('get-point-list', Type.BOOLEAN);\n    this.addOutput('out', Type.STRING);\n    this.addOutput('out msg', Type.STRING);\n    this.addOutput('error', Type.STRING);\n    this.addOutput('points-discovered', Type.STRING);\n    this.addOutput('points-to-poll', Type.STRING);\n    this.properties['pointsList'] = null;\n    this.settings['deviceEnable'] = {\n      description: 'Device enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n\n    // device\n    this.settings['ip'] = { description: 'ip', value: '192.168.13.13', type: SettingType.STRING };\n    this.settings['deviceId'] = { description: 'deviceId', value: 2508, type: SettingType.NUMBER };\n    this.settings['port'] = { description: 'port', value: 47808, type: SettingType.NUMBER };\n\n    // device mac address if under a IP to MS/TP router\n    this.settings['deviceTypeMstp'] = {\n      description: 'BACnet MS/TP device',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    // device mac address if under a IP to MS/TP router\n    this.settings['macAddress'] = {\n      description: 'BACnet Mac address',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['networkNumber'] = {\n      description: 'BACnet network number ',\n      // value: null,\n      type: SettingType.READONLY,\n    };\n  }\n\n  async onAdded() {\n    super.onAdded();\n    // this.name = `BACnet Device: cid_${this.container.id.toString()}_sid_${this.sub_container.id.toString()}_id${this.id.toString()}`; //set default node name\n    await Utils.sleep(1000); // TODO: Since device should start after network, import may shows issue if we don't have this\n    this.setBacnetClient();\n    this.setPayloadsToPointNodes();\n    if (this.side !== Side.server) return;\n    BacnetUtils.addDevice(this.getParentNode(), this);\n    this.updateNetworkSettings();\n    await this.requestPoll();\n  }\n\n  onAfterSettingsChange(oldSettings: any) {\n    super.onAfterSettingsChange(oldSettings);\n    this.setPayloadsToPointNodes();\n    this.requestPoll().then(); // don't await, it will unable to set setting value\n  }\n\n  onRemoved() {\n    super.onRemoved();\n    this.shouldPoll = false;\n    BacnetUtils.removeDevice(this.getParentNode(), this);\n  }\n\n  updateNetworkSettings() {\n    if (this.side !== Side.server) return;\n    this.networkSettings = BacnetUtils.getNetworkSettings(this.getParentNode());\n    this.networkNumber = this.networkSettings.networkNumber.value;\n    this.settings['networkNumber'].value = this.networkNumber;\n    this.broadcastSettingsToClients();\n    this.persistSettings();\n  }\n\n  onInputUpdated() {\n    let pntList = [];\n    for (let pointNode of this.pointNodes) {\n      const settings = pointNode.settings;\n      const id = pointNode.id;\n      const cid = pointNode.id;\n      const name = pointNode.name;\n      let a = {\n        id: id,\n        cid: cid,\n        name: name,\n        settings: settings,\n      };\n      pntList.push(a);\n    }\n    this.setOutputData(4, JSON.stringify(pntList));\n    this.setOutputData(3, JSON.stringify(this.points));\n  }\n\n  async requestPoll() {\n    if (this.currentPollValue() === Poll.START && !this.isPolling) {\n      this.isPolling = true;\n      await this.polling();\n    }\n  }\n\n  currentPollValue(): Poll {\n    return this.settings['deviceEnable'].value && this.networkSettings['networkEnable'].value ? Poll.START : Poll.STOP;\n  }\n\n  setPayloadsToPointNodes() {\n    if (this.side !== Side.server) return; // only execute on server\n    this.setOutputData(this.outputMsg, `INFO: Scan devices`);\n    actor\n      .process<Array<DeviceObject>>(() => this.scanDeviceFunc())\n      .then(points => {\n        this.points = points;\n        this.sendPayloadToPointNodesFunc();\n      });\n    actor.process(async () => await Utils.sleep(this.delayBetweenDevice)).then();\n  }\n\n  sendPayloadToPointNodesFunc() {\n    for (let pointNode of this.pointNodes) {\n      BacnetUtils.sendPayloadToChild(pointNode, {\n        points: this.points,\n        networkSettings: this.networkSettings,\n      });\n    }\n  }\n\n  setBacnetClient() {\n    if (this.side !== Side.server) return;\n    this.bacnetClient = BacnetUtils.getBacnetClient(this.getParentNode());\n  }\n\n  writePresentValue(deviceAddress, type, instance, value, priority, tag) {\n    // console.log(deviceAddress, type, instance, value, priority, tag)\n    if (!this.bacnetClient) return;\n    if (this.settings['deviceTypeMstp'].value) {\n      this.bacnetClient.writeProperty(\n        {\n          address: deviceAddress,\n          net: this.networkNumber,\n          adr: [this.settings['macAddress'].value],\n        },\n        { type: type, instance: instance },\n        85,\n        [{ type: tag, value: value }],\n        { priority: priority },\n        (err, value) => {\n          console.log(err, value);\n        },\n      );\n    } else {\n      this.bacnetClient.writeProperty(\n        deviceAddress,\n        { type: type, instance: instance },\n        85,\n        [{ type: tag, value: value }],\n        { priority: priority },\n        (err, value) => {},\n      );\n    }\n  }\n\n  readObjectList(deviceAddress, deviceId, callback) {\n    // Read Device Object\n    const requestArray = [\n      {\n        objectId: { type: Bacnet.enum.ObjectType.DEVICE, instance: deviceId },\n        properties: [{ id: Bacnet.enum.PropertyIdentifier.OBJECT_LIST }],\n      },\n    ];\n    if (!this.bacnetClient) return;\n    if (this.settings['deviceTypeMstp'].value) {\n      this.bacnetClient.readPropertyMultiple(\n        {\n          address: deviceAddress,\n          net: this.networkNumber,\n          adr: [this.settings['macAddress'].value],\n        },\n        requestArray,\n        requestArray,\n        callback,\n      );\n    } else this.bacnetClient.readPropertyMultiple(deviceAddress, requestArray, callback);\n  }\n\n  readObjectFull(deviceAddress, type): Promise<any> {\n    return this.readObject(deviceAddress, type, [\n      { id: Bacnet.enum.PropertyIdentifier.OBJECT_IDENTIFIER },\n      { id: Bacnet.enum.PropertyIdentifier.OBJECT_NAME },\n      { id: Bacnet.enum.PropertyIdentifier.OBJECT_TYPE },\n      { id: Bacnet.enum.PropertyIdentifier.DESCRIPTION },\n      { id: Bacnet.enum.PropertyIdentifier.UNITS },\n      { id: Bacnet.enum.PropertyIdentifier.PRESENT_VALUE },\n      // { id: Bacnet.enum.PropertyIdentifier.PRIORITY_ARRAY },\n      // { id: Bacnet.enum.PropertyIdentifier.PRIORITY_FOR_WRITING },\n    ]);\n  }\n\n  readObject(deviceAddress, obj, properties): Promise<any> {\n    return new Promise(resolve => {\n      const requestArray = [\n        {\n          objectId: { type: obj.type, instance: obj.instance },\n          properties: properties,\n        },\n      ];\n      if (!this.bacnetClient) return;\n      if (this.settings['deviceTypeMstp'].value) {\n        this.bacnetClient.readPropertyMultiple(\n          {\n            address: deviceAddress,\n            net: this.networkNumber,\n            adr: [this.settings['macAddress'].value],\n          },\n          requestArray,\n          (error, value) => {\n            resolve({\n              error: error,\n              value: value,\n            });\n          },\n        );\n      } else {\n        this.bacnetClient.readPropertyMultiple(deviceAddress, requestArray, (error, value) => {\n          resolve({\n            error: error,\n            value: value,\n          });\n        });\n      }\n    });\n  }\n\n  readProperty(deviceAddress, obj): Promise<any> {\n    return new Promise(resolve => {\n      if (this.settings['deviceTypeMstp'].value) {\n        this.bacnetClient.readProperty(\n          {\n            address: deviceAddress,\n            net: this.networkNumber,\n            adr: [this.settings['macAddress'].value],\n          },\n          { type: obj.type, instance: obj.instance },\n          Bacnet.enum.PropertyIdentifier.PRESENT_VALUE,\n          (error, value) => {\n            resolve({\n              error: error,\n              value: value,\n            });\n          },\n        );\n      } else {\n        this.bacnetClient.readProperty(\n          deviceAddress,\n          { type: obj.type, instance: obj.instance },\n          Bacnet.enum.PropertyIdentifier.PRESENT_VALUE,\n          (error, value) => {\n            resolve({\n              error: error,\n              value: value,\n            });\n          },\n        );\n      }\n    });\n  }\n\n  readPresentValue(obj): any {\n    return this.readProperty(this.settings['ip'].value, obj);\n  }\n\n  findValueById(properties, id) {\n    const property = properties.find(function(element) {\n      return element.id === id;\n    });\n    if (property && property.value && property.value.length > 0) {\n      if (property.value[0].value.errorClass) {\n        return null;\n      }\n      return property.value[0].value;\n    } else {\n      return null;\n    }\n  }\n\n  mapToDeviceObject(object): DeviceObject {\n    if (!object || !object.values) {\n      return null;\n    }\n    const objectInfo = object.values[0].objectId.instance;\n    const objectProperties = object.values[0].values;\n    const name = this.findValueById(objectProperties, Bacnet.enum.PropertyIdentifier.OBJECT_NAME);\n    const description = this.findValueById(objectProperties, Bacnet.enum.PropertyIdentifier.DESCRIPTION);\n    const type = this.findValueById(objectProperties, Bacnet.enum.PropertyIdentifier.OBJECT_TYPE);\n    const units = this.findValueById(objectProperties, Bacnet.enum.PropertyIdentifier.UNITS);\n    const presentValue = this.findValueById(objectProperties, Bacnet.enum.PropertyIdentifier.PRESENT_VALUE);\n\n    return { objectInfo, name, description, type, units, presentValue };\n  }\n\n  async scanDeviceFunc(): Promise<Array<DeviceObject>> {\n    const device = {\n      deviceId: this.settings['deviceId'].value,\n      address: this.settings['ip'].value,\n    };\n    this.setOutputData(1, `INFO: Scan device ID: ${device}`);\n    this.setOutputData(2, ``);\n    return new Promise((resolve, reject) => {\n      this.readObjectList(device.address, device.deviceId, async (err, result) => {\n        if (!err) {\n          const objectArray = result.values[0].values[0].value;\n\n          this.setOutputData(1, `INFO: Scan device ID: ${device}`);\n          this.setOutputData(2, ``);\n          const outputs = [];\n          for (const object of objectArray) {\n            try {\n              const output = await this.readObjectFull(device.address, {\n                type: object.value.type,\n                instance: object.value.instance,\n              });\n              outputs.push(output);\n            } catch (error) {\n              this.setOutputData(1, ``);\n              this.setOutputData(2, `ERROR: while fetching objects: ${JSON.stringify(error)}`);\n              reject(error);\n            }\n            await Utils.sleep(this.delayBetweenDevice);\n          }\n          const successfulResults = outputs.filter(element => !element.error);\n          const deviceObjects = successfulResults.map(element => {\n            return this.mapToDeviceObject(element.value);\n          });\n          resolve(deviceObjects);\n        } else {\n          this.setOutputData(1, ``);\n          this.setOutputData(2, `ERROR: while fetching objects: ${JSON.stringify(err)}`);\n          reject(err);\n        }\n      });\n    });\n  }\n\n  subscribe({ action, payload }) {\n    switch (action) {\n      case ADD_POINT:\n        this.pointNodes.push(payload);\n        break;\n      case REMOVE_POINT:\n        this.pointNodes = this.pointNodes.filter(pointNode => pointNode.id !== payload.id);\n        break;\n      case GET_NETWORK_SETTINGS:\n        return BacnetUtils.getNetworkSettings(this.getParentNode());\n      case GET_POINTS:\n        return this.points;\n      case GET_PRESENT_VALUE:\n        return this.readPresentValue(payload);\n      case SEND_PAYLOAD_TO_CHILD:\n        this.bacnetClient = payload.bacnetClient;\n        this.networkSettings = payload.networkSettings;\n        this.updateNetworkSettings();\n        if (!this.isFirst) {\n          // We can check settings with older settings if we want\n          this.setPayloadsToPointNodes();\n        }\n        this.isFirst = false;\n        this.requestPoll().then();\n        break;\n      case WRITE_PRESENT_VALUE:\n        this.writePresentValue(this.settings['ip'].value, payload[0], payload[1], payload[2], payload[3], payload[4]);\n\n        break;\n      default:\n        this.debugWarn(\"Request action doesn't match\");\n    }\n  }\n\n  emitResult(id, out) {\n    this.setOutputData(id, out);\n  }\n\n  persistSettings() {\n    if (!this.container.db) return;\n    this.container.db.updateNode(this.id, this.container.id, {\n      $set: {\n        settings: this.settings,\n        properties: this.properties,\n      },\n    });\n  }\n\n  async polling() {\n    if (this.currentPollValue() !== Poll.START || !this.shouldPoll) {\n      this.isPolling = false;\n      return;\n    }\n    await actor.process<any>(() => this.pollingFunc());\n    await actor.process<any>(async () => await Utils.sleep(this.delayBetweenDevice));\n    await Utils.sleep(this.networkSettings['devicePolling'].value);\n    await this.polling();\n  }\n\n  async pollingFunc() {\n    for (let pointNode of this.pointNodes) {\n      let selectPoint = pointNode.settings['pointsList'].value;\n      const manualPoint = pointNode.settings['manualPoint'].value;\n      const objectType = pointNode.settings['objectType'].value;\n      const objectInstance = pointNode.settings['objectInstance'].value;\n      if (manualPoint) {\n        selectPoint = { type: objectType, instance: objectInstance };\n      }\n      if (selectPoint) {\n        const value = await this.readPresentValue(selectPoint);\n        BacnetUtils.sendPointValue(pointNode, value);\n        await Utils.sleep(this.delayBetweenPoint);\n      }\n    }\n  }\n}\nContainer.registerNodeType(BACNET_DEVICE, BACnetDevice, BACNET_NETWORK);\n","import { SettingType } from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { Type } from '../../../node-io';\nimport BacnetUtils from './bacnet-utils';\nimport { DeviceObject } from './interface';\nimport { BACNET_DEVICE, BACNET_POINT } from '../../../constants';\nimport { SEND_PAYLOAD_TO_CHILD, SEND_POINT_VALUE } from './bacnet-constant';\nimport Utils from '../../../utils';\nimport HistoryBase from '../../history/HistoryBase';\nimport { isNull } from '../../../../utils/helper';\n\nclass BACnetPoint extends HistoryBase {\n  // to add remove the inputs on the node\n  dynamicInputsExist: boolean = false;\n  dynamicSettingsExist: boolean = false;\n  dynamicInputStartPosition: number = 2;\n  inputCount: number;\n  dynamicMinInputs: number = 0;\n  nullableInputs: boolean = true;\n  dynamicOutputsExist: boolean = false;\n  dynamicInputsStartName: string = 'in';\n  dynamicOutputsStartName: string = 'out';\n  dynamicInputsType: Type = Type.NUMBER;\n\n  // bacnet stuff\n  networkNumber: number;\n  macAddress: number;\n  deviceTypeMstp: boolean;\n  points: Array<DeviceObject> = [];\n\n  // history stuff\n  obj = [];\n  useInterval: boolean;\n  timeoutFunc;\n\n  constructor() {\n    super();\n    this.title = 'BACnet Point';\n    this.description =\n      'All bacnet-point nodes should be added within the bacnet-device container node. Configuration of BACnet points are set from settings.  If the bacnet-network, and bacnet-device are configured correctly, the BACnet points will be available to select from the Select a point setting; otherwise the point can be set manually. For information on History settings, see History/History node. Configuration is the same for bacnet-point histories.';\n    this.addInput('input', Type.ANY);\n    this.addOutput('output', Type.STRING);\n    this.addOutput('output json', Type.STRING);\n    this.addOutput('error', Type.STRING);\n    this.settings['pointEnable'] = {\n      description: 'Point enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['pointWriteEnable'] = {\n      description: 'Point write enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['manualPoint'] = {\n      description: 'Add point manually',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n\n    this.settings['pointsList'] = {\n      description: 'Select a point',\n      value: null,\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [],\n      },\n    };\n    this.settings['objectType'] = {\n      description: 'Output type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'analog-input' },\n          { value: 1, text: 'analog-output' },\n          { value: 2, text: 'analog-value' },\n          { value: 3, text: 'binary-input' },\n          { value: 4, text: 'binary-output' },\n          { value: 5, text: 'binary-value' },\n          { value: 13, text: 'multi-state-input' },\n          { value: 14, text: 'multi-state-output' },\n          { value: 19, text: 'multi-state-value' },\n        ],\n      },\n      value: 0,\n    };\n    this.settings['objectTag'] = { //The data-type of the value to be written.\n      description: 'Data type value to be written',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'NULL(0)' },\n          { value: 1, text: 'BOOLEAN(1)' },\n          { value: 2, text: 'UNSIGNED_INTEGER(2)' },\n          { value: 3, text: 'SIGNED_INTEGER(3)' },\n          { value: 4, text: 'REAL(4)' },\n          { value: 5, text: 'DOUBLE(5)' },\n          { value: 6, text: 'OCTET_STRING(6)' },\n          { value: 7, text: 'CHARACTER_STRING(7)' },\n          { value: 8, text: 'BIT_STRING(8)' },\n          { value: 9, text: 'ENUMERATED(9)' },\n          { value: 10, text: 'DATE(10)' },\n          { value: 11, text: 'TIME(11)' },\n          { value: 12, text: 'OBJECTIDENTIFIER(12)' },\n        ],\n      },\n      value: 1,\n    };\n\n    this.settings['objectInstance'] = {\n      description: 'Point ID',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['priority'] = {\n      description: 'Priority Number',\n      value: 16,\n      type: SettingType.NUMBER,\n    };\n    this.setSettingsConfig({\n      conditions: {\n        pointsList: setting => {\n          return !setting['manualPoint'].value;\n        },\n        objectType: setting => {\n          return setting['manualPoint'].value;\n        },\n      },\n    });\n    this.useInterval = false;\n    this.properties['lastHistoryValue'] = null;\n\n    this.addHistorySettingsConfig(0, false);\n  }\n\n  async onAdded() {\n    super.onAdded();\n    // this.name = `BACnet Point: cid_${this.container.id.toString()}_id${this.id.toString()}`; //set default node name\n    if (this.side !== Side.server) return; // only execute on server\n    await Utils.sleep(2000); // TODO: Since device should start after network > device, import may shows issue if we don't have this\n    this.points = BacnetUtils.getPoints(this.getParentNode());\n    this.setPointsListItems();\n    this.getPresentValue();\n    BacnetUtils.addPoint(this.getParentNode(), this);\n  }\n\n  async onInputUpdated() {\n    // this.setOutputData(0, 1);\n    await super.onInputUpdated();\n    if (this.side !== Side.server) return; // only execute on server\n    let objectType: number;\n    let objectInstance: number;\n    const value = this.getInputData(0);\n    const priority = this.settings['priority'].value;\n    const manualPoint = this.settings['manualPoint'].value;\n    const selectPoint = this.settings['pointsList'].value;\n    const objectTag = this.settings['objectTag'].value;\n    let pointWriteEnable = this.settings['pointWriteEnable'].value;\n    if (manualPoint) {\n      objectType = this.settings['objectType'].value;\n      objectInstance = this.settings['objectInstance'].value;\n    }\n    if (selectPoint) {\n      objectType = selectPoint.type;\n      objectInstance = selectPoint.instance;\n    }\n    // console.log(selectPoint)\n    // console.log({value:value, objectType:objectType, objectInstance:objectInstance, priority:priority})\n    if (isNull(value)) return\n    if (pointWriteEnable === false) return;\n    // write point value\n    BacnetUtils.writePresentValue(this.getParentNode(), [objectType, objectInstance, value, priority, objectTag]);\n  }\n\n  async onAfterSettingsChange() {\n    await super.onAfterSettingsChange();\n    this.getPresentValue();\n    const getNetworkNumber: any = BacnetUtils.getNetworkSettings(this.getParentNode());\n    if (getNetworkNumber) {\n      if (!isNaN(getNetworkNumber.networkNumber.value)) {\n        this.networkNumber = getNetworkNumber.networkNumber.value;\n      }\n    }\n  }\n\n  onRemoved() {\n    super.onRemoved();\n    BacnetUtils.removePoint(this.getParentNode(), this);\n  }\n\n  getPresentValue() {\n    if (this.side !== Side.server) return; // only execute on serve\n    let selectPoint = this.settings['pointsList'].value;\n    const manualPoint = this.settings['manualPoint'].value;\n    const objectType = this.settings['objectType'].value;\n    const objectInstance = this.settings['objectInstance'].value;\n    if (manualPoint) {\n      selectPoint = { type: objectType, instance: objectInstance };\n    }\n    if (selectPoint) {\n      BacnetUtils.getPresentValue(this.getParentNode(), selectPoint).then(msg => {\n        if (!isNull(msg)) {\n          this.setPointValue(msg);\n        }\n      \n      });\n    }\n  }\n\n\n  setPointValue(msg) {\n    if (isNull(msg.value.values[0].value)) {\n      this.setOutputData(2, true, true);\n      return;\n    } \n    let pointValue = msg.value.values[0].value\n    let objectType: number;\n    let objectInstance: number;\n    let pointEnable = this.settings['pointEnable'].value;\n    let pointWriteEnable = this.settings['pointWriteEnable'].value;\n    const priority = this.settings['priority'].value;\n    const manualPoint = this.settings['manualPoint'].value;\n    const selectPoint = this.settings['pointsList'].value;\n    const pointsList = this.settings['pointsList'].config.items;\n    let bacnetPointName;\n\n    if (manualPoint) {\n      objectType = this.settings['objectType'].value;\n      objectInstance = this.settings['objectInstance'].value;\n    }\n    if (selectPoint) {\n      objectType = selectPoint.type;\n      objectInstance = selectPoint.instance;\n      // get bacnet point name\n      if (!isNull(pointsList)) {\n        let obj = pointsList\n        for (var key in obj) {\n          if (obj[key].value.type === selectPoint.type && obj[key].value.instance === selectPoint.instance) {\n            bacnetPointName = obj[key]\n          }\n        };\n      }\n    }\n\n    const json = {\n      name: this.name,\n      pointValue: pointValue,\n      enable: pointEnable,\n      pointWriteEnable: pointWriteEnable,\n      objectType: objectType,\n      objectInstance: objectInstance,\n      priority: priority,\n      bacnetPointName: bacnetPointName\n    }\n    if (msg.value) {\n      this.setOutputData(0, pointValue, true);\n      this.setOutputData(1, json, true);\n      this.setOutputData(2, null, true);\n    } else {\n      this.setOutputData(0, null, true);\n      this.setOutputData(1, null, true);\n      if (msg.error) {\n        this.setOutputData(2, 'Error on reading value');\n      }\n    }\n  }\n\n  setPointsListItems() {\n    this.settings['pointsList'].config.items = this.points.map(point => {\n      return {\n        value: { type: point.type, instance: point.objectInfo },\n        text: point.name,\n        // text: `${point.name} -> ${this.readObjectName(point.type)}: ${point.objectInfo}`,\n      };\n    });\n    this.persistConfiguration();\n    this.broadcastSettingsToClients();\n  }\n\n  subscribe({ action, payload }) {\n    switch (action) {\n      case SEND_PAYLOAD_TO_CHILD:\n        this.points = payload.points;\n        this.setPointsListItems();\n        break;\n      case SEND_POINT_VALUE:\n        this.setPointValue(payload);\n        break;\n      default:\n        this.debugWarn(\"Request action doesn't match\");\n    }\n  }\n\n\n  readObjectName(type) {\n    switch (type) {\n      case 0:\n        return 'AI';\n      case 1:\n        return 'AO';\n      case 2:\n        return 'AV';\n      case 3:\n        return 'BI';\n      case 4:\n        return 'BO';\n      case 5:\n        return 'BV';\n      case 8:\n        return 'Device';\n      case 13:\n        return 'MSI';\n      case 14:\n        return 'MSO';\n      case 19:\n        return 'MSV';\n      default:\n        this.debugWarn('Unknown type of object');\n    }\n  }\n}\nContainer.registerNodeType(BACNET_POINT, BACnetPoint, BACNET_DEVICE);\n","import { Enumify } from 'enumify';\n\nexport class InputMethod extends Enumify {\n  static VALUE_PRIORITY = new InputMethod('Value and Priority');\n  static PRIORITY_ARRAY_LOT = new InputMethod('Priority Array');\n  static PRIORITY_ARRAY_JSON = new InputMethod('JSON');\n  static _ = InputMethod.closeEnum();\n\n  readonly label: string;\n\n  constructor(label: string) {\n    super();\n    this.label = label;\n  }\n\n  static items(): { text: string; value: any }[] {\n    return InputMethod.enumKeys.map(k => {\n      return { value: k, text: (<InputMethod>InputMethod.enumValueOf(k)).label };\n    });\n  }\n}\n","//\n// BACnet device implementation.\n// Top level structure for a device object.\n//\n\nconst assert = require('assert');\nconst bacnet = require('node-bacnet');\nconst logger = require('logplease').create('bacnet', { color: 4 });\n\nconst BE = bacnet && bacnet.enum;\nconst PI = BE && BE.PropertyIdentifier;\n\nconst BACnetObject         = require('./bacnet-object');\nconst BACnetObjectProperty = require('./bacnet-object-property');\nconst Util                 = require('./util');\n\nclass BACnetDevice extends BACnetObject {\n  /**\n   * Create a new BACnet device and listen for BACnet traffic.\n   *\n   * @param deviceInfo\n   *   Must contain all members in `devicePropMap`, plus:\n   *   - `name`: Device friendly name for user display.\n   *   - `deviceId`: BACnet device instance.  Must be a unique number on the\n   *     BACnet network.\n   *\n   * @param hostInfo\n   *   - port: BACnet port to listen on, omit for default 47808.\n   *   - ip: If functioning as a BBMD, this is our own IP address.  Must be\n   *     reachable by the BMS, which will contact us directly on the IP after\n   *     locating us by using the BBMD to forward us broadcasts.\n   *   - interface: Optional IP address to bind to.\n   * @param covListener BACnet change of value listener\n   */\n  constructor(deviceInfo, hostInfo = {}, covListener) {\n    super(null, deviceInfo.deviceId, BE.ObjectType.DEVICE, deviceInfo.name);\n    this.dev         = this;\n    this.deviceInfo  = deviceInfo;\n    this.hostInfo    = hostInfo;\n    this.client      = null;\n    this.covListener = covListener;\n  }\n\n  getProperty(propertyId) {\n    switch (propertyId) {\n      case PI.APDU_TIMEOUT: {\n        // Get the timeout value from node-bacstack\n        const prop  = new BACnetObjectProperty(this, propertyId, undefined, true);\n        prop._value = this.client._settings.apduTimeout;\n        return prop;\n      }\n      default:\n        return super.getProperty(propertyId);\n    }\n  }\n\n  /**\n   * The default code will respond to unhandled messages with an error, however\n   * the error will be broadcasted to the local subnet.  Since we are\n   * functioning as a hybrid device+BBMD, we need to examine the message and if\n   * it has been sent to us as if we're a BBMD, then we need to respond in BBMD\n   * mode instead, otherwise the error response won't make it to the caller and\n   * they will think we have gone offline.\n   */\n  onUnhandledEvent(msg) {\n    if (msg.header.expectingReply) {\n      if (msg.header.sender.forwardedFrom) {\n        // Message came from a BBMD, so need to reply as if we're a BBMD.\n        msg.header.sender.forwardedFrom = this.ip;\n      }\n      const enumType = msg.header.confirmedService ? BE.ConfirmedServiceChoice : BE.UnconfirmedServiceChoice;\n      logger.debug('Replying with error for unhandled service:' + BE.getEnumName(enumType, msg.service));\n      this.client.errorResponse(msg.header.sender, msg.service, msg.invokeId, BE.ErrorClass.SERVICES,\n                                BE.ErrorCode.REJECT_UNRECOGNIZED_SERVICE);\n    }\n  }\n\n  onRegisterForeignDevice(msg) {\n    logger.debug('[recv] Register foreign device:', msg.header.sender.address, 'for TTL', msg.payload.ttl);\n    // Add to device table\n    // TODO: Use a date + TTL so we don't have to keep checking it\n    this.bdt[msg.header.sender.address] = msg.payload.ttl;\n    this.client.resultResponse(msg.header.sender, BE.BvlcResultFormat.SUCCESSFUL_COMPLETION);\n  }\n\n  onWhoIs(msg) {\n    logger.debug('onWhoIs');\n    if (msg.payload.lowLimit === undefined || msg.payload.highLimit === undefined ||\n        (msg.payload.lowLimit <= this.instance && msg.payload.highLimit >= this.instance)) {\n      if (msg.header.sender.forwardedFrom) {\n        // Message came from a BBMD, so need to reply as if we're a BBMD.\n        //msg.header.sender.forwardedFrom = this.ip;\n\n        // Actually it seems like responses should be returned direct to the\n        // caller by the device, bypassing the BBMD.\n        msg.header.sender.forwardedFrom = null;\n      }\n\n      logger.debug(msg.header.sender, this.instance, this.getProperty(PI.SEGMENTATION_SUPPORTED).value,\n                   this.getProperty(PI.VENDOR_IDENTIFIER).value);\n\n      logger.debug(\n        `[send] Replying to whoIs(${msg.payload.lowLimit}..` + `${msg.payload.highLimit}): iAm ${this.instance} -> ` +\n        `${msg.header.sender.address}/${msg.header.sender.forwardedFrom}`);\n      this.client.iAmResponse(msg.header.sender, this.instance, this.getProperty(PI.SEGMENTATION_SUPPORTED).value,\n                              this.getProperty(PI.VENDOR_IDENTIFIER).value);\n    }\n  }\n\n  onWriteProperty(data) {\n    logger.debug(`onWriteProperty: ${JSON.stringify(data)}`);\n    const object = this.getObject(data.payload.objectId.instance, data.payload.objectId.type);\n    if (!object) {\n      return this.client.errorResponse(data.header.sender, data.service, data.invokeId, BE.ErrorClass.OBJECT,\n                                       BE.ErrorCode.UNKNOWN_OBJECT);\n    }\n    let property  = object.getProperty(data.payload.value.property.id);\n    let property3 = object.getProperty(PI.PRIORITY_ARRAY);\n    let value2    = this.encodePropValue(property3);\n\n    if (!property) {\n      return this.client.errorResponse(data.header.sender, data.service, data.invokeId, BE.ErrorClass.PROPERTY,\n                                       BE.ErrorCode.UNKNOWN_PROPERTY);\n    }\n    if (data.payload.value.property.index === 0xffffffff) {\n      let pri = data.payload.value.priority;\n      let val = data.payload.value.value[0].value;\n\n      function arrType(arr, pri, value) {\n        let i;\n        for (i in arr) {\n          let arrNum = parseInt(i) + 1;\n          if (arrNum === pri) {\n            arr[i].value = value;\n            // break;\n          }\n        }\n        return arr;\n      }\n\n      let aa  = arrType(value2, pri, val);\n      let arr = [];\n      let p;\n      for (p in aa) {\n        arr.push(aa[p].value);\n      }\n\n      let priorityValue;\n      let priorityNum;\n      let priorityArr;\n      let q;\n      for (q in arr) {\n        priorityValue = arr[q];\n        priorityNum   = parseInt(q) + 1;\n        priorityArr   = { priorityNum: parseInt(q) + 1, val: arr[q] };\n\n        if (arr[q] != null) {\n          break;\n        }\n      }\n      const inpPresentValue2 = object.addProperty(PI.PRIORITY_ARRAY, BE.ApplicationTags.REAL);\n      inpPresentValue2.value = arr;\n\n      const inpPresentValue23 = object.addProperty(PI.PRESENT_VALUE, BE.ApplicationTags.REAL);\n      inpPresentValue23.value = priorityValue;\n\n      this.client.simpleAckResponse(data.header.sender, data.service, data.invokeId);\n      this.covListener({\n                         objectType   : data.payload.objectId.type,\n                         objectId     : data.payload.objectId.instance,\n                         presentValue : priorityValue,\n                         priority     : priorityNum,\n                         priorityArray: arr,\n                       });\n    } else {\n      let slot = data.payload.value.property.index;\n      if (!slot) {\n        return this.client.errorResponse(data.header.sender, data.service, data.invokeId, BE.ErrorClass.PROPERTY,\n                                         BE.ErrorCode.INVALID_ARRAY_INDEX);\n      }\n      this.client.simpleAckResponse(data.header.sender, data.service, data.invokeId);\n    }\n  }\n\n  onReadProperty(msg) {\n    logger.debug('onReadProperty', msg);\n    const propertyName = Util.getEnumName(PI, msg.payload.property.id);\n    const typeName     = Util.getEnumName(BE.ObjectType, msg.payload.objectId.type);\n    const objectIdName = typeName + ':' + msg.payload.objectId.instance;\n    logger.debug(`[recv/${msg.header.sender.address}] readProperty: ${objectIdName}/${propertyName}`);\n\n    const object = this.getObject(msg.payload.objectId.instance, msg.payload.objectId.type);\n    if (!object) {\n      logger.debug(\n        `[send/${msg.header.sender.address}] Requested non-existent ` + `object ${objectIdName}, responding with error`,\n      );\n      return this.client.errorResponse(msg.header.sender, BE.ConfirmedServiceChoice.READ_PROPERTY, msg.invokeId,\n                                       BE.ErrorClass.OBJECT, BE.ErrorCode.UNKNOWN_OBJECT);\n    }\n\n    let property = object.getProperty(msg.payload.property.id);\n    if (!property) {\n      logger.debug(\n        `[send/${msg.header.sender.address}] Requested non-existent ` +\n        `property ${propertyName} for object ${objectIdName}, responding ` +\n        `with error`,\n      );\n      return this.client.errorResponse(msg.header.sender, BE.ConfirmedServiceChoice.READ_PROPERTY, msg.invokeId,\n                                       BE.ErrorClass.PROPERTY, BE.ErrorCode.UNKNOWN_PROPERTY);\n    }\n\n    if (msg.payload.property.index === 0xffffffff) {\n      const content = this.encodePropValue(property);\n      // const inpPresentValue = object.addProperty(\n      // \tPI.PRESENT_VALUE,\n      // \tBE.ApplicationTags.REAL\n      // );\n      // inpPresentValue.value = Math.floor(Math.random() * 100);  //FOR TESTING\n      this.client.readPropertyResponse(msg.header.sender, msg.invokeId, msg.payload.objectId, msg.payload.property,\n                                       content);\n      logger.debug(\n        `[send/${msg.header.sender.address}] readPropertyResponse@all: ${objectIdName}/${propertyName} => %O`, content);\n    } else {\n      const slot = property.value[msg.payload.property.index];\n      if (!slot) {\n        return this.client.errorResponse(msg.header.sender, BE.ConfirmedServiceChoice.READ_PROPERTY, msg.invokeId,\n                                         BE.ErrorClass.PROPERTY, BE.ErrorCode.INVALID_ARRAY_INDEX);\n      }\n\n      this.client.readPropertyResponse(msg.header.sender, msg.invokeId, msg.payload.objectId, msg.payload.property,\n                                       this.encodePropValue(slot));\n      logger.debug(\n        `[send/${msg.header.sender.address}] readPropertyResponse@${msg.payload.property.index}: ${objectIdName}/${propertyName}`,\n      );\n    }\n  }\n\n  onReadPropertyMultiple(msg) {\n    logger.debug(`onReadPropertyMultiple: ${msg}`);\n    logger.debug(`[recv/${msg.header.sender.address}] readPropertyMultiple`);\n    const responseList = [];\n    const propGroups   = msg.payload.properties;\n\n    propGroups.forEach(propGroup => {\n      const typeName         = Util.getEnumName(BE.ObjectType, propGroup.objectId.type);\n      const objectIdName     = typeName + ':' + propGroup.objectId.instance;\n      const propListFriendly = propGroup.properties.map(prop => Util.getEnumName(PI, prop.id));\n      logger.debug(\n        `[recv/${msg.header.sender.address}] readPropertyMultiple: object ${objectIdName}/%o`,\n        propListFriendly,\n      );\n\n      // BACnet spec 15.7.2\n      // If a device ID of 4194303 is given for a DEVICE(8) read, it should be\n      // treated as if the correct device instance was supplied, to allow\n      // discovering a device that does not respond with I-Am messages.\n      logger.debug(\n        `[BE.ObjectTypesSupported.DEVICE ${propGroup.objectId.instance}] readPropertyMultiple: instance ${BE.ASN1_MAX_PROPERTY_ID}`,\n      );\n      if (propGroup.objectId.type === BE.ObjectTypesSupported.DEVICE &&\n          propGroup.objectId.instance === BE.ASN1_MAX_PROPERTY_ID) {\n        propGroup.objectId.instance = this.instance;\n      }\n      const object   = this.getObject(propGroup.objectId.instance, propGroup.objectId.type);\n      const propList = [];\n\n      propGroup.properties.forEach(item => {\n        let content;\n        if (!object) {\n          // Object was invalid, so every prop is going to be an error.\n          content = [{\n            type : 0,\n            value: {\n              type      : 'BacnetError',\n              errorClass: BE.ErrorClass.OBJECT,\n              errorCode : BE.ErrorCode.UNKNOWN_OBJECT,\n            },\n          }];\n        } else {\n          if (item.id === PI.ALL) {\n            // Caller wants all properties for this object.\n            object.getAllPropertyIds().forEach(propertyId => {\n              // BACnet spec 15.7.3.1.2\n              // ALL and REQUIRED bulk property requests omit PROPERTY_LIST.\n              if (propertyId === PI.PROPERTY_LIST) return;\n\n              const prop = object.getProperty(propertyId);\n              propList.push(\n                { property: { id: propertyId, index: BE.ASN1_ARRAY_ALL }, value: this.encodePropValue(prop) });\n            });\n            return;\n          }\n\n          // Specific properties are listed, so just get those.\n          const property = object.getProperty(item.id);\n          if (!property) {\n            // Property doesn't exist, include an error for this property but\n            // still allow other valid ones to be returned.\n            content = [{\n              type : 0,\n              value: {\n                type      : 'BacnetError',\n                errorClass: BE.ErrorClass.PROPERTY,\n                errorCode : BE.ErrorCode.UNKNOWN_PROPERTY,\n              },\n            }];\n          } else if (item.index === BE.ASN1_ARRAY_ALL) {\n            content = this.encodePropValue(property);\n          } else {\n            const slot = Array.isArray(property.value) && property.value[item.index];\n            if (!slot) {\n              // This array index within the property is invalid.\n              content = [{\n                type : 0,\n                value: {\n                  type      : 'BacnetError',\n                  errorClass: BE.ErrorClass.PROPERTY,\n                  errorCode : BE.ErrorCode.INVALID_ARRAY_INDEX,\n                },\n              }];\n            } else {\n              content = this.encodePropValue(slot);\n            }\n          }\n        }\n\n        // Add the requested property to the list we will be returning, along\n        // with either its value or an error code.\n        assert(Array.isArray(content));\n        propList.push({ property: { id: item.id, index: item.index }, value: content });\n      });\n\n      // Add the object's props (along with any errors for invalid props), or\n      // the single error object if an invalid object instance was given.\n      responseList.push(\n        { objectId: { type: propGroup.objectId.type, instance: propGroup.objectId.instance }, values: propList });\n    });\n\n    logger.debug(\n      `[send/${msg.header.sender.address}] readPropertyMultiple response: %d objects, %d total properties`,\n      responseList.length,\n      responseList.map(o => o.values.length).reduce((a, b) => a + b),\n    );\n    this.client.readPropertyMultipleResponse(msg.header.sender, msg.invokeId, responseList);\n  }\n\n  onSubscribeCov(msg) {\n    logger.debug('onSubscribeCov');\n    const typeName     = Util.getEnumName(BE.ObjectType, msg.payload.monitoredObjectId.type);\n    const objectIdName = typeName + ':' + msg.payload.monitoredObjectId.instance;\n    logger.debug(`[recv/${msg.header.sender.address}] subscribeCov: object ${objectIdName}`);\n\n    const object = this.getObject(msg.payload.monitoredObjectId.instance, msg.payload.monitoredObjectId.type);\n    if (!object) {\n      // Invalid object\n      logger.debug(`${msg.header.sender.address} tried to subscribe to non-existent object ${objectIdName}`);\n      logger.debug(`[send/${msg.header.sender.address}] Returning error OBJECT:UNKNOWN_OBJECT`);\n      this.client.errorResponse(msg.header.sender, msg.service, msg.invokeId, BE.ErrorClass.OBJECT,\n                                BE.ErrorCode.UNKNOWN_OBJECT);\n      return;\n    }\n\n    // Remove any existing subscription for this property and device, as well as\n    // any expired ones.\n    object.subscriptions = object.subscriptions.filter(\n      sub => sub.subscriberAddress !== msg.header.sender && sub.subscriberProcessId !==\n             msg.payload.subscriberProcessId && sub.lifetime > 0);\n\n    // Add the new subscription if a non-zero lifetime is given (as a zero or\n    // missing lifetime means 'unsubscribe').\n    if (msg.payload.lifetime) {\n      const sub = {\n        subscriberAddress          : msg.header.sender,\n        monitoredObjectId          : msg.payload.monitoredObjectId,\n        subscriberProcessId        : msg.payload.subscriberProcessId,\n        issueConfirmedNotifications: true,\n        invokeId                   : msg.invokeId,\n        lifetime                   : msg.payload.lifetime,\n      };\n      object.subscriptions.push(sub);\n      logger.debug(\n        `Adding subscription to object ${objectIdName} for ${msg.header.sender.address}#${msg.payload.subscriberProcessId}`,\n      );\n\n      // We have to send an update immediately after the subscription, even if\n      // the value hasn't changed.\n      let propList = [];\n      // Get all property values.\n      object.getAllPropertyIds().forEach(propertyId => {\n        const property = object.getProperty(propertyId);\n        propList.push({ property: { id: propertyId }, value: this.encodePropValue(property) });\n      });\n      this.sendPropertyCov(sub, propList);\n    } else {\n      logger.debug(\n        `Removing subscription to object ${objectIdName} by ${msg.header.sender.address}#${msg.payload.subscriberProcessId}`,\n      );\n    }\n\n    logger.debug(`[send/${msg.header.sender.address}] simpleAckResponse for subscribeCov`);\n    this.client.simpleAckResponse(msg.header.sender, msg.service, msg.invokeId);\n  }\n\n  onSubscribeProperty(msg) {\n    logger.debug('onSubscribeProperty');\n    const typeName     = Util.getEnumName(BE.ObjectType, msg.payload.monitoredObjectId.type);\n    const objectIdName = typeName + ':' + msg.payload.monitoredObjectId.instance;\n    logger.debug(`[recv/${msg.header.sender.address}] subscribeCovProperty: object ${objectIdName}`);\n\n    if (!msg.payload.issueConfirmedNotifications) {\n      // Unconfirmed notifications aren't yet implemented in bacstack\n      logger.debug(\n        `Returning error to ${msg.header.sender.address} - unable to subscribe with unconfirmed notifications`,\n      );\n      logger.debug(`[send/${msg.header.sender.address}] Returning error OBJECT:OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED`);\n      this.client.errorResponse(msg.header.sender, msg.service, msg.invokeId, BE.ErrorClass.OBJECT,\n                                BE.ErrorCode.OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED);\n      return;\n    }\n\n    const object = this.getObject(msg.payload.monitoredObjectId.instance, msg.payload.monitoredObjectId.type);\n    if (!object) {\n      // Invalid object\n      logger.debug(`${msg.header.sender.address} tried to subscribe to non-existent object ${objectIdName}`);\n      logger.debug(`[send/${msg.header.sender.address}] Returning error OBJECT:UNKNOWN_OBJECT`);\n      this.client.errorResponse(msg.header.sender, msg.service, msg.invokeId, BE.ErrorClass.OBJECT,\n                                BE.ErrorCode.UNKNOWN_OBJECT);\n      return;\n    }\n\n    const property     = object.getProperty(msg.payload.monitoredProperty.id);\n    const propertyName = Util.getPropName(msg.payload.monitoredProperty.id);\n    if (!property) {\n      // Invalid property\n      logger.debug(\n        `${msg.header.sender.address} tried to subscribe to non-existent property ${objectIdName}/${propertyName}`,\n      );\n      logger.debug(`[send/${msg.header.sender.address}] Returning error PROPERTY:UNKNOWN_PROPERTY`);\n      this.client.errorResponse(msg.header.sender, msg.service, msg.invokeId, BE.ErrorClass.PROPERTY,\n                                BE.ErrorCode.UNKNOWN_PROPERTY);\n      return;\n    }\n\n    // Remove any existing subscription for this property and device, as well as\n    // any expired ones.\n    property.subscriptions = property.subscriptions.filter(\n      sub => sub.subscriberAddress !== msg.header.sender && sub.subscriberProcessId !==\n             msg.payload.subscriberProcessId && sub.lifetime > 0);\n\n    // Add the new subscription if a non-zero lifetime is given (as a zero or\n    // missing lifetime means 'unsubscribe').\n    if (msg.payload.lifetime) {\n      const sub = {\n        subscriberAddress          : msg.header.sender,\n        monitoredObjectId          : msg.payload.monitoredObjectId,\n        subscriberProcessId        : msg.payload.subscriberProcessId,\n        issueConfirmedNotifications: msg.payload.issueConfirmedNotifications,\n        monitoredIndex             : msg.payload.monitoredProperty.index,\n        invokeId                   : msg.invokeId,\n        lifetime                   : msg.payload.lifetime,\n      };\n      property.subscriptions.push(sub);\n      logger.debug(\n        `Adding subscription to property ${objectIdName}/${propertyName} for ${msg.header.sender.address}#${msg.payload.subscriberProcessId}`);\n\n      // We have to send an update immediately after the subscription, even if\n      // the value hasn't changed.\n      let propList = [];\n      propList.push({ property: { id: property.propertyId }, value: this.encodePropValue(property) });\n      this.sendPropertyCov(sub, propList);\n    } else {\n      logger.debug(\n        `Removing subscription to ${objectIdName}/${propertyName} by ${msg.header.sender.address}#${msg.payload.subscriberProcessId}`);\n    }\n\n    logger.debug(`[send/${msg.header.sender.address}] simpleAckResponse for subscribeCovProperty`);\n    this.client.simpleAckResponse(msg.header.sender, msg.service, msg.invokeId);\n  }\n\n  /**\n   * Top-level callback function when any property is changed.  We need to look\n   * up any subscriptions and send messages out as needed.\n   */\n  onObjectPropertyChanged(object, property) {\n    // logger.debug(\"onObjectPropertyChanged\")\n    let propList = [];\n\n    propList.push({ property: { id: property.propertyId }, value: this.encodePropValue(property) });\n\n    if (object.subscriptions) {\n      // TODO: add batch/transaction start/stop functions to collect all changes\n      // up into small number of messages, instead of one per property.\n      object.subscriptions.forEach(sub => {\n        const typeName     = Util.getEnumName(BE.ObjectType, sub.monitoredObjectId.type);\n        const objectIdName = typeName + ':' + sub.monitoredObjectId.instance;\n        this.sendPropertyCov(sub, propList);\n      });\n    }\n\n    if (property.subscriptions) {\n      property.subscriptions.forEach(sub => {\n        const typeName     = Util.getEnumName(BE.ObjectType, sub.monitoredObjectId.type);\n        const objectIdName = typeName + ':' + sub.monitoredObjectId.instance;\n        const propertyName = Util.getPropName(property.propertyId);\n        logger.debug(\n          `[send/${sub.subscriberAddress.address}] confirmedCOVNotification: property ${objectIdName}/${propertyName}`,\n        );\n        this.sendPropertyCov(sub, propList);\n      });\n    }\n  }\n\n  /**\n   * Send a COV notification.\n   *\n   * This is a separate function as we need to send the same message both when\n   * the value changes, as well as when a subscription request comes through.\n   */\n  sendPropertyCov(sub, propList) {\n    logger.debug('sendPropertyCov');\n    const typeName     = Util.getEnumName(BE.ObjectType, sub.monitoredObjectId.type);\n    const objectIdName = typeName + ':' + sub.monitoredObjectId.instance;\n    logger.debug(\n      `[send/${sub.subscriberAddress.address}] confirmedCOVNotification: object ${objectIdName}, ${propList.length} items`,\n    );\n    if (sub.issueConfirmedNotifications) {\n      this.client.confirmedCOVNotification(sub.subscriberAddress, sub.monitoredObjectId, sub.subscriberProcessId,\n                                           this.instance, sub.lifetime, propList, { invokeId: sub.invokeId }, err => {\n          if (err) {\n            logger.debug(`[recv/${sub.subscriberAddress.address}] confirmedCOVNotification was rejected:`, err);\n          } else {\n            logger.debug(`[recv/${sub.subscriberAddress.address}] confirmedCOVNotification was ACKed`);\n          }\n        },\n      );\n    } else {\n      // Sending unsubscribedCOV notifications is not yet implemented in bacstack\n    }\n  }\n\n  /**\n   * Encode a property value so that it matches the requested type.\n   *\n   * This is because we store some values differently to the way they are\n   * transmitted via BACnet.  For example we store a bit string as an array of\n   * enum items, so this needs to be encoded into an integer value before\n   * it can be sent in a readProperty response.\n   *\n   * @param BACnetObjectProperty property\n   *   Property class instance to encode.  This must be an instance of\n   *   BACnetObjectProperty as we need to access the property data type.\n   *\n   * @return Object suitable for passing to node-bacstack in a BACnet message\n   *   response.\n   */\n  encodePropValue(property) {\n    // logger.debug(\"encodePropValue\")\n\n    let encodedValue = property.value;\n    if (!Array.isArray(encodedValue)) encodedValue = [encodedValue];\n\n    // These types need the whole array\n    switch (property.typeId) {\n      case BE.ApplicationTags.BIT_STRING:\n        return [\n          {\n            value: bacnet.createBitstring(encodedValue),\n            type : property.typeId,\n          },\n        ];\n    }\n\n    // These types encode per item within the array.\n    return encodedValue.map(item => ({\n      value: (() => {\n        switch (property.typeId) {\n          case BE.ApplicationTags.NULL:\n          case BE.ApplicationTags.BOOLEAN:\n          case BE.ApplicationTags.UNSIGNED_INTEGER:\n          case BE.ApplicationTags.SIGNED_INTEGER:\n          case BE.ApplicationTags.REAL:\n          case BE.ApplicationTags.DOUBLE:\n          case BE.ApplicationTags.CHARACTER_STRING:\n          case BE.ApplicationTags.ENUMERATED:\n            // Nothing to do\n            return item;\n          //TODO case BE.ApplicationTags.OCTET_STRING:\n          // BIT_STRING is handled above\n          //TODO case BE.ApplicationTags.DATE:\n          //TODO case BE.ApplicationTags.TIME:\n          case BE.ApplicationTags.OBJECTIDENTIFIER:\n            // This comes from the structure used in BACnetObject.getProperty()\n            // for the OBJECT_LIST dynamic property handler.\n            return {\n              type    : item.typeId,\n              instance: item.instance,\n            };\n          default:\n            const typeName = Util.getEnumName(BE.ApplicationTags, property.typeId);\n            logger.debug(`No encoding for data type ${typeName}`);\n            throw new Error(`Encoding for data type ${typeName} has not been implemented in bacnet-device yet.`);\n        }\n      })(),\n      type : property.typeId,\n    }));\n  }\n\n  start() {\n    assert(this.deviceInfo.deviceId, 'Cannot create a new device without a deviceId');\n    assert(this.deviceInfo.name, 'Cannot create a new device without a name');\n\n    // Set some defaults to ensure we comply with BACnet standards\n    this.addProperty(PI.SYSTEM_STATUS).value                = BE.DeviceStatus.OPERATIONAL;\n    this.addProperty(PI.VENDOR_NAME).value                  = 'Nube iO Operations';\n    this.addProperty(PI.VENDOR_IDENTIFIER).value            = 1173;\n    this.addProperty(PI.MODEL_NAME).value                   = 'nube-io-bacnet';\n    this.addProperty(PI.FIRMWARE_REVISION).value            = 1;\n    this.addProperty(PI.APPLICATION_SOFTWARE_VERSION).value = 1;\n    this.addProperty(PI.PROTOCOL_VERSION).value             = 1;\n    this.addProperty(PI.PROTOCOL_REVISION).value            = 1;\n    this.addProperty(PI.PROTOCOL_SERVICES_SUPPORTED).value  = [\n      // These are the BACnet calls we support.\n\n      // BE.ServicesSupported.ACKNOWLEDGE_ALARM,\n      BE.ServicesSupported.CONFIRMED_COV_NOTIFICATION,\n      // BE.ServicesSupported.CONFIRMED_EVENT_NOTIFICATION,\n      // BE.ServicesSupported.GET_ALARM_SUMMARY,\n      // BE.ServicesSupported.GET_ENROLLMENT_SUMMARY,\n      BE.ServicesSupported.SUBSCRIBE_COV,\n      // BE.ServicesSupported.ATOMIC_READ_FILE,\n      // BE.ServicesSupported.ATOMIC_WRITE_FILE,\n      // BE.ServicesSupported.ADD_LIST_ELEMENT,\n      // BE.ServicesSupported.REMOVE_LIST_ELEMENT,\n      // BE.ServicesSupported.CREATE_OBJECT,\n      // BE.ServicesSupported.DELETE_OBJECT,\n      BE.ServicesSupported.READ_PROPERTY,\n      BE.ServicesSupported.READ_PROPERTY_MULTIPLE,\n      BE.ServicesSupported.WRITE_PROPERTY,\n      // BE.ServicesSupported.WRITE_PROPERTY_MULTIPLE,\n      // BE.ServicesSupported.DEVICE_COMMUNICATION_CONTROL,\n      // BE.ServicesSupported.CONFIRMED_PRIVATE_TRANSFER,\n      // BE.ServicesSupported.CONFIRMED_TEXT_MESSAGE,\n      // BE.ServicesSupported.REINITIALIZE_DEVICE,\n      // BE.ServicesSupported.VT_OPEN,\n      // BE.ServicesSupported.VT_CLOSE,\n      // BE.ServicesSupported.VT_DATA,\n      // BE.ServicesSupported.READ_PROPERTY_CONDITIONAL,\n      // BE.ServicesSupported.AUTHENTICATE,\n      // BE.ServicesSupported.REQUEST_KEY,\n      BE.ServicesSupported.I_AM,\n      // BE.ServicesSupported.I_HAVE,\n      // BE.ServicesSupported.UNCONFIRMED_COV_NOTIFICATION,\n      // BE.ServicesSupported.UNCONFIRMED_EVENT_NOTIFICATION,\n      // BE.ServicesSupported.UNCONFIRMED_PRIVATE_TRANSFER,\n      // BE.ServicesSupported.UNCONFIRMED_TEXT_MESSAGE,\n      // BE.ServicesSupported.TIME_SYNCHRONIZATION,\n      // BE.ServicesSupported.WHO_HAS,\n      BE.ServicesSupported.WHO_IS,\n      // BE.ServicesSupported.READ_RANGE,\n      // BE.ServicesSupported.UTC_TIME_SYNCHRONIZATION,\n      // BE.ServicesSupported.LIFE_SAFETY_OPERATION,\n      BE.ServicesSupported.SUBSCRIBE_COV_PROPERTY,\n      // BE.ServicesSupported.GET_EVENT_INFORMATION,\n      // BE.ServicesSupported.WRITE_GROUP,\n      // BE.ServicesSupported.SUBSCRIBE_COV_PROPERTY_MULTIPLE,\n      // BE.ServicesSupported.CONFIRMED_COV_NOTIFICATION_MULTIPLE,\n      // BE.ServicesSupported.UNCONFIRMED_COV_NOTIFICATION_MULTIPLE,\n    ];\n    // PROTOCOL_OBJECT_TYPES_SUPPORTED is handled by our parent class.\n    // OBJECT_LIST is handled by our parent class.\n    this.addProperty(PI.MAX_APDU_LENGTH_ACCEPTED).value = 1482;\n    this.addProperty(PI.SEGMENTATION_SUPPORTED).value   = BE.Segmentation.SEGMENTED_BOTH;\n    // APDU_TIMEOUT is handled by getProperty().\n    this.addProperty(PI.NUMBER_OF_APDU_RETRIES).value   = 3;\n    this.addProperty(PI.DEVICE_ADDRESS_BINDING).value   = [];\n    this.addProperty(PI.DATABASE_REVISION).value        = 1;\n\n    // This property is dynamic since we override getProperty() and provide a\n    // value there.  We have to add it to the list of dynamic properties so that\n    // it gets included when lists of properties are requested, as it will never\n    // appear in `this.properties`.\n    this.dynamicProperties.push(PI.APDU_TIMEOUT);\n\n    // Add ourself to the object list.  We can't use addObject() here as that\n    // will create a new object (with no child properties), whereas we need\n    // this same device object as a child object in order for the OBJECT_LIST\n    // property to be correctly constructed.\n    if (!this.objects[BE.ObjectType.DEVICE]) {\n      this.objects[BE.ObjectType.DEVICE] = {};\n    }\n    this.objects[BE.ObjectType.DEVICE][this.instance] = this;\n\n    this.ip     = this.hostInfo.address;\n    this.client = new bacnet({\n                               adpuTimeout     : this.hostInfo.adpuTimeout,\n                               port            : this.hostInfo.port,\n                               interface       : this.hostInfo.address,\n                               broadcastAddress: this.hostInfo.broadcast,\n                             });\n    // Start with an empty Broadcast Distribution Table.\n    this.bdt    = {};\n\n    // And and empty list of SubscribeCov entries.\n    this.subscriptions = [];\n\n    // Set up BACnet callbacks\n    this.client.on('unhandledEvent', this.onUnhandledEvent.bind(this));\n    this.client.on('registerForeignDevice', this.onRegisterForeignDevice.bind(this));\n    this.client.on('whoIs', this.onWhoIs.bind(this));\n    this.client.on('writeProperty', this.onWriteProperty.bind(this));\n    this.client.on('readProperty', this.onReadProperty.bind(this));\n    this.client.on('readPropertyMultiple', this.onReadPropertyMultiple.bind(this));\n    this.client.on('subscribeCov', this.onSubscribeCov.bind(this));\n    this.client.on('subscribeProperty', this.onSubscribeProperty.bind(this));\n    this.client.reinitializeDevice(this.ip, BE.ReinitializedState.COLDSTART, (err, value) => {\n      //TODO check why client report timeout\n      logger.debug('err: ', err);\n      logger.debug('info: ', value);\n    });\n  }\n\n  stop() {\n    if (this.client !== null) {\n      this.client.close();\n    }\n  }\n\n  /**\n   * Add a new object to the device, such as a sensor reading.\n   *\n   * @param bacnetPoint bacnet point\n   * @return BACnetObject\n   */\n  addPoint(bacnetPoint) {\n    if (!bacnetPoint) {\n      return null;\n    }\n    logger.info(`Adding BACnet point ${bacnetPoint.objectType.label}:${bacnetPoint.objectInstance}...`);\n    logger.info(`Adding BACnet point ${bacnetPoint.objectType.label}:${bacnetPoint.objectInstance}...`);\n    assert(Number.isInteger(bacnetPoint.objectType.value), 'Object type must be a BE.ObjectType value.');\n    assert(Number.isInteger(bacnetPoint.objectInstance), 'Instance ID must be an integer.');\n\n    if (!this.objects[bacnetPoint.objectType.value]) this.objects[bacnetPoint.objectType.value] = {};\n    let object = new BACnetObject(this, bacnetPoint.objectInstance, bacnetPoint.objectType.value, bacnetPoint.objectName);\n    return (this.objects[bacnetPoint.objectType.value][bacnetPoint.objectInstance] = object);\n  }\n\n  updatePoint(bacnetPoint) {\n    if (!bacnetPoint) {\n      return null;\n    }\n    let object = this.getObject(bacnetPoint.objectInstance, bacnetPoint.objectType.value);\n    logger.info(`Updating BACNet point properties ${bacnetPoint.objectType.label}:${bacnetPoint.objectInstance}...`);\n    if (!object) {\n      return this.addPoint(bacnetPoint);\n    }\n    object.addProperty(bacnet.enum.PropertyIdentifier.OBJECT_NAME).value = bacnetPoint.objectName;\n    return (this.objects[bacnetPoint.objectType.value][bacnetPoint.objectInstance] = object);\n  }\n\n  updateValue(bacnetPoint) {\n    if (!bacnetPoint) {\n      return null;\n    }\n    logger.info(`Pushing BACNet point Value ${bacnetPoint.objectType.label}:${bacnetPoint.objectInstance}...`);\n    let object = this.getObject(bacnetPoint.objectInstance, bacnetPoint.objectType.value);\n    if (!object) {\n      return null;\n    }\n    let pv                                                                   = bacnetPoint.pointValue;\n    object.addProperty(PI.PRESENT_VALUE, BE.ApplicationTags.REAL).value      = pv.presentValue;\n    object.addProperty(PI.PRIORITY, BE.ApplicationTags.SIGNED_INTEGER).value = pv.priority;\n    object.addProperty(PI.PRIORITY_ARRAY, BE.ApplicationTags.REAL).value     = Object.values(pv.priorityArray);\n    return pv;\n  }\n\n  delObject(instance, objectTypeId) {\n    assert(Number.isInteger(instance), 'Instance ID must be an integer.');\n    assert(Number.isInteger(objectTypeId), 'Object type must be a BE.ObjectType value.');\n    logger.debug(`BACNet delete object ${objectTypeId}:${instance}`);\n    if (this.objects[objectTypeId]) {\n      delete this.objects[objectTypeId][instance];\n    }\n  }\n}\n\nexport default BACnetDevice;\n","module.exports = require(\"assert\");","//\n// BACnet device implementation.\n// Objects attached to devices.\n//\nconst bacnet = require('node-bacnet');\nconst logger = require('logplease').create('bacnet', { color: 6 });\n\nconst BACnetObjectProperty = require('./bacnet-object-property');\nconst MandatoryProperties  = require('./mandatory-properties');\nconst Util                 = require('./util');\n\nclass BACnetObject {\n  constructor(dev, instance, typeId, name) {\n    this.dev           = dev;\n    this.instance      = instance;\n    this.objects       = {};\n    this.properties    = {};\n    this.subscriptions = [];\n\n    // This is a list of dynamic properties provided by getProperty().  It is\n    // an instance variable so that subclasses can append to it if they override\n    // getProperty().\n    this.dynamicProperties = [\n      bacnet.enum.PropertyIdentifier.OBJECT_IDENTIFIER,\n      bacnet.enum.PropertyIdentifier.PROPERTY_LIST,\n      bacnet.enum.PropertyIdentifier.OBJECT_LIST,\n      bacnet.enum.PropertyIdentifier.PROTOCOL_OBJECT_TYPES_SUPPORTED,\n    ];\n\n    // Set some defaults to ensure we comply with BACnet standards\n    this.addProperty(bacnet.enum.PropertyIdentifier.OBJECT_TYPE).value = typeId;\n    this.addProperty(bacnet.enum.PropertyIdentifier.OBJECT_NAME).value = name;\n    // We don't set PRESENT_VALUE in case the user wants to, and wants to set\n    // it to a different type to the one we might use (e.g. analogue values\n    // are REAL while digital values are BOOLEAN.)\n    this.addProperty(bacnet.enum.PropertyIdentifier.STATUS_FLAGS).value   = [];\n    this.addProperty(bacnet.enum.PropertyIdentifier.EVENT_STATE).value    =\n      bacnet.enum.EventState.NORMAL;\n    this.addProperty(bacnet.enum.PropertyIdentifier.OUT_OF_SERVICE).value = false;\n    this.addProperty(bacnet.enum.PropertyIdentifier.UNITS).value          = bacnet.enum.EngineeringUnits.NO_UNITS;\n  }\n\n  /**\n   * Add a new property if it doesn't already exist, and return it either way.\n   */\n  addProperty(propertyId, typeId = undefined) {\n    propertyId = parseInt(propertyId);\n    if (this.dynamicProperties.includes(propertyId)) {\n      const propertyName = Util.getPropName(propertyId);\n      throw new Error(`Property ${propertyName} is generated on-the-fly and cannot be set.`);\n    }\n    return (\n      this.properties[propertyId] ||\n      (this.properties[propertyId] = new BACnetObjectProperty(this, propertyId, typeId))\n    );\n  }\n\n  /**\n   * Add multiple properties and set their values at the same time.\n   *\n   * This is typically used to set static values like names and descriptions.\n   *\n   * @param object propList\n   *   Associative array.  Array key is PropertyIdentifier enum, and the array\n   *   value is used as the property value.\n   */\n  addPropertyBulk(propList) {\n    Object.keys(propList).forEach(p => {\n      this.addProperty(p).value = propList[p];\n    });\n  }\n\n  /**\n   * Remove a property, since properties can't have 'undefined' as a value.\n   */\n  delProperty(propertyId, index = undefined) {\n    if (index !== undefined) {\n      delete this.properties[propertyId][index];\n    } else {\n      delete this.properties[propertyId];\n    }\n  }\n\n  getProperty(propertyId) {\n    propertyId = parseInt(propertyId);\n    // Some properties are generated dynamically\n    switch (propertyId) {\n      case bacnet.enum.PropertyIdentifier.OBJECT_IDENTIFIER: {\n        // Construct this one from the other properties.\n        const prop  = new BACnetObjectProperty(this, propertyId, undefined, true);\n        prop._value = {\n          // Object type, e.g. BE.ObjectTypesSupported.DEVICE\n          typeId  : this.getProperty(bacnet.enum.PropertyIdentifier.OBJECT_TYPE).value,\n          // Instance number.\n          instance: this.instance,\n        };\n        return prop;\n      }\n\n      case bacnet.enum.PropertyIdentifier.PROPERTY_LIST: {\n        // Return a list of all properties.\n\n        // These properties are not included per the BACnet standard.\n        const ignoreProps  = [\n          bacnet.enum.PropertyIdentifier.OBJECT_NAME,\n          bacnet.enum.PropertyIdentifier.OBJECT_TYPE,\n          bacnet.enum.PropertyIdentifier.OBJECT_IDENTIFIER,\n          bacnet.enum.PropertyIdentifier.PROPERTY_LIST,\n        ];\n        const prop         = new BACnetObjectProperty(this, propertyId, undefined, true);\n        const propertyList = this.getAllPropertyIds();\n        prop._value        = propertyList.filter(p => !ignoreProps.includes(p));\n\n        // Check to ensure all the mandatory properties are included, and warn\n        // the user if not.  This is not required but will help users of this\n        // library create confirmant BACnet devices.\n        const selfTypeId = this.getProperty(bacnet.enum.PropertyIdentifier.OBJECT_TYPE).value;\n        if (MandatoryProperties[selfTypeId]) {\n          const missingProperties = MandatoryProperties[selfTypeId].filter(\n            p => !prop._value.includes(p),\n          );\n          if (missingProperties.length > 0) {\n            const selfName             = this.getProperty(bacnet.enum.PropertyIdentifier.OBJECT_NAME).value;\n            const missingPropertyNames = missingProperties.map(p => Util.getPropName(p));\n            logger.error(\n              `Object #${this.instance}(\"${selfName}\") is missing these mandatory properties: %o`,\n              missingPropertyNames,\n            );\n          }\n        } else {\n          const typeName = Util.getEnumName(bacnet.enum.ObjectType, selfTypeId);\n          logger.error(\n            `TODO: No mandatory properties have been defined for the object type ${typeName}`,\n          );\n        }\n        return prop;\n      }\n\n      case bacnet.enum.PropertyIdentifier.OBJECT_LIST: {\n        let objectList = [];\n        Object.keys(this.objects).forEach(objType => {\n          const objectsOfType = this.objects[objType];\n          Object.keys(objectsOfType).forEach(objectInstance => {\n            const obj = objectsOfType[objectInstance];\n            objectList.push({\n                              typeId  : obj.getProperty(bacnet.enum.PropertyIdentifier.OBJECT_TYPE).value,\n                              instance: obj.instance,\n                            });\n          });\n        });\n        const prop  = new BACnetObjectProperty(this, propertyId, undefined, true);\n        prop._value = objectList;\n        return prop;\n      }\n\n      case bacnet.enum.PropertyIdentifier.PROTOCOL_OBJECT_TYPES_SUPPORTED: {\n        // Run through all our objects and return just the types in use.\n        let typeList = {};\n        Object.keys(this.objects).forEach(objType => {\n          const objectsOfType = this.objects[objType];\n          Object.keys(objectsOfType).forEach(objectInstance => {\n            const obj      = objectsOfType[objectInstance];\n            const type     = obj.getProperty(bacnet.enum.PropertyIdentifier.OBJECT_TYPE).value;\n            typeList[type] = true;\n          });\n        });\n        const prop  = new BACnetObjectProperty(this, propertyId, undefined, true);\n        prop._value = Object.keys(typeList).map(t => parseInt(t));\n        return prop;\n      }\n\n      default:\n        break;\n    }\n    return this.properties[propertyId];\n  }\n\n  getAllPropertyIds() {\n    const propertyList = [\n      ...Object.keys(this.properties),\n      // Also add the dynamic properties generated by this function, since\n      // they won't be in this.properties.\n      ...this.dynamicProperties,\n    ];\n    // Convert the string keys back into integer values that will match enums.\n    return propertyList.map(p => parseInt(p));\n  }\n\n  /**\n   * Called when a child property's value has changed, so that we can notify\n   * any object-level subscribers.\n   */\n  onPropertyChanged(property) {\n    if (!this.dev) return; // happens during init on Device object\n    this.dev.onObjectPropertyChanged(this, property);\n  }\n\n  /**\n   * Return an object with the properties as string keys, suitable for passing\n   * to console.log() to check the current state of the object.\n   *\n   * This is more useful than dumping `this.properties`, as this function will\n   * convert the enums from integers into strings.\n   */\n  dumpProperties() {\n    let fullPropList = Object.keys(this.properties).map(p => parseInt(p));\n\n    // Include dynamic props in the dump\n    fullPropList.push(bacnet.enum.PropertyIdentifier.PROTOCOL_OBJECT_TYPES_SUPPORTED);\n    fullPropList.push(bacnet.enum.PropertyIdentifier.OBJECT_IDENTIFIER);\n    fullPropList.push(bacnet.enum.PropertyIdentifier.PROPERTY_LIST);\n    fullPropList.push(bacnet.enum.PropertyIdentifier.OBJECT_LIST);\n\n    let props = {};\n    fullPropList.forEach(key => {\n      const property = this.getProperty(key);\n      const keyName  = Util.getPropName(key);\n      props[keyName] = property.valueAsString();\n    });\n    return props;\n  }\n\n  /**\n   * Get the sub-object identified by the given instance ID, optionally matching\n   * the given type as well.\n   *\n   * @param instance ID number for the object.\n   *\n   * @param objectTypeId bacnet.enum.ObjectType objectTypeId\n   *   Object type, such as an analogue input or digital output.  This must be\n   *   specified because it is possible to have multiple objects with the same\n   *   instance ID, differing only by type (such as Analogue Input #1 and\n   *   Digital Output #1).\n   *\n   * @return If `instance` and `objectTypeId` are valid, the `BACnetObject` is\n   *   returned.  If `instance` or `objectTypeId` are invalid, `undefined` is\n   *   returned.\n   */\n  getObject(instance, objectTypeId) {\n    const typeGroup = this.objects[objectTypeId];\n    if (!typeGroup) return undefined;\n\n    return typeGroup[instance];\n  }\n}\n\nmodule.exports = BACnetObject;\n","module.exports = require(\"util\");","//\n// BACnet device implementation.\n// Mapping between properties and default types.\n//\n\nconst bacnet = require('node-bacnet');\n\nconst pi   = bacnet && bacnet.enum.PropertyIdentifier;\nconst type = bacnet && bacnet.enum.ApplicationTags;\n\nconst propertyTypeMap = bacnet && {\n  [pi.APPLICATION_SOFTWARE_VERSION]   : type.CHARACTER_STRING,\n  [pi.APDU_TIMEOUT]                   : type.UNSIGNED_INTEGER,\n  [pi.DATABASE_REVISION]              : type.UNSIGNED_INTEGER,\n  [pi.DESCRIPTION]                    : type.CHARACTER_STRING,\n  [pi.DEVICE_ADDRESS_BINDING]         : type.CHARACTER_STRING,\n  [pi.DEVICE_TYPE]                    : type.CHARACTER_STRING,\n  [pi.EVENT_STATE]                    : type.ENUMERATED,\n  [pi.FIRMWARE_REVISION]              : type.CHARACTER_STRING,\n  [pi.DEVICE_ADDRESS_BINDING]         : type.OCTET_STRING, // just a guess\n  [pi.MAX_APDU_LENGTH_ACCEPTED]       : type.UNSIGNED_INTEGER,\n  [pi.MODEL_NAME]                     : type.CHARACTER_STRING,\n  [pi.NUMBER_OF_APDU_RETRIES]         : type.UNSIGNED_INTEGER,\n  [pi.OBJECT_IDENTIFIER]              : type.OBJECTIDENTIFIER,\n  [pi.OBJECT_LIST]                    : type.OBJECTIDENTIFIER,\n  [pi.OBJECT_NAME]                    : type.CHARACTER_STRING,\n  [pi.OBJECT_TYPE]                    : type.ENUMERATED,\n  [pi.OUT_OF_SERVICE]                 : type.BOOLEAN,\n  //[pi.PRESENT_VALUE]: Not set as this depends on the object type\n  [pi.PROPERTY_LIST]                  : type.ENUMERATED,\n  [pi.PROTOCOL_OBJECT_TYPES_SUPPORTED]: type.BIT_STRING,\n  [pi.PROTOCOL_REVISION]              : type.UNSIGNED_INTEGER,\n  [pi.PROTOCOL_SERVICES_SUPPORTED]    : type.BIT_STRING,\n  [pi.PROTOCOL_VERSION]               : type.UNSIGNED_INTEGER,\n  [pi.RELIABILITY]                    : type.ENUMERATED,\n  [pi.SEGMENTATION_SUPPORTED]         : type.ENUMERATED,\n  [pi.STATUS_FLAGS]                   : type.BIT_STRING,\n  [pi.SYSTEM_STATUS]                  : type.ENUMERATED,\n  [pi.UNITS]                          : type.ENUMERATED,\n  [pi.UPDATE_INTERVAL]                : type.UNSIGNED_INTEGER,\n  [pi.VENDOR_IDENTIFIER]              : type.UNSIGNED_INTEGER,\n  [pi.VENDOR_IDENTIFIER]              : type.UNSIGNED_INTEGER,\n  [pi.VENDOR_NAME]                    : type.CHARACTER_STRING,\n};\n\nmodule.exports = propertyTypeMap;\n","const bacnet = require('node-bacnet');\n\nconst BE = bacnet && bacnet.enum;\nconst PI = bacnet && BE.PropertyIdentifier;\n\n// Note that OBJECT_IDENTIFIER, OBJECT_NAME, OBJECT_TYPE and PROPERTY_LIST are\n// not included in the lists below, as they are not returned by the\n// PROPERTY_LIST request.  They are also handled internally so should never be\n// omitted by accident.\nmodule.exports = bacnet && {\n  [BE.ObjectType.ANALOG_OUTPUT]: [\n    // PAGE 161 of spec\n    // Object_Identifier  PROP_OBJECT_IDENTIFIER  Type is 12 for a // ASHRE 135-2016 - 20.2.1.4 Application Tags - Enumerators\n    // Object_Name  // CharacterString // type.CHARACTER_STRING,\n    // Object_Type  // BACnetObjectType // type.ENUMERATED,\n    PI.PRESENT_VALUE, // PROP_PRESENT_VALUE Type 4 is  REAL: 4,\n    PI.STATUS_FLAGS, // BACnetStatusFlags  // type.BIT_STRING\n    PI.EVENT_STATE, // BACnetEventState  //  type.ENUMERATED,\n    PI.OUT_OF_SERVICE, //BOOLEAN\n    PI.UNITS, // PAGE 156 of spec Example milliamperes (2),   // type.ENUMERATED\n    PI.PRIORITY_ARRAY, //Type BACnetPriorityArray // PAGE 831 of spec. // depands on the data type. So for an AO its type: 4 and the value is real\n    PI.RELINQUISH_DEFAULT, //REAL\n  ],\n  [BE.ObjectType.ANALOG_INPUT] : [\n    // PAGE 156 of spec\n    // Object_Identifier\n    // Object_Name\n    // Object_Type\n    PI.PRESENT_VALUE,\n    PI.STATUS_FLAGS,\n    PI.EVENT_STATE,\n    PI.OUT_OF_SERVICE,\n    PI.UNITS,\n  ],\n  [BE.ObjectType.DEVICE]       : [\n    PI.SYSTEM_STATUS,\n    PI.VENDOR_NAME,\n    PI.VENDOR_IDENTIFIER,\n    PI.MODEL_NAME,\n    PI.FIRMWARE_REVISION,\n    PI.APPLICATION_SOFTWARE_VERSION,\n    PI.PROTOCOL_VERSION,\n    PI.PROTOCOL_REVISION,\n    PI.PROTOCOL_SERVICES_SUPPORTED,\n    PI.PROTOCOL_OBJECT_TYPES_SUPPORTED,\n    PI.OBJECT_LIST,\n    PI.MAX_APDU_LENGTH_ACCEPTED,\n    PI.SEGMENTATION_SUPPORTED,\n    PI.APDU_TIMEOUT,\n    PI.NUMBER_OF_APDU_RETRIES,\n    PI.DEVICE_ADDRESS_BINDING,\n    PI.DATABASE_REVISION,\n  ],\n};\n","import { PointOutput, PointValueCreator } from '../../../../backend/models/point-model';\nimport { isNull } from '../../../../utils/helper';\nimport {\n  DefaultObservable,\n  HasCentralizedListener,\n  ICentralizedListener,\n  MockCentralizedListener,\n  NodeStoreItem,\n  Observer,\n} from '../../../../utils/pattern';\nimport { Container, Side } from '../../../container';\nimport { Node, NodeSettings, SettingType } from '../../../node';\nimport { NodeInput, Type } from '../../../node-io';\nimport Registry from '../../../registry';\nimport { DependantConnectionNode, DependantConnectionNodeMixin } from '../connection-node-mixin';\nimport {\n  DataPointFlowHandler,\n  HasDataPointFlowHandler,\n  HasPointOutputObservers,\n  MockHasPointOutputObservers,\n  PointNodeMixin,\n} from '../model/point-node';\nimport {\n  BACNET_SERVER_NODE_TYPE,\n  PUSH_BACNET_POINT_VALUE,\n  REGISTER_BACNET_POINT,\n  UNREGISTER_BACNET_POINT,\n  UPDATE_BACNET_POINT,\n} from './bacnet-server-node';\nimport { BacnetPoint, BacnetPointCreator, PointKind } from './core/bacnet-model';\n\nclass BACnetServerPointNode extends DependantConnectionNodeMixin(PointNodeMixin(Node))\n  implements HasPointOutputObservers<BacnetPoint>, HasDataPointFlowHandler<BacnetPoint>, DataPointFlowHandler<BacnetPoint>,\n    DependantConnectionNode, HasCentralizedListener {\n  constructor() {\n    super();\n    this.title = 'BACnet Server Point';\n    this.description =\n      'Bacnet-server-point nodes should be added within a bacnet-server container node. ' +\n      'BACnet point details should be set in settings. BACnet point settings include ID, Type, and Name.';\n    this.mixinEnableInputSetting();\n    this.mixinConnectionStatusOutput();\n    this.addInputWithSettings('point-id', Type.NUMBER, 1, 'BACnet Object Id');\n    this.settings['point-kind'] = {\n      description: 'BACnet Object Type',\n      type       : SettingType.DROPDOWN,\n      config     : { items: PointKind.items() },\n      value      : PointKind.ANALOG_INPUT.enumKey,\n    };\n    this.addInputWithSettings('point-name', Type.STRING, 'bacnet-point', 'BACnet Point Name');\n    this.setSettingsConfig(this.mixinPointValueInputOutput());\n  }\n\n  flowHandler(): DataPointFlowHandler<BacnetPoint> {\n    return this;\n  }\n\n  listener(): ICentralizedListener {\n    return MockCentralizedListener.cast(this.getParentNode());\n  }\n\n  pointObservers(): Observer<PointOutput<BacnetPoint>>[] {\n    return [...super.pointObservers(),\n            ...MockHasPointOutputObservers.cast(this.getParentNode()).pointObservers()];\n  }\n\n  notifyOutput(point: BacnetPoint, observers: Observer<PointOutput<BacnetPoint>>[]): void {\n    let cp = this.initializePointBySettingObject() ?? point;\n    if (isNull(cp)) {\n      return;\n    }\n    point.pointValue = isNull(point?.pointValue) ? PointValueCreator.by() : point?.pointValue.merge(cp.pointValue);\n    this.settings[this.modelSettingKey()].value = point;\n    new DefaultObservable(observers).notify({ point: point, connStatus: { status: this.getConnectionStatus() } });\n  }\n\n  onRemoved() {\n    if (this.listener() === MockCentralizedListener.LISTENER) {\n      return;\n    }\n    let event = {\n      action : UNREGISTER_BACNET_POINT,\n      payload: this.createPayload(this.initializePointBySettingObject()),\n    };\n    this.listener().listen(event);\n  }\n\n  handleOnUpdate(current: BacnetPoint, prev?: BacnetPoint): BacnetPoint {\n    if (this.side !== Side.server || (!prev?.objectInstance && !current?.objectInstance)) {\n      return null;\n    }\n    let payload = this.createPayload(current);\n    if (!prev || this.getConnectionStatus().isError()) {\n      this.listener().listen({ action: REGISTER_BACNET_POINT, payload });\n    } else if (!current.mightOnlyValueChanged(prev)) {\n      if (!current.equals(prev)) {\n        current.pointValue = PointValueCreator.by();\n      }\n      payload.prev = this.createPayload(prev);\n      this.listener().listen({ action: UPDATE_BACNET_POINT, payload });\n    }\n    if (!current.enabled || (isNull(current?.pointValue?.presentValue) &&\n                             (prev && !current.equals(prev) || isNull(prev?.pointValue?.presentValue)))) {\n      return current;\n    }\n    let cov = current.pointValue.changedOfValue(prev?.pointValue);\n    if (cov) {\n      payload.data.pointValue = cov;\n    }\n    current.pointValue = this.listener().listen({ action: PUSH_BACNET_POINT_VALUE, payload });\n    return current;\n  }\n\n  initializePointBySettingObject(settings?: { [name: string]: NodeSettings }): BacnetPoint {\n    let st = (settings ?? this.settings) as { [name: string]: NodeSettings };\n    return BacnetPointCreator.from(st[this.modelSettingKey()].value);\n  }\n\n  initializePointBySettingInput(settings?: { [name: string]: NodeSettings }): BacnetPoint {\n    let st = (settings ?? this.settings) as { [name: string]: NodeSettings };\n    let kind = <PointKind>PointKind.enumValueOf(st['point-kind'].value);\n    return BacnetPointCreator.by(this.isEnabled(), st['point-id'].value, kind, st['point-name'].value,\n                                 this.createPointValue(st));\n  }\n\n  reEvaluateSettingByInput(inputs: { [p: number]: NodeInput }, settings: { [name: string]: NodeSettings }) {\n    settings['point-id'].value = inputs[1].updated ? inputs[1].data : settings['point-id'].value;\n    settings['point-name'].value = inputs[2].updated ? inputs[2].data : settings['point-name'].value;\n    super.reEvaluateSettingByInput(inputs, settings);\n  }\n\n  onReceiveMessage(point: BacnetPoint): void {\n    this.notifyOutput(point, this.pointObservers());\n  }\n\n  protected statusOutputIdx(): number {\n    return 0;\n  }\n\n  protected enableDescription(): string {\n    return 'Enable BACnet Point';\n  }\n\n  protected modelSettingKey(): string {\n    return 'bp';\n  }\n\n  protected valueInputIdx(): number {\n    return 3;\n  }\n\n  protected valueOutputIdx(): number {\n    return this.errorOutputIdx() + 1;\n  }\n\n  protected computeTitle(): string {\n    let kind = <PointKind>PointKind.enumValueOf(this.settings['point-kind'].value);\n    return `BACnet Point (ObjectType: ${kind.label}, ObjectId: ${this.settings['point-id'].value})`;\n  }\n\n  private createPayload(point: BacnetPoint) {\n    return {\n      identifier: point?.identifier(),\n      enabled   : point?.enabled,\n      data      : point,\n      nodeId    : Registry.getId(this.cid, this.id),\n      callback  : (p: BacnetPoint) => this.onReceiveMessage(p),\n    } as NodeStoreItem;\n  }\n}\n\nContainer.registerNodeType('protocols/bacnet-server/bacnet-server-point', BACnetServerPointNode,\n                           BACNET_SERVER_NODE_TYPE);\n","import { Node, SettingType} from '../../../node';\nimport { Container } from '../../../container';\nimport { Type } from '../../../node-io';\nimport TimeUtils from '../../../utils/time-utils';\n\ninterface LoraSensor {\n  id: string;\n  voltage: number;\n  rssi: number;\n  snr: number;\n  nodeName: string;\n  topic: {}\n  lastMessage: any\n}\ninterface AASensor extends LoraSensor {\n  pulses: number;\n  a1: number;\n  a2: number;\n  a3: number;\n}\ninterface B0Sensor extends LoraSensor {\n  temp: number;\n  pressure: number;\n  humidity: number;\n}\ninterface B1Sensor extends B0Sensor {\n  lux: number;\n}\ninterface B2Sensor extends B1Sensor {\n  movement: boolean;\n}\n\nenum SensorType {\n  Droplet = 'Droplet',\n  MicroEdge = 'MicroEdge',\n}\n\nexport class LoraSensorDecoderNode extends Node {\n  watchdogDelay = 3600000;\n  nodeID = '';\n  timeoutFunc;\n  sensorType: string;\n\n  constructor() {\n    super();\n    this.title = `Lora Sensor Decoder (Droplet | Micro)`;\n    this.description =\n      'This node is used to decode raw serial input messages to LORA sensor values. It should be used in conjunction with the protocols/serial-connector node. If a nodeID is set, only messages from matching LORA sensors will be output;  if no nodeID is set, all valid LORA sensor messages will be output.  Outputs that are not present in the raw serial input message will be null.  lowBatteryAlm output will be true if the LORA sensor has a battery voltage value less than the Low battery warning voltage setting; otherwise it will be false.  watchdog output will be true if there has been no valid message from the nodeID LORA sensor for the Watchdog Delay; otherwise watchdog output will be false.  Maximum Watchdog Delay setting is 587 hours.  This node can be used for decoding Nube Droplet sensors, and Nube MicroEdge sensors.  The sensor type can be selected from settings.';\n\n    this.settings['sensorType'] = {\n      description: 'LORA Sensor Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: SensorType.Droplet, text: SensorType.Droplet },\n          { value: SensorType.MicroEdge, text: SensorType.MicroEdge },\n        ],\n      },\n      value: 'Droplet',\n    };\n    this.addInput('rawInput', Type.STRING);\n    this.addInputWithSettings('nodeID', Type.STRING, '', 'NodeID');\n    this.addInputWithSettings('topic', Type.STRING, '', 'Set topic for use elsewhere in wires');\n    this.addOutput('json', Type.STRING);\n    this.addOutput('id', Type.STRING);\n    this.addOutput('voltage', Type.NUMBER);\n    this.addOutput('rssi', Type.NUMBER);\n    this.addOutput('lowBatteryAlm', Type.BOOLEAN);\n    this.addOutput('watchdog', Type.BOOLEAN);\n    this.addOutput('temperature', Type.NUMBER);\n    this.addOutput('humidity', Type.NUMBER);\n    this.addOutput('lux', Type.NUMBER);\n    this.addOutput('pressure', Type.NUMBER);\n    this.addOutput('movement', Type.BOOLEAN);\n    this.settings['microEdgeA1'] = {\n      description: 'MicroEdge a1 Input Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: '10k', text: '10k Thermistor' },\n          { value: '10vdc', text: '0-10vdc' },\n          { value: 'digital', text: 'Digital' },\n        ],\n      },\n      value: '10vdc',\n    };\n    this.settings['microEdgeA2'] = {\n      description: 'MicroEdge a2 Input Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: '10k', text: '10k Thermistor' },\n          { value: '10vdc', text: '0-10vdc' },\n          { value: 'digital', text: 'Digital' },\n        ],\n      },\n      value: '10vdc',\n    };\n    this.settings['microEdgeA3'] = {\n      description: 'MicroEdge a3 Input Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: '10k', text: '10k Thermistor' },\n          { value: '10vdc', text: '0-10vdc' },\n          { value: 'digital', text: 'Digital' },\n        ],\n      },\n      value: '10vdc',\n    };\n    this.settings['battery-warn'] = {\n      description: 'Low battery warning voltage',\n      value: 3.5,\n      type: SettingType.NUMBER,\n    };\n    this.settings['watchdog'] = {\n      description: 'Watchdog (No message warning) Delay',\n      value: 60,\n      type: SettingType.NUMBER,\n    };\n    this.settings['time'] = {\n      description: 'Time',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'minutes',\n    };\n    this.setSettingsConfig({\n      groups: [{ time: {}, watchdog: { weight: 2 } }],\n      conditions: {\n        microEdgeA1: setting => {\n          return setting['sensorType'].value === SensorType.MicroEdge;\n        },\n        microEdgeA2: setting => {\n          return setting['sensorType'].value === SensorType.MicroEdge;\n        },\n        microEdgeA3: setting => {\n          return setting['sensorType'].value === SensorType.MicroEdge;\n        },\n      },\n    });\n  }\n\n  onAdded() {\n    this.sensorType = this.settings['sensorType'].value;\n    if (this.sensorType === SensorType.MicroEdge) {\n      /**\n       * Issue: #552\n       * On frontend side:\n       * Removing this one here, because constructor() and onAdded() function gets called while doing each refresh\n       * And always 'movement' slot (slot number: 10) gets displayed even when it shouldn't\n       * It's because when sensorType === 'MicroEdge', we are replacing slots 6-9 with new one and leaving 0-5 as is,\n       * But we are doing nothing for node 10, so on it displays on frontend side even it doesn't have real value on backend\n       */\n      this.removeOutput(10);\n    }\n    this.clearOutputs();\n    this.updateTitle();\n  }\n\n  onInputUpdated() {\n    const sensorType = this.settings['sensorType'].value;\n    let nodeID = this.getInputData(1).toUpperCase() || '';\n    if (nodeID != this.nodeID) {\n      this.nodeID = nodeID;\n      this.updateTitle(); // Update title is also related with nodeID update so\n      this.broadcastTitleToClients();\n      this.clearOutputs();\n      this.resetWatchdog();\n    }\n    let data: string = this.getInputData(0) || '';\n    if (!data) return;\n    else if (data.length % 2 === 1 && (data[data.length - 1] === '\\r' || data[data.length - 1] === '\\n')) {\n      data = data.substring(0, data.length - 1);\n    } else if (data.substring(data.length - 2, data.length) === '\\r\\n') {\n      data = data.substring(0, data.length - 2);\n    }\n\n    if (\n      data.length !== 36 &&\n      data.length !== 44 &&\n      data.substring(2, 4) !== 'AA' &&\n      data.substring(2, 4) !== 'B0' &&\n      data.substring(2, 4) !== 'B1' &&\n      data.substring(2, 4) !== 'B2'\n    ) {\n      return;\n    }\n\n    if (nodeID == data.substring(0, 8) || nodeID == '') {\n      if (\n        sensorType === SensorType.MicroEdge &&\n        data.substring(2, 4) === 'AA' &&\n        (data.length === 44 || data.length === 36)\n      ) {\n        if (this.inputs[0].updated) this.resetWatchdog();\n        this.writeOutputs(this.microEdgeDecode(data));\n      } else if (\n        sensorType === SensorType.Droplet &&\n        data.substring(2, 3) === 'B' &&\n        (data.length === 44 || data.length === 36)\n      ) {\n        if (this.inputs[0].updated) this.resetWatchdog();\n        this.writeOutputs(this.dropletDecode(data));\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    let watchdogTime = this.settings['watchdog'].value;\n    watchdogTime = TimeUtils.timeConvert(watchdogTime, this.settings['time'].value);\n    if (this.watchdogDelay != watchdogTime) {\n      this.resetWatchdog();\n    }\n    this.setOutputs();\n    this.updateNodeOutput();\n    this.onInputUpdated();\n  }\n\n  private writeOutputs(output: LoraSensor) {\n    switch (this.settings['sensorType'].value) {\n      case SensorType.Droplet:\n        this.setOutputData(0, JSON.stringify(output));\n        this.setOutputData(1, output['id'] == null ? null : output['id']);\n        this.setOutputData(2, output['voltage'] == null ? null : output['voltage']);\n        this.setOutputData(3, output['rssi'] == null ? null : output['rssi']);\n        this.setOutputData(4, output['voltage'] < this.settings['battery-warn'].value);\n        this.setOutputData(6, output['temp'] == null ? null : output['temp']);\n        this.setOutputData(7, output['humidity'] == null ? null : output['humidity']);\n        this.setOutputData(8, output['lux'] == null ? null : output['lux']);\n        this.setOutputData(9, output['pressure'] == null ? null : output['pressure']);\n        this.setOutputData(10, output['movement'] == null ? null : output['movement']);\n        break;\n\n      case SensorType.MicroEdge:\n        this.setOutputData(0, JSON.stringify(output));\n        this.setOutputData(1, output['id'] == null ? null : output['id']);\n        this.setOutputData(2, output['voltage'] == null ? null : output['voltage']);\n        this.setOutputData(3, output['rssi'] == null ? null : output['rssi']);\n        this.setOutputData(4, output['voltage'] < this.settings['battery-warn'].value);\n        this.setOutputData(6, output['pulses'] == null ? null : output['pulses']);\n        const microEdgeOutputs = this.MicroEdgeAnalogs([output['a1'], output['a2'], output['a3']]);\n        this.setOutputData(7, microEdgeOutputs[0] == null ? null : microEdgeOutputs[0]);\n        this.setOutputData(8, microEdgeOutputs[1] == null ? null : microEdgeOutputs[1]);\n        this.setOutputData(9, microEdgeOutputs[2] == null ? null : microEdgeOutputs[2]);\n        break;\n    }\n  }\n\n  private MicroEdgeAnalogs(analogInputs) {\n    let output = [];\n    for (var i = 0; i < 3; i++) {\n      if (typeof analogInputs[i] == 'number') {\n        switch (this.settings[`microEdgeA${i + 1}`].value) {\n          case '10k':\n            const Vref = 3.34;\n            const V = (analogInputs[i] / 1024) * Vref;\n            const R0 = 10000;\n            const R = (R0 * V) / (Vref - V);\n            const T0 = 273 + 25;\n            const B = 3850;\n            const T = 1 / (1 / T0 + (1 / B) * Math.log(R / R0));\n            const temp = T - 273.15;\n            output.push(Math.round(temp * 100) / 100);\n            break;\n\n          case '10vdc':\n            output.push((analogInputs[i] / 1024) * 10);\n            break;\n\n          case 'digital':\n            if (analogInputs[i] === undefined || analogInputs[i] >= 1000) {\n              output.push(false);\n            } else {\n              output.push(true);\n            }\n            break;\n        }\n      } else output.push(null);\n    }\n    return output;\n  }\n\n  lastMessageTimeStamp(){\n    return  new Date()\n  }\n\n  microEdgeDecode(data: string): AASensor {\n    const topic = this.getInputData(2)\n    const topicsBuilder = {\n      id : topic+\"/id\",\n      pulses: topic+\"/pulses\",\n      voltage: topic+\"/voltage\",\n      a1: topic+\"/a1\",\n      a2: topic+\"/a2\",\n      a3: topic+\"/a3\",\n      rssi: topic+\"/rssi\",\n      snr: topic+\"/snr\"\n    }\n    let lastMessage = null;\n    lastMessage = this.lastMessageTimeStamp()\n    return {\n      id: data.substring(0, 8),\n      pulses: parseInt(data.substring(8, 16), 16),\n      voltage: parseInt(data.substring(16, 18), 16) / 50,\n      a1: parseInt(data.substring(18, 22), 16),\n      a2: parseInt(data.substring(22, 26), 16),\n      a3: parseInt(data.substring(26, 30), 16),\n      rssi: parseInt(data.substring(data.length - 4, data.length - 2), 16) * -1,\n      snr: parseInt(data.substring(data.length - 2, data.length), 16) / 10,\n      nodeName: this.name,\n      topic: topicsBuilder,\n      lastMessage: lastMessage\n    };\n  }\n\n  dropletDecode(data: string): B0Sensor {\n    const topic = this.getInputData(2)\n    const topicsBuilder = {\n      id : topic+\"/id\",\n      temp: topic+\"/temp\",\n      pressure: topic+\"/pressure\",\n      humidity: topic+\"/humidity\",\n      lux: topic+\"/lux\",\n      movement: topic+\"/movement\",\n      voltage: topic+\"/voltage\",\n      rssi: topic+\"/rssi\",\n      snr: topic+\"/snr\"\n    }\n    let lastMessage = null;\n    lastMessage = this.lastMessageTimeStamp()\n\n    let output: B0Sensor = {\n      id: data.substring(0, 8),\n      temp: parseInt(data.substring(10, 12) + data.substring(8, 10), 16) / 100,\n      pressure: parseInt(data.substring(14, 16) + data.substring(12, 14), 16) / 10,\n      humidity: parseInt(data.substring(16, 18), 16) % 128,\n      voltage: parseInt(data.substring(22, 24), 16) / 50,\n      rssi: parseInt(data.substring(data.length - 4, data.length - 2), 16) * -1,\n      snr: parseInt(data.substring(data.length - 2, data.length), 16) / 10,\n      nodeName: this.name,\n      topic: topicsBuilder,\n      lastMessage: lastMessage\n    };\n    if (data.substring(2, 4) === 'B1' || data.substring(2, 4) === 'B2') {\n      const b1Sensor: B1Sensor = output as B1Sensor;\n      b1Sensor.lux = parseInt(data.substring(20, 22) + data.substring(18, 20), 16);\n      output = b1Sensor;\n      if (data.substring(2, 4) == 'B2') {\n        const b2_sensor: B2Sensor = b1Sensor as B2Sensor;\n        b2_sensor.movement = parseInt(data.substring(16, 18), 16) > 127;\n        output = b2_sensor;\n      }\n    }\n    return output;\n  }\n\n  resetWatchdog() {\n    this.setOutputData(5, false, true);\n    clearInterval(this.timeoutFunc);\n    let watchdogTime = this.settings['watchdog'].value;\n    watchdogTime = TimeUtils.timeConvert(watchdogTime, this.settings['time'].value);\n    this.watchdogDelay = watchdogTime;\n    this.timeoutFunc = setTimeout(() => {\n      this.setOutputData(5, true, true);\n    }, watchdogTime);\n  }\n\n  setOutputs() {\n    const currentSensorType = this.settings['sensorType'].value;\n    if (this.sensorType != currentSensorType) {\n      switch (currentSensorType) {\n        case SensorType.Droplet:\n          this.removeOutput(6);\n          this.removeOutput(7);\n          this.removeOutput(8);\n          this.removeOutput(9);\n          if (this.outputs[10]) this.removeOutput(10);\n          this.addOutput('temperature', Type.NUMBER);\n          this.addOutput('humidity', Type.NUMBER);\n          this.addOutput('lux', Type.NUMBER);\n          this.addOutput('pressure', Type.NUMBER);\n          this.addOutput('movement', Type.BOOLEAN);\n          this.clearOutputs();\n          break;\n\n        case SensorType.MicroEdge:\n          this.removeOutput(6);\n          this.removeOutput(7);\n          this.removeOutput(8);\n          this.removeOutput(9);\n          this.removeOutput(10);\n          if (this.outputs[11]) this.removeOutput(11);\n          this.addOutput('pulses', Type.NUMBER);\n          this.addOutput('a1', Type.NUMBER);\n          this.addOutput('a2', Type.NUMBER);\n          this.addOutput('a3', Type.NUMBER);\n          this.clearOutputs();\n          break;\n      }\n    }\n    if (currentSensorType == SensorType.MicroEdge) {\n      this.outputs[7].name = `a1 (${this.settings['microEdgeA1'].value})`;\n      this.outputs[8].name = `a2 (${this.settings['microEdgeA2'].value})`;\n      this.outputs[9].name = `a3 (${this.settings['microEdgeA3'].value})`;\n    }\n    this.sensorType = currentSensorType;\n    this.updateTitle();\n  }\n\n  updateTitle() {\n    if (this.nodeID) this.title = `Lora Sensor Decoder (${this.sensorType} | ${this.nodeID})`;\n    else this.title = `Lora Sensor Decoder (${this.sensorType} | ALL)`;\n  }\n\n  clearOutputs() {\n    this.setOutputData(0, null);\n    this.setOutputData(1, null);\n    this.setOutputData(2, null);\n    this.setOutputData(3, null);\n    this.setOutputData(4, null);\n    this.setOutputData(5, null);\n    this.setOutputData(6, null);\n    this.setOutputData(7, null);\n    this.setOutputData(8, null);\n    this.setOutputData(9, null);\n    if (this.settings['sensorType'].value === SensorType.Droplet) this.setOutputData(10, null);\n  }\n}\nContainer.registerNodeType('protocols/lora-raw/lora-sensor-decoder', LoraSensorDecoderNode);\n","import { Node, SettingType} from '../../../node';\nimport { Container } from '../../../container';\nimport { Type } from '../../../node-io';\nimport { LORA_DATA_TYPE_NAMES, LORA_DATA_TYPE_LENGTHS } from './lora-two-way-in';\n\nexport class LoRaRawTwoWayOutput extends Node {\n  payloadDefinition: Array<LORA_DATA_TYPE_NAMES> = [];\n  inputsUpdated: Array<boolean> = [];\n\n  constructor() {\n    super();\n    this.title = `Nube LoRaRAW Two Way Out`;\n    this.description = 'This node compiles points to Nubes LoRa Two Way protocol';\n    this.settings['enable'] = {\n      description: 'enable',\n      type: SettingType.BOOLEAN,\n      value: false,\n    };\n    this.settings['senderId'] = {\n      description: 'sender Id',\n      type: SettingType.NUMBER,\n      value: 0,\n    };\n    this.settings['port'] = {\n      description: 'port number',\n      type: SettingType.NUMBER,\n      value: 0,\n    };\n    // this.settings['sendUpdatedOnly'] = {\n    //   description: 'send only updated inputs',\n    //   type: SettingType.BOOLEAN,\n    //   value: true,\n    // },\n    this.settings['types'] = {\n      description: 'Types',\n      type: SettingType.READONLY,\n      value: 'INT8, INT16, INT32, FLOAT',\n      // value: 'INT8, UINT8, INT16, UINT16, INT32, UINT32, FLOAT',\n    };\n    this.settings['definition'] = {\n      description: 'payload definition (JSON)',\n      type: SettingType.STRING,\n      value: '',\n    };\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('error', Type.STRING);\n    this.addOutput('output', Type.ANY);\n  }\n\n  init() {\n    this.updateOutputs();\n  }\n\n  onAdded() {\n    this.payloadDefinition = this.stringToDataTypes(this.settings['definition'].value);\n    this.inputsUpdated = new Array<boolean>(this.payloadDefinition.length);\n    this.inputsUpdated.fill(false);\n  }\n\n  onInputUpdated() {\n    for (let i = 1; i < this.getInputsCount(); i++) {\n      if (this.inputs[i].updated) {\n        this.inputsUpdated[i - 1] = true;\n      }\n    }\n    if (this.settings['enable'].value === false) return;\n    if (!this.inputs[0].updated || this.getInputData(0) === false) {\n      return;\n    }\n\n    // PARSING\n    const parseError = msg => {\n      this.setOutputData(1, 'parse error: ' + msg);\n    };\n\n    const checkInputAndType = (value, type) => {\n      let isOk = true;\n      switch (type) {\n        case LORA_DATA_TYPE_NAMES.INT8:\n          isOk = value >= -128 && value <= 127;\n          break;\n\n        case LORA_DATA_TYPE_NAMES.UINT8:\n          isOk = value >= 0 && value <= 0xff;\n          break;\n\n        case LORA_DATA_TYPE_NAMES.INT16:\n          isOk = value >= -32768 && value <= 32767;\n          break;\n\n        case LORA_DATA_TYPE_NAMES.UINT16:\n          isOk = value >= 0 && value <= 0xffff;\n          break;\n\n        case LORA_DATA_TYPE_NAMES.INT32:\n          isOk = value >= -2147483648 && value <= 2147483647;\n          break;\n\n        case LORA_DATA_TYPE_NAMES.UINT32:\n          isOk = value >= 0 && value <= 0xffffffff;\n          break;\n      }\n      return isOk;\n    };\n\n    // if (!this.settings['sendUpdatedOnly'].value) {\n    //   this.inputsUpdated.fill(true);\n    // }\n    this.inputsUpdated.fill(true);\n    let data_lengths = 0;\n    for (let i = 0; i < this.payloadDefinition.length; i++) {\n      if (this.inputsUpdated[i]) {\n        data_lengths += LORA_DATA_TYPE_LENGTHS[this.payloadDefinition[i]] + 1;\n      }\n    }\n    if (data_lengths === 0) {\n      parseError('No input updates');\n      return;\n    }\n    let buffer = Buffer.alloc(data_lengths + 2);\n\n    buffer.writeUInt8(this.settings['senderId'].value, 0);\n    buffer.writeUInt8(this.settings['port'].value, 1);\n\n    let point = 0;\n    for (let i = 2; i < buffer.length; ) {\n      if (!this.inputsUpdated[point]) {\n        point++;\n        continue;\n      }\n      let type = this.payloadDefinition[point];\n      let value = this.getInputData(point + 1);\n\n      if (!checkInputAndType(value, type)) {\n        parseError('invalid value input ' + point);\n        return;\n      }\n\n      buffer.writeUInt8(point, i++);\n\n      switch (type) {\n        case LORA_DATA_TYPE_NAMES.INT8:\n          buffer.writeInt8(value, i);\n          break;\n\n        case LORA_DATA_TYPE_NAMES.UINT8:\n          buffer.writeUInt8(value, i);\n          break;\n\n        case LORA_DATA_TYPE_NAMES.INT16:\n          buffer.writeInt16LE(value, i);\n          break;\n\n        case LORA_DATA_TYPE_NAMES.UINT16:\n          buffer.writeUInt16LE(value, i);\n          break;\n\n        case LORA_DATA_TYPE_NAMES.INT32:\n          buffer.writeInt32LE(value, i);\n          break;\n\n        case LORA_DATA_TYPE_NAMES.UINT32:\n          buffer.writeUInt32LE(value, i);\n          break;\n\n        case LORA_DATA_TYPE_NAMES.FLOAT:\n          buffer.writeFloatLE(value, i);\n          break;\n      }\n\n      i += LORA_DATA_TYPE_LENGTHS[type];\n      point++;\n    }\n\n    this.setOutputData(1, null);\n    this.setOutputData(0, buffer);\n\n    this.inputsUpdated.fill(false);\n  }\n\n  onAfterSettingsChange() {\n    this.payloadDefinition = this.updateOutputs();\n    this.setOutputData(1, null);\n    this.onInputUpdated();\n  }\n\n  private updateOutputs() {\n    const data = this.stringToDataTypes(this.settings['definition'].value);\n    if (this.payloadDefinition.length !== data.length) {\n      const inputsCount = this.getInputsCount();\n      for (let i = 1; i < inputsCount; i++) {\n        this.removeInput(i);\n      }\n\n      this.inputsUpdated = new Array<boolean>(data.length);\n      for (let i = 0; i < data.length; i++) {\n        this.addInput(i.toString(), Type.NUMBER);\n        this.inputsUpdated[i] = false;\n      }\n    }\n    return data;\n  }\n\n  stringToDataTypes(str) {\n    const data = str\n      .toUpperCase()\n      .replace(/ /g, '')\n      .split(',')\n      .filter(x => x !== '');\n\n    if (data && data.length) {\n      for (let i = 0; i < data.length; i++) {\n        if (LORA_DATA_TYPE_NAMES[data[i]] === undefined) {\n          this.setOutputData(1, 'settings parse error');\n          return undefined;\n        }\n        data[i] = LORA_DATA_TYPE_NAMES[data[i]];\n      }\n    }\n    return data;\n  }\n}\nContainer.registerNodeType('protocols/lora-raw/lora-raw-two-way-out', LoRaRawTwoWayOutput);\n","import { Node} from '../../../node';\nimport { Container } from '../../../container';\nimport { Type } from '../../../node-io';\n\nexport class LoRaRawTwoWayTest extends Node {\n  constructor() {\n    super();\n    this.title = `Nube LoRaRAW Two Way Test Node`;\n    this.description = 'Acts as the transport layer for testing only';\n\n    this.addInput('input', Type.ANY);\n    this.addOutput('output', Type.STRING);\n  }\n\n  onInputUpdated() {\n    let buffer = this.getInputData(0);\n\n    if (!buffer) {\n      return;\n    }\n\n    let str = 'FFFFFFFF';\n    let len = buffer.length.toString(16).toUpperCase();\n    len = len.length == 1 ? '0' + len : len;\n    str += len;\n    str += buffer.toString('hex').toUpperCase();\n    console.log('LoRa Two Way output buffer and input hex string:');\n    console.log(buffer);\n    console.log(str);\n    this.setOutputData(0, str);\n  }\n}\nContainer.registerNodeType('protocols/lora-raw/lora-raw-two-way-test', LoRaRawTwoWayTest);\n","import { Node, SettingType} from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { Type } from '../../../node-io';\n\nlet ModbusRTU = require('modbus-serial');\n\n// guide and code for converting modbus data types\n//https://github.com/ioBroker/ioBroker.modbus\n\nclass ModbusServerNode extends Node {\n  tcpServer = null;\n\n  constructor() {\n    super();\n    this.title = 'Modbus Server';\n    this.description =\n      `## Description\\n ` +\n      ` This node is used to create a modbus server.\\n ` +\n      ` Once the Port and Modbus Address settings are configured, when enabled, this node will create a Local Modbus TCP/IP Server.  The points on this created Modbus Server can be written to and read from with other Modbus Nodes, or from another device.\\n ` +\n      `   \\n ` +\n      `## Point Address\\n ` +\n      `   \\n ` +\n      `### Coils\\n ` +\n      `   \\n ` +\n      ` Valid Coil range is between 0 and 10001. This will allow any modbus client to read and write to those coli ranges\\n ` +\n      `   \\n ` +\n      `### Holding Register\\n ` +\n      `   \\n ` +\n      ` Valid Holding Register range is between 10001 and 19999. This will allow any modbus client to read and write to those coli ranges\\n ` +\n      `   \\n ` +\n      `### Enable\\n ` +\n      `   \\n ` +\n      ` This will enable/disable the modbus server \\n ` +\n      `   \\n ` +\n      `### Port\\n ` +\n      `   \\n ` +\n      ` This is the setting that the modbus server will listen on \\n ` +\n      `   \\n ` +\n      `### Modbus address\\n ` +\n      `   \\n ` +\n      ` This will set the modbus server modbus address (valid range between 0 and 255) \\n ` +\n      `   \\n `;\n    this.addInput('connect', Type.BOOLEAN);\n    this.addOutput('status', Type.BOOLEAN);\n    this.addOutput('error', Type.STRING);\n    this.addOutput('message', Type.STRING);\n    this.settings['serverEnable'] = {\n      description: 'Server enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['port'] = { description: 'port', value: 8502, type: SettingType.NUMBER };\n    this.settings['address'] = {\n      description: 'Modbus address',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n  }\n\n  onAdded() {\n    this.createModbusServer();\n  }\n\n  onInputUpdated() {\n    this.createModbusServer();\n  }\n\n  onAfterSettingsChange() {\n    this.createModbusServer();\n  }\n\n  onRemoved() {\n    this.closeTcpServer();\n  }\n\n  private createModbusServer() {\n    if (this.side !== Side.server) return; // only execute on server\n    this.closeTcpServer();\n    this.emitResult(false, false, 'close connection');\n\n    if (this.settings['serverEnable'].value) {\n      // set the server to answer for modbus requests\n      const coils = Buffer.alloc(160008, 0); // coils and discrete inputs\n      const registers = Buffer.alloc(160008, 0); // input and holding registers\n\n      let unitId = this.settings['address'].value;\n      unitId = parseInt(unitId);\n      const minAddress = 0;\n      const maxInputAddress = 10001;\n      const maxAddress = 20001;\n      const bufferFactor = 8;\n\n      // 1...10000*      address - 1      Coils (outputs)    0   Read/Write\n      // 10001...20000*  address - 10001  Discrete Inputs    01  Read\n      // 30001...40000*  address - 30001  Input Registers    04  Read\n      // 40001...50000*  address - 40001  Holding Registers  03  Read/Write\n\n      const vector = {\n        getCoil: function(addr, unitID) {\n          if (unitID === unitId && addr >= minAddress && addr < maxAddress) {\n            // console.log('get coils', coils.readUInt8(addr * bufferFactor));\n            return coils.readUInt8(addr * bufferFactor);\n          }\n        },\n        getInputRegister: function(addr, unitID) {\n          if (unitID === unitId && addr >= minAddress && addr < maxInputAddress) {\n            // 0 to 10001\n            // console.log('get getInputRegister', registers.readUInt16BE(addr * bufferFactor));\n            return registers.readUInt16BE(addr * bufferFactor);\n          }\n        },\n        getHoldingRegister: function(addr, unitID) {\n          if (unitID === unitId && addr >= maxInputAddress && addr < maxAddress) {\n            // 10001 to 20001\n            // console.log('get getHoldingRegister', registers.readUInt16BE(addr * bufferFactor));\n            return registers.readUInt16BE(addr * bufferFactor);\n          }\n        },\n        setCoil: function(addr, value, unitID) {\n          if (unitID === unitId && addr >= minAddress && addr < maxAddress) {\n            // console.log('set coil', addr, value, unitID);\n            coils.writeUInt8(value, addr * bufferFactor);\n          }\n        },\n        setRegister: function(addr, value, unitID) {\n          if (unitID === unitId && addr >= minAddress && addr < maxAddress) {\n            // console.log(' setRegister', addr, value, unitID);\n            registers.writeUInt16BE(value, addr * bufferFactor);\n          }\n        },\n        readDeviceIdentification: function(unitID) {\n          return new Promise(function(resolve) {\n            setTimeout(function() {\n              resolve({\n                0x00: 'Nube-IO',\n                0x01: 'wires-server',\n                0x02: '1',\n                0x05: 'wires-server',\n              });\n            }, 10);\n          });\n        },\n      };\n\n      //make a server to test the port\n      var net = require('net');\n      var server = net.createServer();\n      let port = this.settings['port'].value;\n      let salveAddress = this.settings['address'].value;\n      //make sure port size is >= 4\n      if (port.toString().length >= 3) {\n        server.once('error', err => {\n          if (err.code === 'EADDRINUSE') {\n            this.emitResult(false, false, 'port in use');\n            server.close();\n          }\n        });\n        //check if port is in use\n        server.once('listening', () => {\n          //make a modbus server\n          this.tcpServer = new ModbusRTU.ServerTCP(vector, {\n            host: '0.0.0.0',\n            port: port,\n            debug: true,\n            unitID: parseInt(salveAddress),\n          });\n\n          this.tcpServer.on('socketError', err => {\n            this.emitResult(false, err, 'server error');\n          });\n\n          this.tcpServer.on('initialized', () => {\n            this.emitResult(true, false, 'initialized');\n          });\n          //close test port\n          server.close();\n        });\n        //check port\n        server.listen(port);\n      } else if (port.toString().length < 3) {\n        this.emitResult(null, false, 'use a port >= 3');\n      }\n    }\n  }\n\n  private closeTcpServer() {\n    this.tcpServer &&\n      this.tcpServer.close(() => {\n        this.emitResult(false, false, 'closed');\n      });\n  }\n\n  emitResult(out, err, msg) {\n    this.setOutputData(0, out);\n    this.setOutputData(1, err);\n    this.setOutputData(2, msg);\n  }\n}\nContainer.registerNodeType('protocols/modbus/modbus-server', ModbusServerNode);\n","import { ContainerNode } from '../../../container-node';\nimport { Container, Side } from '../../../container';\nimport { SettingType } from '../../../node';\nimport { MODBUS_RTU_DEVICE, MODBUS_RTU_NETWORK } from '../../../constants';\nimport { Type } from '../../../node-io';\nconst net = require('net');\nclass ModbusSerialDeviceNode extends ContainerNode {\n  tcpServer = null;\n  db = null;\n  uuid: Number = null;\n\n  // node outputs\n  outStatus = 0;\n  outError = 1;\n  outMessageJson = 2;\n\n  constructor(container) {\n    super(container);\n    this.title = 'Modbus Device';\n    this.description =\n      `## Description\\n ` +\n      ` This node is used as a modbus TCP or RTU(rs485) modbus device.\\n ` +\n      ` The node is to be added inside a modbus network node (The network details will be added in the network node)\\n ` +\n      ` The points for the device will be added inside this node \\n ` +\n      `   \\n ` +\n      `### Enable\\n ` +\n      `   \\n ` +\n      ` This will enable/disable the device from polling \\n ` +\n      `   \\n ` +\n      `### Modbus Address\\n ` +\n      `   \\n ` +\n      ` If device is RTU type set the slave modbus address\\n ` +\n      `   \\n ` +\n      `### Device Timeout\\n ` +\n      `   \\n ` +\n      ` This setting is used for the polling. This is the amount of time the polling will wait before moving onto the next register or device to poll\\n ` +\n      `   \\n ` +\n      `### Network Type\\n ` +\n      `   \\n ` +\n      `If type is TCP set select type TCP and set the target device IP and port \\n ` +\n      `If type is RTU set the device address as per setting **Modbus Address** \\n ` +\n      `   \\n ` +\n      `### Point address starting offset\\n ` +\n      `   \\n ` +\n      `Modbus point address offset(Base 1 subtracts 1 to the address) \\n ` +\n      `If set to Base 1 this will make for example point address 1 (from the manufacture data sheet) equal to 0\\n ` +\n      `The default setting is Base 1\\n ` +\n      `   \\n ` +\n      `## Node outputs\\n ` +\n      `   \\n ` +\n      ` If device is TCP when the node is added or after the setting a change a device ping will be sent to see if the device is online\\n ` +\n      ` If device is online **status** will be sent to true and the **error** will be sent to false. If the device if offline the **status** will be sent to false and the **error** true \\n ` +\n      `   \\n `;\n    this.addOutput('status', Type.BOOLEAN);\n    this.addOutput('error', Type.STRING);\n    this.addOutput('message', Type.JSON);\n    this.settings['deviceEnable'] = {\n      description: 'Device enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['address'] = {\n      description: 'Modbus address',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n    this.settings['deviceTimeout'] = {\n      description: 'Device Timeout Delay Setting (MS)', //TODO ADD CAP/LIMIT\n      value: 2000,\n      type: SettingType.NUMBER,\n    };\n    this.settings['transport'] = {\n      description: 'TCP or RTU/RS485',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'rtu', text: 'Modbus RTU over Serial 485' },\n          { value: 'tcp', text: 'Modbus TCP/IP' },\n        ],\n      },\n      value: 'rtu',\n    };\n    this.settings['ipAddress'] = {\n      description: 'Network IP Address',\n      value: '0.0.0.0',\n      type: SettingType.STRING,\n    };\n    this.settings['ipPort'] = {\n      description: 'Network Port Number',\n      value: 502,\n      type: SettingType.NUMBER,\n    };\n    this.settings['deviceAddressOffset'] = {\n      description: 'Point address starting offset',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 1, text: 'Base 1' },\n          { value: 0, text: 'Base 0' },\n        ],\n      },\n      value: 1,\n    };\n    this.setSettingsConfig({\n      conditions: {\n        ipAddress: setting => {\n          return setting['transport'].value === 'tcp';\n        },\n        ipPort: setting => {\n          return setting['transport'].value === 'tcp';\n        },\n      },\n    });\n  }\n\n  onRemoved() {\n    if (this.side !== Side.server) return; // only execute on server\n    // delete all nodes under this sub_container\n    for (let id in this.sub_container._nodes) {\n      let node = this.sub_container._nodes[id];\n      node.container.remove(node);\n    }\n    delete Container.containers[this.sub_container.id];\n  }\n\n  // onCreated() {\n  //   // this.updateTitle()\n  // }\n\n  onAdded() {\n    super.onAdded();\n    this.broadcastNameToClients();\n    this.updateTitle()\n    if (this.side !== Side.server) return;\n    this.uuid = this.id;\n    if (this.settings['transport'].value === 'tcp') {\n      this.ping();\n    }\n\n  }\n\n\n  updateTitle() {\n    const address = this.settings['address'].value;\n    const transport = this.settings['transport'].value;\n    const ipAddress = this.settings['ipAddress'].value;\n    const ipPort = this.settings['ipPort'].value;\n    if (transport === 'tcp') {\n      this.title = `Modbus Device (Type: ${this.settings['transport'].value}, AD: ${address} , IP: ${ipAddress}:${ipPort})`;\n      this.broadcastSettingsToClients();\n    } else {\n      this.title = `Modbus Device (Type: ${this.settings['transport'].value}, AD: ${address})`;\n      this.broadcastSettingsToClients();\n    }\n \n  }\n\n  ping() {\n    const host = [this.settings['ipAddress'].value, this.settings['ipPort'].value];\n    var sock = new net.Socket();\n    sock.setTimeout(5000);\n    sock\n      .on('connect', () => {\n        this.setOutputData(this.outStatus, true, true);\n        this.setOutputData(this.outError, false, true);\n        this.setOutputData(this.outMessageJson, host[0] + ':' + host[1] + ' is up.', true);\n        sock.destroy();\n      })\n      .on('error', e => {\n        this.setOutputData(this.outError, true, true);\n        this.setOutputData(this.outStatus, false, true);\n        this.setOutputData(this.outMessageJson, host[0] + ':' + host[1] + ' is down: ' + e.message, true);\n      })\n      .on('timeout', e => {\n        this.setOutputData(this.outError, true, true);\n        this.setOutputData(this.outStatus, false, true);\n        this.setOutputData(this.outMessageJson, host[0] + ':' + host[1] + ' is down: timeout', true);\n      })\n      .connect(host[1], host[0]);\n  }\n\n\n\n  onAfterSettingsChange(oldSettings: any) {\n    this.updateTitle()\n    super.onAfterSettingsChange(oldSettings);\n    if (this.side !== Side.server) return;\n    if (this.settings['transport'].value === 'tcp') {\n      this.ping();\n    }\n\n  }\n\n  subscribeMessage(e) {\n    this.setOutputData(0, true, true);\n    this.setOutputData(1, false, true);\n    this.setOutputData(2, null, true);\n  }\n\n  subscribeError(e) {\n    if (e === null) return;\n    this.setOutputData(0, false, true);\n    this.setOutputData(1, true, true);\n    this.setOutputData(2, e, true);\n  }\n}\n\nContainer.registerNodeType(MODBUS_RTU_DEVICE, ModbusSerialDeviceNode, MODBUS_RTU_NETWORK);\n","import { SettingType, Node } from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { InputSetting, NodeInput, Type } from '../../../node-io';\nimport CheckTypes from '../../../utils/check-types';\nimport { MODBUS_RTU_DEVICE, MODBUS_RTU_POINT } from '../../../constants';\nimport BACnetEnumsUnits from '../../../utils/points/BACnet-enums-units';\nimport Utils from '../../../utils';\nimport MathUtils, { MATH_FUNC_TYPE } from '../../../utils/MathUtils';\nimport { isNull } from '../../../../utils/helper';\n\nexport class ModbusPointNode extends Node {\n\n\n  dynamicInputsExist: boolean = false;\n  dynamicSettingsExist: boolean = false;\n  dynamicInputStartPosition: number = 0;\n  inputCount: number;\n  dynamicMinInputs: number = 0;\n  nullableInputs: boolean = true;\n  dynamicOutputsExist: boolean = false;\n  dynamicInputsStartName: string = 'in';\n  dynamicOutputsStartName: string = 'out';\n  dynamicInputsType: Type = Type.NUMBER;\n  previousPointType;\n\n  lastInputState: any;\n\n  // node inputs\n  inAlarmTrigger = 0;\n  inHistoryTrigger = 1;\n  inInput = 2;\n\n  // node outputs\n  outVal = 0;\n  outError = 1;\n  outModbusMessage = 2;\n  outMessageJson = 3;\n  outAlarm = 3;\n  outArray = 4;\n  constructor() {\n    super();\n    this.title = 'Modbus Point';\n    this.description =\n      `## Description\\n ` +\n      ` This node is used as a modbus device point.\\n ` +\n      ` The points for the device will be added inside the device node (right click and **open** on the network node to add the device and points) \\n ` +\n      `   \\n ` +\n      `## Point Address\\n ` +\n      `   \\n ` +\n      `### Coils\\n ` +\n      `   \\n ` +\n      ` Valid Coil range is between 0 and 10001. This will allow any modbus client to read and write to those coli ranges\\n ` +\n      `   \\n ` +\n      `### Holding Register\\n ` +\n      `   \\n ` +\n      ` Valid Holding Register range is between 10001 and 19999. This will allow any modbus client to read and write to those coli ranges\\n ` +\n      `   \\n ` +\n      `## Enable\\n ` +\n      `   \\n ` +\n      ` This will enable/disable the point from polling \\n ` +\n      `   \\n `;\n\n    this.addInput('[name]', Type.STRING);\n    this.addOutput('output', Type.NUMBER);\n    this.addOutput('error', Type.STRING);\n    this.addOutput('output-msg', Type.STRING);\n    this.addOutput('output json', Type.STRING);\n    this.addOutput('output-modbus-array', Type.STRING);\n    this.properties['pointVal'] = null;\n    this.properties['address'] = 0;\n    /**\n      Default point Settings (Will be in point class)\n   */\n    this.settings['pointEnable'] = {\n      description: 'Point enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['value_group'] = {\n      description: 'Point settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.addInputWithSettings('input', Type.NUMBER, 0, 'point write value', false);\n    this.settings['valOffset'] = {\n      description: 'Out value offset',\n      value: 1000,\n      type: SettingType.NUMBER,\n    };\n    this.settings['valPrecision'] = {\n      description: 'Out value precision',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.settings['units_group'] = {\n      description: 'Units (Save to get units)',\n      type: SettingType.GROUP,\n    };\n    this.settings['unitsType'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: BACnetEnumsUnits.unitCategory,\n      },\n    };\n    this.settings['units'] = {\n      description: 'Units',\n      value: BACnetEnumsUnits.COMMON_METRIC.NO_UNITS,\n      type: SettingType.DROPDOWN,\n    };\n\n    /**\n      Point Math settings\n   */\n    this.settings['math_group'] = {\n      description: 'Math settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['mathFunc'] = {\n      description: 'Math on output value (optional)',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: MATH_FUNC_TYPE.NA, text: 'na' },\n          { value: MATH_FUNC_TYPE.ADD, text: 'add' },\n          { value: MATH_FUNC_TYPE.SUBTRACT, text: 'subtract' },\n          { value: MATH_FUNC_TYPE.MULTIPLY, text: 'multiply' },\n          { value: MATH_FUNC_TYPE.DIVIDE, text: 'divide' },\n          { value: MATH_FUNC_TYPE.BOOL_INVERT, text: 'bool invert' },\n          { value: MATH_FUNC_TYPE.ONE_TO_TRUE, text: 'convert 1/0 to true/false' },\n          { value: MATH_FUNC_TYPE.TRUE_TO_ONE, text: 'convert true/false to 1/0' },\n        ],\n      },\n      value: MATH_FUNC_TYPE.NA,\n    };\n    this.settings['mathValue'] = {\n      description: 'Enter a value',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n    /**\n     Modbus (Just for modbus)\n     */\n    this.settings['modbus_group'] = {\n      description: 'Modbus point settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['pointType'] = {\n      description: 'Select a point type',\n      value: 1,\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 1, text: `Read Coil's` },\n          // { value: 21, text: `Read DO` },\n          { value: 2, text: `readDiscreteInput's` },\n          // { value: 22, text: `Read DI` },\n          { value: 3, text: `readHoldingRegister's` },\n          // { value: 23, text: `Read AO` },\n          { value: 4, text: `readInputRegister's` },\n          // { value: 24, text: `Read AI` },\n          { value: 5, text: `writeCoil` },\n          // { value: 25, text: `Write DO` },\n          { value: 6, text: `writeRegister` },\n          // { value: 26, text: `Write AO` },\n          // { value: 15, text: `writeCoil's` },\n          { value: 16, text: `writeRegister's` },\n        ],\n      },\n    };\n    this.addInputWithSettings('address', Type.NUMBER, 1, 'Register address', false);\n    this.settings['pointTimeout'] = {\n      description: 'Point Timeout (MS)',\n      value: 1000,\n      type: SettingType.NUMBER,\n    };\n    this.settings['offset'] = {\n      description: 'Register offset',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n    this.settings['dataType'] = {\n      description: 'Set data type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'na' }, // use reg length from setting\n          { value: 1, text: 'INT-16' }, // 1 reg\n          { value: 2, text: `UINT-16` }, // 1 reg\n          { value: 3, text: 'INT-32' }, // 2 reg\n          { value: 4, text: 'UINT-32' }, // 2 reg\n          { value: 5, text: 'FLOAT-32' }, // 2 reg // for support of nube hardware BEB_LEW as a float\n          // { value: 6, text: 'INT64' },\n          // { value: 7, text: 'UINT64' },\n          { value: 8, text: 'DOUBLE-64' }, // 4 reg\n        ],\n      },\n      value: 0,\n    };\n    this.settings['dataEndian'] = {\n      description: 'Set byte order',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'LE-Byte BE-Word' },\n          { value: 1, text: 'LE-Byte LE-Word' },\n          { value: 2, text: 'BE-Byte LE-Word' },\n          { value: 3, text: 'BE-Byte BE-Word' },\n        ],\n      },\n      value: 0,\n    };\n    this.setSettingsConfig({\n      groups: [\n        { address: {}, offset: {}, pointTimeout: {} },\n        { dataType: {}, dataEndian: {} },\n        { pointLimitEnable: {}, limitLow: {}, limitHigh: {} },\n        { mathFunc: {}, mathValue: {} },\n        { valOffset: {}, valPrecision: {} },\n      ],\n      conditions: {\n        offset: setting => {\n          const val = setting['pointType'].value;\n          return ![5, 6].includes(val);\n        },\n        dataType: setting => {\n          const val = setting['pointType'].value;\n          return ![1, 2, 5, 15].includes(val);\n        },\n        dataEndian: setting => {\n          const val = setting['pointType'].value;\n          return ![1, 2, 5, 15].includes(val);\n        },\n      },\n    });\n  }\n\n  onCreated() {\n    this.updateTitle()\n  }\n\n  onAdded() {\n    if (this.side !== Side.server) return;\n    this.onInputUpdated();\n    this.updateTitle()\n  }\n\n  updateTitle() {\n    let address = this.getInputData(1);\n    this.title = `Modbus Point (FC: ${this.settings['pointType'].value}, AD: ${address})`;\n    this.broadcastSettingsToClients();\n  }\n\n\n  onInputUpdated() {\n    // priority array\n    let pointType = this.settings['pointType'].value;\n    if ([5, 6, 15, 16, 25, 26].includes(pointType)) {\n      const input = this.getInputData(1);\n      if (isNull(input)) return\n      this.setOutputData(this.outModbusMessage, `write val ${input}`);\n      // lastInputState is to stop a new value that is input into the node but the value hasn't updated\n      if (input !== this.lastInputState) {\n        this.properties['pointVal'] = input;\n        // Persist the pointVal. (This is for outputs nodes only like AO, or BO)\n        this.persistProperties(false, true);\n        this.lastInputState = input;\n      } else if (typeof this.lastInputState === 'undefined') {\n        this.lastInputState = input;\n      }\n    }\n\n    //update point address\n    if (this.inputs[2].updated) {\n      const address = this.getInputData(2);\n      if (!isNull(address)) {\n        this.properties['address'] = address;\n        this.persistProperties(false, true);\n      } else {\n        this.properties['address'] = 0\n        this.persistProperties(false, true);\n      }\n    }\n\n    //update node name\n    if (this.inputs[0].updated) {\n      let nodeName = this.getInputData(0)\n      if (!isNull(nodeName)) {\n        this.name = nodeName;\n        this.broadcastNameToClients()\n      };\n    }\n  }\n\n\n  onAfterSettingsChange() {\n    const address = this.getInputData(2);\n    if (!isNull(address)) {\n      this.properties['address'] = address;\n      this.persistProperties(false, true);\n    } else {\n      this.properties['address'] = 0\n      this.persistProperties(false, true);\n    }\n    this.onInputUpdated();\n    this.updateTitle()\n  }\n\n  sendJson(pointValue) {\n    return {\n      name: this.name,\n      pointValue: pointValue,\n      enable: this.settings['pointEnable'].value,\n      address: this.settings['address'].value,\n      offset: this.settings['offset'].value,\n      pointType: this.settings['pointType'].value\n    };\n  }\n  /**\n   * Gets a the modbus values from the network to update the point node values\n   */\n  subscribe(payload) {\n    let pointType = this.settings['pointType'].value;\n    this.setOutputData(this.outArray, payload.res.data);\n    this.setOutputData(this.outError, false, true);\n    if ([5, 6, 15, 16, 25, 26].includes(pointType)) {\n      if (payload.payload === 'writeOk') {\n\n        this.setOutputData(this.outVal, this.properties['pointVal']);\n        this.setOutputData(this.outMessageJson, this.sendJson(this.properties['pointVal']));\n      } else {\n        this.setOutputData(this.outModbusMessage, `write fail`, true);\n        this.setOutputData(this.outMessageJson, null);\n      }\n    } else {\n      const mathFunc = this.settings['mathFunc'].value;\n      const mathValue = this.settings['mathValue'].value;\n      let out: any;\n      if (mathFunc !== 0) {\n        if (MathUtils.validateNumbers(payload.payload, mathValue)) {\n          out = MathUtils.mathSwitch(mathFunc, payload.payload, mathValue);\n          this.setOutputData(this.outVal, out);\n          this.setOutputData(this.outMessageJson, this.sendJson(out));\n        }\n      } else {\n        if (typeof payload.payload === 'number') {\n          this.setOutputData(this.outVal, payload.payload);\n          this.setOutputData(this.outMessageJson, this.sendJson(payload.payload));\n        } else if (typeof payload.payload === 'boolean') {\n          this.setOutputData(this.outVal, payload.payload ? 1 : 0); // convert bool to int\n          this.setOutputData(this.outMessageJson, this.sendJson(payload.payload ? 1 : 0)); // convert bool to int\n        }\n      }\n    }\n  }\n  subscribeError(e: any) {\n    this.setOutputData(this.outError, true, true);\n    this.setOutputData(this.outModbusMessage, e, true);\n  }\n}\n\nContainer.registerNodeType(MODBUS_RTU_POINT, ModbusPointNode, MODBUS_RTU_DEVICE);\n","import { ContainerNode } from '../../../container-node';\nimport { Container, Side } from '../../../container';\nimport { SettingType} from '../../../node';\nimport { Type } from '../../../node-io';\nimport ModbusUtils from './modbus-functions';\nimport ModbusMethods from './modbus-fc/modbus-point-methods';\nimport { MODBUS_RTU_DEVICE, MODBUS_RTU_NETWORK, MODBUS_RTU_POINT } from '../../../constants';\nimport Utils from '../../../utils';\nimport Registry from '../../../registry';\nimport { ModbusRTU as RTUModbus } from 'modbus-serial/ModbusRTU';\nconst ModbusRTU = require('modbus-serial');\n\nenum Poll {\n  DO_NOT_INIT = 0,\n  FIRST_START = 1,\n  STOP = 2,\n}\n\nenum Transport {\n  TCP = 'tcp',\n  RTU = 'rtu',\n}\n\nclass ModbusSerialNetworkNode extends ContainerNode {\n  rs485DeviceName: string = 'ttyUSB1';\n  isPortOk: boolean = false;\n  isPortInUse: boolean = false;\n  serialPortStatus: boolean = false;\n  checkPort: any;\n\n  // settings\n  networkEnable: boolean;\n  port: string;\n  baudRate: string;\n  parity: number;\n  dataBits: number;\n  stopBits: number;\n  devicePolling: number;\n  registerDelay: number;\n  transport: string;\n\n  // pooling running\n  pollEnableSetting: boolean = false;\n  poll: Poll;\n\n  // modbus client\n  client = null;\n  tcpClients: { [key: string]: RTUModbus } = {};\n\n  // node outputs\n  outStatus = 0;\n  outError = 1;\n  outPortStatus = 2;\n  outPortMsg = 3;\n  outMessageJson = 4;\n\n  constructor(container) {\n    super(container);\n    this.title = 'Modbus 485 Network';\n    this.description =\n      `## Description\\n ` +\n      ` This node is used as a modbus TCP or RTU(rs485) modbus network.\\n ` +\n      ` The device and points for the device will be added inside this node (right click and **open** on the network node to add the device and points) \\n ` +\n      `   \\n ` +\n      `### Enable\\n ` +\n      `   \\n ` +\n      ` This will enable/disable the network from polling \\n ` +\n      `   \\n `;\n    this.addOutput('status', Type.BOOLEAN);\n    this.addOutput('error', Type.STRING);\n    this.addOutput('port status', Type.STRING);\n    this.addOutput('port messages', Type.STRING);\n    this.addOutput('message', Type.STRING);\n    this.settings['networkEnable'] = {\n      description: 'Network enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['devicePolling'] = {\n      description: 'Polling time setting in ms',\n      value: 2000, // TODO Add min limit\n      type: SettingType.NUMBER,\n    };\n    this.settings['registerDelay'] = {\n      description: 'Polling delay between each register in ms',\n      value: 30, // TODO Add min limit\n      type: SettingType.NUMBER,\n    };\n    this.settings['transport'] = {\n      description: 'TCP or RTU/RS485',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: Transport.RTU, text: 'Modbus RTU over Serial 485' },\n          { value: Transport.TCP, text: 'Modbus TCP/IP' },\n        ],\n      },\n      value: Transport.RTU,\n    };\n    this.setSettingsConfig({\n      groups: [\n        { port: {}, baudRate: {} },\n        { parity: {}, dataBits: {}, stopBits: {} },\n        { devicePolling: {}, registerDelay: {} },\n      ],\n      conditions: {\n        port: setting => {\n          return setting['transport'].value === Transport.RTU;\n        },\n        baudRate: setting => {\n          return setting['transport'].value === Transport.RTU;\n        },\n        parity: setting => {\n          return setting['transport'].value === Transport.RTU;\n        },\n        dataBits: setting => {\n          return setting['transport'].value === Transport.RTU;\n        },\n        stopBits: setting => {\n          return setting['transport'].value === Transport.RTU;\n        },\n      },\n    });\n    this.settings['port'] = {\n      description: 'port',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: '/dev/ttyUSB0', text: 'ttyUSB0' },\n          { value: '/dev/ttyUSB1', text: 'ttyUSB1' },\n          { value: '/dev/ttyUSB2', text: 'ttyUSB2' },\n          { value: '/dev/ttyUSB3', text: 'ttyUSB3' },\n          { value: '/dev/ttyUSB4', text: 'ttyUSB4' },\n        ],\n      },\n      value: '/dev/ttyUSB0',\n    };\n    this.settings['baudRate'] = {\n      description: 'Baud Rate',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 115200, text: '115200' },\n          { value: 57600, text: '57600' },\n          { value: 38400, text: '38400' },\n          { value: 19200, text: '19200' },\n          { value: 9600, text: '9600' },\n        ],\n      },\n      value: 9600,\n    };\n    this.settings['parity'] = {\n      description: 'Parity',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'none', text: 'none' },\n          { value: 'even', text: 'even' },\n          { value: 'mark', text: 'mark' },\n          { value: 'odd', text: 'odd' },\n          { value: 'space', text: 'space' },\n        ],\n      },\n      value: 'none',\n    };\n    this.settings['dataBits'] = {\n      description: 'Data Bits',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 8, text: '8' },\n          { value: 7, text: '7' },\n          { value: 6, text: '6' },\n          { value: 5, text: '5' },\n        ],\n      },\n      value: 8,\n    };\n    this.settings['stopBits'] = {\n      description: 'Stop Bits',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 2, text: '2' },\n          { value: 1.5, text: '1.5' },\n          { value: 1, text: '1' },\n        ],\n      },\n      value: 1,\n    };\n  }\n\n  static async getDevicesPoints(sub_container: any, container_db: any) {\n    let devicesPoints = [];\n    let devices: any = await ModbusUtils.getDevice(MODBUS_RTU_DEVICE, sub_container, container_db);\n    for (let device of devices) {\n      let points = await ModbusUtils.getPoints(MODBUS_RTU_POINT, device, container_db);\n      devicesPoints.push(points);\n    }\n    return devicesPoints;\n  }\n\n  async onAdded() {\n    super.onAdded();\n    let nodeDetailsMessage = {\n      nodeId: this.id,\n      cid: this.container.id,\n      sub_id: this.sub_container.id,\n    };\n    this.setOutputData(this.outMessageJson, nodeDetailsMessage);\n    await this.setupForPolling();\n  }\n\n  onCreated() {\n    super.onCreated();\n    if (this.side !== Side.server) return;\n  }\n\n  async onRemoved() {\n    super.onRemoved();\n    await this.polling(Poll.STOP);\n    if (this.client) {\n      this.client.close(() => {});\n    }\n    Object.keys(this.tcpClients).forEach(key => {\n      if (this.tcpClients[key]) this.tcpClients[key].close(() => {});\n    });\n  }\n\n  onAfterSettingsChange(oldSettings: any) {\n    super.onAfterSettingsChange(oldSettings);\n    setTimeout(async () => {\n      await this.setupForPolling();\n    });\n  }\n\n\n  async polling(poll: Poll) {\n    this.poll = poll;\n    if (this.side !== Side.server) return; // only execute on server\n    if (this.poll === Poll.STOP) {\n      // close MB client\n      this.setOutputData(this.outPortMsg, 'INFO: closed port connection');\n      this.setOutputData(this.outStatus, false, true);\n      if (this.client) this.client.close(() => {});\n      return;\n    }\n    if (this.transport === Transport.RTU) {\n      if (this.client) this.client.close(() => {});\n      this.client = new ModbusRTU();\n      this.client.setTimeout(500);\n      setTimeout(() => {\n        this.client\n          .connectRTUBuffered(this.port, {\n            baudRate: this.baudRate,\n            parity: this.parity,\n            dataBits: this.dataBits,\n            stopBits: this.stopBits,\n          })\n          .catch(() => {\n            this.setOutputData(this.outStatus, false, true);\n            this.setOutputData(this.outError, true, true);\n            this.setOutputData(this.outPortMsg, `ERROR! port: ${this.port.substring(5)}`);\n          });\n        this.setOutputData(this.outStatus, true, true);\n        this.setOutputData(this.outPortMsg, `INFO: polling RS485 `);\n      }, 500);\n    } else {\n      this.setOutputData(this.outPortMsg, `INFO: polling TCP `);\n    }\n    if (this.poll === Poll.FIRST_START) {\n      await this.pollDevicesPoints();\n    }\n  }\n\n  async pollDevicesPoints() {\n    if (this.poll === Poll.STOP) return;\n    const devices = await ModbusSerialNetworkNode.getDevicesPoints(this.sub_container.id, this.container.db);\n    let errorOnModbusDevicesExec = false;\n    for (let device of devices) {\n      let { deviceCID, deviceID, deviceAddress, ipAddress, ipPort, deviceAddressOffset } = device.deviceObj;\n      const deviceNode = Registry._nodes[Registry.getId(deviceCID, deviceID)];\n      if (!deviceNode) return;\n      let points = device.points;\n\n      let client = this.client;\n      let existingTcpClients: string[] = [];\n      if (this.transport === Transport.TCP) {\n        const key = this.getTcpKey(ipAddress, ipPort);\n        existingTcpClients.push(key);\n        if (!this.tcpClients[key]) {\n          this.debugInfo(`Creating tcpClient with IP: ${ipAddress} and Port: ${ipPort}`);\n          this.tcpClients[key] = new ModbusRTU();\n        }\n        if (!this.tcpClients[key].isOpen) {\n          this.debugInfo(`Connecting tcpClient with IP: ${ipAddress} and Port: ${ipPort}`);\n          try {\n            await this.tcpClients[key].connectTCP(ipAddress, { port: ipPort });\n            this.tcpClients[key].setTimeout(5000);\n          } catch (e) {\n            errorOnModbusDevicesExec = true;\n            ModbusUtils.sendDeviceError(deviceNode, e);\n            this.setOutputData(this.outError, e);\n            continue;\n          }\n        }\n        client = this.tcpClients[key];\n      }\n\n      // Close if tcpClient doesn't exist\n      Object.keys(this.tcpClients).forEach(key => {\n        if (!existingTcpClients.includes(key)) {\n          this.tcpClients[key].close(() => {});\n        }\n      });\n\n      let errorOnModbusPointsExec = false;\n      for (let point of points) {\n        const { pntAddr, pntType, pntOffset, pntVal, pntCid, pntId, pntDataType, pntDataEndian } = point;\n        await Utils.sleep(this.registerDelay || 50);\n        const pointNode = Registry._nodes[Registry.getId(pntCid, pntId)];\n        if (!pointNode) return;\n        // TODO for point write don't return if input properties.pointVal = null\n        // if ((pntType === 5 || pntType === 6) && typeof pntVal === 'number') {\n        try {\n          const response: any = await ModbusMethods.modbusMethods(\n            // TODO add return interface\n            client,\n            deviceAddress,\n            pntType,\n            pntAddr,\n            pntOffset,\n            pntVal,\n            pntDataType,\n            pntDataEndian,\n            deviceAddressOffset,\n          );\n          ModbusUtils.sendPointMessage(pointNode, response);\n          ModbusUtils.sendDeviceMessage(deviceNode, response);\n        } catch (e) {\n          errorOnModbusDevicesExec = true;\n          this.setOutputData(this.outError, e);\n          ModbusUtils.sendDeviceError(deviceNode, e);\n          ModbusUtils.sendPointError(pointNode, e);\n        }\n      }\n      if (!errorOnModbusDevicesExec) ModbusUtils.sendDeviceError(deviceNode, null);\n      errorOnModbusDevicesExec = errorOnModbusDevicesExec || errorOnModbusPointsExec;\n    }\n    if (errorOnModbusDevicesExec) {\n      this.setOutputData(this.outStatus, false, true);\n      this.setOutputData(this.outError, true, true);\n    } else {\n      this.setOutputData(this.outStatus, true, true);\n      this.setOutputData(this.outError, null, true);\n    }\n\n    await Utils.sleep(this.devicePolling || 2000);\n    await this.pollDevicesPoints(); // start loop again\n  }\n\n  private async setupForPolling() {\n    if (this.side !== Side.server) return;\n    this.networkEnable = this.settings['networkEnable'].value;\n    this.port = this.settings['port'].value;\n    this.baudRate = this.settings['baudRate'].value;\n    this.parity = this.settings['parity'].value;\n    this.dataBits = this.settings['dataBits'].value;\n    this.stopBits = this.settings['stopBits'].value;\n    this.devicePolling = this.settings['devicePolling'].value;\n    this.registerDelay = this.settings['registerDelay'].value;\n    this.transport = this.settings['transport'].value;\n\n    if (this.networkEnable) {\n      if (!this.pollEnableSetting) {\n        // start devicePolling\n        this.pollEnableSetting = true;\n        await this.polling(Poll.FIRST_START);\n      } else {\n        // continue devicePolling\n        await this.polling(Poll.DO_NOT_INIT);\n      }\n    } else {\n      this.pollEnableSetting = false;\n      await this.polling(Poll.STOP);\n    }\n  }\n\n  private getTcpKey(address: string, port: number): string {\n    return `${address}:${port}`;\n  }\n}\nContainer.registerNodeType(MODBUS_RTU_NETWORK, ModbusSerialNetworkNode);\n","export default class ModbusUtils {\n  static sendPointMessage(pointNode, msg) {\n    if (pointNode['subscribe']) pointNode['subscribe'](msg);\n  }\n\n  static sendPointError(pointNode, e) {\n    if (pointNode['subscribeError']) pointNode['subscribeError'](e);\n  }\n\n  static sendDeviceError(deviceNode, e) {\n    if (deviceNode['subscribeError']) deviceNode['subscribeError'](e);\n  }\n\n  static sendDeviceMessage(deviceNode, msg) {\n    if (deviceNode['subscribeMessage']) deviceNode['subscribeMessage'](msg);\n  }\n\n  static getDevice(typeDevice: string, cidDevice: any, container_db: any) {\n    return new Promise((resolve, reject) => {\n      let query = { 'type': typeDevice, 'cid': cidDevice, 'settings.deviceEnable.value': true };\n      container_db.getNodeByQuery(query, (err: any, docs: Array<any>) => {\n        let output = [];\n        if (!err) {\n          try {\n            docs.forEach(doc => {\n              const { cid, id, sub_container, settings } = doc;\n              output.push({\n                deviceCID: cid,\n                deviceID: id,\n                deviceSubCID: sub_container.id,\n                deviceAddress: settings.address.value,\n                ipAddress: settings.ipAddress.value,\n                ipPort: settings.ipPort.value,\n                deviceTimeout: settings.deviceTimeout.value,\n                deviceAddressOffset: settings.deviceAddressOffset.value,\n              });\n            });\n          } catch (err) {\n            reject(err);\n          }\n          resolve(output);\n        } else {\n          reject(err);\n        }\n      });\n    });\n  }\n\n  static getPoints(pointType: string, deviceObj: any, container_db: any) {\n    return new Promise((resolve, reject) => {\n      let query = {\n        'type': pointType,\n        'cid': deviceObj.deviceSubCID,\n        'settings.pointEnable.value': true,\n      };\n      container_db.getNodeByQuery(query, (err: any, docs: Array<any>) => {\n        let output = [];\n        if (!err) {\n          try {\n            docs.forEach(doc => {\n              const { cid, id, settings, properties } = doc;\n              output.push({\n                pntCid: cid,\n                pntId: id,\n                pntAddr: properties.address,\n                pntType: settings.pointType.value,\n                pntOffset: settings.offset.value,\n                pntMathFunc: settings.mathFunc.value,\n                pntMathValue: settings.mathValue.value,\n                pntDataType: settings.dataType.value,\n                pntDataEndian: settings.dataEndian.value,\n                pntTimeout: settings.pointTimeout.value,\n                pntVal: properties.pointVal,\n              });\n            });\n          } catch (err) {\n            reject(err);\n          }\n          resolve({\n            deviceObj,\n            points: output,\n          });\n        } else {\n        }\n      });\n    });\n  }\n}\n","import Utils from '../../../../utils';\nimport ModbusByteOrder from './modbus-point-byte-order';\nimport {isNumeric } from '../../../../../utils/helper';\nexport default class ModbusMethods {\n  static modbusMethods = async (\n    thisInstance: any,\n    id: number,\n    type: number, // type is for example readInputRegisters\n    regAddr: number,\n    regLength: number,\n    nodeInputValue?: number,\n    pntDataType?: number, // INT16\n    pntDataEndian?: number, // BE-LW\n    deviceAddressOffset?: number, // this is the point base offset 1 is default\n  ) => {\n    // console.log(\n    //   `Modbus call @  ${id}, FC: ${type}, regAddr: ${regAddr}, length: ${regLength} , writeVal: ${nodeInputValue} , pntDataType: ${pntDataType}, pntDataEndian: ${pntDataEndian}`,\n    // );\n    let pointAddress = regAddr - deviceAddressOffset\n    if(pointAddress < 0) pointAddress = 0; //make sure address is not less then 0\n    let ft = await ModbusMethods.pntSwitch(\n      type,\n      pointAddress,\n      regLength,\n      nodeInputValue,\n      pntDataType,\n      pntDataEndian,\n    );\n    // console.log(\n    //   `Modbus pntSwitch FC-METHOD: ${ft.methodType}, @ ${id}, FC: ${ft.funcType}, regAddr: ${regAddr}, length: ${regLength} , writeVal: ${nodeInputValue} , pntDataType: ${pntDataType}, pntDataEndian: ${pntDataEndian}`,\n    // );\n    // console.log(JSON.stringify(ft))\n    await thisInstance.setID(id);\n    await Utils.sleep(5);\n    return await new Promise((resolve, reject) => {\n      // This blocks requests for Modbus functionality, if it's still unsuccessful of 1 sec, it will return as error\n      thisInstance[ft.funcType](...ft.methodType).then((res: any) => {\n        // read holing and or input reg\n        if (type === 3 || type === 4) {\n          if (![0].includes(pntDataType)) {\n            const payload = ModbusByteOrder.readByteOrder(res.buffer, 0, pntDataType, pntDataEndian);\n            resolve({ res: res, payload: payload });\n          } else {\n            resolve({ res: res, payload: res.data[0] });\n          }\n          // read nube BIs and BOs\n        } else if (type === 1 || type === 2 || type === 21 || type === 22) {\n          const payload = ModbusMethods.readBool(res);\n          resolve({ res: res, payload: payload });\n\n          // read nube AIs and AOs\n        } else if (type === 23 || type === 24) {\n          let nubeType = ModbusMethods.nubeAnalogueRead();\n          const payload = ModbusByteOrder.readByteOrder(res.buffer, 0, nubeType[0], nubeType[1]);\n          resolve({ res: res, payload: payload });\n          // write response for nube DOs and AOs and writeCoil, writeCoil's, writeRegister writeRegister's\n        } else if (type === 5 || type === 6 || type === 16 || type === 25 || type === 26) {\n          if (res) {\n            resolve({ res: res, payload: 'writeOk' });\n          }\n        }\n      });\n      setTimeout(() => {\n        reject(\n          `Fail to execute > id: ${id}, FC: ${ft.funcType}, regAddr: ${regAddr}, length: ${regLength} , writeVal: ${nodeInputValue}`,\n        );\n      }, 1000);\n    });\n  };\n\n  private static readBool(res: any) {\n    return res.data[0];\n  }\n\n  private static nubeAnalogueRead() {\n    // this is for support of nube hardware BEB_LEW as a float\n    let pntDataType = 2;\n    let pntDataEndian = 2;\n    return [pntDataType, pntDataEndian];\n  }\n  private static dataTypeCase(c: number) {\n    const type16 = 1;\n    const type32 = 2;\n    const type64 = 4;\n    switch (c) {\n      case 1:\n      case 2:\n        return type16;\n      case 3:\n      case 4:\n      case 5:\n        return type32;\n      case 8:\n        return type64;\n    }\n  }\n\n  private static async pntSwitch(\n    type: number,\n    regAddr: number,\n    regLength: any,\n    nodeInputValue: any,\n    pntDataType?: number,\n    pntDataEndian?: number,\n  ) {\n    let funcType = null;\n    let methodType = null;\n    try {\n      // readCoils\n      if (type === 1) {\n        funcType = 'readCoils'; // (1, 4)  // read the 4 registers starting at address 1\n        methodType = [regAddr, regLength];\n        // read DO\n      } else if (type === 21) {\n        // read DO\n        funcType = 'readCoils';\n        methodType = [regAddr, 1];\n        // readDiscreteInputs\n      } else if (type === 2) {\n        funcType = 'readDiscreteInputs'; // (1, 4)  // read the 4 registers starting at address 1\n        methodType = [regAddr, regLength];\n        // read DI\n      } else if (type === 22) {\n        // read D1\n        funcType = 'readDiscreteInputs';\n        methodType = [regAddr, 1];\n        // read readHoldingRegisters\n      } else if (type === 3) {\n        funcType = 'readHoldingRegisters';\n        if (pntDataType !== 0) {\n          methodType = [regAddr, ModbusMethods.dataTypeCase(pntDataType)];\n        } else methodType = [regAddr, regLength];\n        // read AO\n      } else if (type === 23) {\n        funcType = 'readHoldingRegisters';\n        methodType = [regAddr, 2];\n        // read readInputRegisters\n      } else if (type === 4) {\n        funcType = 'readInputRegisters';\n        if (pntDataType !== 0) {\n          methodType = [regAddr, ModbusMethods.dataTypeCase(pntDataType)];\n        } else methodType = [regAddr, regLength];\n        // read AI\n      } else if (type === 24) {\n        funcType = 'readInputRegisters';\n        methodType = [regAddr, 2];\n        // writeCoil or DO\n      } else if (type === 5 || type === 25) {\n        funcType = 'writeCoil';\n        if (nodeInputValue === 1 || nodeInputValue === 0) {\n          methodType = [regAddr, nodeInputValue];\n        }\n        // writeRegister\n      } else if (type === 6) {\n        funcType = 'writeRegister'; // (5, 12) \"Write 12 to reg 5\"\n        if (isNumeric(nodeInputValue)) {\n          methodType = [regAddr, nodeInputValue];\n        };\n        // writeCoils\n      } else if (type === 16) {\n        funcType = 'writeRegisters'; //// example 1, [1, 22, 33, 444])\n        if (isNumeric(nodeInputValue)) {\n          methodType = [regAddr, ModbusByteOrder.writeValue(nodeInputValue, pntDataType, pntDataEndian)];\n        }\n      }\n      return {\n        funcType: funcType,\n        methodType: methodType,\n      };\n    } catch (error) {\n      console.log(`buffer readValue issue in modus-point-methods. Buffer.alloc ${error}`);\n    }\n  }\n}\n","\nimport * as mqtt from 'mqtt';\nimport { Container, Side } from '../../../container';\nimport { Node, SettingType } from '../../../node';\nimport { Type } from '../../../node-io';\nimport Utils from '../../../utils';\nimport CryptoUtils from '../../../utils/crypto-utils';\nimport { MQTTMessage } from './core/mqtt-model';\nimport config from '../../../../config';\nimport { isNull } from '../../../../utils/helper';\n\nconst matchMQTT = require('mqtt-match');\n\n//import { themes } from 'src/client/editor/renderer-themes';\n\nclass MqttClientNode extends Node {\n  client: any;\n  topicsCount = 0;\n  messageQueue: Array<MQTTMessage> = [];\n  rateLimitMS = 200;\n\n  constructor() {\n    super();\n    this.title = 'MQTT client';\n    this.description =\n      'This node connects to an MQTT Broker, subscribes to topics, and can publish values to topics.  ' +\n      'Once configured (in settings) with a valid Broker URL, Broker Port, and Authentication (if required), ' +\n      'this node will read and write to MQTT topics when enable is true.  ' +\n      'Number of topics, and the topic names can be configured from settings. ' +\n      'Each topic will have a corresponding input and output. ';\n\n    this.addInput('[enable]', Type.BOOLEAN);\n    this.addOutput('connected', Type.BOOLEAN);\n    this.settings['enable'] = { description: 'Enable', value: false, type: SettingType.BOOLEAN };\n    this.settings['broker_group'] = {\n      description: 'Broker settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['broker_group'] = {\n      description: 'Broker settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['useEnv'] = { description: 'Dont use env settings', value: false, type: SettingType.BOOLEAN };\n    this.settings['server'] = { description: 'Broker URL', value: '0.0.0.0', type: SettingType.STRING };\n    this.settings['port'] = { description: 'Broker port', value: '1883', type: SettingType.STRING };\n    this.settings['authentication'] = {\n      description: 'Use Authentication',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['username'] = { description: 'User name', value: '', type: SettingType.STRING };\n    this.settings['password'] = { description: 'Password', value: '', type: SettingType.PASSWORD };\n    this.settings['topics_group'] = {\n      description: 'Topic settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['topics_count'] = {\n      description: 'Number of Topics',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n    this.settings['decimals'] = {\n      description: 'Decimal Places (Numerics)',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: '0' },\n          { value: 1, text: '1' },\n          { value: 2, text: '2' },\n          { value: 3, text: '3' },\n          { value: 4, text: '4' },\n          { value: 5, text: '5' },\n          { value: 6, text: '6' },\n          { value: 7, text: '7' },\n          { value: 8, text: '8' },\n          { value: 9, text: '9' },\n          { value: 10, text: '10' },\n        ],\n      },\n      value: 3,\n    };\n\n    this.setSettingsConfig({\n      groups: [\n        { server: { weight: 3 }, port: { weight: 1 } },\n        { useEnv: {}, authentication: {} },\n        { username: {}, password: {} },\n        { topics_count: {}, decimals: {} },\n      ],\n      conditions: {\n        server: setting => {\n          return !!setting['useEnv'].value;\n        },\n        port: setting => {\n          return !!setting['useEnv'].value;\n        },\n        authentication: setting => {\n          return !!setting['useEnv'].value;\n        },\n        username: setting => {\n          return !!setting['authentication'].value;\n        },\n        password: setting => {\n          return !!setting['authentication'].value;\n        }\n      },\n    });\n  }\n\n  init() {\n    this.changeTopicsCount(this.settings['topics_count'].value);\n  }\n\n  onCreated() {\n    this.renameInputsOutputs();\n  }\n\n  onAdded() {\n    this.EXECUTE_INTERVAL = 200;\n\n    this.topicsCount = this.settings['topics_count'].value;\n    if (this.side == Side.server) {\n      this.setOutputData(0, false);\n      // connect if \"connect\" input disconnected or input data==true\n      if (this.settings['enable'].value && (this.inputs[0].link == null || this.inputs[0].data == true)) {\n        this.connectToBroker();\n      }\n    }\n  }\n\n  connectToBroker() {\n    let { protocol, host, port, username, password } = config.mqtt;\n    let options: any = {};\n\n    if (this.settings['useEnv'].value) {  //dont use env\n      if (this.settings['server'].value != null && this.settings['server'].value != '')\n        options.host = this.settings['server'].value;\n\n      if (this.settings['port'].value != null && this.settings['port'].value != '')\n        options.port = this.settings['port'].value;\n\n      if (this.settings['username'].value != null && this.settings['username'].value != '')\n        options.username = this.settings['username'].value;\n\n      if (this.settings['password'].value != null && this.settings['password'].value != '')\n        options.password = CryptoUtils.decrypt(this.settings['password'].value);\n\n    } else { //use use env\n      if (isNull(host)) return;\n      if (isNull(port)) return;\n      options.host = host\n      options.port = port\n      if(this.settings['authentication'].value === true){\n        if (!isNull(options.username)) {\n          options.username = username;\n        }\n        if (!isNull(options.password)) {\n          options.password = CryptoUtils.decrypt(password);\n        }\n      }\n    }\n\n    this.client = mqtt.connect(options);\n    this.client.on('connect', () => {\n      this.setOutputData(0, true);\n      //subscribe\n      for (let i = 1; i <= this.topicsCount; i++) {\n        let topic = this.settings['topic' + i].value;\n        if (topic && topic != '') this.client.subscribe(topic);\n      }\n    });\n\n    this.client.on('close', () => {\n      this.setOutputData(0, false);\n      this.setOutputData(1, null);\n    });\n\n    this.client.on('error', error => {\n      this.debugWarn(error);\n    });\n\n    this.client.on('message', (topic, message) => {\n      let obj: MQTTMessage = { topic: topic, message: message.toString() };\n      this.messageQueue.push(obj);\n    });\n  }\n\n  disconnectFromBroker() {\n    if (this.client) this.client.end();\n  }\n\n  onInputUpdated() {\n    //connect/disconnect\n    if (this.inputs[0].updated) {\n      if (this.inputs[0].data == false) this.disconnectFromBroker();\n      //auto connect when input disconnected\n      else if (this.settings['enable'].value && (this.inputs[0].link == null || this.inputs[0].data == true))\n        this.connectToBroker();\n    }\n\n    //publish message\n    if (this.settings['enable'].value && this.client && this.client.connected) {\n      for (let i = 1; i < this.getInputsCount(); i++) {\n        let data = this.inputs[i].data;\n        if (data && this.inputs[i].updated) {\n          let isJSON = true;\n          try {\n            data = JSON.parse(data);\n          } catch {\n            console.log('Not a valid JSON');\n            isJSON = false;\n          }\n          let topic: string;\n          let payload: string = '';\n\n          if (\n            isJSON &&\n            data.hasOwnProperty('topic') &&\n            typeof data.topic === Type.STRING &&\n            data.hasOwnProperty('payload')\n          ) {\n            payload = JSON.stringify(data.payload);\n            this.client.publish(data.topic, '' + payload);\n          } else {\n            topic = this.settings['topic' + i].value;\n            if (isJSON) payload = JSON.stringify(data);\n            else payload = String(data);\n            this.client.publish(topic, '' + payload);\n          }\n        }\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    let topics = this.settings['topics_count'].value;\n    topics = Utils.clamp(topics, 1, 100);\n    this.settings['topics_count'].value = topics;\n\n    //change topics count\n    if (this.topicsCount != topics) this.changeTopicsCount(topics);\n\n    //rename inputs, outputs\n    this.renameInputsOutputs();\n\n    //add code to hide inputs that are not writeable.\n\n    //update db\n    if (this.container.db)\n      this.container.db.updateNode(this.id, this.container.id, {\n        $set: { inputs: this.inputs, outputs: this.outputs, settings: this.settings },\n      });\n\n    if (this.side == Side.server) {\n      this.disconnectFromBroker();\n\n      if (this.settings['enable'].value) this.connectToBroker();\n    }\n  }\n\n  changeTopicsCount(target_count) {\n    let diff = target_count - this.topicsCount;\n    if (diff == 0) return;\n\n    //add inputs, outputs\n    this.changeInputsCount(target_count + 1, Type.STRING);\n    this.changeOutputsCount(target_count + 1, Type.STRING);\n\n    //change settings for topics\n    if (diff > 0) {\n      for (let i = this.topicsCount + 1; i <= target_count; i++) {\n        this.settings['outputType' + i] = {\n          description: 'Output Type',\n          type: SettingType.DROPDOWN,\n          config: {\n            items: [\n              { value: false, text: 'Payload' },\n              { value: true, text: 'JSON' },\n            ],\n          },\n          value: false,\n        };\n        this.settings['topic' + i] = {\n          description: 'Topic ' + i,\n          value: '',\n          type: SettingType.STRING,\n        };\n        for (let i = this.topicsCount + 1; i <= target_count; i++) {\n          this.settingConfigs.groups.push({\n            [`outputType${i}`]: { weight: 2 },\n            [`topic${i}`]: { weight: 5 },\n          });\n        }\n      }\n    } else if (diff < 0) {\n      for (let i = this.topicsCount; i > target_count; i--) {\n        delete this.settings['topic' + i];\n        this.settingConfigs.groups.pop();\n      }\n    }\n\n    this.topicsCount = target_count;\n  }\n\n  renameInputsOutputs() {\n    for (let i = 1; i <= this.topicsCount; i++) {\n      //this.inputs[i].name = '[' + i + ']';\n      let topic = this.settings['topic' + i].value;\n      if (topic.length > 20) topic = '...' + topic.substr(topic.length - 20, 20);\n      this.inputs[i].name = '' + i + ' | ' + topic;\n      this.outputs[i].name = topic + ' | ' + i;\n    }\n\n    if (this.side == Side.editor) {\n      for (let i = 1; i <= this.topicsCount; i++) {\n        this.inputs[i].label = this.inputs[i].name;\n        this.outputs[i].label = this.outputs[i].name;\n      }\n      this.setDirtyCanvas(true, true);\n    }\n  }\n\n  // TODO: queue for each output\n  onExecute() {\n    if (this.messageQueue && this.messageQueue.length > 0) {\n      this.processQueue(this.messageQueue.shift());\n    }\n  }\n\n  setMQTTOutput(mqttMessage: MQTTMessage, outputNum: number) {\n    if (this.settings['outputType' + outputNum].value) {\n      this.setOutputData(outputNum, { topic: mqttMessage.topic, payload: mqttMessage.message });\n      return;\n    } else {\n      let msgAsNum = Number(mqttMessage.message);\n      if (isNaN(msgAsNum)) {\n        this.setOutputData(outputNum, mqttMessage.message);\n        return;\n      }\n      this.setOutputData(outputNum, Utils.toFixedNumber(msgAsNum, this.settings['decimals'].value).toString());\n    }\n  }\n\n  processQueue(mqttMessage: MQTTMessage) {\n    // look into using mqtt-match library. (https://www.npmjs.com/package/mqtt-match)\n    for (let outInd = 1; outInd <= this.topicsCount; outInd++) {\n      //console.log('index:'+outInd+'  ', this.settings['topic' + outInd].value, '   ', mqttMessage.topic, '   ', matchMQTT(this.settings['topic' + outInd].value, mqttMessage.topic))\n      if (matchMQTT(this.settings['topic' + outInd].value, mqttMessage.topic)) this.setMQTTOutput(mqttMessage, outInd);\n    }\n  }\n}\nContainer.registerNodeType('protocols/mqtt/client', MqttClientNode);\n","import * as mqtt from 'mqtt';\nimport { Container, Side } from '../../../container';\nimport { Node, SettingType } from '../../../node';\nimport { Type } from '../../../node-io';\nimport CryptoUtils from '../../../utils/crypto-utils';\nimport { MQTTMessage } from './core/mqtt-model';\nimport config from '../../../../config';\nimport { isNull } from '../../../../utils/helper';\nconst matchMQTT = require('mqtt-match');\n\nclass MqttClientSingleNode extends Node {\n  client: any;\n\n  //node inputs\n  inName = 0;\n  inEnable = 1;\n  inData = 2;\n  inTopic = 3;\n  enableDebug = false;\n\n  constructor() {\n    super();\n    this.title = 'MQTT Single Topic client';\n    this.description =\n      `## Description\\n ` +\n      `This node connects to an MQTT Broker, subscribes to topics, and can publish values to topics. .\\n ` +\n      `Once configured (in settings) with a valid Broker URL, Broker Port, and Authentication (if required), .\\n ` +\n      `this node will read and write to MQTT topics when enable is true.  .\\n ` +\n      `Each topic will have a corresponding input and output. .\\n ` +\n      `   \\n ` +\n      `### Enable\\n ` +\n      `   \\n ` +\n      ` This will enable/disable the device from broker \\n ` +\n      `   \\n ` +\n      `### Use env settings\\n ` +\n      `   \\n ` +\n      ` If set to true this will allow you to use the MQTT broker details set from the .env configuration file in the device\\n ` +\n      ` If set to false this will allow you to set the MQTT broker details manually\\n ` +\n      `   \\n ` +\n      `### Node input\\n ` +\n      `   \\n ` +\n      ` The input named \"input\" can accept a json input or an mqtt payload to send when the topic is set in the node setting called \"[topic]\".\\n ` +\n      ` The input named \"input\" can accept a json payload input with the name, topic, and mqtt payload. See example below.\\n ` +\n      ` { \"payload\": 22, \"topic\": \"my topic\", \"name\": \"my node node\"}\\n ` +\n      `   \\n `;\n    this.addInput('[name]', Type.STRING);\n    this.addInputWithSettings('enable', Type.BOOLEAN, false, 'enable broker');\n    this.addInputWithSettings('input', Type.STRING, '', 'JSON input or input value');\n    this.addInputWithSettings('topic', Type.STRING, '', 'enter topic if not used from input');\n    this.addOutput('connected', Type.BOOLEAN);\n    this.addOutput('output', Type.ANY);\n    this.addOutput('output-json', Type.JSON);\n    this.settings['retain'] = { description: 'Retain message on publish', value: true, type: SettingType.BOOLEAN };\n    this.settings['qos'] = {\n      description: 'MQTT Quality Of Service (QoS)',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: -1, text: 'na' },\n          { value: 0, text: 'QoS 0' },\n          { value: 1, text: 'QoS 1' },\n          { value: 2, text: 'QoS 2' },\n        ],\n      },\n      value: 0,\n    };\n    this.settings['broker_group'] = {\n      description: 'Broker settings',\n      value: '',\n      type: SettingType.GROUP,\n    };\n    this.settings['useEnv'] = { description: 'Dont use env settings', value: false, type: SettingType.BOOLEAN };\n    this.settings['server'] = { description: 'Broker URL', value: '0.0.0.0', type: SettingType.STRING };\n    this.settings['port'] = { description: 'Broker port', value: '1883', type: SettingType.STRING };\n    this.settings['authentication'] = {\n      description: 'Use Authentication',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['username'] = { description: 'User name', value: '', type: SettingType.STRING };\n    this.settings['password'] = { description: 'Password', value: '', type: SettingType.PASSWORD };\n    this.setSettingsConfig({\n      groups: [\n        { server: { weight: 3 }, port: { weight: 1 } },\n        { username: {}, password: {} },\n      ],\n      conditions: {\n        server: setting => {\n          return !!setting['useEnv'].value;\n        },\n        port: setting => {\n          return !!setting['useEnv'].value;\n        },\n        authentication: setting => {\n          return !!setting['useEnv'].value;\n        },\n        username: setting => {\n          return !!setting['authentication'].value;\n        },\n        password: setting => {\n          return !!setting['authentication'].value;\n        },\n      },\n    });\n  }\n\n  onAdded() {\n    this.EXECUTE_INTERVAL = 200;\n    if (this.side == Side.server) {\n      this.setOutputData(0, false);\n      if (this.getInputData(this.inEnable) === true) {\n        this.connectToBroker();\n        if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE: connect to Broker`);\n      }\n    }\n  }\n\n  connectToBroker() {\n    let { host, port, username, password } = config.mqtt;\n    let options: any = {};\n    const qos = this.settings['qos'].value;\n    if (qos !== -1) {\n      options.qos = qos;\n    }\n    if (this.settings['useEnv'].value) {\n      //dont use env\n      if (this.settings['server'].value != null && this.settings['server'].value != '')\n        options.host = this.settings['server'].value;\n      if (this.settings['port'].value != null && this.settings['port'].value != '')\n        options.port = this.settings['port'].value;\n      if (this.settings['username'].value != null && this.settings['username'].value != '')\n        options.username = this.settings['username'].value;\n      if (this.settings['password'].value != null && this.settings['password'].value != '')\n        options.password = CryptoUtils.decrypt(this.settings['password'].value);\n    } else {\n      //use use env\n      if (isNull(host)) return;\n      if (isNull(port)) return;\n      options.host = host;\n      options.port = port;\n      if (this.settings['authentication'].value === true) {\n        if (!isNull(options.username)) {\n          options.username = username;\n        }\n        if (!isNull(options.password)) {\n          options.password = CryptoUtils.decrypt(password);\n        }\n      }\n    }\n    this.client = mqtt.connect(options);\n    this.client.on('connect', () => {\n      if (this.enableDebug)\n        this.debugInfo(`MQTT-CLIENT-SINGLE NODE: this.client = mqtt.connect options: ${JSON.stringify(options)}`);\n      this.setOutputData(0, true);\n      let data = this.getInputData(this.inData);\n      let topic = this.getInputData(this.inTopic);\n      if (data || topic) {\n        let isJSON = true;\n        try {\n          data = JSON.parse(data);\n        } catch {\n          if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE: input isn't JSON`);\n          isJSON = false;\n        }\n        if (isJSON && data.hasOwnProperty('topic') && typeof data.topic === Type.STRING) {\n          if (data.topic != '') {\n            this.client.subscribe(data.topic);\n            if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE:  subscribe on json topic ${data.topic}`);\n          }\n        } else {\n          // if no json topic use input 2 topic\n          if (data.topic != '') {\n            if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE:  subscribe on node input topic ${topic}`);\n            this.client.subscribe(topic);\n          }\n        }\n      }\n    });\n    this.client.on('close', () => {\n      this.setOutputData(0, false);\n    });\n\n    this.client.on('error', error => {\n      this.debugWarn(error);\n    });\n    this.client.on('message', (topic, message) => {\n      let obj: MQTTMessage = { topic: topic, message: message.toString() };\n      if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE:  this.client.on('message' ${JSON.stringify(obj)}`);\n      this.processMessage(obj);\n    });\n  }\n\n  disconnectFromBroker() {\n    if (this.client) this.client.end();\n  }\n\n  onInputUpdated() {\n    //connect/disconnect\n    if (this.inputs[this.inEnable].updated) {\n      if (this.getInputData(this.inEnable) === true) {\n        this.connectToBroker();\n        if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE: connect to Broker`);\n      } else if (this.getInputData(this.inEnable) === false) {\n        this.disconnectFromBroker();\n        if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE: disconnect From Broker`);\n      } else if (isNull(this.getInputData(this.inEnable))) {\n        this.onAfterSettingsChange();\n        if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE: disconnect enable input from node`);\n      }\n    }\n\n    //update node name\n    if (this.inputs[this.inName].updated) {\n      let nodeName = this.getInputData(this.inName);\n      if (!isNull(nodeName)) {\n        this.name = nodeName;\n        this.broadcastNameToClients();\n      }\n    }\n\n    //update topic\n    if (this.getInputData(this.inEnable) && this.inputs[this.inTopic].updated) {\n      this.connectToBroker();\n      if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE: node input topic updated`);\n    }\n\n    //publish message\n    if (this.getInputData(this.inEnable) && this.client && this.client.connected) {\n      let data = this.getInputData(this.inData);\n      if (data && this.inputs[this.inData].updated) {\n        let isJSON = true;\n        try {\n          data = JSON.parse(data);\n        } catch {\n          if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE: input isn't JSON`);\n          isJSON = false;\n        }\n        let topic: string;\n        let payload: string = '';\n        if (\n          isJSON &&\n          data.hasOwnProperty('topic') &&\n          typeof data.topic === Type.STRING &&\n          data.hasOwnProperty('payload')\n        ) {\n          payload = JSON.stringify(data.payload);\n          if (data.topic == '') {\n            return;\n          }\n          if (this.settings['retain'].value) {\n            this.client.publish(data.topic, '' + payload, { retain: true });\n          } else {\n            this.client.publish(data.topic, '' + payload);\n          }\n          if (this.enableDebug)\n            this.debugInfo(`MQTT-CLIENT-SINGLE NODE: publish on input topic from json ${data.topic}, '' + ${payload}`);\n        } else {\n          topic = this.getInputData(this.inTopic);\n          if (isJSON) payload = JSON.stringify(data);\n          else payload = String(data);\n          if (topic == '') {\n            return;\n          }\n          if (this.settings['retain'].value) {\n            this.client.publish(topic, '' + payload, { retain: true });\n          } else {\n            this.client.publish(topic, '' + payload);\n          }\n          if (this.enableDebug)\n            this.debugInfo(`MQTT-CLIENT-SINGLE NODE: publish on input topic from node input ${topic}, '' + ${payload}`);\n        }\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    //update db\n    if (this.container.db)\n      this.container.db.updateNode(this.id, this.container.id, {\n        $set: { inputs: this.inputs, outputs: this.outputs, settings: this.settings },\n      });\n\n    if (this.side == Side.server) {\n      this.disconnectFromBroker();\n      if (this.getInputData(this.inEnable)) {\n        this.connectToBroker();\n        if (this.enableDebug) this.debugInfo(`MQTT-CLIENT-SINGLE NODE: connect to Broker from settings`);\n      }\n    }\n  }\n\n  processMessage(mqttMessage: MQTTMessage) {\n    // look into using mqtt-match library. (https://www.npmjs.com/package/mqtt-match)\n    let topic = this.getInputData(this.inTopic);\n    if (matchMQTT(topic, mqttMessage.topic)) {\n      this.setOutputData(1, mqttMessage.message);\n      this.setOutputData(2, mqttMessage);\n    }\n  }\n}\nContainer.registerNodeType('protocols/mqtt/client-single', MqttClientSingleNode);\n","import { connect, IClientPublishOptions, IClientSubscribeOptions, MqttClient } from 'mqtt';\nimport { MQTTMessage } from './mqtt-model';\n\nconst logger = require('logplease').create('mqtt', { color: 4 });\n\nexport interface MqttClientWrapper {\n\n  start(): MqttClientWrapper;\n\n  stop(): void;\n\n  isConnected(): boolean;\n\n  publish(topic: string, payload: string, options?: {}, cb?: any): void;\n\n  subscribe(topic: string, options?: {}, cb?: any): void;\n\n  unsubscribe(topic: string, cb?: any): void;\n}\n\nexport interface MqttLifecycle {\n\n  /**\n   * Emitted on successful (re)connection (i.e. connack rc=0).\n   * @param connack received connack packet.\n   */\n  onConnect(connack): void;\n\n  /**\n   * Emitted when a reconnect starts.\n   */\n  onReconnect(): void;\n\n  /**\n   * Emitted after a disconnection.\n   */\n  onClose(): void;\n\n  /**\n   * Emitted after receiving disconnect packet from broker. MQTT 5.0 feature.\n   */\n  onDisconnect(): void;\n\n  /**\n   * Emitted when the client goes offline.\n   */\n  onOffline(): void;\n\n  /**\n   * Emitted when the client cannot connect (i.e. connack rc != 0) or when a parsing error occurs.\n   */\n  onError(err): void;\n\n  /**\n   * Emitted when mqtt.Client#end() is called.\n   * If a callback was passed to mqtt.Client#end(), this event is emitted once the callback returns.\n   */\n  onEnd(): void;\n\n  /**\n   * Emitted when the client receives a publish packet\n   * @param topic topic of the received packet\n   * @param message payload of the received packet\n   * @param packet received packet, as defined in mqtt-packet\n   */\n  onMessage(topic, message, packet): void;\n\n  /**\n   * Emitted when the client sends any packet.\n   * This includes .published() packets as well as packets used by MQTT for managing subscriptions and connections\n   * @param packet received packet, as defined in mqtt-packet\n   */\n  onPacketSend(packet): void;\n\n  /**\n   * Emitted when the client receives any packet.\n   * This includes packets from subscribed topics as well as packets used by MQTT for managing subscriptions and connections\n   * @param packet received packet, as defined in mqtt-packet\n   */\n  onPacketReceive(packet): void;\n\n}\n\nexport class DefaultMqttClient implements MqttClientWrapper, MqttLifecycle {\n\n  private readonly options: {};\n  private readonly callbackWhenConnected: (client: MqttClientWrapper) => void;\n  private readonly callbackWhenOffline: (client: MqttClientWrapper, offlineMsg?: string) => void;\n  private readonly callbackIncomingMessage: (msg: MQTTMessage) => void;\n  private client: MqttClient;\n  private connected: boolean = false;\n  private clientId: string;\n\n  constructor(options: {}, callbackWhenConnected: (client: MqttClientWrapper) => void,\n              callbackWhenOffline: (client: MqttClientWrapper, offlineMsg?: string) => void,\n              callbackIncomingMessage: (msg: MQTTMessage) => void) {\n    this.options = options;\n    this.callbackWhenConnected = callbackWhenConnected;\n    this.callbackWhenOffline = callbackWhenOffline;\n    this.callbackIncomingMessage = callbackIncomingMessage;\n  }\n\n  static init(options: {}, callbackWhenConnected: (client: MqttClientWrapper) => void,\n              callbackWhenOffline: (client: MqttClientWrapper, offlineMsg?: string) => void,\n              callbackIncomingMessage: (msg: MQTTMessage) => void): MqttClientWrapper {\n    return new DefaultMqttClient(options, callbackWhenConnected, callbackWhenOffline, callbackIncomingMessage).start();\n  }\n\n  onClose(): void {\n    logger.debug(`MQTT Client ${this.clientId} closed`);\n    this.connected = false;\n  }\n\n  onConnect(connack): void {\n    logger.info(`MQTT Client ${this.clientId} connected ${JSON.stringify(connack)}`);\n    this.connected = true;\n    if (this.callbackWhenConnected) {\n      this.callbackWhenConnected(this);\n    }\n  }\n\n  onDisconnect(): void {\n    logger.warn(`MQTT Client ${this.clientId} disconnected`);\n    this.connected = false;\n    if (this.callbackWhenOffline) {\n      this.callbackWhenOffline(this, `Unable connect to server`);\n    }\n  }\n\n  onEnd(): void {\n    logger.info(`MQTT Client ${this.clientId} ended`);\n    this.connected = false;\n    if (this.callbackWhenOffline) {\n      this.callbackWhenOffline(this);\n    }\n  }\n\n  onError(err): void {\n    logger.error(`Error connection in MQTT Client ${this.clientId}`, err);\n    this.stop();\n  }\n\n  onMessage(topic, message, packet): void {\n    logger.info(`MQTT Client '${this.clientId}' dispatch message on topic '${topic}'`);\n    this.callbackIncomingMessage({ topic, message: message.toString() } as MQTTMessage);\n  }\n\n  onOffline(): void {\n    logger.warn(`MQTT Client '${this.clientId}' is offline`);\n    this.connected = false;\n    if (this.callbackWhenOffline) {\n      this.callbackWhenOffline(this, `Unable connect to server`);\n    }\n  }\n\n  onPacketReceive(packet): void {\n    logger.debug(`MQTT Client '${this.clientId}' receives packet '${packet?.cmd}'`);\n  }\n\n  onPacketSend(packet): void {\n    logger.debug(`MQTT Client '${this.clientId}' sends packet '${packet?.cmd}'`);\n  }\n\n  onReconnect(): void {\n    logger.info(`MQTT Client '${this.clientId}' reconnected`);\n    if (this.callbackWhenConnected) {\n      this.callbackWhenConnected(this);\n    }\n  }\n\n  start(): MqttClientWrapper {\n    this.client = connect(this.options);\n    this.client.on('connect', connack => this.onConnect(connack));\n    this.client.on('close', () => this.onClose());\n    this.client.on('disconnect', () => this.onDisconnect());\n    this.client.on('end', () => this.onEnd());\n    this.client.on('error', err => this.onError(err));\n    this.client.on('offline', () => this.onOffline());\n    this.client.on('packetreceive', packet => this.onPacketReceive(packet));\n    this.client.on('packetsend', packet => this.onPacketSend(packet));\n    this.client.on('message', (topic, msg, packet) => this.onMessage(topic, msg, packet));\n    this.clientId = this.client?.options?.clientId;\n    return this;\n  }\n\n  stop(): void {\n    if (this.client) {\n      this.client.end(true);\n    }\n  }\n\n  isConnected(): boolean {\n    return this.client && this.connected;\n  }\n\n  publish(topic: string, payload: string, options?: {}, cb?: any): void {\n    if (!this.isConnected()) {\n      return;\n    }\n    this.client.publish(topic, payload, (options || { retain: true }) as IClientPublishOptions, cb);\n  }\n\n  subscribe(topic: string, options?: {}, cb?: any): void {\n    if (!this.isConnected()) {\n      return;\n    }\n    logger.info(`MQTT Client '${this.clientId}' subscribe topic '${topic}'...`);\n    this.client.subscribe(topic, (options || {}) as IClientSubscribeOptions, cb);\n  }\n\n  unsubscribe(topic: string, cb?: any): void {\n    if (!this.isConnected()) {\n      return;\n    }\n    logger.info(`MQTT Client '${this.clientId}' unsubscribe topic '${topic}'...`);\n    if (topic) {\n      this.client.unsubscribe(topic, cb);\n    }\n  }\n}\n","import { PointOutput, PointValueCreator } from '../../../../backend/models/point-model';\nimport { isEmpty, isNull } from '../../../../utils/helper';\nimport {\n  DefaultObservable,\n  HasCentralizedListener,\n  ICentralizedListener,\n  IMessageConverter,\n  MockCentralizedListener,\n  Observer,\n} from '../../../../utils/pattern';\nimport { Container } from '../../../container';\nimport { Node, NodeSettings, SettingType } from '../../../node';\nimport { NodeInput, Type } from '../../../node-io';\nimport Registry from '../../../registry';\nimport { DependantConnectionNode, DependantConnectionNodeMixin } from '../connection-node-mixin';\nimport {\n  DataPointFlowHandler,\n  HasDataPointFlowHandler,\n  HasPointOutputObservers,\n  MockHasPointOutputObservers,\n  PointNodeMixin,\n} from '../model/point-node';\nimport { MqttPointCreator, MqttPointValue, SillyMqttPoint } from './core/mqtt-model';\nimport {\n  MQTT_CLIENT_NODE,\n  PUBLISH_MQTT_DATA,\n  REGISTER_MQTT_POINT,\n  UNREGISTER_MQTT_POINT,\n  UPDATE_MQTT_POINT,\n} from './mqtt-client-node';\nimport { MqttPointStoreItem } from './mqtt-client-node-store';\n\nclass MqttPointNode extends DependantConnectionNodeMixin(PointNodeMixin(Node))\n  implements HasPointOutputObservers<SillyMqttPoint>, HasDataPointFlowHandler<SillyMqttPoint>,\n    DependantConnectionNode, DataPointFlowHandler<SillyMqttPoint>, IMessageConverter, HasCentralizedListener {\n\n  private readonly _iTopic = 'topic';\n  private readonly _sReqRes = 'enabledReqRes';\n\n  constructor() {\n    super();\n    this.title = 'MQTT Point';\n    //TODO Should re-update\n    this.description =\n      'Mqtt Point Node includes MQTT publisher and subscriber inside. ' +\n      'This node connects to an MQTT Broker, subscribes to a topic, ' +\n      'and can publish values once we enable the node.';\n    this.mixinEnableInputSetting();\n    this.mixinConnectionStatusOutput();\n    this.addInputWithSettings(this._iTopic, Type.STRING, '', 'MQTT Topic');\n    this.settings[this._sReqRes] = {\n      description: 'Request Response mode',\n      type       : SettingType.BOOLEAN,\n      value      : false,\n    };\n    this.setSettingsConfig(this.mixinPointValueInputOutput());\n  }\n\n  flowHandler(): DataPointFlowHandler<SillyMqttPoint> {\n    return this;\n  }\n\n  listener(): ICentralizedListener {\n    return MockCentralizedListener.cast(this.getParentNode());\n  }\n\n  pointObservers(): Observer<PointOutput<SillyMqttPoint>>[] {\n    return [...super.pointObservers(),\n            ...MockHasPointOutputObservers.cast(this.getParentNode()).pointObservers()];\n  }\n\n  notifyOutput(point: SillyMqttPoint, observers: Observer<PointOutput<SillyMqttPoint>>[]): void {\n    if (isNull(point)) {\n      return;\n    }\n    let cp = this.initializePointBySettingObject();\n    point.pointValue = isNull(point?.pointValue) ? PointValueCreator.by() : point.pointValue.merge(cp?.pointValue);\n    this.settings[this.modelSettingKey()].value = point;\n    new DefaultObservable(observers).notify({ point: point, connStatus: { status: this.getConnectionStatus() } });\n  }\n\n  onRemoved() {\n    if (this.listener() === MockCentralizedListener.LISTENER) {\n      return;\n    }\n    let mqttPoint = this.initializePointBySettingObject();\n    if (mqttPoint) {\n      this.listener().listen({ action: UNREGISTER_MQTT_POINT, payload: this.createMqttPointStoreItem(mqttPoint) });\n    }\n  }\n\n  reEvaluateSettingByInput(inputs: { [p: number]: NodeInput }, settings: { [p: string]: NodeSettings }) {\n    settings[this._iTopic].value = inputs[this.topicInputIdx()].updated ? inputs[this.topicInputIdx()].data\n                                                                        : settings[this._iTopic].value;\n    super.reEvaluateSettingByInput(inputs, settings);\n  }\n\n  handleOnUpdate(current: SillyMqttPoint, prev?: SillyMqttPoint): SillyMqttPoint {\n    if (!prev?.mqttTopic && !current?.mqttTopic) {\n      return null;\n    }\n    if (isEmpty(current.mqttTopic)) {\n      throw new Error('Must define MQTT topic');\n    }\n    let payload = this.createMqttPointStoreItem(current);\n    if (isNull(prev) || this.getConnectionStatus().isError()) {\n      this.listener().listen({ action: REGISTER_MQTT_POINT, payload });\n    } else if (!current.mightOnlyValueChanged(prev)) {\n      if (!current.equals(prev)) {\n        current.pointValue = PointValueCreator.by();\n      }\n      payload.publisher.prev = this.createMqttPointStoreItem(prev);\n      payload.subscriber.prev = this.createMqttPointStoreItem(prev);\n      this.listener().listen({ action: UPDATE_MQTT_POINT, payload });\n    }\n    if (!current.enabled || (isNull(current?.pointValue?.presentValue) &&\n                             (prev && !current.equals(prev) || isNull(prev?.pointValue?.presentValue)))) {\n      return current;\n    }\n    if (current.isReqRes) {\n      // Always publish highest data to mqtt broker\n      return this.listener().listen({ action: PUBLISH_MQTT_DATA, payload: payload.toPublisher() });\n    }\n    let cov = current.pointValue.changedOfValue(prev?.pointValue);\n    if (cov) {\n      payload.publisher.data.pointValue = cov;\n    }\n    return this.listener().listen({ action: PUBLISH_MQTT_DATA, payload: payload.toPublisher() });\n  }\n\n  initializePointBySettingInput(settings?: { [name: string]: NodeSettings }): SillyMqttPoint {\n    let st = (settings ?? this.settings) as { [name: string]: NodeSettings };\n    return SillyMqttPoint.by(MqttPointCreator.by(this.isEnabled(), st[this._iTopic].value, this.createPointValue(st)),\n                             this.settings[this._sReqRes].value);\n  }\n\n  initializePointBySettingObject(settings?: { [name: string]: NodeSettings }): SillyMqttPoint {\n    let st = (settings ?? this.settings) as { [name: string]: NodeSettings };\n    return SillyMqttPoint.by(MqttPointCreator.from(st[this.modelSettingKey()].value),\n                             this.settings[this._sReqRes].value);\n  }\n\n  onConvertMessage(data: any): string {\n    return MqttPointValue.by(data?.pointValue).toString();\n  }\n\n  onReceiveMessage(incomingMessage: any): void {\n    let pointValue = MqttPointValue.parse(incomingMessage).to();\n    let cp = this.initializePointBySettingObject();\n    cp.pointValue = pointValue.merge(cp.pointValue);\n    if (this.settings[this._sReqRes].value) {\n      this.listener().listen({ action: PUBLISH_MQTT_DATA, payload: this.createMqttPointStoreItem(cp).toPublisher() });\n    }\n    this.notifyOutput((this.settings[this.modelSettingKey()].value = cp), this.pointObservers());\n  }\n\n  protected statusOutputIdx(): number {\n    return 0;\n  }\n\n  protected modelSettingKey(): string {\n    return `mqttp`;\n  }\n\n  protected valueInputIdx(): number {\n    return 2;\n  }\n\n  protected valueOutputIdx(): number {\n    return 2;\n  }\n\n  protected presentValueType(): Type {\n    return Type.ANY;\n  }\n\n  protected computeTitle(): string {\n    return `MQTT Point (Topic: ${this.settings[this._iTopic].value})`;\n  }\n\n  protected enableDescription(): string {\n    return 'Enable MQTT Point';\n  }\n\n  protected topicInputIdx(): number {\n    return 1;\n  }\n\n  private createMqttPointStoreItem(mqttPoint: SillyMqttPoint): MqttPointStoreItem {\n    return new MqttPointStoreItem(mqttPoint.identifier(), Registry.getId(this.cid, this.id), mqttPoint?.enabled,\n                                  {\n                                    identifier: mqttPoint.publishedTopic(),\n                                    data      : mqttPoint,\n                                    callback  : (data: any) => this.onConvertMessage(data),\n                                  }, {\n                                    identifier: mqttPoint.subscribedTopic(),\n                                    callback  : (msg: any) => this.onReceiveMessage(msg),\n                                  });\n  }\n}\n\nContainer.registerNodeType('protocols/mqtt/mqtt-point', MqttPointNode, MQTT_CLIENT_NODE);\n","import { PointModel, PointValue, PointValueCreator } from '../../../../../backend/models/point-model';\nimport { isJSON, isNull } from '../../../../../utils/helper';\n\nexport interface MqttPoint extends PointModel {\n  mqttTopic: string;\n}\n\nexport class MqttPointCreator {\n  private constructor() {\n  }\n\n  static from = (json: object): MqttPoint => {\n    if (isNull(json)) {\n      return null;\n    }\n    // @ts-ignore\n    let pv = json?.pointValue;\n    // @ts-ignore\n    return MqttPointCreator.by(json?.enabled, json?.mqttTopic,\n                               PointValueCreator.create(pv?.presentValue, pv?.priority, pv?.priorityArray));\n  };\n\n  static by = (enabled: boolean, mqttTopic: string, pointValue: PointValue): MqttPoint => {\n    return new DefaultMqttPoint(enabled, mqttTopic, pointValue);\n  };\n}\n\nclass DefaultMqttPoint implements MqttPoint {\n  enabled: boolean;\n  mqttTopic: string;\n  pointValue: PointValue;\n\n  constructor(enabled: boolean, mqttTopic: string, pointValue: PointValue) {\n    this.enabled = enabled || false;\n    this.mqttTopic = mqttTopic;\n    this.pointValue = pointValue;\n  }\n\n  identifier(): string {\n    return this.mqttTopic;\n  }\n\n  mightOnlyValueChanged(point: MqttPoint): boolean {\n    return this.enabled === point?.enabled && this.mqttTopic === point?.mqttTopic;\n  }\n\n  equals(point: MqttPoint): boolean {\n    return this.identifier() === point?.identifier();\n  }\n}\n\nexport interface MQTTMessage {\n  topic: string;\n  message: any;\n}\n\nexport class MqttPointValue {\n  value: number;\n  priority: number;\n\n  constructor(value: number, priority: number) {\n    this.value = value;\n    this.priority = priority;\n  }\n\n  static by(pv: PointValue): MqttPointValue {\n    return new MqttPointValue(pv?.presentValue, pv?.priority ?? 16);\n  }\n\n  static parse(message: any): MqttPointValue {\n    try {\n      let payload = isJSON(message) ? message : JSON.parse(message);\n      return new MqttPointValue(payload?.value, payload?.priority);\n    } catch (e) {\n      throw new Error('Invalid JSON when parsing MQTTMessage');\n    }\n  }\n\n  to(): PointValue {\n    return PointValueCreator.init(this.value, this.priority);\n  }\n\n  toString() {\n    return JSON.stringify(this);\n  }\n}\n\n//To support NubeIO request/response pattern. It should be removed in future\nexport class SillyMqttPoint extends DefaultMqttPoint implements MqttPoint {\n  readonly isReqRes: boolean = false;\n\n  private constructor(mqttPoint: MqttPoint, isReqRes: boolean) {\n    super(mqttPoint.enabled, mqttPoint.mqttTopic, mqttPoint.pointValue);\n    this.isReqRes = isReqRes;\n  }\n\n  static by = (mqttPoint: MqttPoint, isReqRes: boolean): SillyMqttPoint => {\n    return isNull(mqttPoint) ? null : new SillyMqttPoint(mqttPoint, isReqRes);\n  };\n\n  mightOnlyValueChanged(point: MqttPoint): boolean {\n    return super.mightOnlyValueChanged(point) && this.isReqRes === (<SillyMqttPoint>point)?.isReqRes;\n  }\n\n  subscribedTopic(): string {\n    return this.isReqRes ? `${this.mqttTopic}/req` : this.mqttTopic;\n  }\n\n  publishedTopic(): string {\n    return this.isReqRes ? `${this.mqttTopic}/res` : this.mqttTopic;\n  }\n}\n","import { Constructor, isEmpty, isFunction, isJSON } from '../../../../utils/helper';\nimport {\n  HasCentralizedListener,\n  ICentralizedListener,\n  IMessageConverter,\n  IMessageSubscriber,\n  MockCentralizedListener,\n  NodeStoreItem,\n} from '../../../../utils/pattern';\nimport { Container, Side } from '../../../container';\nimport { Node, NodeSettings} from '../../../node';\nimport { NodeInput, Type } from '../../../node-io';\nimport Registry from '../../../registry';\nimport { AbleEnableNode, NodeInputEvaluation } from '../../node-mixin';\nimport { DependantConnectionNode, DependantConnectionNodeMixin } from '../connection-node-mixin';\nimport {\n  MQTT_CLIENT_NODE,\n  PUBLISH_MQTT_DATA,\n  REGISTER_MQTT_PUBLISHER,\n  REGISTER_MQTT_SUBSCRIBER,\n  UNREGISTER_MQTT_PUBLISHER,\n  UNREGISTER_MQTT_SUBSCRIBER,\n  UPDATE_MQTT_PUBLISHER,\n  UPDATE_MQTT_SUBSCRIBER,\n} from './mqtt-client-node';\n\nfunction MqttGenericNodeMixin<TBase extends Constructor<Node>>(Base: TBase) {\n  abstract class MqttGenericNodeMixinBase extends AbleEnableNode(Base)\n    implements NodeInputEvaluation, HasCentralizedListener {\n    protected readonly _iTopic = 'topic';\n\n    onAdded(): void {\n      if (this.side !== Side.server) {\n        return;\n      }\n      this.handleOnUpdate(this.createPayload());\n      this.updateTitle();\n    }\n\n    onAfterSettingsChange(oldSettings, oldName?): void {\n      if (this.side !== Side.server) {\n        return;\n      }\n      this.handleOnUpdate(this.createPayload(), this.createPayload(oldSettings));\n      this.updateTitle();\n    }\n\n    onInputUpdated(): void {\n      if (this.side !== Side.server) {\n        return;\n      }\n      let prev = this.createPayload();\n      this.reEvaluateSettingByInput(this.inputs, this.settings);\n      this.handleOnUpdate(this.createPayload(), prev);\n      this.updateTitle();\n    }\n\n    onRemoved() {\n      if (this.listener() === MockCentralizedListener.LISTENER) {\n        return;\n      }\n      this.listener().listen({ action: this.unregisterAction(), payload: this.createPayload() });\n    }\n\n    reEvaluateSettingByInput(inputs: { [p: number]: NodeInput }, settings: { [name: string]: NodeSettings }) {\n      settings[this._iTopic].value = inputs[this.topicInputIdx()].updated ? inputs[this.topicInputIdx()].data\n                                                                          : settings[this._iTopic].value;\n      if (isFunction(super['reEvaluateSettingByInput'])) {\n        super['reEvaluateSettingByInput'](inputs, settings);\n      }\n    }\n\n    listener(): ICentralizedListener {\n      return MockCentralizedListener.cast(this.getParentNode());\n    }\n\n    protected abstract topicInputIdx(): number;\n\n    protected abstract updateTitle(): void;\n\n    protected abstract registerAction(): string;\n\n    protected abstract updateAction(): string;\n\n    protected abstract unregisterAction(): string;\n\n    protected abstract doAfterUpdate(current: NodeStoreItem, prev?: NodeStoreItem): any;\n\n    protected mixinMqttTopicInputSetting() {\n      this.addInputWithSettings(this._iTopic, Type.STRING, '', 'MQTT Topic');\n    }\n\n    protected handleOnUpdate(current: NodeStoreItem, prev?: NodeStoreItem): any {\n      if (!prev?.identifier && !current?.identifier) {\n        return;\n      }\n      if (isEmpty(current.identifier)) {\n        throw new Error('Must define MQTT topic');\n      }\n      if (this.shouldRegister(prev)) {\n        this.listener().listen({ action: this.registerAction(), payload: current });\n      } else if (current.identifier !== prev.identifier || current.enabled !== prev.enabled) {\n        current.prev = prev;\n        this.listener().listen({ action: this.updateAction(), payload: current });\n      }\n      this.doAfterUpdate(current, prev);\n    }\n\n    protected createPayload(settings?: NodeSettings): NodeStoreItem {\n      let identifier = (settings ?? this.settings)['topic']?.value;\n      let enabled = settings ? settings[this.enableSettingKey()]?.value : this.isEnabled();\n      return {\n        identifier: identifier,\n        nodeId    : Registry.getId(this.cid, this.id),\n        enabled   : enabled,\n      } as NodeStoreItem;\n    }\n\n    protected shouldRegister(prev: NodeStoreItem) {\n      return !prev || !prev.identifier;\n    }\n\n  }\n\n  return MqttGenericNodeMixinBase;\n}\n\n// Need to mixin to keep call chain to update status\nabstract class MqttGenericNode extends DependantConnectionNodeMixin(MqttGenericNodeMixin(Node))\n  implements DependantConnectionNode, HasCentralizedListener {\n  protected _title: string;\n\n  protected constructor(title: string, description: string) {\n    super();\n    this._title = this.title = title;\n    this.description = description;\n    this.mixinEnableInputSetting();\n    this.mixinConnectionStatusOutput();\n    this.mixinMqttTopicInputSetting();\n  }\n\n  protected statusOutputIdx(): number {\n    return 0;\n  }\n\n  protected enableDescription(): string {\n    return `Enable ${this._title}`;\n  }\n\n  protected updateTitle() {\n    this.title = `${this._title} (${this.settings['topic'].value})`;\n  }\n\n  protected topicInputIdx() {\n    return 1;\n  }\n\n  protected shouldRegister(prev: NodeStoreItem) {\n    return super.shouldRegister(prev) || this.getConnectionStatus().isError();\n  }\n\n  protected handleError(err: Error, func: string) {\n    super.handleError(err, func);\n  }\n}\n\nclass MqttPublisherNode extends MqttGenericNode implements IMessageConverter {\n\n  constructor() {\n    super('MQTT Publisher', `MQTT Publisher Node is used to publish MQTT message for generic purpose`);\n    this.addInputWithSettings('is-json', Type.BOOLEAN, false, 'MQTT Message is JSON type');\n    this.addInputWithSettings('message', Type.ANY, '', 'MQTT Message');\n  }\n\n  onConvertMessage(data: any): string {\n    return isJSON(data) ? JSON.stringify(data) : data?.toString();\n  }\n\n  reEvaluateSettingByInput(inputs: { [p: number]: NodeInput }, settings: { [name: string]: NodeSettings }) {\n    super.reEvaluateSettingByInput(inputs, settings);\n    this.settings['is-json'].value = this.inputs[2].updated ? this.inputs[2].data : this.settings['is-json'].value;\n    this.settings['message'].value = this.inputs[3].updated ? this.inputs[3].data : this.settings['message'].value;\n  }\n\n  protected registerAction(): string {\n    return REGISTER_MQTT_PUBLISHER;\n  }\n\n  protected updateAction(): string {\n    return UPDATE_MQTT_PUBLISHER;\n  }\n\n  protected unregisterAction(): string {\n    return UNREGISTER_MQTT_PUBLISHER;\n  }\n\n  protected createPayload(settings?: NodeSettings): NodeStoreItem {\n    let payload = super.createPayload(settings);\n    payload.callback = data => this.onConvertMessage(data);\n    payload.data = this.settings['message'].value;\n    return payload;\n  }\n\n  protected doAfterUpdate(current: NodeStoreItem, prev?: NodeStoreItem): any {\n    if (isEmpty(current?.data) && (prev?.identifier && current.identifier !== prev.identifier || isEmpty(prev?.data))) {\n      return current;\n    }\n    if (current?.enabled) {\n      if (this.settings['is-json'].value && !isJSON(current.data)) {\n        try {\n          current.data = isEmpty(current.data) ? {} : JSON.parse(current.data);\n        } catch (err) {\n          this.debug(err);\n          throw new Error(`Payload is invalid JSON in MQTT publisher on topic ${current.identifier}`);\n        }\n      }\n      return this.listener().listen({ action: PUBLISH_MQTT_DATA, payload: current });\n    }\n  }\n\n}\n\nclass MqttSubscriberNode extends MqttGenericNode implements IMessageSubscriber {\n  constructor() {\n    super('MQTT Subscriber', `MQTT Subscriber Node is used for generic purpose`);\n    this.addOutput('out', Type.ANY);\n  }\n\n  onReceiveMessage(incomingMessage: any): void {\n    this.setOutputData(this.errorOutputIdx() + 1, incomingMessage);\n  }\n\n  protected registerAction(): string {\n    return REGISTER_MQTT_SUBSCRIBER;\n  }\n\n  protected updateAction(): string {\n    return UPDATE_MQTT_SUBSCRIBER;\n  }\n\n  protected unregisterAction(): string {\n    return UNREGISTER_MQTT_SUBSCRIBER;\n  }\n\n  protected createPayload(settings?: NodeSettings): NodeStoreItem {\n    let payload = super.createPayload(settings);\n    payload.callback = (out: any) => this.onReceiveMessage(out);\n    return payload;\n  }\n\n  protected doAfterUpdate(current: NodeStoreItem, prev?: NodeStoreItem): any {\n\n  }\n}\n\nContainer.registerNodeType('protocols/mqtt/mqtt-subscriber', MqttSubscriberNode, MQTT_CLIENT_NODE);\nContainer.registerNodeType('protocols/mqtt/mqtt-publisher', MqttPublisherNode, MQTT_CLIENT_NODE);\n","import { Node, SettingType} from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { exec } from 'child_process';\nimport * as fs from 'fs';\nimport { Type } from '../../../node-io';\nimport CryptoUtils from '../../../utils/crypto-utils';\n\nclass MqttBroker extends Node {\n  constructor() {\n    super();\n    this.title = 'MQTT Broker';\n    this.description = '.';\n\n    this.addInput('ping broker', Type.STRING);\n    this.addOutput('status', Type.STRING);\n    this.addOutput('error', Type.STRING);\n    this.addOutput('debug', Type.STRING);\n\n    this.settings['enable'] = {\n      description: 'Broker enable',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['authentication'] = {\n      description: 'Use Authentication',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['username'] = { description: 'User name', value: '', type: SettingType.STRING };\n    this.settings['password'] = { description: 'Password', value: '', type: SettingType.PASSWORD };\n    //this.settings['password'] = { description: 'Password', value: '', type: SettingType.STRING };\n\n    this.setSettingsConfig({\n      groups: [\n        { enable: {}, authentication: {} },\n        { username: {}, password: {} },\n      ],\n      conditions: {\n        username: setting => {\n          return !!setting['authentication'].value;\n        },\n        password: setting => {\n          return !!setting['authentication'].value;\n        },\n      },\n    });\n\n    this.properties['useAuthentication'];\n  }\n\n  async onRemoved() {\n    // super.onRemoved();\n    await this.stopBroker()\n      .then(e => {\n        console.log(e);\n      })\n      .catch(err => {\n        console.log(err);\n      });\n  }\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return; // only execute on server\n    const username = this.settings['username'].value;\n    const password = this.settings['password'].value;\n    const decryptPass = { username, password: CryptoUtils.decrypt(password) };\n    console.log('password', decryptPass);\n\n    this.statusBroker()\n      .then(e => {\n        this.setOutputData(0, e);\n        this.setOutputData(1, false);\n      })\n      .catch(err => {\n        this.setOutputData(0, false);\n        this.setOutputData(1, true);\n      });\n  }\n\n  onAfterSettingsChange() {\n    const enable = this.settings['enable'].value;\n    if (enable) {\n      this.startBroker()\n        .then(e => {\n          this.onInputUpdated(); //call to get broker status (TODO not the best but to busy to care)\n        })\n        .catch(err => {\n          this.setOutputData(0, false);\n          this.setOutputData(1, true);\n        });\n\n      this.checkAuthentication();\n    } else if (enable === false) {\n      this.stopBroker()\n        .then(e => {\n          this.onInputUpdated(); //call to get broker status\n        })\n        .catch(err => {\n          this.onInputUpdated(); //call to get broker status\n        });\n    }\n  }\n\n  stopBroker() {\n    return new Promise((resolve, reject) => {\n      let command = `sudo systemctl stop mosquitto`;\n      exec(command, (err, stdout, stderr) => {\n        if (err) {\n          reject({ err, stderr });\n        } else {\n          resolve(stdout);\n        }\n      });\n    });\n  }\n\n  statusBroker() {\n    return new Promise((resolve, reject) => {\n      let command = `ps -A | grep -i mosquitto | grep -v grep`;\n      exec(command, (err, stdout, stderr) => {\n        if (err) {\n          reject(false);\n        } else {\n          resolve(true);\n        }\n      });\n    });\n  }\n\n  startBroker() {\n    return new Promise((resolve, reject) => {\n      let command = `sudo systemctl start mosquitto`;\n      exec(command, (err, stdout, stderr) => {\n        if (err) {\n          console.log(err);\n          reject({ err, stderr });\n        } else {\n          resolve(stdout);\n        }\n      });\n    });\n  }\n\n  checkAuthentication() {\n    const path = '/etc/mosquitto/';\n    const configFile = 'mosquitto.conf';\n    const passwordFile = 'MQTTPasswords.txt';\n    if (this.settings['authentication'].value && !this.properties['useAuthentication']) {\n      this.properties['useAuthentication'] = this.settings['authentication'].value;\n      const username = this.settings['username'].value;\n      const password = this.settings['password'].value;\n      if (!username || !password) {\n        this.setOutputData(1, 'Invalid Credentials');\n        this.debugErr('Invalid Credentials');\n        return;\n      }\n      const command = 'sudo mosquitto_passwd -U ' + path + passwordFile;\n      fs.writeFile(path + passwordFile, username + ':' + password, err => {\n        if (err) {\n          this.setOutputData(1, err);\n          this.debugErr(err);\n          return;\n        }\n        try {\n          exec(command, (err, stdout, stderr) => {\n            if (stdout) {\n              this.setOutputData(1, stdout);\n              this.debugErr(stdout);\n              return;\n            }\n            if (err) {\n              this.setOutputData(1, err);\n              this.debugErr(err);\n              return;\n            }\n            if (stderr) {\n              this.setOutputData(1, stderr);\n              this.debugErr(stderr);\n              return;\n            }\n          });\n          fs.readFile(path + configFile, (err, buff) => {\n            if (err) {\n              this.setOutputData(1, err);\n              this.debugErr(err);\n              return;\n            }\n            let text = buff.toString('utf8');\n            this.setOutputData(2, text);\n            const allowAnonymousIndex = text.indexOf('allow_anonymous ');\n            if (allowAnonymousIndex >= 0) {\n              const allowAnonymous = text.slice(allowAnonymousIndex, allowAnonymousIndex + 22);\n              let allowAnonymousArray = allowAnonymous.split(' ');\n              if (allowAnonymousArray[1] == 'true') allowAnonymousArray[1] = 'false';\n              text.replace(\n                allowAnonymous,\n                allowAnonymousArray[0] + ' ' + allowAnonymousArray[1] + '       \\n',\n              );\n            } else {\n              text += '\\nallow_anonymous true     \\n';\n            }\n            const passwordRefIndex = text.indexOf('password_file ');\n            if (passwordRefIndex >= 0) {\n              const passwordRef = text.slice(passwordRefIndex, passwordRefIndex + 50);\n              let passwordRefArray = passwordRef.split(' ');\n              if (passwordRefArray[1] !== path + passwordFile) {\n                passwordRefArray[1] = path + passwordFile;\n                text = text.replace(\n                  passwordRef,\n                  passwordRefArray[0] + ' ' + passwordRefArray[1] + '       \\n',\n                );\n              }\n            } else {\n              text += '\\npassword_file /etc/mosquitto/MQTTPasswords.txt     \\n';\n            }\n            fs.writeFile(path + configFile, text, err => {\n              if (err) {\n                this.setOutputData(1, err);\n                this.debugErr(err);\n                return;\n              }\n            });\n            exec('sudo systemctl restart mosquitto', (err, stdout, stderr) => {\n              if (stdout) {\n                this.setOutputData(1, stdout);\n                this.debugErr(stdout);\n                return;\n              }\n              if (err) {\n                this.setOutputData(1, err);\n                this.debugErr(err);\n                return;\n              }\n              if (stderr) {\n                this.setOutputData(1, stderr);\n                this.debugErr(stderr);\n                return;\n              }\n            });\n          });\n        } catch (e) {\n          this.setOutputData(1, e);\n          this.debugErr(e);\n          return;\n        }\n      });\n    } else if (!this.settings['authentication'].value && this.properties['useAuthentication']) {\n      this.properties['useAuthentication'] = this.settings['authentication'].value;\n      fs.unlink(path + passwordFile, err => {\n        if (err) {\n          this.setOutputData(2, err);\n          this.debugErr(err);\n          return;\n        }\n      });\n      fs.readFile(path + configFile, (err, buff) => {\n        if (err) {\n          this.setOutputData(1, err);\n          this.debugErr(err);\n          return;\n        }\n        let text = buff.toString('utf8');\n        this.setOutputData(2, text);\n        const allowAnonymousIndex = text.indexOf('allow_anonymous ');\n        if (allowAnonymousIndex >= 0) {\n          const allowAnonymous = text.slice(allowAnonymousIndex, allowAnonymousIndex + 22);\n          let allowAnonymousArray = allowAnonymous.split(' ');\n          if (allowAnonymousArray[1] == 'false') allowAnonymousArray[1] = 'true';\n          text = text.replace(\n            allowAnonymous,\n            allowAnonymousArray[0] + ' ' + allowAnonymousArray[1] + '   ',\n          );\n        } else {\n          text += '\\nallow_anonymous false     \\n';\n        }\n        fs.writeFile(path + configFile, text, err => {\n          if (err) {\n            this.setOutputData(1, err);\n            this.debugErr(err);\n            return;\n          }\n        });\n        exec('sudo systemctl restart mosquitto', (err, stdout, stderr) => {\n          if (stdout) {\n            this.setOutputData(1, stdout);\n            this.debugErr(stdout);\n            return;\n          }\n          if (err) {\n            this.setOutputData(1, err);\n            this.debugErr(err);\n            return;\n          }\n          if (stderr) {\n            this.setOutputData(1, stderr);\n            this.debugErr(stderr);\n            return;\n          }\n        });\n      });\n    }\n  }\n}\n\nContainer.registerNodeType('protocols/mqtt-broker/mqtt-broker', MqttBroker);\n","import { Node} from '../../../node';\nimport { Container } from '../../../container';\nimport { Type } from '../../../node-io';\n\nclass MqttTopicPartsNode extends Node {\n  constructor() {\n    super();\n    this.title = 'MQTT topic extractor';\n    this.description =\n      `## Description\\n ` +\n      ` The is node is used to extract sections out of an MQTT topic\\n `+\n      `## Settings\\n ` +\n      ` Index will let you select the part of the topic that you want to extract ***topic/abc/123*** \\n `+\n      ` For example if the ***topic*** = ***topic/abc/123***  and ***index*** = 1 the the node ***output*** will = ***abc*** \\n `+\n      `## Inputs\\n ` +\n      ` The input data must be a sting and in a topic format like ***topic/abc/123*** \\n `+\n      `## Outputs\\n ` +\n      ` ***output*** will return the ***index*** selection \\n `+\n      ` ***output-all*** (Returns an array) will return all the topic parts\\n `+\n      ` For example if the ***topic*** = ***topic/abc/123***  the  ***output-all*** will return ***[topic, abc, 123]***\\n `\n    this.addInput('input', Type.STRING);\n    this.addInputWithSettings('index', Type.NUMBER, 0, 'Index', false);\n    this.addOutput('output', Type.STRING);\n    this.addOutput('output-all', Type.JSON);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const text = this.getInputData(0);\n    const index = this.getInputData(1);\n    if (text != null && index != null) {\n      const topic = text.split('/')\n      this.setOutputData(0, topic[index], true);\n      this.setOutputData(1, topic, true);\n    } else {\n      this.setOutputData(0, null, true);\n      this.setOutputData(1, null, true);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\n\nContainer.registerNodeType('protocols/mqtt/mqtt-topic-extractor', MqttTopicPartsNode);\n","import { Container } from '../../../container';\nimport { FlexibleNode } from '../../../flexible-node';\nimport { Type } from '../../../node-io';\n\nclass MQTTTopicBuilderNode extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.STRING;\n    super.dynamicInputsStartName = 'string';\n    this.title = 'MQTT Topic Builder';\n    this.description =\n      \"This node takes String inputs and concatenates/joins them with '/' to produce an MQTT Topic 'output'.   The number of inputs can be modified from settings.\";\n    this.addOutput('output', Type.STRING);\n    this.setOutputData(0, null);\n  }\n\n  onAdded() {\n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const inputs = this.getInputsCount();\n    let output = '';\n    for (let i = this.dynamicInputStartPosition; i < inputs; i++) {\n      const value = (this.getInputData(i) || '').toString(); // making string null i.e `''` and other `null` same\n      if (value != ''){\n        if(output != '') output = output.concat('/');\n        output = output.concat(value);\n        //if(i !== (inputs - 1)) output = output.concat('/');\n      }\n    }\n    this.setOutputData(0, output, true);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\n\nContainer.registerNodeType('protocols/mqtt/topic-builder', MQTTTopicBuilderNode);\n","import { Node, SettingType} from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { Type } from '../../../node-io';\nimport SerialUtils from '../../../utils/serial-utils';\nconst SerialPort = require('serialport');\n\nclass SerialConnectorNode extends Node {\n  baudRates = [110, 300, 600, 1200, 2400, 4800, 9600, 14400, 19200, 38400, 57600, 115200, 128000, 256000];\n  isConnected = false;\n  port = null;\n\n  constructor() {\n    super();\n    this.title = 'Serial Connector';\n      this.description =\n      `## Description\\n ` +\n      ` This node reads/writes serial data from/to the onboard serial ports.  These ports can be RS485 ports, or Rubix Compute wireless interface ports.  Once the Port and Baud Rate settings are configured, when enabled, the output will be raw messages received over the configured serial port.  Any values written to the writeValue input will be sent on the configured serial port.\\n ` +\n      `   \\n ` +\n      `## Nube LoRa Raw Baud Rate\\n ` +\n      ` Default Baud Rate For Nube LoRa Raw is ***38400*** \\n `\n    this.addInput('writeValue', Type.STRING);\n    this.addInput('enable', Type.BOOLEAN);\n    this.addInput('list-ports', Type.BOOLEAN);\n    // this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addOutput('output', Type.STRING);\n    this.addOutput('error', Type.STRING);\n    this.addOutput('status', Type.BOOLEAN);\n    this.addOutput('last-message', Type.STRING);\n    this.addOutput('active-ports', Type.BOOLEAN);\n\n    this.settings['port'] = {\n      description: 'Serial Port',\n      value: '/dev/ttyUSB2',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: '/dev/ttyUSB2', text: 'RS485-1 (/dev/ttyUSB2)' },\n          { value: '/dev/ttyUSB3', text: 'RS485-2 (/dev/ttyUSB3)' },\n          { value: '/dev/ttyUSB1', text: 'Xbee-1 (/dev/ttyUSB1)' },\n          { value: '/dev/ttyUSB0', text: 'Xbee-2 (/dev/ttyUSB0)' },\n          { value: '/dev/ttyAMA0', text: 'Xbee-3 (/dev/ttyAMA0)' },\n          { value: '/dev/ttyUSB4', text: 'USB Port (/dev/ttyUSB4)' },\n          { value: '/dev/ttyS1', text: 'Edge28 Expansion (/dev/ttyS1)' },\n        ],\n      },\n    };\n    this.settings['baudRate'] = {\n      description: 'Baud rate',\n      value: this.baudRates[6],\n      type: SettingType.DROPDOWN,\n      config: {\n        items: this.baudRates.map(baudRate => {\n          return { value: baudRate, text: baudRate };\n        }),\n      },\n    };\n    this.setOutputData(0, null);\n    this.setOutputData(1, false);\n    this.setOutputData(2, null);\n  }\n\n  onInputUpdated() {\n    if (!this.isConnected) {\n      this.connectToSerialPort();\n    } else if (this.isConnected && !this.getInputData(1)) {\n      this.isConnected = false;\n      this.clearOutputs();\n      this.closePort();\n      return;\n    }\n\n    this.writePortData(this.getInputData(0));\n\n    if (this.getInputData(2) === true) {\n      this.listPorts();\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.connectToSerialPort();\n  }\n\n  onRemoved() {\n    this.closePort();\n  }\n\n  connectToSerialPort() {\n    if (this.side !== Side.server) return;\n\n    this.clearOutputs();\n    this.closePort();\n\n    if (!this.getInputData(1)) return;\n\n    let portName = this.settings['port'].value;\n    let baudRate = this.settings['baudRate'].value;\n\n    if (!portName) {\n      this.debugErr('Port name is not defined!');\n      this.setOutputData(1, 'Port name is not defined!');\n      return;\n    }\n\n    this.port = new SerialPort(portName, { baudRate: baudRate, autoOpen: false });\n\n    this.port.on('open', () => {\n      this.isConnected = true;\n      this.setOutputData(2, this.isConnected);\n      this.debugInfo('Port connected');\n    });\n\n    this.port.on('error', err => {\n      this.port = null; // this.port contains a serial object but it can't close since it never been opened\n      this.isConnected = false;\n      this.setOutputData(1, err.message);\n      this.setOutputData(2, this.isConnected);\n      this.debugErr(err.message);\n    });\n\n    this.port.on('close', () => {\n      this.debugInfo(this.isConnected ? 'Port closed. Gateway disconnected.' : 'Port closed');\n      this.isConnected = false;\n      this.setOutputData(2, this.isConnected);\n    });\n\n    this.port.on('disconnect', () => {\n      this.isConnected = false;\n      this.setOutputData(2, this.isConnected);\n      this.debugInfo('Disconnected');\n    });\n\n    const Readline = SerialPort.parsers.Readline;\n    const parser = this.port.pipe(new Readline({ delimiter: '\\n' }));\n    parser.on('data', data => this.readPortData(data));\n\n    this.debugInfo('Connecting to ' + portName + ' at ' + baudRate + '...');\n    this.port.open();\n  }\n\n  private clearOutputs() {\n    this.setOutputData(0, null);\n    this.setOutputData(1, null);\n    this.setOutputData(2, false);\n  }\n\n  private listPorts() {\n    SerialUtils.listPorts()\n      .then(e => {\n        this.setOutputData(4, e);\n      })\n      .catch(err => {\n        this.setOutputData(4, err);\n      });\n  }\n\n  private closePort() {\n    if (this.port) {\n      this.port.close();\n    }\n    this.port = null;\n  }\n\n  private readPortData(data) {\n    this.setOutputData(0, data);\n    this.setOutputData(3, this.formattedExecutionTime());\n  }\n\n  private writePortData(message) {\n    if (message) {\n      //TODO: temporary fix\n      //  any byte over 128 gets message up (nodejs serialPort must use signed bytes for strings for some dumb reason...)\n      //  best solution is to be able to send an array to this (typeof [1,2,3] === 'object')\n      //  couldn't get it working for now so sending to this node as a JSON string for now\n      try {\n        message = Buffer.from(JSON.parse(message));\n      } catch (e) {}\n\n      try {\n        this.port.write(message);\n      } catch (e) {\n        this.setOutputData(1, e.message);\n      }\n    }\n  }\n}\n\nContainer.registerNodeType('protocols/misc/serial-connector', SerialConnectorNode);\n","const SerialPort = require('serialport');\n\nexport default class SerialUtils {\n  /**\n   * Get a list of active serial ports on linux\n   * @returns {object}\n   */\n\n  static listPorts() {\n    return new Promise<Array<any>>((resolve, reject) => {\n      try {\n        let portList = [];\n        SerialPort.list().then(ports => {\n          ports.forEach(port => {\n            portList.push(port);\n          });\n          resolve(portList);\n        });\n      } catch (err) {\n        reject(err);\n      }\n    });\n  }\n}\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport UuidUtils from '../../utils/uuid-utils';\nimport * as moment from 'moment-timezone';\nimport { ScheduleUtils } from './schedule-utils';\n\nclass WeeklyScheduleNode extends Node {\n  daysArray = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];\n\n  constructor() {\n    super();\n    this.title = 'Weekly Schedule';\n    this.description = 'Weekly Schedule';\n\n    this.addOutput('output', Type.BOOLEAN);\n\n    this.settings['enable'] = {\n      description: 'Schedule Enable',\n      value: true,\n      type: SettingType.BOOLEAN,\n    };\n\n    this.settings['stringScheduleName'] = {\n      //description: 'Schedule Name String',\n      description: 'Schedule Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    this.settings['timezone'] = {\n      description: 'TIMEZONE: Enter the timezone',\n      value: moment.tz.guess(),\n      type: SettingType.STRING,\n    };\n\n    this.settings['startHour'] = {\n      description: 'Start Time',\n      value: 7,\n      type: SettingType.DROPDOWN,\n      config: {\n        items: this.makeHoursDropdown(),\n      },\n    };\n    this.settings['startMin'] = {\n      description: '',\n      value: 0,\n      type: SettingType.DROPDOWN,\n      config: {\n        items: this.makeMinsDropdown(),\n      },\n    };\n\n    this.settings['endHour'] = {\n      description: 'End Time',\n      value: 19,\n      type: SettingType.DROPDOWN,\n      config: {\n        items: this.makeHoursDropdown(),\n      },\n    };\n    this.settings['endMin'] = {\n      description: '',\n      value: 0,\n      type: SettingType.DROPDOWN,\n      config: {\n        items: this.makeMinsDropdown(),\n      },\n    };\n\n    this.settings['sunday'] = {\n      description: 'sunday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['monday'] = {\n      description: 'monday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['tuesday'] = {\n      description: 'tuesday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['wednesday'] = {\n      description: 'wednesday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['thursday'] = {\n      description: 'thursday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['friday'] = {\n      description: 'friday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['saturday'] = {\n      description: 'saturday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n\n    this.settings['payload'] = {\n      description: 'Schedule Payload',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n\n    this.setSettingsConfig({\n      groups: [\n        { startHour: {}, startMin: {} },\n        { endHour: {}, endMin: {} },\n      ],\n    });\n  }\n\n  onAdded() {\n    this.onAfterSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    var scheduleOutput = { weekly: {}, events: {} };\n    if (!this.settings['enable'].value) return scheduleOutput;\n    const schedID = UuidUtils.createUUID();\n    const tzOffset = moment.tz(this.settings['timezone'].value).utcOffset();\n    const offsetHours = Math.floor(tzOffset / 60);\n    const offsetMins = tzOffset % 60;\n    var rolloverFlag = 0;\n    var startHourUTC = this.settings['startHour'].value - offsetHours;\n    if (startHourUTC < 0) {\n      rolloverFlag = -1;\n      startHourUTC = startHourUTC + 24;\n    } else if (startHourUTC > 24) {\n      rolloverFlag = 1;\n      startHourUTC = startHourUTC - 24;\n    }\n    var startMinsUTC = this.settings['startMin'].value - offsetMins;\n    if (startMinsUTC < 0) startMinsUTC = startMinsUTC + 60;\n    else if (startMinsUTC >= 60) startMinsUTC = startMinsUTC - 60;\n    var endHourUTC = this.settings['endHour'].value - offsetHours;\n    if (endHourUTC < 0) {\n      endHourUTC = endHourUTC + 24;\n    } else if (endHourUTC > 24) {\n      endHourUTC = endHourUTC - 24;\n    }\n    var endMinsUTC = this.settings['endMin'].value - offsetMins;\n    if (endMinsUTC < 0) endMinsUTC = endMinsUTC + 60;\n    else if (endMinsUTC >= 60) endMinsUTC = endMinsUTC - 60;\n\n    const sundayIndex = this.settings['sunday'].value && rolloverFlag == -1 ? 7 : 0;\n    const saturdayIndex = this.settings['saturday'].value && rolloverFlag == 1 ? -1 : 6;\n    var daysOutput = [];\n    this.settings['sunday'].value ? daysOutput.push(this.daysArray[sundayIndex + rolloverFlag]) : null;\n    this.settings['monday'].value ? daysOutput.push(this.daysArray[1 + rolloverFlag]) : null;\n    this.settings['tuesday'].value ? daysOutput.push(this.daysArray[2 + rolloverFlag]) : null;\n    this.settings['wednesday'].value ? daysOutput.push(this.daysArray[3 + rolloverFlag]) : null;\n    this.settings['thursday'].value ? daysOutput.push(this.daysArray[4 + rolloverFlag]) : null;\n    this.settings['friday'].value ? daysOutput.push(this.daysArray[5 + rolloverFlag]) : null;\n    this.settings['saturday'].value ? daysOutput.push(this.daysArray[saturdayIndex + rolloverFlag]) : null;\n\n    scheduleOutput.weekly = {\n      [schedID]: {\n        colour: '#FFFFFF',\n        name: this.settings['stringScheduleName'].value || 'unknownSchedule',\n        start: `${String(startHourUTC).padStart(2, '0')}:${String(startMinsUTC).padStart(2, '0')}`,\n        end: `${String(endHourUTC).padStart(2, '0')}:${String(endMinsUTC).padStart(2, '0')}`,\n        days: daysOutput,\n        value: this.settings['payload'].value,\n        id: schedID,\n      },\n    };\n    this.setOutputData(0, scheduleOutput);\n  }\n\n  makeHoursDropdown() {\n    var hoursArray = [];\n    for (var h = 0; h < 24; h++) {\n      hoursArray.push({ value: h, text: String(h).padStart(2, '0') });\n    }\n    return hoursArray;\n  }\n\n  makeMinsDropdown() {\n    var minsArray = [];\n    for (var m = 0; m < 60; m++) {\n      minsArray.push({ value: m, text: String(m).padStart(2, '0') });\n    }\n    return minsArray;\n  }\n}\n\nContainer.registerNodeType('schedule/weekly-schedule', WeeklyScheduleNode);\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\nimport UuidUtils from '../../utils/uuid-utils';\nimport * as moment from 'moment-timezone';\nimport { ScheduleUtils } from './schedule-utils';\n\nclass ScheduleMergeNode extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicSettingsExist = false;\n    this.dynamicInputsType = Type.STRING;\n    this.title = 'Weekly Schedule';\n    this.description = 'Weekly Schedule';\n\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('error', Type.STRING);\n  }\n\n  onAdded() {\n    this.onAfterSettingsChange();\n  }\n\n  onInputUpdated() {\n    var weeklyOutput = {};\n    var eventOutput = {};\n    var inputString;\n    var inputObject;\n    for (var i = 0; i < this.getInputsCount(); i++) {\n      inputString = this.getInputData(i);\n      if (!inputString) continue;\n      try {\n        inputObject = JSON.parse(inputString);\n        for (var weeklySched in inputObject.weekly) {\n          weeklyOutput[weeklySched] = inputObject.weekly[weeklySched];\n        }\n        for (var eventSched in inputObject.events) {\n          weeklyOutput[eventSched] = inputObject.events[eventSched];\n        }\n        this.setOutputData(0, { weekly: weeklyOutput, events: eventOutput });\n      } catch (e) {\n        this.setOutputData(1, e);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\n\nContainer.registerNodeType('schedule/schedule-merge', ScheduleMergeNode);\n","//import * as moment from 'moment';\nimport * as moment from 'moment-timezone';\nimport { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport { ScheduleUtils } from './schedule-utils';\nimport TimeUtils from '../../utils/time-utils';\n\n/**\n * ScheduleChecker checks the schedule is active or not on current time\n * This node is for checking a formatted schedule JSON: SCHEDULE_MODE.INPUT\n * https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\n */\nexport class ScheduleChecker extends Node {\n  nextStart;\n  nextStop;\n  schedulePayload;\n  constructor() {\n    super();\n    this.title = 'Schedule Checker (unconfigured)';\n    this.description =\n      'This node checks the API-Schedule output string for active schedules that match the selected Schedule Name setting.  output will be true when the matching schedule is active and enable is true; otherwise output will be false.  nextStart is the timestamp output of the next scheduled start time.  nextStop is the timestamp output of the next scheduled stop time.  lastCheck is the timestamp output of the last time a schedule check was run.  error output will be true if there is an error while checking the schedule input string; otherwise error will be false.  The frequency that schedules are checked can be modified with the Schedule Check Interval setting (set in millis).  The Timestamp Output Format setting can be adjusted to output timestamps as strings or as Epoch Timestamps.  String timestamps will be displayed in the timezone specified by the Timezone setting.';\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable', false);\n    this.addInput('schedules', Type.JSON);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('payload', Type.BOOLEAN);\n    this.addOutput('nextStart', Type.STRING);\n    this.addOutput('nextStop', Type.STRING);\n    this.addOutput('lastCheck', Type.STRING);\n    this.addOutput('error', Type.STRING);\n    /*\n    this.settings['scheduleName'] = {\n      description: 'Select Schedule',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [],\n      },\n      value: '',\n    };\n    this.settings['includeStringName'] = {\n      description: \"Use 'Schedule Name String' from Below\",\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    */\n\n    this.settings['stringScheduleName'] = {\n      //description: 'Schedule Name String',\n      description: 'Schedule Name',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    this.settings['timezone'] = {\n      description: 'TIMEZONE: Enter the timezone',\n      value: moment.tz.guess(),\n      type: SettingType.STRING,\n    };\n\n    this.settings['interval'] = {\n      description: 'Schedule Check Interval (minimum 10 seconds)',\n      value: 30,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n\n    this.settings['numericTimeFormat'] = {\n      description: 'Timestamp Output Format',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: false, text: 'Timestamps as Strings' },\n          { value: true, text: 'Timestamps as Epoch Numerics' },\n        ],\n      },\n      value: false,\n    };\n\n    this.nextStart = null;\n    this.nextStop = null;\n    this.schedulePayload = null;\n    this.EXECUTE_INTERVAL = 10000;\n  }\n\n  async onAdded() {\n    await this.updateTitle();\n    await this.onInputUpdated();\n  }\n\n  async onInputUpdated() {\n    if (this.side !== Side.server) return;\n    let input = this.getInputData(1) || { weekly: {}, events: {} };\n\n    /*  FOR USE WITH DROPDOWN SCHEDULE SELECTION\n    let weeklyInput = input['weekly'];\n    let eventsInput = input['events'];\n    console.log(weeklyInput, 'schedule weeklyInput');\n    console.log(eventsInput, 'schedule eventsInput');\n    const scheduleNameItems = [];\n    weeklyInput &&\n      Object.keys(weeklyInput).forEach(key => {\n        scheduleNameItems.push(weeklyInput[key].name);\n      });\n    eventsInput &&\n      Object.keys(eventsInput).forEach(key => {\n        if (!scheduleNameItems.includes(eventsInput[key]['name'])) {\n          scheduleNameItems.push(eventsInput[key]['name']);\n        }\n      });\n    // What if the intended schedule isn't in the current JSON when configuring? Can set a 'Schedule Name String' from settings.\n    if (\n      this.settings['includeStringName'].value &&\n      this.settings['stringScheduleName'].value != '' &&\n      !scheduleNameItems.includes(this.settings['stringScheduleName'].value)\n    ) {\n      scheduleNameItems.push(this.settings['stringScheduleName'].value);\n    }\n    console.log(scheduleNameItems, 'scheduleNameItems');\n    let settingsItems = [];\n    scheduleNameItems.forEach(scheduleName => {\n      settingsItems.push({\n        value: scheduleName,\n        text: scheduleName,\n      });\n    });\n    this.settings['scheduleName'].config.items = settingsItems;\n    this.broadcastSettingsToClients();\n    if (scheduleNameItems.length == 0) {\n      this.settings['scheduleName'].value = null;\n      this.setOutputData(0, false, true);\n      this.setOutputData(1, null, true);\n      this.setOutputData(2, null, true);\n      this.setOutputData(3, null, true);\n      this.setOutputData(4, moment(this.executeLastTime).format('YYYY-MM-DDTHH:MM:ss'), true);\n      this.setOutputData(5, true, true);\n      console.log('Schedule Checker Error: no schedule selected');\n      return;\n    } else if (!scheduleNameItems.includes(this.settings['scheduleName'].value)) {\n      this.settings['scheduleName'].value = null;\n      this.setOutputData(0, false, true);\n      this.setOutputData(1, null, true);\n      this.setOutputData(2, null, true);\n      this.setOutputData(3, null, true);\n      this.setOutputData(4, moment(this.executeLastTime).format('YYYY-MM-DDTHH:MM:ss'), true);\n      this.setOutputData(5, false, true);\n      return;\n    }\n    */\n\n    await this.setOutput(input);\n  }\n\n  async onExecute() {\n    await this.setOutput();\n  }\n\n  async updateTitle() {\n    if (\n      this.settings['stringScheduleName'].value != null &&\n      this.settings['stringScheduleName'].value != ''\n    ) {\n      this.title = `Schedule Checker (${this.settings['stringScheduleName'].value})`;\n    } else this.title = 'Schedule Checker (unconfigured)';\n    this.broadcastTitleToClients();\n  }\n\n  async onAfterSettingsChange() {\n    await this.updateTitle();\n    let interval = this.settings['interval'].value;\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    this.EXECUTE_INTERVAL = Math.max(interval, 10000);\n    await this.onInputUpdated();\n  }\n\n  private async setOutput(input = null) {\n    this.nextStart = null;\n    this.nextStop = null;\n    this.schedulePayload = null;\n    if (!input) input = this.getInputData(1) || { weekly: {}, events: {} };\n    console.log('input1', input)\n\n\n    //const key = this.settings['scheduleName'].value;   FOR USE WITH DROPDOWN SCHEDULE SELECTION\n    const key = this.settings['stringScheduleName'].value;\n    console.log('key', key)\n    if (key == null || key === '') {\n      this.setOutputData(0, false);\n      this.setOutputData(1, null);\n      this.setOutputData(2, null);\n      this.setOutputData(3, null);\n      this.setOutputData(4, moment(this.executeLastTime).format('YYYY-MM-DDTHH:MM:ss'));\n      this.setOutputData(5, 'Schedule Checker Error: invalid schedule selected');\n      return;\n    }\n\n    //const now = moment();\n    let timeZone = this.settings['timezone'].value;\n    if (!moment.tz.zone(timeZone)) {\n      timeZone = moment.tz.guess();\n    }\n    const now = moment.tz(timeZone);\n    console.log('now', now.format())\n    //const now = moment('2020-01-21T07:00:00.000+05:00')\n    //const now = moment.tz(\"2020-03-27T01:30\", 'Canada/Pacific');    //for testing\n    //const now = moment.tz(\"2020-03-26T12:30\", 'Australia/Sydney');  //for testing\n    //const now = moment.tz(\"2020-09-25T04:30\", timeZone);            //for testing\n    //console.log(\"now\", now.format())\n\n    const isEnabled = this.getInputData(0);\n    if (input && key && isEnabled) {\n      let weeklyOutput = false;\n      let weeklyScheduleOutput = null;\n      for (var sched in input['weekly']) {\n        if (input['weekly'][sched]['name'] === key) {\n          weeklyScheduleOutput = ScheduleUtils.checkWeeklySchedule(input['weekly'][sched], now); // returns {scheduleStatus, nextStart, nextStop value}\n          weeklyOutput = weeklyScheduleOutput.scheduleStatus || weeklyOutput;\n          this.schedulePayload = weeklyScheduleOutput.value || this.schedulePayload;\n          if (weeklyScheduleOutput.nextStop != null) {\n            if (this.nextStop == null || weeklyScheduleOutput.nextStop.isBefore(this.nextStop)) {\n              this.nextStop = weeklyScheduleOutput.nextStop;\n            }\n          }\n          if(weeklyScheduleOutput.nextStart != null){\n            if (this.nextStart == null || weeklyScheduleOutput.nextStart.isBefore(this.nextStart)) {\n              this.nextStart = weeklyScheduleOutput.nextStart;\n            }\n          }\n        }\n      }\n\n      let eventsOutput = false;\n      let eventScheduleOutput = null;\n      for (var sched in input['events']) {\n        if (input['events'][sched]['name'] === key) {\n          eventScheduleOutput = ScheduleUtils.checkEventsSchedule(input['events'][sched], now); // returns {scheduleStatus, nextStart, nextStop, value}\n          eventsOutput = eventScheduleOutput.scheduleStatus || eventsOutput;\n          this.schedulePayload = eventScheduleOutput.value || this.schedulePayload;\n          if (eventScheduleOutput.nextStop != null) {\n            if (eventScheduleOutput.nextStop.isBefore(this.nextStop) || this.nextStop == null)\n              this.nextStop = eventScheduleOutput.nextStop;\n          }\n          if (eventScheduleOutput.nextStart != null) {\n            if (eventScheduleOutput.nextStart.isBefore(this.nextStart) || this.nextStart == null)\n              this.nextStart = eventScheduleOutput.nextStart;\n          }\n        }\n      }\n      const output = weeklyOutput || eventsOutput;\n\n      this.setOutputData(0, output);\n      this.setOutputData(1, this.schedulePayload);\n      if (this.nextStart != null) {\n        if (!this.settings['numericTimeFormat'].value)\n          this.setOutputData(2, this.nextStart.tz(timeZone).format());\n        else this.setOutputData(2, this.nextStart.valueOf());\n      } else this.setOutputData(2, null);\n\n      if (this.nextStop != null) {\n        if (!this.settings['numericTimeFormat'].value)\n          this.setOutputData(3, this.nextStop.tz(timeZone).format());\n        else this.setOutputData(3, this.nextStop.valueOf());\n      } else this.setOutputData(3, null);\n    } else {\n      this.setOutputData(0, false);\n      this.setOutputData(1, null);\n      this.setOutputData(2, null);\n      this.setOutputData(3, null);\n    }\n    if (!this.settings['numericTimeFormat'].value) {\n      this.setOutputData(\n        4,\n        moment(this.executeLastTime)\n          .tz(timeZone)\n          .format(),\n      );\n    } else this.setOutputData(4, moment(this.executeLastTime).valueOf());\n    this.setOutputData(5, false);\n  }\n}\nContainer.registerNodeType('schedule/schedule-checker', ScheduleChecker);\n","import * as moment from 'moment-timezone';\nimport Utils from '../../utils';\n\nexport class ScheduleUtils {\n  /**\n   * @param eventSchedule\n   * @param dt: {moment} datetime which is to be compared\n   */\n  static checkEventsSchedule(eventSchedule, dt: moment) {\n    if (eventSchedule && Object.prototype.hasOwnProperty.call(eventSchedule, 'dates')) {\n      let eventOutput = false;\n      let nextOn = null;\n      let nextOff = null;\n      let scheduleValue = null;\n      for (let i = 0; i < eventSchedule.dates.length; i++) {\n        const dtUTC = dt.clone().tz('Etc/UTC'); // remove this line and replace dtUTC with dt once testing is complete\n        const startMoment = moment.tz(eventSchedule.dates[i].start, 'Etc/UTC');\n        const endMoment = moment.tz(eventSchedule.dates[i].end, 'Etc/UTC');\n        //console.log('dtUTC', dtUTC.format('YYYY-MM-DDTHH:MM:ss'));\n        //console.log('startMoment', startMoment.format('YYYY-MM-DDTHH:MM:ss'));\n        //console.log('endMoment', endMoment.format('YYYY-MM-DDTHH:MM:ss'));\n        if (dtUTC.isAfter(startMoment) && dtUTC.isBefore(endMoment)) {\n          //return [true, null, endMoment];\n          eventOutput = true;\n          if (eventSchedule && Object.prototype.hasOwnProperty.call(eventSchedule, 'value'))\n            scheduleValue = eventSchedule.value;\n          if (nextOff == null || endMoment.isBefore(nextOff)) {\n            nextOff = endMoment;\n          }\n        } else if (dtUTC.isBefore(startMoment) && dtUTC.isBefore(endMoment)) {\n          //return [false, startMoment, endMoment];\n          if (nextOn == null || startMoment.isBefore(nextOn)) {\n            nextOn = startMoment;\n          }\n          if (nextOff == null || endMoment.isBefore(nextOff)) {\n            nextOff = endMoment;\n          }\n        }\n      }\n      //return [eventOutput, nextOn, nextOff];\n      return {\n        scheduleStatus: eventOutput,\n        nextStart: nextOn,\n        nextStop: nextOff,\n        value: scheduleValue,\n      };\n    }\n    //return [false, null, null];\n    return { scheduleStatus: false, nextStart: null, nextStop: null, value: null };\n  }\n\n  /**\n   * @param weeklySchedule\n   * @param dt: {moment} datetime which is to be compared\n   */\n  static checkWeeklySchedule(weeklySchedule, dt: moment) {\n    let weeklyOutput = false;\n    let nextOn = null;\n    let nextOff = null;\n    let scheduleValue = null;\n\n    if (weeklySchedule) {\n      //console.log(dt)\n      //console.log('dt', dt.format());\n      const dtUTC = dt.clone().tz('Etc/UTC'); // remove this line and replace dtUTC with dt once testing is complete\n      //console.log(\"dtUTC\", dtUTC.format());\n      //console.log(\"dtUTCday\", dtUTC.isoWeekday());\n      //console.log(\"weeklySchedule.days\", weeklySchedule.days);\n      let daysArray = weeklySchedule.days.map(day => {\n        return Utils.getISOday(day);\n      });\n      //console.log(\"daysArray\", daysArray);\n\n      let startArray = weeklySchedule.start.split(':').map(part => {\n        return Number(part);\n      }); // make the start string into an array of numbers [hour,min]\n      let endArray = weeklySchedule.end.split(':').map(part => {\n        return Number(part);\n      }); // make the end string into an array of numbers [hour,min]\n\n      let rolloverFlag = 0;\n      if (startArray[0] > endArray[0]) {\n        // schedule period runs into next day on UTC\n        rolloverFlag = 1;\n      }\n      //console.log('rolloverFlag', rolloverFlag)\n\n      const date = dtUTC.format('YYYY-MM-DD'); //current date in local (tz) time.\n      //console.log('date', date);\n\n      let startMomentArray = daysArray.map(day => {\n        return moment.tz(`${date}T${weeklySchedule.start}:00.000Z`, 'Etc/UTC').isoWeekday(day);\n      });\n      //console.log(\"startMomentArray\", startMomentArray.map((day)=>{return day.format()}));\n\n      let endMomentArray = daysArray.map(day => {\n        return moment\n          .tz(`${date}T${weeklySchedule.end}:00.000Z`, 'Etc/UTC')\n          .isoWeekday(day + rolloverFlag);\n      });\n      //console.log(\"endMomentArray\", endMomentArray.map((day)=>{return day.format()}));\n\n      // check if any of the end moments are more than a week past current moment.\n      // This is for the edge case where there is a sunday that rolls over into a monday.\n      //if (rolloverFlag && endMomentArray.some((end)=>{return dtUTC.add(1, 'week').isBefore(end)})){\n      if (rolloverFlag) {\n        for (let i = 0; i < endMomentArray.length; i++) {\n          if (\n            dtUTC\n              .clone()\n              .add(1, 'weeks')\n              .isBefore(endMomentArray[i])\n          ) {\n            //endMomentArray[i] = endMomentArray[i].subtract(1, 'weeks');\n            endMomentArray[i].subtract(1, 'weeks');\n            //startMomentArray[i] = startMomentArray[i].subtract(1, 'weeks');\n            startMomentArray[i].subtract(1, 'weeks');\n            //console.log(\"Sunday->Monday Rollover Edge Case\")\n            //console.log(\"startMomentArray\", startMomentArray.map((day)=>{return day.format()}));\n            //console.log(\"endMomentArray\", endMomentArray.map((day)=>{return day.format()}));\n            break;\n          }\n        }\n      }\n\n      // check if all of the start and end moments are before the current moment\n      if (\n        startMomentArray.every(start => {\n          return start.isBefore(dtUTC);\n        }) &&\n        endMomentArray.every(end => {\n          return end.isBefore(dtUTC);\n        })\n      ) {\n        // if so then add a week to all start and end moments\n        //startMomentArray = startMomentArray.map((start)=>{return start.add(1, 'weeks')});\n        startMomentArray.map(start => {\n          return start.add(1, 'weeks');\n        });\n        //endMomentArray = endMomentArray.map((end)=>{return end.add(1, 'weeks')});\n        endMomentArray.map(end => {\n          return end.add(1, 'weeks');\n        });\n        //console.log(\"Added a week to all START and END moments\")\n        //console.log(\"startMomentArray\", startMomentArray.map((day)=>{return day.format()}));\n        //console.log(\"endMomentArray\", endMomentArray.map((day)=>{return day.format()}));\n      }\n      // check if all of the start moments are before the current moment.\n      // This means that the last schedule period is active. There will only be one End time after the last start time.\n      else if (\n        startMomentArray.every(start => {\n          return start.isBefore(dtUTC);\n        })\n      ) {\n        for (let j = 0; j < endMomentArray.length; j++) {\n          if (endMomentArray[j].isBefore(dtUTC)) {\n            endMomentArray[j].add(1, 'weeks');\n            startMomentArray[j].add(1, 'weeks');\n          }\n        }\n      }\n\n      // search the Start and End moments for active schedules, and get nextOn and nextOff times.\n      for (let x = 0; x < startMomentArray.length; x++) {\n        //console.log(\"dtUTC\", dtUTC.format())\n        //console.log(\"startMomentArray[x]\", startMomentArray[x].format())\n        //console.log(\"endMomentArray[x]\", endMomentArray[x].format())\n        if (startMomentArray[x].isBefore(dtUTC) && endMomentArray[x].isAfter(dtUTC)) {\n          weeklyOutput = true;\n          if (weeklySchedule && Object.prototype.hasOwnProperty.call(weeklySchedule, 'value'))\n            scheduleValue = weeklySchedule.value;\n          nextOff = endMomentArray[x];\n          nextOn = startMomentArray[x].add(1, 'weeks');\n        } else if (\n          startMomentArray[x].isAfter(dtUTC) &&\n          (nextOn == null || startMomentArray[x].isBefore(nextOn))\n        ) {\n          nextOn = startMomentArray[x];\n        }\n        if (\n          endMomentArray[x].isAfter(dtUTC) &&\n          (nextOff == null || endMomentArray[x].isBefore(nextOff))\n        ) {\n          nextOff = endMomentArray[x];\n        }\n      }\n      //console.log(\"weeklyOutput\", weeklyOutput)\n      //console.log(\"nextOn\", nextOn.format())\n      //console.log(\"nextOff\", nextOff.format())\n    }\n    //return [weeklyOutput, nextOn, nextOff];\n    return {\n      scheduleStatus: weeklyOutput,\n      nextStart: nextOn,\n      nextStop: nextOff,\n      value: scheduleValue,\n    };\n  }\n}\n\n/*\n * @param weeklySchedule\n * @param dt: {moment} datetime which is to be compared\n */\n/*\n/*\n  static checkWeeklySchedule(weeklySchedule, dt:moment): boolean {\n    // Helper function that shifts the schedule days (weeklySchedule.days): shiftDaysArray(['monday', 'tuesday'], 1) => ['tuesday', 'wednesday']\n    function shiftDaysArray(daysArray:string[], shiftNumber:number) {\n       return daysArray.map((string) => {\n        return moment().day(string).add(shiftNumber,'days').format('dddd').toLowerCase();\n      });\n    }\n    if (weeklySchedule) {\n      //console.log(dt)\n      let tzOffset:number = null;\n      if(dt.hasOwnProperty('_offset')) tzOffset = dt._offset;\n      else tzOffset = 0;\n      const tzOffsetHours = Math.floor(tzOffset/60);\n      const tzOffsetMins = (tzOffset % 60) * Math.sign(tzOffsetHours);\n      let tzone = null;\n      if(dt.hasOwnProperty('_z')){\n        if(dt._z != null){\n          if(dt._z.hasOwnProperty('name')) tzone = dt._z.name;\n        }\n      }\n      if(tzone == null) tzone = 'Etc/UTC';\n      //console.log('tzone', tzone)\n      let daysArray = weeklySchedule.days.map(day => day.toLowerCase());\n      //console.log(\"daysArray1\", daysArray)\n      let startArray = weeklySchedule.start.split(':').map((part)=>{return Number(part)});  // make the start string into an array of numbers [hour,min]\n      let endArray = weeklySchedule.end.split(':').map((part)=>{return Number(part)});  // make the end string into an array of numbers [hour,min]\n      //console.log(\"startArray 1\", startArray)\n      //console.log(\"endArray 1\", endArray)\n      startArray[0] += tzOffsetHours;\n      startArray[1] += tzOffsetMins;\n      endArray[0] += tzOffsetHours;\n      endArray[1] += tzOffsetMins;\n      //console.log(\"startArray 2\", startArray)\n      //console.log(\"endArray 2\", endArray)\n      if (startArray[0] >= 24 && endArray[0] >= 24){\n        startArray[0] -= 24;\n        endArray[0] -= 24;\n        daysArray = shiftDaysArray(daysArray, 1);  //shift days array +1\n      }\n      else if (startArray[0] >= 24 && endArray[0] < 24 && endArray[0] >= 0){\n        startArray[0] -= 24;\n        daysArray = shiftDaysArray(daysArray, 1);  //shift days array +1\n      }\n      else if (startArray[0] < 0 && endArray[0] < 0){\n        startArray[0] += 24;\n        endArray[0] += 24;\n        daysArray = shiftDaysArray(daysArray, -1);  //shift days array -1\n      }\n      else if (endArray[0] < 0 && startArray[0] < 24 && startArray[0] >= 0){\n        endArray[0] += 24;\n      }\n      else if (startArray[0] < 0 && endArray[0] < 24 && endArray[0] >= 0){\n        startArray[0] += 24;\n        daysArray = shiftDaysArray(daysArray, -1);  //shift days array -1\n      }\n      else if (endArray[0] >= 24 && startArray[0] < 24 && startArray[0] >= 0){\n        endArray[0] -= 24;\n      }\n      //console.log(\"daysArray2\", daysArray)\n      //console.log('startArray 3', startArray)\n      //console.log('endArray 3', endArray)\n      \n      const date = dt.format('YYYY-MM-DD');  //current date in local (tz) time.\n      //console.log('date', date);\n      let day = dt.tz(tzone).format('dddd').toLowerCase(); // Sunday, or Monday, or ..\n      //console.log('day', day)\n      //console.log(\"dt\", dt.tz(tzone).format())\n      // make moment objects with the start and end times and the current date\n      const start = moment.tz(`${date}T${startArray[0].toString().padStart(2,'0')}:${startArray[1].toString().padStart(2,'0')}:00`, tzone); \n      //console.log('start', start.format())\n      const end = moment.tz(`${date}T${endArray[0].toString().padStart(2,'0')}:${endArray[1].toString().padStart(2,'0')}:00`, tzone);\n      //console.log('end1', end.format());\n      if (start.isAfter(end)) {   // if the scheduled period runs over into the next day\n        if (daysArray.includes(moment().day(day).subtract(1,'days').format('dddd').toLowerCase())) {    //If daysArray includes the previous day\n          if (dt.isBefore(end)) return true;  // check if we are in the overlap period from the previous day\n        }\n        if (daysArray.includes(day && dt.isAfter(start))) return true; //If we are between the start time and end of the day\n        return false;\n      }\n      else if (daysArray.includes(day)){  \n        if (dt.isAfter(start) && dt.isBefore(end)) return true;\n      }\n  \n    }\n    return false;\n  }\n  */\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport Statistics from './statistics';\n\nclass MinMaxAvgNode extends Statistics {\n  constructor() {\n    super();\n    this.title = 'Min-Max-Avg';\n    this.description =\n      'Outputs the Minimum, Maximum, and Average values of all the (non null) Numeric inputs.  The number of inputs and their values can be modified from settings.';\n    this.addOutput('Min', Type.NUMBER);\n    this.addOutput('Max', Type.NUMBER);\n    this.addOutput('Avg', Type.NUMBER);\n  }\n\n  onInputUpdated() {\n    const data = this.getDefinedInputsOrSettingsValues();\n    const min = Math.min.apply(Math, data);\n    const max = Math.max.apply(Math, data);\n    const count = data.length;\n    const sum = Utils.sum(data);\n    const avg = sum / count;\n\n    this.setOutputData(0, min);\n    this.setOutputData(1, max);\n    this.setOutputData(2, avg);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\n\nContainer.registerNodeType('statistics/min-max-avg', MinMaxAvgNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport Statistics from './statistics';\n\nclass AvgNode extends Statistics {\n  constructor() {\n    super();\n    this.title = 'Average';\n    this.description =\n      'Outputs the Average, Count, and Sum values of all the (non null) Numeric inputs. The number of inputs and their values can be modified from settings.';\n    this.addOutput('Avg', Type.NUMBER);\n    this.addOutput('Count', Type.STRING);\n    this.addOutput('Sum', Type.STRING);\n  }\n\n  onInputUpdated() {\n    const data = this.getDefinedInputsOrSettingsValues();\n    const count = data.length;\n    const sum = Utils.sum(data);\n    let avg = 0;\n    if (count !== 0) {\n      avg = sum / count;\n    }\n\n    this.setOutputData(0, avg);\n    this.setOutputData(1, count);\n    this.setOutputData(2, sum);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('statistics/avg', AvgNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport Statistics from './statistics';\n\nclass MinNode extends Statistics {\n  constructor() {\n    super();\n    this.title = 'Min';\n    this.description =\n      'Outputs the Minimum value of all the (non null) Numeric inputs. The number of inputs and their values can be modified from settings.';\n    this.addOutput('min', Type.NUMBER);\n  }\n\n  onInputUpdated() {\n    const data = this.getDefinedInputsOrSettingsValues();\n    const min = Utils.stat.min(data);\n    this.setOutputData(0, min);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('statistics/min', MinNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport Statistics from './statistics';\n\nclass MaxNode extends Statistics {\n  constructor() {\n    super();\n    this.title = 'Max';\n    this.description =\n      'Outputs the Maximum value of all the (non null) Numeric inputs. The number of inputs and their values can be modified from settings.';\n    this.addOutput('max', Type.NUMBER);\n  }\n\n  onInputUpdated() {\n    const data = this.getDefinedInputsOrSettingsValues();\n    const max = Utils.stat.max(data);\n    this.setOutputData(0, max);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('statistics/max', MaxNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport Statistics from './statistics';\n\nclass SumNode extends Statistics {\n  constructor() {\n    super();\n    this.title = 'Sum';\n    this.description =\n      'Outputs the Sum of all the (non null) Numeric inputs. The number of inputs and their values can be modified from settings.';\n    this.addOutput('sum', Type.NUMBER);\n  }\n\n  onInputUpdated() {\n    const data = this.getDefinedInputsOrSettingsValues();\n    const sum = Utils.stat.sum(data);\n    this.setOutputData(0, sum);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('statistics/sum', SumNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport Statistics from './statistics';\n\nclass MedianNode extends Statistics {\n  constructor() {\n    super();\n    this.title = 'Median';\n    this.description =\n      'Outputs the Median value of all the (non null) Numeric inputs. The number of inputs and their values can be modified from settings.';\n    this.addOutput('median', Type.NUMBER);\n  }\n\n  onInputUpdated() {\n    const data = this.getDefinedInputsOrSettingsValues();\n    const median = Utils.stat.median(data);\n    this.setOutputData(0, median);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('statistics/median', MedianNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport Statistics from './statistics';\n\nclass RangeNode extends Statistics {\n  constructor() {\n    super();\n    this.title = 'range';\n    this.description =\n      'Outputs the Range value (max-min) of all the (non null) Numeric inputs. The number of inputs and their values can be modified from settings.';\n    this.addOutput('range', Type.NUMBER);\n  }\n\n  onInputUpdated() {\n    const data = this.getDefinedInputsOrSettingsValues();\n    const range = Utils.stat.range(data);\n    this.setOutputData(0, range);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('statistics/range', RangeNode);\n","import { SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass RankNode extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicOutputsExist = true;\n    this.dynamicSettingsExist = false;\n    this.dynamicInputsType = Type.NUMBER;\n    super.dynamicOutputsType = Type.NUMBER;\n    this.dynamicDefaultInputs = 5;\n    this.dynamicDefaultOutputs = 3;\n    this.title = 'Rank (Highest)';\n    this.description =\n      'Outputs the ranked highest (max to min), or ranked lowest (min to max) of all the (non null) Numeric inputs.  The number of inputs and the number of outputs can be modified from settings.';\n    this.settings['rank'] = {\n      description: 'Highest or Lowest',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'top', text: 'Rank Highest' },\n          { value: 'bottom', text: 'Rank Lowest' },\n        ],\n      },\n      value: 'top',\n    };\n  }\n\n  onAdded() {\n    this.updateTitle();\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let data = this.getDefinedInputValues();\n    data = data.sort((a, b) => a - b);\n    const outputCount = this.getOutputsCount();\n    if (this.settings['rank'].value === 'bottom') {\n      for (let i = 0; i < outputCount; i++) {\n        this.setOutputData(i, data[i]);\n      }\n    } else {\n      for (let i = 0; i < outputCount; i++) {\n        this.setOutputData(i, data[data.length - (i + 1)]);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    if (Number(this.settings['outputs'].value) > Number(this.settings['inputs'].value)) {\n      this.settings['outputs'].value = Number(this.settings['inputs'].value);\n    }\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n    this.updateTitle();\n  }\n\n  private updateTitle() {\n    if (this.settings['rank'].value === 'top') this.title = 'Rank (Highest)';\n    else if (this.settings['rank'].value === 'bottom') this.title = 'Rank (Lowest)';\n  }\n}\nContainer.registerNodeType('statistics/rank', RankNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport Statistics from './statistics';\n\nclass AnyStatAllNode extends Statistics {\n  constructor() {\n    super();\n    this.title = 'all stats';\n    this.description =\n      'Outputs the Maximum, Minimum, Range, Sum, Mean, Median, Modes, Variance, Standard Deviation, Mean Absolute Deviation, and Z Score values of all the (non null) Numeric inputs. The number of inputs and their values can be modified from settings.';\n    this.addOutput('max', Type.NUMBER);\n    this.addOutput('min', Type.NUMBER);\n    this.addOutput('range', Type.NUMBER);\n    this.addOutput('sum', Type.NUMBER);\n    this.addOutput('mean', Type.NUMBER);\n    this.addOutput('median', Type.NUMBER);\n    this.addOutput('modes', Type.NUMBER);\n    this.addOutput('variance', Type.NUMBER);\n    this.addOutput('standardDeviation', Type.NUMBER);\n    this.addOutput('meanAbsoluteDeviation', Type.NUMBER);\n    this.addOutput('zScores', Type.NUMBER);\n  }\n\n  onInputUpdated() {\n    const a = this.getDefinedInputsOrSettingsValues();\n    this.setOutputData(0, Utils.stat.max(a));\n    this.setOutputData(1, Utils.stat.min(a));\n    this.setOutputData(2, Utils.stat.range(a));\n    this.setOutputData(3, Utils.stat.sum(a));\n    this.setOutputData(4, Utils.stat.mean(a));\n    this.setOutputData(5, Utils.stat.median(a));\n    this.setOutputData(6, Utils.stat.modes(a));\n    this.setOutputData(7, Utils.stat.variance(a));\n    this.setOutputData(8, Utils.stat.standardDeviation(a));\n    this.setOutputData(9, Utils.stat.meanAbsoluteDeviation(a));\n    this.setOutputData(10, Utils.stat.zScores(a));\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\n\nContainer.registerNodeType('statistics/stats-all', AnyStatAllNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass NumbersAverageNode extends Node {\n  values = [];\n  lastReset: boolean;\n  avg: number;\n  constructor() {\n    super();\n    this.title = 'Stream Average';\n    this.description =\n      `## Description\\n ` +\n      ` 'output' is the average of all received Numeric 'input' value.  'output' is reset when 'reset' transitions from 'false' to 'true'. \\n ` +\n      ` ## Reset to null\\n ` +\n      `***Reset to null*** if set to option true and a true value on the node ***reset*** this will reset the node ***output*** to a value of null, If set to false it will keep the last node ***output*** value \\n `\n    this.addInput('value', Type.NUMBER);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n    this.settings['null'] = {\n      description: 'Reset to null',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.lastReset = false;\n  }\n\n  onInputUpdated() {\n    const reset = this.getInputData(1);\n    let val = this.getInputData(0);\n    const resetToNull = this.settings['null'].value;\n    if (reset && !this.lastReset) {\n      if (resetToNull) {\n        this.setOutputData(0, null);\n        this.values = [];\n        this.lastReset = reset;\n      } else {\n        this.values = [];\n        this.setOutputData(0, this.avg);\n        this.lastReset = reset;\n      }\n      return;\n    } else if (!reset && this.lastReset) {\n      this.lastReset = reset;\n      return;\n    }\n    if (val == null) return;\n    this.values.push(val);\n    let sum = this.values.reduce(function (a, b) {\n      return a + b;\n    });\n    let avg = sum / this.values.length;\n    this.avg = avg\n    this.setOutputData(0, this.avg);\n  }\n}\nContainer.registerNodeType('streams/stream-average', NumbersAverageNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass NumbersHighestNode extends Node {\n  val: number;\n  lastReset: boolean;\n  constructor() {\n    super();\n    this.title = 'Stream Highest';\n    this.description =\n      `## Description\\n ` +\n      ` 'output' is the highest received Numeric 'input' value.  'output' is reset when 'reset' transitions from 'false' to 'true'. \\n ` +\n      ` ## Reset to null\\n ` +\n      `***Reset to null*** if set to option true and a true value on the node ***reset*** this will reset the node ***output*** to a value of null, If set to false it will keep the last node ***output*** value \\n `\n\n    this.addInput('input', Type.NUMBER);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n    this.settings['null'] = {\n      description: 'Reset to null',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.lastReset = false;\n    this.val = null;\n  }\n\n  onInputUpdated() {\n    const reset = this.getInputData(1);\n    const resetToNull = this.settings['null'].value;\n    if (reset && !this.lastReset) {\n      if (resetToNull) {\n        this.setOutputData(0, null);\n        this.val = null\n        this.lastReset = reset;\n      } else {\n        this.setOutputData(0, this.val);\n        this.val = null\n        this.lastReset = reset;\n      }\n      return;\n    } else if (!reset && this.lastReset) {\n      this.lastReset = reset;\n      return;\n    }\n\n    let inputVal = this.getInputData(0);\n    if (inputVal == null) return;\n\n    if (this.val == null || this.val < inputVal) {\n      this.val = inputVal;\n      this.setOutputData(0, this.val);\n    }\n  }\n}\nContainer.registerNodeType('streams/stream-highest', NumbersHighestNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass NumbersLowestNode extends Node {\n  val: number;\n  lastReset: boolean;\n\n  constructor() {\n    super();\n    this.title = 'Stream Lowest';\n    this.description =\n      `## Description\\n ` +\n      ` 'output' is the lowest received Numeric 'input' value.  'output' is reset when 'reset' transitions from 'false' to 'true'. \\n ` +\n      ` ## Reset to null\\n ` +\n      `***Reset to null*** if set to option true and a true value on the node ***reset*** this will reset the node ***output*** to a value of null, If set to false it will keep the last node ***output*** value \\n `\n\n    this.addInput('input', Type.NUMBER);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n    this.settings['null'] = {\n      description: 'Reset to null',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.val = null;\n    this.lastReset = false;\n  }\n\n  onInputUpdated() {\n    const reset = this.getInputData(1);\n    const resetToNull = this.settings['null'].value;\n    if (reset && !this.lastReset) {\n      if (resetToNull) {\n        this.setOutputData(0, null);\n        this.val = null\n        this.lastReset = reset;\n      } else {\n        this.setOutputData(0, this.val);\n        this.val = null\n        this.lastReset = reset;\n      }\n      return;\n    } else if (!reset && this.lastReset) {\n      this.lastReset = reset;\n      return;\n    }\n\n    let inputVal = this.getInputData(0);\n    if (inputVal == null) return;\n\n    if (this.val == null || this.val > inputVal) {\n      this.val = inputVal;\n      this.setOutputData(0, this.val);\n    }\n  }\n}\nContainer.registerNodeType('streams/stream-lowest', NumbersLowestNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass NumbersSumNode extends Node {\n  val = 0;\n  lastReset: boolean;\n  constructor() {\n    super();\n    this.title = 'Stream Sum';\n    this.description =\n      `## Description\\n ` +\n      ` output' is the sum of all received Numeric 'input' value.  'output' is reset to 0 when 'reset' transitions from 'false' to 'true'. \\n ` +\n      ` ## Reset to null\\n ` +\n      `***Reset to null*** if set to option true and a true value on the node ***reset*** this will reset the node ***output*** to a value of null, If set to false it will keep the last node ***output*** value \\n `\n    this.addInput('input', Type.NUMBER);\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('output', Type.NUMBER);\n    this.settings['null'] = {\n      description: 'Reset to null',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.lastReset = false;\n  }\n\n  onInputUpdated() {\n    const reset = this.getInputData(1);\n    const resetToNull = this.settings['null'].value;\n    if (reset && !this.lastReset) {\n      if (resetToNull) {\n        this.setOutputData(0, null);\n        this.val = null\n        this.lastReset = reset;\n      } else {\n        this.setOutputData(0, this.val);\n        this.val = 0\n        this.lastReset = reset;\n      }\n      return;\n    } else if (!reset && this.lastReset) {\n      this.lastReset = reset;\n      return;\n    }\n    if (this.inputs[0].updated && this.inputs[0].data != null) this.val += this.inputs[0].data;\n    this.setOutputData(0, this.val, true);\n  }\n}\nContainer.registerNodeType('streams/stream-sum', NumbersSumNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport { FlexibleNode } from '../../flexible-node';\n\nclass StreamMergeNode extends FlexibleNode {\n  val: number;\n  lastReset: boolean;\n\n  constructor() {\n    super();\n    this.dynamicSettingsExist = false;\n    this.dynamicInputsType = Type.ANY;\n    this.title = 'Stream Merge';\n    this.description =\n      \"This node merges multiple inputs into a single stream/output.  Any new 'input' ('in #') value will be passed to 'output'.  The number of inputs can be modified from settings.\";\n    this.addOutput('output', Type.ANY);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n    this.size = this.computeSize();\n  }\n\n  onInputUpdated() {\n    const inputs = this.getInputsCount();\n    for (let i = this.dynamicInputStartPosition; i < inputs; i++) {\n      let inputValue = this.getInputData(i);\n      if (Utils.hasInput(inputValue)) {\n        if (this.inputs[i].updated) {\n          this.setOutputData(0, this.inputs[i].data);\n          return;\n        }\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('streams/stream-merge', StreamMergeNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass GateNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Message Gate';\n    this.description =\n      \"This node can allow(gate open) or block(gate close) the transfer of the 'input' to 'output'.  When 'open' is 'true', 'input' is passed to 'output'.  When 'open' is 'false', 'output' will maintain its last value.  If 'Send null when closed' setting is ticked, 'output' will be 'null' when 'open' is 'false'. \";\n    this.addInput('input', Type.STRING);\n    this.addInput('open', Type.BOOLEAN);\n    this.addOutput('output', Type.STRING);\n    this.settings['send-null'] = {\n      description: 'Send null when closed',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  onInputUpdated() {\n    let key = this.getInputData(1);\n\n    if (key) this.setOutputData(0, this.getInputData(0));\n    else if (this.settings['send-null'].value && this.outputs[0].data != null)\n      this.setOutputData(0, null);\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('streams/gate', GateNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass StackNode extends Node {\n  data = [];\n  lastReset: boolean;\n\n  constructor() {\n    super();\n\n    this.title = 'Stack';\n    this.description =\n      \"'input' values are stored in a list.  Stored 'input' values are passed to 'output' one by one each time 'trigger' transitions from 'false' to 'true'.  'input' values are passed to 'output' in a last-in, first-out order.  Stored 'input' values are deleted when 'clear' transitions from 'false' to 'true'. 'count' is the number of stored 'input' values. \";\n\n    this.addInput('input');\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInput('clear', Type.BOOLEAN);\n    this.addOutput('output');\n    this.addOutput('count', Type.NUMBER);\n    this.lastReset = false;\n  }\n\n  onInputUpdated() {\n    const reset = this.getInputData(2);\n    if (reset && !this.lastReset) {\n      this.data = [];\n      this.setOutputData(0, null);\n      this.setOutputData(1, 0);\n      this.lastReset = reset;\n      return;\n    } else if (!reset && this.lastReset) {\n      this.lastReset = reset;\n      return;\n    }\n\n    if (this.inputs[0].updated && this.inputs[0].data != null) {\n      this.data.push(this.inputs[0].data);\n      this.setOutputData(1, this.data.length);\n    }\n\n    if (this.inputs[1].updated && this.inputs[1].data == true) {\n      let val = this.data.length > 0 ? this.data.pop() : null;\n      this.setOutputData(0, val);\n      this.setOutputData(1, this.data.length);\n    }\n  }\n}\nContainer.registerNodeType('streams/stack', StackNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass QueueNode extends Node {\n  data = [];\n  lastReset: boolean;\n\n  constructor() {\n    super();\n\n    this.title = 'Queue';\n    this.description =\n      \"'input' values are stored in a list.  Stored 'input' values are passed to 'output' one by one each time 'trigger' transitions from 'false' to 'true'.  'input' values are passed to 'output' in a first-in, first-out order.  Stored 'input' values are deleted when 'clear' transitions from 'false' to 'true'. 'count' is the number of stored 'input' values.\";\n\n    this.addInput('input');\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInput('clear', Type.BOOLEAN);\n    this.addOutput('output');\n    this.addOutput('count', Type.NUMBER);\n    this.lastReset = false;\n  }\n\n  onInputUpdated() {\n    const reset = this.getInputData(2);\n    if (reset && !this.lastReset) {\n      this.data = [];\n      this.setOutputData(0, null);\n      this.setOutputData(1, 0);\n      this.lastReset = reset;\n      return;\n    } else if (!reset && this.lastReset) {\n      this.lastReset = reset;\n      return;\n    }\n\n    if (this.inputs[0].updated && this.inputs[0].data != null) {\n      this.data.unshift(this.inputs[0].data);\n      this.setOutputData(1, this.data.length);\n    }\n\n    if (this.inputs[1].updated && this.inputs[1].data == true) {\n      let val = this.data.length > 0 ? this.data.pop() : null;\n      this.setOutputData(0, val);\n      this.setOutputData(1, this.data.length);\n    }\n  }\n}\nContainer.registerNodeType('streams/queue', QueueNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass DelayNode extends Node {\n  delayedValues = [];\n\n  constructor() {\n    super();\n    this.title = 'Stream Delay';\n    this.description =\n      \"input' values are passed to 'output' after a 'delay' period. Each 'input' value is delayed by the same 'delay' period. 'delay' units can be configured from settings. Maximum delay setting is 587 hours.\";\n\n    this.addInput('input');\n    this.addInputWithSettings('delay', Type.NUMBER, 1000, 'Delay (millis)', false);\n    this.addOutput('output');\n\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ delay: { weight: 2 }, time: {} }],\n    });\n  }\n\n  onAdded() {\n    this.inputs[1]['name'] = `[delay] (${this.settings['time'].value})`;\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[1]['name'] = `[delay] (${this.settings['time'].value})`;\n  }\n\n  onInputUpdated() {\n    if (this.inputs[0].updated)\n      this.delayedValues.push({\n        val: this.inputs[0].data,\n        time: Date.now(),\n      });\n  }\n\n  onExecute() {\n    if (this.delayedValues.length == 0) return;\n    let delay = this.getInputData(1);\n    delay = TimeUtils.timeConvert(delay, this.settings['time'].value);\n    const val = this.delayedValues[0];\n    if (Date.now() - val.time >= delay) {\n      this.delayedValues.shift();\n      this.setOutputData(0, val.val);\n      return;\n    }\n  }\n}\nContainer.registerNodeType('streams/stream-delay', DelayNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass DelayMeterNode extends Node {\n  lastTime;\n  lastReset: boolean;\n\n  constructor() {\n    super();\n    this.title = 'Stream Delay meter';\n    this.description =\n      \"This node measures the delay between the incoming events.  Any value sent to 'input' (excluding null) will be accepted.  'ms' output is the time between the lastest 'input', and the previous 'input'.   'ms' is reset when 'reset' transitions from 'false' to 'true'.  'ms' output is in millis.\";\n\n    this.addInput('input');\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('ms', Type.NUMBER);\n    this.lastReset = false;\n  }\n\n  onInputUpdated() {\n    const reset = this.getInputData(1);\n    if (reset && !this.lastReset) {\n      this.lastTime = null;\n      this.setOutputData(0, null);\n      this.lastReset = reset;\n      return;\n    } else if (!reset && this.lastReset) {\n      this.lastReset = reset;\n      return;\n    }\n\n    if (this.inputs[0].updated && this.inputs[0].data != null) {\n      if (this.lastTime != null) {\n        let delay = Date.now() - this.lastTime;\n        this.setOutputData(0, delay);\n      }\n\n      this.lastTime = Date.now();\n    }\n  }\n}\nContainer.registerNodeType('streams/stream-delay-meter', DelayMeterNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass TimeFrequencyMeterNode extends Node {\n  count = 0;\n  countWas = 0;\n  lastReset: boolean;\n\n  constructor() {\n    super();\n    this.title = 'Frequency meter';\n    this.description =\n      \"This node measures the frequency of the incoming 'input' events.  Any value sent to 'input' (excluding null) will be accepted.  'events/sec' output is the average rate received 'input' values.  'events/sec' is reset when 'reset' transitions from 'false' to 'true'.\";\n\n    this.addInput('input');\n    this.addInput('reset', Type.BOOLEAN);\n    this.addOutput('events/sec', Type.NUMBER, undefined, { data: 0 });\n    this.lastReset = false;\n\n    setInterval(() => {\n      if (this.count != this.countWas) {\n        this.setOutputData(0, this.count);\n      }\n      this.countWas = this.count;\n      this.count = 0;\n    }, 1000);\n  }\n\n  onInputUpdated() {\n    const reset = this.getInputData(1);\n    if (reset && !this.lastReset) {\n      this.count = 0;\n      this.countWas = 0;\n      this.setOutputData(0, null);\n      this.lastReset = reset;\n      return;\n    } else if (!reset && this.lastReset) {\n      this.lastReset = reset;\n      return;\n    }\n\n    this.count++;\n  }\n}\nContainer.registerNodeType('streams/frequency-meter', TimeFrequencyMeterNode);\n","import { Node } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport { isString, isNull } from '../../../utils/helper';\nimport tagRefs from '../../utils/points/point-ref-utils';\n\nclass StringCaseAcronymsNode extends Node {\n  constructor() {\n    super();\n    this.title = 'String Case Acronyms';\n    this.description =\n      \"This node will upper case any common HVAC Acronyms, For example it will Upper Fcu to FCU\";\n    this.addInput('input', Type.STRING);\n    this.addOutput('output', Type.STRING);\n    // this.setOutputData(0, null);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    if (!Utils.hasInput(input)) {\n      this.setOutputData(0, null, true);\n      return;\n    }\n    if (isNull(input)) return\n    let result:string;\n    let obj = tagRefs.acronyms\n    if (isString(input)) {\n      for (let key in obj) {\n        if (obj[key].toLowerCase() === input.toLowerCase()) {\n          result = obj[key].toUpperCase()\n        }\n      };\n      this.setOutputData(0, result, true);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n\n\n}\nContainer.registerNodeType('string/string-acronyms', StringCaseAcronymsNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport jsonStringCompare from '../../utils/string-json-compare-utils';\n\nenum compareType {\n  Equals = 'Equals',\n  NotEquals = 'Not Equal',\n  GreaterThanEqual = 'Greater Than Equal',\n  GreaterThan = 'Greater Than',\n  LessThanEqual = 'Less Than Equal',\n  LessThan = 'Less Than',\n  Includes = 'Includes',\n  startsWith = 'Starts With',\n  endsWith = 'Ends With'\n}\nclass StringCompareNode extends Node {\n  constructor() {\n    super();\n    this.title = 'String Compare';\n    this.description =\n      \"This node provides several functions to compare 2 String inputs, with a Boolean 'output'.  Available comparison functions are: Equals, Includes, Starts With, and Ends With.  The comparison function is selected from settings.\";\n\n    this.addInput('input', Type.STRING);\n    this.addInputWithSettings('comparison-to', Type.STRING, '', 'Comparison Value');\n    this.addOutput('match', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.setOutputData(0, null);\n    this.setOutputData(1, null);\n    this.settings['function'] = {\n      description: 'Comparison Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: compareType.Equals, text: compareType.Equals },\n          { value: compareType.NotEquals, text: compareType.NotEquals },\n          { value: compareType.GreaterThanEqual, text: compareType.GreaterThanEqual },\n          { value: compareType.GreaterThan, text: compareType.GreaterThan },\n          { value: compareType.LessThanEqual, text: compareType.LessThanEqual },\n          { value: compareType.LessThan, text: compareType.LessThan },\n          { value: compareType.Includes, text: compareType.Includes },\n          { value: compareType.startsWith, text: compareType.startsWith },\n          { value: compareType.endsWith, text: compareType.endsWith },\n        ],\n      },\n      value: compareType.Equals,\n    };\n    this.settings['isNumber'] = {\n      description: 'Comparison value is a number',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['passNull'] = {\n      description: 'Send null if not a match',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['null'] = {\n      description: 'Block null messages on input',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const string1 = this.getInputData(0);\n    const string2 = this.getInputData(1);\n    const resetToNull = this.settings['null'].value;\n    if (!Utils.hasInput(string1)) {\n      this.setOutputData(0, null);\n      return;\n    }\n    if (string1 === null && !resetToNull) {\n      return;\n    }\n    const out = jsonStringCompare.compare(this, string1, string2)\n    if (out) {\n      this.setOutputData(0, true);\n      this.setOutputData(1, string1);\n    } else if (this.settings['passNull'].value === true) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n    } else {\n      this.setOutputData(0, false);\n      this.setOutputData(1, string1);\n    }\n\n  }\n\n  onAfterSettingsChange() {\n    const inputType = this.settings['function'].value\n    const title = \"String Comparison\"\n    this.title = `${title} Compare (${inputType})`;\n    this.broadcastTitleToClients();\n    this.onInputUpdated();\n  }\n\n\n}\nContainer.registerNodeType('string/string-compare', StringCompareNode);\n\n\n\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass TextCutSubstringNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Substring Cut';\n    this.description =\n      \"This node outputs a portion of a String 'input' defined by the Numeric 'start' and 'length' parameters.  String 'output' is the portion of 'input' starting at index (position) 'start' and continating the next 'length' value of characters.  'start' value of 0 is the beggining of the string.  If a negative 'start' value is given, the substring will be selected from the end of the 'input' string (eg. -1 is the end of the 'input'; -2 is the second to last character of the 'input', ...).\";\n\n    this.addInput('input', Type.STRING);\n    this.addInputWithSettings('start', Type.NUMBER, 0, 'Start', false);\n    this.addInputWithSettings('length', Type.NUMBER, 1, 'Length', false);\n    this.addOutput('output', Type.STRING);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const text = this.getInputData(0);\n    const start = this.getInputData(1);\n    const length = this.getInputData(2);\n    if (text != null && start != null && length != null) {\n      this.setOutputData(0, text.substr(start, length));\n    } else this.setOutputData(0, null);\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('string/cut-substring', TextCutSubstringNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nclass StringJoinNode extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.STRING;\n    super.dynamicInputsStartName = 'string';\n    this.title = 'String Join';\n    this.description =\n      \"This node takes String inputs and concatenates/joins them to produce a String 'output'.   The number of inputs can be modified from settings.\";\n    this.addOutput('output', Type.STRING);\n    this.setOutputData(0, null);\n  }\n\n  onAdded() {\n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const inputs = this.getInputsCount();\n    let output = '';\n    for (let i = this.dynamicInputStartPosition; i < inputs; i++) {\n      output = output.concat(this.getInputData(i));\n    }\n    this.setOutputData(0, output, true);\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\n\nContainer.registerNodeType('string/string-join', StringJoinNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass TextStringLengthNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'String Length';\n    this.description = \"'output' is the number of characters in the given String 'input' value.\";\n\n    this.addInput('input', Type.STRING);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n    if (val != null) this.setOutputData(0, val.length);\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('string/string-length', TextStringLengthNode);\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\n\nclass StringIndexOfNode extends Node {\n  constructor() {\n    super();\n    this.title = 'String Index Of';\n    this.description =\n      \"This node takes String 'input' and 'searchFor'; Numeric 'output' is the index(position) of the first instance of 'searchFor' in 'input'.  Index of 0 is the begginning of the 'input' string. \";\n\n    this.addInputWithSettings('input', Type.STRING, '', 'Input Value', false);\n    this.addInputWithSettings('searchFor', Type.STRING, '', 'Search For Value', false);\n    this.addOutput('startIndex', Type.NUMBER);\n    this.addOutput('endIndex', Type.NUMBER);\n    this.setOutputData(0, null);\n    this.setOutputData(1, null);\n    this.settings['input'] = {\n      description: 'string1 Value',\n      value: '',\n      type: SettingType.STRING,\n    };\n    this.settings['searchFor'] = {\n      description: 'Search For Value',\n      value: '',\n      type: SettingType.STRING,\n    };\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    const searchFor = this.getInputData(1);\n    const index = input.indexOf(searchFor);\n    const length = searchFor.length;\n    if (index < 0) {\n      this.setOutputData(0, null, true);\n      this.setOutputData(1, null, true);\n    } else {\n      this.setOutputData(0, index, true);\n      this.setOutputData(1, index + length, true);\n    }\n  }\n\n  onAfterSettingsChange() {\n    if (this.side !== Side.server) return;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('string/string-index-of', StringIndexOfNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass TextCharAtIndexNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Char at Index';\n    this.description =\n      \"'output' is the character at the Numeric 'index' (position) of String 'input'.  The first character of the String 'input' is 'index' 0. If 'index' is negative, characters will be selected from the end of the 'input' string (eg. -1 is the last character; -2 is the second to last character). 'output' will be 'null' on an invalid 'index'.\";\n\n    this.addInput('input', Type.STRING);\n    this.addInputWithSettings('index', Type.NUMBER, 0, 'Index', false);\n    this.addOutput('output', Type.STRING);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const text = this.getInputData(0);\n    const index = this.getInputData(1);\n    if (text != null && index != null) {\n      if (index === -1) this.setOutputData(0, text.slice(-1));\n      else this.setOutputData(0, text.slice(index, index + 1));\n    } else this.setOutputData(0, null);\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('string/char-at-index', TextCharAtIndexNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass TextSplitStringsNode extends Node {\n  currentIndex = 0;\n  lastStart:boolean;\n  lastNext:boolean;\n\n  constructor() {\n    super();\n\n    this.title = 'String Split';\n    this.description =\n      \"Portions of the String 'input' are sent to the String 'output' sequentially when 'next' trasitions from 'false' to 'true'; these 'output' strings are portions of the 'input' string split by the String 'separator' value.  The Numeric 'left' outputs the number of 'output' strings remaining to be sent.  When 'start' transitions from 'false' to 'true', the 'output' string will go back to the first portion of the 'input' string. \";\n\n    this.addInput('input', Type.STRING);\n    this.addInputWithSettings('separator', Type.STRING, '', 'Separator Value', false);\n    this.addInput('start', Type.BOOLEAN);\n    this.addInput('next', Type.BOOLEAN);\n    this.addOutput('output', Type.STRING);\n    this.addOutput('left', Type.NUMBER);\n    this.setOutputData(0, null);\n    this.setOutputData(1, 0);\n  }\n\n  onCreated() {\n    this.lastStart = false;\n    this.lastNext = false;\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const start = this.getInputData(2) || false;\n    const next = this.getInputData(3) || false;\n\n    if (this.inputs[2].updated && start && !this.lastStart) {\n      this.currentIndex = 0;\n      this.splitNext();\n    }\n    this.lastStart = start;\n\n    if (this.inputs[3].updated && next && !this.lastNext) this.splitNext();\n    this.lastNext = next;\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n\n  splitNext() {\n    const text = this.getInputData(0);\n    const separator = this.getInputData(1);\n    if (text == null || separator == null) return;\n\n    const splittedText = text.split(separator);\n    if (this.currentIndex >= splittedText.length) return;\n\n    this.setOutputData(0, splittedText[this.currentIndex]);\n    this.setOutputData(1, splittedText.length - this.currentIndex - 1);\n\n    this.currentIndex++;\n  }\n}\nContainer.registerNodeType('string/string-split', TextSplitStringsNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport { isString, isNull } from '../../../utils/helper';\nclass StringCaseChangeNode extends Node {\n  conversionFunction;\n  constructor() {\n    super();\n    this.title = 'String Case (Lower)';\n    this.description =\n      \"'output' is the 'input' string with all characters changed to either upper or lower case.  Upper or Lower case can be selected from settings.\";\n\n    this.addInput('input', Type.STRING);\n    this.addOutput('output', Type.STRING);\n    this.setOutputData(0, null);\n    this.settings['function'] = {\n      description: 'Select Case',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'lower', text: 'Lower Case' },\n          { value: 'upper', text: 'Upper Case' },\n          { value: 'first_upper', text: 'First Characters to Upper Case' },\n        ],\n      },\n      value: 'lower',\n    };\n  }\n\n  onAdded() {\n    this.setTitleAndConversionFunction();\n    this.onInputUpdated();\n  }\n\n  toTitleCase = (phrase: string): string => {\n    if (isString(phrase) && !isNull(phrase)) {\n      return phrase\n        .toLowerCase()\n        .split(' ')\n        .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n        .join(' ');\n    } else return null\n  };\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    if (!Utils.hasInput(input)) {\n      this.setOutputData(0, null, true);\n      return;\n    }\n    this.setOutputData(0, this.conversionFunction(input), true);\n  }\n\n  onAfterSettingsChange() {\n    this.setTitleAndConversionFunction();\n    this.onInputUpdated();\n  }\n\n  setTitleAndConversionFunction() {\n    const inputType = this.settings['function'].value;\n    switch (inputType) {\n      case 'first_upper':\n        this.title = 'String Case (First Character to Upper)';\n        this.conversionFunction = s1 => {\n          return this.toTitleCase(s1);\n        };\n        break;\n      case 'lower':\n        this.title = 'String Case (Lower)';\n        this.conversionFunction = s1 => {\n          return s1.toLowerCase();\n        };\n        break;\n      case 'upper':\n        this.title = 'String Case (Upper)';\n        this.conversionFunction = s1 => {\n          return s1.toUpperCase();\n        };\n        break;\n      default:\n        this.title = 'String Case (Lower)';\n        this.conversionFunction = s1 => {\n          return s1.toLowerCase();\n        };\n    }\n  }\n}\nContainer.registerNodeType('string/string-case', StringCaseChangeNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass TextASCIICodeNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'Char to ASCII Code';\n    this.description =\n      \"'output' is the ASCII code of the first character of a given String 'input' value.\";\n\n    this.addInput('input', Type.STRING);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n\n    if (val != null) this.setOutputData(0, val.charCodeAt(0));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('string/char-to-ascii', TextASCIICodeNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass TextASCIICharNode extends Node {\n  constructor() {\n    super();\n\n    this.title = 'ASCII Code to Char';\n    this.description = \"'output' is the character of the given Numeric ASCII code 'input' value.\";\n\n    this.addInput('input', Type.NUMBER);\n    this.addOutput('output', Type.STRING);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let val = this.getInputData(0);\n\n    if (val != null) this.setOutputData(0, String.fromCharCode(val));\n    else this.setOutputData(0, null);\n  }\n}\nContainer.registerNodeType('string/ascii-to-char', TextASCIICharNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass StringBufferNode extends Node {\n  useTrigger: boolean;\n  bufferData: string;\n  lastSend:boolean;\n  lastClear:boolean;\n  lastAdd:boolean;\n\n\n  constructor() {\n    super();\n\n    this.title = 'String Buffer';\n    this.description = '';\n\n    this.addInput('input', Type.STRING);\n    this.addInput('sendBuffer', Type.BOOLEAN);\n    this.addInput('clearBuffer', Type.BOOLEAN);\n    this.addInput('addToBuffer', Type.BOOLEAN);\n    this.addOutput('output', Type.STRING);\n    this.addOutput('currentBuffer', Type.STRING);\n\n    this.settings['useTrigger'] = {\n      description: 'Select a Buffer Input Method',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: true, text: 'Add Input to Buffer When Triggered' },\n          { value: false, text: 'Collect all Input Messages (no Trigger)' },\n        ],\n      },\n      value: true,\n    };\n    this.useTrigger = true;\n    this.bufferData = '';\n  }\n\n  onCreated() {\n    this.lastSend = false;\n    this.lastClear = false;\n    this.lastAdd = false;\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const send = this.getInputData(1) || false;\n    const clear = this.getInputData(2) || false;\n    let addTrigger = false;\n    if (this.useTrigger) addTrigger = this.getInputData(3) || false;\n\n    if (this.inputs[1].updated && send && !this.lastSend) {\n      this.setOutputData(0, this.bufferData);\n      this.bufferData = '';\n    }\n    this.lastSend = send;\n\n    if (this.inputs[2].updated && clear && !this.lastClear) this.bufferData = '';\n    this.lastClear = clear;\n\n    if (\n      (!this.useTrigger && this.inputs[0].updated) ||\n      (this.useTrigger && this.inputs[3].updated && addTrigger && !this.lastAdd)\n    ) {\n      const input = this.getInputData(0);\n      if (input == null) return;\n      this.bufferData += String(input);\n    }\n    this.lastAdd = addTrigger;\n\n    this.setOutputData(1, this.bufferData);\n  }\n\n  onAfterSettingsChange() {\n    const triggerInput = this.settings['useTrigger'].value;\n    if (triggerInput !== this.useTrigger) {\n      if (triggerInput) this.addInput('addToBuffer', Type.BOOLEAN);\n      else this.removeInput(3);\n    }\n    this.useTrigger = triggerInput;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('string/string-buffer', StringBufferNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass BoolSwitchNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Boolean Switch';\n    this.description =\n      \"Boolean 'switch' passes corresponding Boolean input to 'output'.  If 'switch' is 'true', Boolean 'inTrue' value will be passed to 'output'  'inTrue' and 'inFalse' values can be set in settings.\";\n\n    this.addInput('switch', Type.BOOLEAN);\n    this.addInput('[inTrue]', Type.BOOLEAN);\n    this.addInput('[inFalse]', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.settings['inTrue'] = {\n      description: 'True Value',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: false, text: 'false' },\n          { value: true, text: 'true' },\n          { value: null, text: 'null' },\n        ],\n      },\n      value: null,\n    };\n    this.settings['inFalse'] = {\n      description: 'False Value',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: false, text: 'false' },\n          { value: true, text: 'true' },\n          { value: null, text: 'null' },\n        ],\n      },\n      value: null,\n    };\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let select = this.getInputData(0);\n    if (!Utils.hasInput(select)) {\n      this.setOutputData(0, null);\n      return;\n    }\n    let inA = this.getInputData(1);\n    if (!Utils.hasInput(inA)) inA = this.settings['inTrue'].value;\n    let inB = this.getInputData(2);\n    if (!Utils.hasInput(inB)) inB = this.settings['inFalse'].value;\n\n    if (select) this.setOutputData(0, inA);\n    else this.setOutputData(0, inB);\n  }\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('switch/bool-switch', BoolSwitchNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass NumSwitchNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Numeric Switch';\n    this.description =\n      \"Boolean 'switch' passes corresponding Numeric input to 'output'.  If 'switch' is 'true', Numeric 'inTrue' value will be passed to 'output'  'inTrue' and 'inFalse' values can be set in settings.\";\n\n    this.addInput('switch', Type.BOOLEAN);\n    this.addInputWithSettings('inTrue', Type.NUMBER, null, 'True Value');\n    this.addInputWithSettings('inFalse', Type.NUMBER, null, 'False Value');\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let select = this.getInputData(0);\n    if (!Utils.hasInput(select)) {\n      this.setOutputData(0, null);\n      return;\n    }\n    const inA = this.getInputData(1);\n    const inB = this.getInputData(2);\n    if (select) this.setOutputData(0, inA);\n    else this.setOutputData(0, inB);\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('switch/num-switch', NumSwitchNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass StringSwitchNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'String Switch';\n    this.description =\n      \"Boolean 'switch' passes corresponding String input to 'output'.  If 'switch' is 'true', String 'inTrue' value will be passed to 'output'  'inTrue' and 'inFalse' values can be set in settings.\";\n\n    this.addInput('switch', Type.BOOLEAN);\n    this.addInputWithSettings('inTrue', Type.STRING, '', 'True Value');\n    this.addInputWithSettings('inFalse', Type.STRING, '', 'False Value');\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let select = this.getInputData(0);\n    if (!Utils.hasInput(select)) {\n      this.setOutputData(0, null);\n      return;\n    }\n    const inA = this.getInputData(1);\n    const inB = this.getInputData(2);\n    if (select) this.setOutputData(0, inA);\n    else this.setOutputData(0, inB);\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('switch/string-switch', StringSwitchNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport { FlexibleNode } from '../../flexible-node';\n\nclass BoolSelectNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.BOOLEAN;\n    super.dynamicInputStartPosition = 1;\n    this.title = 'Boolean Select';\n    this.description =\n      \"Numeric integer 'select' passes corresponding Boolean input to 'output'.  If 'select' is 2, 'in 2' will be passed to 'output' (likewise for other integer 'select' values). If the 'select' value does not have a corresponding 'in #' value, 'output' value will be 'null'.  The number of inputs and their values can be modified from settings.\";\n    this.addInput('select', Type.NUMBER);\n    this.addOutput('output', Type.BOOLEAN);\n  }\n\n  onAdded() {\n \n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const select = this.getInputData(0);\n    if (\n      !Utils.hasInput(select) ||\n      select < this.dynamicInputStartPosition ||\n      select > this.getInputsCount() - this.dynamicInputStartPosition\n    ) {\n      this.setOutputData(0, null);\n      return;\n    }\n    this.setOutputData(0, this.getInputData(select));\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('switch/bool-select', BoolSelectNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport { FlexibleNode } from '../../flexible-node';\n\nclass NumSelectNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.NUMBER;\n    super.dynamicInputStartPosition = 1;\n    this.title = 'Numeric Select';\n    this.description =\n      \"Numeric integer 'select' passes corresponding Numeric input to 'output'.  If 'select' is 2, 'in 2' will be passed to 'output' (likewise for other integer 'select' values). If the 'select' value does not have a corresponding 'in #' value, 'output' value will be 'null'.  The number of inputs and their values can be modified from settings.\";\n    this.addInput('select', Type.NUMBER);\n    this.addOutput('output', Type.NUMBER);\n  }\n\n  onAdded() {\n \n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const select = this.getInputData(0);\n    if (\n      !Utils.hasInput(select) ||\n      select < this.dynamicInputStartPosition ||\n      select > this.getInputsCount() - this.dynamicInputStartPosition\n    ) {\n      this.setOutputData(0, null);\n      return;\n    }\n    this.setOutputData(0, this.getInputData(select));\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('switch/num-select', NumSelectNode);\n","import { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport { FlexibleNode } from '../../flexible-node';\n\nclass StringSelectNode extends FlexibleNode {\n\n  constructor() {\n    super();\n    this.dynamicInputsType = Type.STRING;\n    super.dynamicInputStartPosition = 1;\n    this.title = 'String Select';\n    this.description =\n      \"Numeric integer 'select' passes corresponding String input to 'output'.  If 'select' is 2, 'in 2' will be passed to 'output' (likewise for other integer 'select' values). If the 'select' value does not have a corresponding 'in #' value, 'output' value will be 'null'.  The number of inputs and their values can be modified from settings.\";\n    this.addInput('select', Type.NUMBER);\n    this.addOutput('output', Type.STRING);\n  }\n\n  onAdded() {\n \n    this.size = this.computeSize();\n    this.onInputUpdated();\n  }\n\n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const select = this.getInputData(0);\n    if (\n      !Utils.hasInput(select) ||\n      select < this.dynamicInputStartPosition ||\n      select > this.getInputsCount() - this.dynamicInputStartPosition\n    ) {\n      this.setOutputData(0, null);\n      return;\n    }\n    this.setOutputData(0, this.getInputData(select));\n  }\n\n  onAfterSettingsChange() {\n    super.onAfterSettingsChange();\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('switch/string-select', StringSelectNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nexport class BoolOutputSelectNode extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicOutputsExist = true;\n    this.dynamicInputsExist = false;\n    this.dynamicSettingsExist = false;\n    super.dynamicOutputsType = Type.BOOLEAN;\n    this.title = 'Boolean Output Select';\n    this.description =\n      \"Numeric integer 'select' passes Boolean 'input' to the corresponding Boolean 'output'.  If 'select' is 2, 'input' will be passed to 'out 2' (likewise for other integer 'select' values). If the 'select' value does not have a corresponding 'out #' value, no values will be passed.  The number of outputs  can be modified from settings.\";\n    this.addInput('select', Type.NUMBER);\n    this.addInput('input', Type.BOOLEAN);\n  }\n\n  onInputUpdated() {\n    let active = this.getInputData(0);\n    let val = this.getInputData(1);\n\n    if (active < 0 || active >= this.getOutputsCount()) {\n      this.debugWarn('Defined active output does not exist');\n      return;\n    }\n\n    this.setOutputData(active, val);\n  }\n}\nContainer.registerNodeType('switch/bool-output-select', BoolOutputSelectNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nexport class NumOutputSelectNode extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicOutputsExist = true;\n    this.dynamicInputsExist = false;\n    this.dynamicSettingsExist = false;\n    super.dynamicOutputsType = Type.NUMBER;\n    this.title = 'Numeric Output Select';\n    this.description =\n      \"Numeric integer 'select' passes Numeric 'input' to the corresponding Numeric 'output'. If 'select' is 2, 'input' will be passed to 'out 2' (likewise for other integer 'select' values). If the 'select' value does not have a corresponding 'out #' value, no values will be passed. The number of outputs can be modified from settings.\";\n    this.addInput('select', Type.NUMBER);\n    this.addInput('input', Type.NUMBER);\n  }\n\n  onInputUpdated() {\n    let active = this.getInputData(0);\n    let val = this.getInputData(1);\n\n    if (active < 0 || active >= this.getOutputsCount()) {\n      this.debugWarn('Defined active output does not exist');\n      return;\n    }\n\n    this.setOutputData(active, val);\n  }\n}\nContainer.registerNodeType('switch/num-output-select', NumOutputSelectNode);\n","import { Container } from '../../container';\nimport { FlexibleNode } from '../../flexible-node';\nimport { Type } from '../../node-io';\n\nexport class StringOutputSelectNode extends FlexibleNode {\n  constructor() {\n    super();\n    this.dynamicOutputsExist = true;\n    this.dynamicInputsExist = false;\n    this.dynamicSettingsExist = false;\n    super.dynamicOutputsType = Type.STRING;\n    this.title = 'String Output Select';\n    this.description =\n      \"Numeric integer 'select' passes String 'input' to the corresponding String 'output'. If 'select' is 2, 'input' will be passed to 'out 2' (likewise for other integer 'select' values). If the 'select' value does not have a corresponding 'out #' value, no values will be passed. The number of outputs can be modified from settings.\";\n    this.addInput('select', Type.NUMBER);\n    this.addInput('input', Type.STRING);\n  }\n\n  onInputUpdated() {\n    let active = this.getInputData(0);\n    let val = this.getInputData(1);\n\n    if (active < 0 || active >= this.getOutputsCount()) {\n      this.debugWarn('Defined active output does not exist');\n      return;\n    }\n    this.setOutputData(active, val);\n  }\n}\nContainer.registerNodeType('switch/string-output-select', StringOutputSelectNode);\n","import { Node} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport OsUtils from '../../utils/os-utils';\n\nclass HostInfo extends Node {\n  constructor() {\n    super();\n    this.title = 'Host Info';\n    this.description =\n      `## Description\\n ` +\n      ` This node outputs various linux system information\\n ` +\n      ` More Info:  https://docs.nube-iiot.com/en/nodes/home#host-info\\n ` +\n      `   \\n ` +\n      `## On change of settings\\n ` +\n      `   \\n ` +\n      ` On change of settings output ***system-info*** will return data in json format\\n ` +\n      `## On active Input\\n ` +\n      `   \\n ` +\n      ` On an active input ***trigger*** the outputs ***cpu-temp***, ***disc-usage***, ***system-time***, ***system-memory*** will return data in json format\\n ` +\n      `## The data returned\\n ` +\n      `   \\n ` +\n      ` On change of settings output ***system-info*** will return data in json format\\n ` +\n      `   \\n `;\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('system-info', Type.JSON);\n    this.addOutput('cpu-temp', Type.JSON);\n    this.addOutput('disc-usage', Type.JSON);\n    this.addOutput('system-time', Type.JSON);\n    this.addOutput('system-memory', Type.JSON);\n    this.addOutput('error', Type.STRING);\n  }\n\n  onCreated() {\n    this.onAfterSettingsChange();\n  }\n\n  callSystemInfo() {\n    OsUtils.systemInfo()\n      .then(e => this.setOutputData(0, e))\n      .catch(err => this.setOutputData(5, err));\n  }\n\n  callInfo() {\n    OsUtils.cpuTemperature()\n      .then(e => this.setOutputData(1, e))\n      .catch(err => this.setOutputData(5, err));\n    OsUtils.fsSize()\n      .then(e => this.setOutputData(2, e))\n      .catch(err => this.setOutputData(5, err));\n    OsUtils.systemTime()\n      .then(e => this.setOutputData(3, e))\n      .catch(err => this.setOutputData(5, err));\n    OsUtils.systemMem()\n      .then(e => this.setOutputData(4, e))\n      .catch(err => this.setOutputData(5, err));\n  }\n\n  onAfterSettingsChange() {\n    if (this.side !== Side.server) return;\n    this.callSystemInfo();\n  }\n\n  onInputUpdated() {\n    if (this.side !== Side.server) return;\n    this.callInfo();\n  }\n}\nContainer.registerNodeType('system/host-info', HostInfo);\n","module.exports = require(\"systeminformation\");","import { SettingType } from '../../node';\nimport { ContainerNode } from '../../container-node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport OsUtils from '../../utils/os-utils';\nimport FileUtils from '../../utils/file-utils';\nimport UuidUtils from '../../utils/uuid-utils';\nimport config from '../../../config';\n\nclass PlatNode extends ContainerNode {\n  // haystack site\n  haystackSite = {\n    id: { description: 'enter site id', value: 'My ID', type: SettingType.STRING },\n  };\n\n  haystackAbout = {\n    serverName: OsUtils.hostName(),\n    productVersion: OsUtils.getCurrentWiresVersion(),\n  };\n\n  // global settings\n  globalSettings = {\n    units: ['metric, imperial'],\n    vendorName: 'Nube IO',\n  };\n\n  constructor(container) {\n    super(container);\n    this.title = 'Platform';\n    this.description =\n      'This node provides global settings for the Wires instance. It should be added to the main(root) Editor Pane of each Wires instance. Client ID and Device ID are used by each node with a history logging configuration to store data.';\n\n    this.addInputWithSettings('clientId', Type.STRING, 'client id', 'client id', false);\n    this.addInputWithSettings('siteId', Type.STRING, 'site id', 'site id', false);\n    this.addInputWithSettings('clientName', Type.STRING, 'client name', 'Client Name', false);\n    this.addInputWithSettings('siteName', Type.STRING, 'site name', 'Site/Building Name', false);\n    this.addInputWithSettings('siteAddress', Type.STRING, '123 my street', 'Site/Building Address', false);\n    this.addOutput('device-id', Type.STRING);\n    this.addOutput('client-id', Type.STRING);\n    this.addOutput('site-id', Type.STRING);\n    this.addOutput('wires-version', Type.STRING);\n    this.addOutput('output-json', Type.JSON);\n    this.settings['deviceIdType'] = {\n      description: 'Device ID Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: false, text: 'Fixed ID' },\n          { value: true, text: 'Custom ID' },\n        ],\n      },\n      value: false,\n    };\n\n    this.settings['deviceIDFixed'] = {\n      description: 'Fixed Device ID',\n      value: 'unknownDeviceID',\n      type: SettingType.READONLY,\n    };\n\n    this.settings['deviceIDcustom'] = {\n      description: 'Custom Device ID',\n      value: '',\n      type: SettingType.STRING,\n    };\n\n    this.settings['serverName'] = {\n      description: 'serverName',\n      value: '',\n      type: SettingType.READONLY,\n    };\n    this.settings['productVersion'] = {\n      description: 'productVersion',\n      value: '',\n      type: SettingType.READONLY,\n    };\n\n    this.setSettingsConfig({\n      groups: [],\n      conditions: {\n        deviceIDFixed: setting => {\n          return !setting['deviceIdType'].value;\n        },\n        deviceIDcustom: setting => {\n          return !!setting['deviceIdType'].value;\n        },\n      },\n    });\n\n    this.properties['deviceID'] = {};\n  }\n\n  async onAdded() {\n    super.onAdded();\n    await this.haystackAbout.serverName.then(e => {\n      this.settings['serverName'].value = e;\n      this.broadcastSettingsToClients();\n    });\n    await this.haystackAbout.productVersion.then(e => {\n      this.settings['productVersion'].value = e;\n      this.broadcastSettingsToClients();\n      this.setOutputData(3, e); // wires version\n    });\n\n    await this.onAfterSettingsChange(null);\n  }\n\n  async onInputUpdated() {\n    await this.onAfterSettingsChange(null);\n  }\n\n  async onAfterSettingsChange(oldSettings) {\n    super.onAfterSettingsChange(oldSettings);\n    if (this.side !== Side.server) return; // only execute on server\n    await this.doUUIDSteps();\n    this.properties['deviceID'] = this.settings['deviceIdType'].value\n      ? this.settings['deviceIDcustom'].value\n      : this.settings['deviceIDFixed'].value;\n    this.persistSettings();\n    this.setOutputData(0, this.properties['deviceID']);\n    this.setOutputData(1, this.getInputData(0)); // client-id\n    this.setOutputData(2, this.getInputData(1)); // site-id\n    const out = {\n      deviceID: this.properties['deviceID'],\n      clientID: this.getInputData(0), // client-id\n      siteID: this.getInputData(1), // site-id\n      clientName: this.getInputData(2), // client-name\n      siteName: this.getInputData(3), // site-name\n      siteAddress: this.getInputData(4), // site-address\n    };\n    this.setOutputData(4, out); // json\n  }\n\n  persistSettings() {\n    if (!this.container.db) return;\n    this.container.db.updateNode(this.id, this.container.id, {\n      $set: {\n        settings: this.settings,\n        properties: this.properties,\n      },\n    });\n  }\n\n  async doUUIDSteps() {\n    const fileName = 'deviceUUID.txt';\n    const dirPath = `${config.dataDir}/ids`;\n    const filePath = `${dirPath}/${fileName}`;\n    const isOldFileExist = await FileUtils.checkForOldDirectory(filePath);\n    if (!isOldFileExist) {\n      const isUUIDFile = await UuidUtils.isUUIDFile(filePath);\n      if (!isUUIDFile) {\n        try {\n          await UuidUtils.makeUUIDFile(dirPath, fileName);\n        } catch (e) {\n          this.debugErr(e);\n        }\n      }\n    }\n    await this.getDeviceUUID(filePath);\n  }\n\n  async getDeviceUUID(filePath) {\n    try {\n      const data = await FileUtils.readFile(filePath);\n      this.settings['deviceIDFixed'].value = data.toString().trim();\n      this.broadcastSettingsToClients();\n    } catch (e) {\n      this.debugWarn(e);\n    }\n  }\n}\nContainer.registerNodeType('system/platform', PlatNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nconst os = require('os');\n\nfunction getSysInfo(val) {\n  switch (val) {\n    case 0:\n      return os.totalmem() / 1048576;\n    case 1:\n      return os.freemem() / 1048576;\n    case 2:\n      return os.networkInterfaces();\n    case 3:\n      return os.hostname();\n    case 4:\n      return os.platform();\n    case 5:\n      return os.uptime();\n    case 6:\n      return os.homedir();\n    case 7:\n      return os.arch();\n    case 8:\n      return os.loadavg();\n    default:\n      return;\n  }\n}\n\nclass SystemInfo extends Node {\n  constructor() {\n    super();\n    this.title = 'System Info';\n    this.description =\n      'This node outputs various linux system information.  Once a system property has been selected from settings, a false to true transition on the trigger input will update the output.  error will display error information if the request is not successful.';\n    // this.headerColor = '#4A37EE37';\n    // this.iconImageUrl = 'images/node-editor/icons/function/function.svg';\n\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('output', Type.STRING);\n    this.addOutput('error', Type.STRING);\n    this.settings['output-type'] = {\n      description: 'Output type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'total memory' },\n          { value: 1, text: 'free memory' },\n          { value: 2, text: 'Network Interfaces' },\n          { value: 3, text: 'hostname' },\n          { value: 4, text: 'platform' },\n          { value: 5, text: 'uptime in sec' },\n          { value: 6, text: 'home dir' },\n          { value: 7, text: 'arch' },\n          { value: 8, text: 'System load average' },\n        ],\n      },\n    };\n  }\n\n  onCreated() {\n    this.onAfterSettingsChange();\n  }\n\n  onAdded() {\n    this.updateTitle();\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n    if (!this.settings['output-type'].value) return;\n    this.updateTitle();\n  }\n\n  private updateTitle() {\n    const settingsConfig = this.settings['output-type'].config.items;\n    const settingsText = [JSON.stringify(this.settings['output-type'].value)];\n    const filteredNodeSettings = Object.keys(settingsConfig)\n      .filter(key => settingsText.includes(key))\n      .reduce((obj, key) => {\n        obj[key] = settingsConfig[key].text;\n        return obj;\n      }, {});\n\n    const settingValue = this.settings['output-type'].value;\n    this.title = 'System Info' + ' ' + '(' + filteredNodeSettings[settingValue] + ')';\n  }\n\n  onInputUpdated() {\n    const outType = this.settings['output-type'].value;\n    try {\n      let call = getSysInfo(outType);\n      this.setOutputData(0, call);\n      this.setOutputData(1, false);\n    } catch (e) {\n      this.setOutputData(1, true);\n    }\n  }\n}\nContainer.registerNodeType('system/system-info', SystemInfo);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nclass SystemBeepNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Beep';\n    this.description =\n      'This node plays a default system sound on the server (not in the browser) when trigger transitions from false to true.';\n\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('error', Type.STRING);\n  }\n\n  onInputUpdated() {\n    try {\n      if (this.getInputData(0) == true) process.stderr.write('\\x07');\n      this.setOutputData(0, false);\n    } catch (e) {\n      this.setOutputData(0, true);\n    }\n  }\n}\nContainer.registerNodeType('system/beep', SystemBeepNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { exec } from 'child_process';\nimport { Type } from '../../node-io';\nimport { isNull } from '../../../utils/helper';\nclass SystemExecuteNode extends Node {\n  lastTrigger:boolean;\n\n  constructor() {\n    super();\n    this.title = 'Execute Command';\n    this.description =\n      'This node triggers commands to be run on the linux host.  The string input command input will be run when trigger transitions from false to true.      NOTE: ONLY USE THIS NODE IF YOU KNOW EXACTLY WHAT YOU ARE DOING. SYSTEM COMMANDS CAN CHANGE SYSTEM CONFIGURATION WHICH CANNOT BE FIXED FROM WITHIN WIRES.  YOU COULD BREAK WIRES, THE CONTROLLER, OR YOUR PC. ';\n\n    this.addInputWithSettings('command', Type.STRING, 'pwd', 'Linux Command', false);\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('out stdout', Type.STRING);\n    this.addOutput('out err', Type.STRING);\n    this.addOutput('out stderr', Type.STRING);\n    this.addOutput('error', Type.STRING);\n  }\n\n  onCreated(){\n    this.lastTrigger = false;\n  }\n\n  // example cmd to run a nodejs script cd /home/aidan/ && node lora-reset.js\n  onInputUpdated() {\n    const trigger = this.getInputData(1) || false;\n    if (this.inputs[1].updated && trigger && !this.lastTrigger) {\n      const command = this.getInputData(0);\n      if(isNull(command))return;\n\n      try {\n        exec(command, (err, stdout, stderr) => {\n          if (stdout) {\n            // this.debugErr(stdout);\n            this.setOutputData(0, stdout);\n            this.setOutputData(3, false);\n          }\n          if (err) {\n            // this.debugInfo(err);\n\n            this.setOutputData(1, err);\n            this.setOutputData(3, true);\n          }\n          if (stderr) {\n            this.setOutputData(2, stderr);\n            this.setOutputData(3, true);\n          }\n        });\n      } catch (e) {\n        this.setOutputData(3, true);\n      }\n    }\n    this.lastTrigger = trigger;\n  }\n}\nContainer.registerNodeType('system/execute-cmd', SystemExecuteNode);\n","import { Node} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\n\nclass FlowExport extends Node {\n  constructor() {\n    super();\n    this.title = 'Flow Export';\n    this.description =\n      'A node to export the wires flow to JSON when trigger values gets changed to true from different state';\n    this.addOutput('output', Type.STRING);\n    this.addInput('trigger', Type.BOOLEAN);\n  }\n\n  init() {\n    if (!this.properties) {\n      this.properties['lastTrigger'] = false;\n    }\n  }\n\n  onInputUpdated() {\n    if (this.side != Side.server) return;\n    const input: boolean = this.getInputData(0);\n    if (this.properties['lastTrigger'] !== input && input) {\n      const container = Container.containers[0];\n      container.db.getNodes((err, docs) => {\n        if (!err) {\n          this.setOutputData(0, JSON.stringify(docs));\n        } else {\n          this.debugErr(` Node id [ ${this.cid}/${this.id} ] has error: ${err.message}.`);\n        }\n      });\n    }\n    this.properties['lastTrigger'] = input;\n    this.persistProperties(false, true);\n  }\n}\nContainer.registerNodeType('system/flow-export', FlowExport);\n","import { Node, SettingType, NodeState} from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { Type } from '../../../node-io';\nimport Utils from '../../../utils';\nimport IpAddressUtils from '../../../utils/ip-address-utils';\nimport { exec } from 'child_process';\nimport OsUtils from '../../../utils/os-utils';\nimport NodeColours from '../../../utils/nodes/node-colour-change';\nclass UpdateIPEdge28 extends Node {\n  timeStamp = Utils.getTimeStamp();\n  interfaceEth0 = 'eth0'; //eth0 //wlp3s0\n\n  //outputs\n  eth0Ip = 0;\n  messageOutput = 2;\n  errorOutput = 3;\n\n  constructor() {\n    super();\n    this.title = 'Network Interface EdgeIO-28';\n    this.description =\n      'This node is used to configure the network (IP) interface for edge28 controllers.  Changes made to settings will only be saved if Save changes on save is toggled ON.  In some cases a reboot will be required to save the changes, if Reboot is toggled ON, then clicking save will reboot the controller.        NOTE: Making changes on a remote device could cause the device to become inaccessible.';\n    this.addInput('get interface address', Type.BOOLEAN);\n    this.addInput('enable eth0 ', Type.BOOLEAN);\n    this.addOutput('ip eth0', Type.STRING);\n    this.addOutput('message', Type.STRING);\n    this.addOutput('error', Type.STRING);\n\n    this.settings['writeChanges'] = {\n      description: 'Save changes on save',\n      type: SettingType.BOOLEAN,\n      value: false,\n    };\n\n    this.settings['reboot'] = {\n      description: 'Optional Reboot. Warning this will reboot the device',\n      type: SettingType.BOOLEAN,\n      value: false,\n    };\n\n    this.settings['eth0_group'] = {\n      description: 'Eth Port 0',\n      value: '',\n      type: SettingType.GROUP,\n    };\n\n    this.settings['interfaceTypeEth0'] = {\n      description: 'Interface Type eth0',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'DHCP' },\n          { value: 1, text: 'Static' },\n        ],\n      },\n      value: 0,\n    };\n    this.settings['newIpEth0'] = {\n      description: 'IP',\n      value: '192.168.0.40',\n      type: SettingType.STRING,\n    };\n\n    this.settings['netNetmaskEth0'] = {\n      description: 'Netmask eth0',\n      value: '255.255.255.0',\n      type: SettingType.STRING,\n    };\n    this.settings['newGatewayEth0'] = {\n      description: 'Gateway',\n      value: '192.168.0.1',\n      type: SettingType.STRING,\n    };\n\n    this.settings['newNameServerEth0'] = {\n      description: 'Name Servers eth0',\n      value: '8.8.8.8',\n      type: SettingType.STRING,\n    };\n\n    this.setSettingsConfig({\n      groups: [\n        { newIpEth0: {}, netNetmaskEth0: {} },\n        { newGatewayEth0: {}, newNameServerEth0: {} },\n      ],\n      conditions: {\n        newIpEth0: setting => {\n          const val = setting['interfaceTypeEth0'].value;\n          return ![0].includes(val);\n        },\n        netNetmaskEth0: setting => {\n          const val = setting['interfaceTypeEth0'].value;\n          return ![0].includes(val);\n        },\n        newGatewayEth0: setting => {\n          const val = setting['interfaceTypeEth0'].value;\n          return ![0].includes(val);\n        },\n        newNameServerEth0: setting => {\n          const val = setting['interfaceTypeEth0'].value;\n          return ![0].includes(val);\n        },\n      },\n    });\n  }\n\n  onAdded() {\n    setTimeout(() => {\n      this.getInterfaces();\n    }, 2000);\n  }\n\n  onInputUpdated() {\n    let enableInterfaceEth0 = this.getInputData(1);\n\n    //refresh the interfaces\n    if (this.inputs[0].updated) {\n      this.msgOut(this.messageOutput, 'called getInterfaces' + ' ' + this.timeStamp);\n      setTimeout(() => {\n        this.getInterfaces();\n      }, 2000);\n    }\n    // enable/disable eth0\n    if (this.inputs[1].updated) {\n      if (enableInterfaceEth0 === true) {\n        this.msgOut(this.messageOutput, 'called enable Eth0 true' + ' ' + this.timeStamp);\n        this.enableNetwork(this.interfaceEth0);\n      } else if (enableInterfaceEth0 === false) {\n        this.msgOut(this.messageOutput, 'called disable Eth0 false' + ' ' + this.timeStamp);\n        this.disableNetwork(this.interfaceEth0);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    if (this.side !== Side.server) return; // only execute on server\n    const newIpEth0 = this.settings['newIpEth0'].value;\n    const netNetmaskEth0 = this.settings['netNetmaskEth0'].value;\n    const newGatewayEth0 = this.settings['newGatewayEth0'].value;\n    const newNameServerEth0 = this.settings['newNameServerEth0'].value;\n    const interfaceTypeEth0 = this.settings['interfaceTypeEth0'].value;\n    const writeChanges = this.settings['writeChanges'].value;\n    const reboot = this.settings['reboot'].value;\n\n    const checkIpSettingsEth0 = IpAddressUtils.checkIpValid(\n      newIpEth0,\n      netNetmaskEth0,\n      newGatewayEth0,\n      newNameServerEth0,\n    );\n\n    //device reboot\n    if (reboot) {\n      this.msgOut(this.messageOutput, 'called sudo reboot will reboot in 10 sec' + ' ' + this.timeStamp);\n      //set setting back to false so its not ticked after reboot\n      this.settings['reboot'].value = false;\n      this.broadcastSettingsToClients();\n      //reboot after 10 sec\n      setTimeout(() => {\n        this.execCommand(`sudo reboot`);\n      }, 10000);\n    }\n    // check if OS is the BBB\n    OsUtils.systemInfo()\n      .then(e => {\n        if (e.system.model === \"GENERIC AM33XX (FLATTENED DEVICE TREE)\") {\n          if (checkIpSettingsEth0 && writeChanges) {\n            //network update\n            if (interfaceTypeEth0 == 0) {\n              //DHCP\n              this.title = 'Adapter' + +' ' + '(DHCP)';\n              IpAddressUtils.bbbGetInterfaceDetails()\n                .then(e => {\n                  this.msgOut(this.messageOutput, `'MSG: get interface ID' ${e}`);\n                  IpAddressUtils.bbbSetIPDHCP(e)\n                    .then(e => {\n                      this.msgOut(this.messageOutput, `'MSG: set ip to DHCP' ${e}`);\n                    })\n                    .catch(err => {\n                      this.msgOut(this.messageOutput, `'ERROR: setting to DHCP' ${err}`);\n                    });\n                })\n                .catch(err => {\n                  this.msgOut(this.messageOutput, `'ERROR: setting to DHCP' ${err}`);\n                });\n            } else if (interfaceTypeEth0 == 1) {\n              //Static\n              this.title = 'Adapter' + ' ' + '(Static)';\n              IpAddressUtils.bbbGetInterfaceDetails()\n                .then(iface => {\n                  //iface, ipAddress, subnetMask, gateway\n                  IpAddressUtils.bbbSetIPFixed(iface, newIpEth0, netNetmaskEth0, newGatewayEth0)\n                    .then(e => {\n                      this.msgOut(this.messageOutput, `'MSG: set ip to fixed IP' ${e}`);\n                    })\n                    .catch(err => {\n                      this.msgOut(this.messageOutput, `'ERROR: setting to fixed IP' ${err}`);\n                    });\n                })\n                .catch(err => {\n                  this.msgOut(this.messageOutput, `'ERROR: setting to fixed IP' ${err}`);\n                });\n            }\n          } else {\n            this.msgOut(this.messageOutput, 'invalid ip settings');\n          }\n        } else {\n          // set node to red to show its the incorrect device type\n          NodeColours.nodeColourChange(this, NodeState.ERROR);\n          this.msgOut(this.messageOutput, `'ERROR: incorrect device type ${e.system.model}`)\n        }\n      }).catch(err => this.msgOut(this.messageOutput, `'ERROR: incorrect device type' ${err}`));\n\n    if (!writeChanges) {\n      // user didnt toggle the save button\n      this.msgOut(this.messageOutput, 'nothing saved' + ' ' + this.timeStamp);\n      this.msgOut(this.errorOutput, true);\n    }\n\n\n  }\n\n  //msg output\n  msgOut = (num: number, msg: any) => {\n    this.setOutputData(num, msg);\n  };\n\n  execCommand(command: string) {\n    if (this.side !== Side.server) return;\n    try {\n      exec(command, (err, stdout, stderr) => {\n        this.msgOut(this.messageOutput, 'called command' + ' ' + command + ' ' + this.timeStamp);\n        if (stdout) {\n          this.msgOut(this.messageOutput, stdout + ' ' + this.timeStamp);\n          this.msgOut(this.errorOutput, false);\n        }\n        if (err) {\n          this.msgOut(this.messageOutput, err + ' ' + this.timeStamp);\n          this.msgOut(this.errorOutput, true);\n        }\n        if (stderr) {\n          this.msgOut(this.messageOutput, stderr + ' ' + this.timeStamp);\n          this.msgOut(this.errorOutput, true);\n        }\n      });\n    } catch (e) {\n      this.msgOut(this.messageOutput, e + ' ' + this.timeStamp);\n      this.msgOut(this.errorOutput, true);\n      // this.debugInfo(e);\n    }\n  }\n\n  getInterfaces() {\n    IpAddressUtils.getActiveNetworks()\n      .then(list => {\n        //eth0\n        const getInterfaceEth0 = list.filter(e => {\n          return e.name == this.interfaceEth0;\n        });\n        this.msgOut(this.eth0Ip, getInterfaceEth0[0].ip_address); //ip\n        this.msgOut(this.errorOutput, false); //error\n      })\n      .catch(err => {\n        this.msgOut(this.messageOutput, err);\n        this.msgOut(this.errorOutput, true);\n      });\n  }\n\n  enableNetwork(iface: string) {\n    try {\n      IpAddressUtils.networkUpDown(iface, 'up')\n        .then(r => {\n          console.log(r);\n          setTimeout(() => {\n            this.getInterfaces();\n          }, 5000);\n        })\n        .catch(e => console.log(e));\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  disableNetwork(iface: string) {\n    try {\n      IpAddressUtils.networkUpDown(iface, 'down')\n        .then(r => {\n          console.log(r);\n        })\n        .catch(err => console.log(err));\n    } catch (err) {\n      console.log(err);\n    }\n  }\n}\nContainer.registerNodeType('system/network-interface-edge-28', UpdateIPEdge28);\n","module.exports = require(\"network\");","import { Node, SettingType, NodeState } from '../../../node';\nimport { Container, Side } from '../../../container';\nimport { Type } from '../../../node-io';\nimport Utils from '../../../utils';\nimport IpAddressUtils from '../../../utils/ip-address-utils';\nimport { exec } from 'child_process';\nimport OsUtils from '../../../utils/os-utils';\nimport NodeColours from '../../../utils/nodes/node-colour-change';\nconst set_ip_address = require('set-ip-address'); //for setting IPs\nconst ip = require('ip'); //for checking if IPs are valid\n\nclass UpdateIP extends Node {\n  timeStamp = Utils.getTimeStamp();\n\n  interfaceEth0 = 'eth0'; //eth0 //wlp3s0\n  interfaceEth1 = 'eth1'; //eth0 //enp0s31f6\n\n  //outputs\n  eth0Ip = 0;\n  eth1Ip = 1;\n  messageOutput = 2;\n  errorOutput = 3;\n\n  constructor() {\n    super();\n    this.title = 'Network Interfaces';\n    this.description =\n      'This node is used to configure the network (IP) interfaces for the device.  Changes made to settings will only be saved if Save changes on save is toggled ON.  In some cases a reboot will be required to save the changes, if Reboot is toggled ON, then clicking save will reboot the controller.      NOTE: Making changes on a remote device could cause the device to become inaccessible.';\n    this.addInput('get interface address', Type.BOOLEAN);\n    this.addInput('enable eth0 ', Type.BOOLEAN);\n    this.addInput('enable eth1 ', Type.BOOLEAN);\n    this.addOutput('ip eth0', Type.STRING);\n    this.addOutput('ip eth1', Type.STRING);\n    this.addOutput('message', Type.STRING);\n    this.addOutput('error', Type.STRING);\n\n    this.settings['writeChanges'] = {\n      description: 'Save changes on save',\n      type: SettingType.BOOLEAN,\n      value: false,\n    };\n\n    this.settings['reboot'] = {\n      description: 'Reboot. Warning this will reboot the device',\n      type: SettingType.BOOLEAN,\n      value: false,\n    };\n\n    this.settings['eth0_group'] = {\n      description: 'Eth Port 0',\n      value: '',\n      type: SettingType.GROUP,\n    };\n\n    this.settings['interfaceTypeEth0'] = {\n      description: 'Interface Type eth0',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'DHCP' },\n          { value: 1, text: 'Static' },\n        ],\n      },\n      value: 0,\n    };\n    this.settings['newIpEth0'] = {\n      description: 'IP',\n      value: '192.168.0.40',\n      type: SettingType.STRING,\n    };\n\n    this.settings['netNetmaskEth0'] = {\n      description: 'Netmask eth0',\n      value: '255.255.255.0',\n      type: SettingType.STRING,\n    };\n    this.settings['newGatewayEth0'] = {\n      description: 'Gateway',\n      value: '192.168.0.1',\n      type: SettingType.STRING,\n    };\n\n    this.settings['newNameServerEth0'] = {\n      description: 'Name Servers eth0',\n      value: '8.8.8.8',\n      type: SettingType.STRING,\n    };\n\n    this.settings['eth1_group'] = {\n      description: 'Eth Port 1',\n      value: '',\n      type: SettingType.GROUP,\n    };\n\n    this.settings['interfaceTypeEth1'] = {\n      description: 'Interface Type eth1',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'DHCP' },\n          { value: 1, text: 'Static' },\n        ],\n      },\n      value: 0,\n    };\n    this.settings['newIpEth1'] = {\n      description: 'IP',\n      value: '192.168.1.40',\n      type: SettingType.STRING,\n    };\n\n    this.settings['netNetmaskEth1'] = {\n      description: 'Netmask eth1',\n      value: '255.255.255.0',\n      type: SettingType.STRING,\n    };\n    this.settings['newGatewayEth1'] = {\n      description: 'Gateway',\n      value: '192.168.1.1',\n      type: SettingType.STRING,\n    };\n\n    this.settings['newNameServerEth1'] = {\n      description: 'Name Servers eth1',\n      value: '8.8.8.8',\n      type: SettingType.STRING,\n    };\n\n    this.setSettingsConfig({\n      groups: [\n        { newIpEth0: {}, netNetmaskEth0: {} },\n        { newGatewayEth0: {}, newNameServerEth0: {} },\n        { newIpEth1: {}, netNetmaskEth1: {} },\n        { newGatewayEth1: {}, newNameServerEth1: {} },\n      ],\n      conditions: {\n        newIpEth0: setting => {\n          const val = setting['interfaceTypeEth0'].value;\n          return ![0].includes(val);\n        },\n        netNetmaskEth0: setting => {\n          const val = setting['interfaceTypeEth0'].value;\n          return ![0].includes(val);\n        },\n        newGatewayEth0: setting => {\n          const val = setting['interfaceTypeEth0'].value;\n          return ![0].includes(val);\n        },\n        newNameServerEth0: setting => {\n          const val = setting['interfaceTypeEth0'].value;\n          return ![0].includes(val);\n        },\n        newIpEth1: setting => {\n          const val = setting['interfaceTypeEth1'].value;\n          return ![0].includes(val);\n        },\n        netNetmaskEth1: setting => {\n          const val = setting['interfaceTypeEth1'].value;\n          return ![0].includes(val);\n        },\n        newGatewayEth1: setting => {\n          const val = setting['interfaceTypeEth1'].value;\n          return ![0].includes(val);\n        },\n        newNameServerEth1: setting => {\n          const val = setting['interfaceTypeEth1'].value;\n          return ![0].includes(val);\n        },\n      },\n    });\n  }\n\n  onAdded() {\n    setTimeout(() => {\n      this.getInterfaces();\n    }, 2000);\n  }\n\n  onInputUpdated() {\n    let enableInterfaceEth0 = this.getInputData(1);\n    let enableInterfaceEth1 = this.getInputData(2);\n\n    //refresh the interfaces\n    if (this.inputs[0].updated) {\n      this.msgOut(this.messageOutput, 'called getInterfaces' + ' ' + this.timeStamp);\n      setTimeout(() => {\n        this.getInterfaces();\n      }, 2000);\n    }\n    // enable/disable eth0\n    if (this.inputs[1].updated) {\n      if (enableInterfaceEth0 === true) {\n        this.msgOut(this.messageOutput, 'called enable Eth0 true' + ' ' + this.timeStamp);\n        this.enableNetwork(this.interfaceEth0);\n      } else if (enableInterfaceEth0 === false) {\n        this.msgOut(this.messageOutput, 'called disable Eth0 false' + ' ' + this.timeStamp);\n        this.disableNetwork(this.interfaceEth0);\n      }\n    }\n    // enable/disable eth1\n    if (this.inputs[2].updated) {\n      if (enableInterfaceEth1 === true) {\n        this.msgOut(this.messageOutput, 'called enable Eth1 true' + ' ' + this.timeStamp);\n        this.enableNetwork(this.interfaceEth1);\n      } else if (enableInterfaceEth1 === false) {\n        this.msgOut(this.messageOutput, 'called disable Eth1 false' + ' ' + this.timeStamp);\n        this.disableNetwork(this.interfaceEth1);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    if (this.side !== Side.server) return; // only execute on server\n    const newIpEth0 = this.settings['newIpEth0'].value;\n    const netNetmaskEth0 = this.settings['netNetmaskEth0'].value;\n    const newGatewayEth0 = this.settings['newGatewayEth0'].value;\n    const newNameServerEth0 = this.settings['newNameServerEth0'].value;\n    const interfaceTypeEth0 = this.settings['interfaceTypeEth0'].value;\n\n    const newIpEth1 = this.settings['newIpEth1'].value;\n    const netNetmaskEth1 = this.settings['netNetmaskEth1'].value;\n    const newGatewayEth1 = this.settings['newGatewayEth1'].value;\n    const newNameServerEth1 = this.settings['newNameServerEth1'].value;\n    const interfaceTypeEth1 = this.settings['interfaceTypeEth1'].value;\n\n    const writeChanges = this.settings['writeChanges'].value;\n    const reboot = this.settings['reboot'].value;\n\n    const checkIpSettingsEth0 = IpAddressUtils.checkIpValid(\n      newIpEth0,\n      netNetmaskEth0,\n      newGatewayEth0,\n      newNameServerEth0,\n    );\n    const checkIpSettingsEth1 = IpAddressUtils.checkIpValid(\n      newIpEth1,\n      netNetmaskEth1,\n      newGatewayEth1,\n      newNameServerEth1,\n    );\n    //device reboot\n    if (reboot) {\n      this.msgOut(\n        this.messageOutput,\n        'called sudo reboot will reboot in 10 sec' + ' ' + this.timeStamp,\n      );\n      //set setting back to false so its not ticked after reboot\n      this.settings['reboot'].value = false;\n      this.broadcastSettingsToClients();\n      //reboot after 10 sec\n      setTimeout(() => {\n        this.execCommand(`sudo reboot`);\n      }, 10000);\n    }\n\n    // check if OS is the BBB\n    OsUtils.systemInfo()\n      .then(e => {\n        if (e.system.model === \"BCM2835\") {\n          if (checkIpSettingsEth0 && checkIpSettingsEth1 && writeChanges) {\n            //network update\n            let interfacesArray = [];\n            if (interfaceTypeEth0 == 0) {\n              //DHCP\n              this.title = 'Adapter' + +' ' + '(DHCP)';\n              let eth0 = {\n                interface: this.interfaceEth0,\n                dhcp: true,\n              };\n              interfacesArray.push(eth0);\n            }\n            if (interfaceTypeEth0 == 1) {\n              //Static\n              this.title = 'Adapter' + ' ' + '(Static)';\n              let subnetMaskLength = ip.subnet(newIpEth0, netNetmaskEth0);\n              let eth0 = {\n                interface: this.interfaceEth0,\n                ip_address: newIpEth0,\n                prefix: subnetMaskLength.subnetMaskLength,\n                gateway: newGatewayEth0,\n                nameservers: [newNameServerEth0],\n              };\n              interfacesArray.push(eth0);\n            }\n\n            if (interfaceTypeEth1 == 0) {\n              //DHCP\n              this.title = 'Adapter' + +' ' + '(DHCP)';\n              let eth1 = {\n                interface: this.interfaceEth1,\n                dhcp: true,\n              };\n              interfacesArray.push(eth1);\n            }\n\n            if (interfaceTypeEth1 == 1) {\n              //Static\n              this.title = 'Adapter' + ' ' + '(Static)';\n              let subnetMaskLength = ip.subnet(newIpEth1, netNetmaskEth1);\n              let eth1 = {\n                interface: this.interfaceEth1,\n                ip_address: newIpEth1,\n                prefix: subnetMaskLength.subnetMaskLength,\n                gateway: newGatewayEth1,\n                nameservers: [newNameServerEth1],\n              };\n              interfacesArray.push(eth1);\n            }\n            set_ip_address.configure(interfacesArray).then(() => {\n              this.msgOut(this.messageOutput, 'updated' + ' ' + this.timeStamp);\n              this.msgOut(this.errorOutput, false);\n            });\n          } else this.msgOut(this.messageOutput, 'invalid ip settings');\n        } else {\n          // set node to red to show its the incorrect device type\n          NodeColours.nodeColourChange(this, NodeState.ERROR);\n          this.msgOut(this.messageOutput, `'ERROR: incorrect device type ${e.system.model}`)\n        }\n      }).catch(err => this.msgOut(this.messageOutput, `'ERROR: incorrect device type' ${err}`));\n\n    if (!writeChanges) {\n      // user didnt toggle the save button\n      this.msgOut(this.messageOutput, 'nothing saved' + ' ' + this.timeStamp);\n      this.msgOut(this.errorOutput, true);\n    }\n  }\n  //msg output\n  msgOut = (num: number, msg: any) => {\n    this.setOutputData(num, msg);\n  };\n\n  execCommand(command: string) {\n    if (this.side !== Side.server) return;\n    try {\n      exec(command, (err, stdout, stderr) => {\n        this.msgOut(this.messageOutput, 'called command' + ' ' + command + ' ' + this.timeStamp);\n        if (stdout) {\n          this.msgOut(this.messageOutput, stdout + ' ' + this.timeStamp);\n          this.msgOut(this.errorOutput, false);\n        }\n        if (err) {\n          this.msgOut(this.messageOutput, err + ' ' + this.timeStamp);\n          this.msgOut(this.errorOutput, true);\n        }\n        if (stderr) {\n          this.msgOut(this.messageOutput, stderr + ' ' + this.timeStamp);\n          this.msgOut(this.errorOutput, true);\n        }\n      });\n    } catch (e) {\n      this.msgOut(this.messageOutput, e + ' ' + this.timeStamp);\n      this.msgOut(this.errorOutput, true);\n      // this.debugInfo(e);\n    }\n  }\n\n  getInterfaces() {\n    IpAddressUtils.getActiveNetworks()\n      .then(list => {\n        //eth0\n        const getInterfaceEth0 = list.filter(e => {\n          return e.name == this.interfaceEth0;\n        });\n        this.msgOut(this.eth0Ip, getInterfaceEth0[0].ip_address); //ip\n        this.msgOut(this.errorOutput, false); //error\n\n        //eth1\n        const getInterfaceEth1 = list.filter(e => {\n          return e.name == this.interfaceEth1;\n        });\n        this.msgOut(this.eth1Ip, getInterfaceEth1[0].ip_address); //ip\n        this.msgOut(this.errorOutput, false); //error\n      })\n      .catch(err => {\n        this.msgOut(this.messageOutput, err);\n        this.msgOut(this.errorOutput, true);\n      });\n  }\n\n  enableNetwork(iface: string) {\n    try {\n      IpAddressUtils.networkUpDown(iface, 'up')\n        .then(r => {\n          console.log(r);\n          setTimeout(() => {\n            this.getInterfaces();\n          }, 5000);\n        })\n        .catch(e => console.log(e));\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  disableNetwork(iface: string) {\n    try {\n      IpAddressUtils.networkUpDown(iface, 'down')\n        .then(r => {\n          console.log(r);\n        })\n        .catch(err => console.log(err));\n    } catch (err) {\n      console.log(err);\n    }\n  }\n}\nContainer.registerNodeType('system/network-interfaces', UpdateIP);\n","module.exports = require(\"set-ip-address\");","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { exec } from 'child_process';\nimport { Type } from '../../node-io';\n\nconst pkg = require('../../../../package.json');\n\nclass WiresVersion extends Node {\n  constructor() {\n    super();\n    this.title = 'Build Versions';\n    this.description = \"A node for return the build versions of wires and nodejs'\";\n    this.addInput('in1', Type.STRING);\n    this.addOutput('wires-version', Type.STRING);\n    this.addOutput('nodejs-version', Type.STRING);\n    this.addOutput('npm-version', Type.STRING);\n    this.addOutput('json out', Type.STRING);\n    this.addOutput('error', Type.STRING);\n  }\n\n  getCurrentWiresVersion() {\n    return new Promise(function(resolve) {\n      return resolve({\n        version: pkg.version,\n      });\n    });\n  }\n\n  getNodeJsVersion() {\n    return new Promise((resolve, reject) => {\n      exec('node -v', (err, stdout, stderr) => {\n        if (err) {\n          reject(err);\n          return;\n        } else {\n          resolve({\n            stdout,\n          });\n        }\n      });\n    });\n  }\n\n  getNPMVersion() {\n    return new Promise((resolve, reject) => {\n      exec('npm -v', (err, stdout, stderr) => {\n        if (err) {\n          reject(err);\n          return;\n        } else {\n          resolve({\n            stdout,\n          });\n        }\n      });\n    });\n  }\n\n  onInputUpdated() {\n    let arr = [];\n\n    // wires build\n    this.getCurrentWiresVersion()\n      .then(r => {\n        r = JSON.stringify(r)\n          .replace(/\\\\n/g, '')\n          .split('version')\n          .join('wires version');\n        arr.push(r);\n        this.setOutputData(0, r);\n      })\n      .catch(e => {\n        this.setOutputData(4, e);\n      });\n    // nodejs version\n    this.getNodeJsVersion()\n      .then(r => {\n        r = JSON.stringify(r)\n          .replace(/\\\\n/g, '')\n          .split('stdout')\n          .join('nodejs version');\n        arr.push(r);\n        this.setOutputData(1, r);\n      })\n      .catch(e => {\n        this.setOutputData(4, e);\n      });\n    // npm version\n    this.getNPMVersion()\n      .then(r => {\n        r = JSON.stringify(r)\n          .replace(/\\\\n/g, '')\n          .split('stdout')\n          .join('npm version');\n        arr.push(r);\n        this.setOutputData(3, arr); //json out\n        this.setOutputData(2, r);\n      })\n      .catch(e => {\n        this.setOutputData(4, e);\n      });\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('system/system-build-version', WiresVersion);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nexport class TimeConvertNode extends Node {\n  conversionFunction;\n  constructor() {\n    super();\n    this.title = 'Time Conversion (min)';\n    this.description =\n      \"This node converts between Time units Days('day'), Hours('hour'), Minutes('min'), Seconds('sec'), and Milliseconds('milli').  Input type can be selected from settings. Outputs will change based on selected input type.  The number of decimal places that output values have can be set from the 'Precision' setting.\";\n\n    this.addInput('min', Type.NUMBER);\n    this.addOutput('day', Type.NUMBER);\n    this.addOutput('hour', Type.NUMBER);\n    this.addOutput('sec', Type.NUMBER);\n    this.addOutput('milli', Type.NUMBER);\n    this.settings['inputType'] = {\n      description: 'Input Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'day', text: 'Days (day)' },\n          { value: 'hour', text: 'Hours (hour)' },\n          { value: 'min', text: 'Minutes (min)' },\n          { value: 'sec', text: 'Seconds (sec)' },\n          { value: 'milli', text: 'Milliseconds(milli)' },\n        ],\n      },\n      value: 'min',\n    };\n    this.settings['precision'] = { description: 'Precision', type: SettingType.NUMBER, value: '2' };\n    this.conversionFunction = input => {\n      let outputArray: number[] = [null, null, null, null];\n      outputArray[0] = input * 0.000694444;\n      outputArray[1] = input * 0.016666667;\n      outputArray[2] = input * 60;\n      outputArray[3] = input * 60000;\n      return outputArray;\n    };\n  }\n\n  onAdded() {\n    this.setConversionFunction();\n    this.onAfterSettingsChange()\n  }\n\n  onInputUpdated() {\n    this.onInputOrSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.setConversionFunction();\n    this.onInputOrSettingsChange();\n  }\n\n  private onInputOrSettingsChange() {\n    const input = this.getInputData(0);\n    if (!Utils.hasInput(input)) {\n      this.setOutputData(0, null);\n      this.setOutputData(1, null);\n      this.setOutputData(2, null);\n      this.setOutputData(3, null);\n      this.setOutputData(4, null);\n      return;\n    }\n    const output = this.conversionFunction(input);\n    const precision = Math.abs(this.settings['precision'].value);\n    this.setOutputData(0, Number(output[0]).toFixed(precision));\n    this.setOutputData(1, Number(output[1]).toFixed(precision));\n    this.setOutputData(2, Number(output[2]).toFixed(precision));\n    this.setOutputData(3, Number(output[3]).toFixed(precision));\n    this.setOutputData(4, Number(output[4]).toFixed(precision));\n  }\n\n  setConversionFunction() {\n    const inputType = this.settings['inputType'].value;\n    switch (inputType) {\n      case 'min':\n        this.title = 'Time Conversion (min)';\n        this.inputs[0].name = 'min';\n        this.outputs[0].name = 'day';\n        this.outputs[1].name = 'hour';\n        this.outputs[2].name = 'sec';\n        this.outputs[3].name = 'milli';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null];\n          outputArray[0] = input * 0.000694444;\n          outputArray[1] = input * 0.016666667;\n          outputArray[2] = input * 60;\n          outputArray[3] = input * 60000;\n          return outputArray;\n        };\n        break;\n      case 'sec':\n        this.title = 'Time Conversion (sec)';\n        this.inputs[0].name = 'sec';\n        this.outputs[0].name = 'day';\n        this.outputs[1].name = 'hour';\n        this.outputs[2].name = 'min';\n        this.outputs[3].name = 'milli';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null];\n          outputArray[0] = input * 1.1574e-5;\n          outputArray[1] = input * 0.000277778;\n          outputArray[2] = input * 0.016666667;\n          outputArray[3] = input * 1000;\n          return outputArray;\n        };\n        break;\n      case 'milli':\n        this.title = 'Time Conversion (milli)';\n        this.inputs[0].name = 'milli';\n        this.outputs[0].name = 'day';\n        this.outputs[1].name = 'hour';\n        this.outputs[2].name = 'min';\n        this.outputs[3].name = 'sec';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null];\n          outputArray[0] = input * 1.1574e-8;\n          outputArray[1] = input * 2.7778e-7;\n          outputArray[2] = input * 1.6667e-5;\n          outputArray[3] = input * 0.00100002;\n          return outputArray;\n        };\n        break;\n      case 'day':\n        this.title = 'Time Conversion (day)';\n        this.inputs[0].name = 'day';\n        this.outputs[0].name = 'hour';\n        this.outputs[1].name = 'min';\n        this.outputs[2].name = 'sec';\n        this.outputs[3].name = 'milli';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null];\n          outputArray[0] = input * 24;\n          outputArray[1] = input * 1440;\n          outputArray[2] = input * 86400;\n          outputArray[3] = input * 8.64e7;\n          return outputArray;\n        };\n        break;\n      case 'hour':\n        this.title = 'Time Conversion (hour)';\n        this.inputs[0].name = 'hour';\n        this.outputs[0].name = 'day';\n        this.outputs[1].name = 'min';\n        this.outputs[2].name = 'sec';\n        this.outputs[3].name = 'milli';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null];\n          outputArray[0] = input * 0.0416667;\n          outputArray[1] = input * 60;\n          outputArray[2] = input * 3600;\n          outputArray[3] = input * 3.6e6;\n          return outputArray;\n        };\n        break;\n      default:\n        this.title = 'Time Conversion (min)';\n        this.inputs[0].name = 'min';\n        this.outputs[0].name = 'day';\n        this.outputs[1].name = 'hour';\n        this.outputs[2].name = 'sec';\n        this.outputs[3].name = 'milli';\n        this.conversionFunction = input => {\n          let outputArray: number[] = [null, null, null, null];\n          outputArray[0] = input * 0.000694444;\n          outputArray[1] = input * 0.016666667;\n          outputArray[2] = input * 60;\n          outputArray[3] = input * 60000;\n          return outputArray;\n        };\n    }\n  }\n}\nContainer.registerNodeType('time/conversion', TimeConvertNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nenum TIME_TYPE {\n  TIME = 'time string as input',\n  EPOCH = 'time epoch as input',\n  NEW_TS = 'time now',\n}\n\nexport class TimeConvertPlusNode extends Node {\n  conversionFunction;\n  constructor() {\n    super();\n    this.title = 'Time Conversion Json';\n    this.description =\n      `## Description\\n ` +\n      ` This node will let you convert a timestamp or unix (epoch) timestamp into date and time parts \\n ` +\n      ` ## Example output\\n ` +\n      ` ***{\"date\":\"Mon Aug 17 2020\",\"yearMonthDay\":\"2020-08-17\",\"year\":\"2020\",\"month\":\"Aug\",\"monthAsNumber\":\"08\",\"dayAsNumber\":\"17\",\"dayOfYearNumber\":\"230\",\"day\":\"Mon\",\"pmOrAm\":\"PM\",\"hourAsAmPm\":\"8\",\"hour\":\"20\",\"timeHourMin\":\"20:26\",\"time\":\"20:26:49\",\"minute\":\"26\",\"minutesSeconds\":\"26:49\",\"seconds\":\"49\",\"milliseconds\":\"000\",\"epoch\":\"1597660009000\",\"rawDate\":\"2020-08-17T10:26:49.000Z\"}***\\n `\n\n    this.addInput('input', Type.ANY);\n    this.addOutput('out-json', Type.JSON);\n    this.settings['time'] = {\n      description: 'Time',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: TIME_TYPE.TIME, text: TIME_TYPE.TIME },\n          { value: TIME_TYPE.EPOCH, text: TIME_TYPE.EPOCH },\n          { value: TIME_TYPE.NEW_TS, text: TIME_TYPE.NEW_TS },\n        ],\n      },\n      value: TIME_TYPE.TIME,\n    };\n  }\n\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    const result = this.timeSelection(input)\n    const out = TimeUtils.timeConvertPlus(result)\n    this.setOutputData(0, out);\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated()\n\n  }\n\n  timeSelection(input: any){\n    const timeType = this.settings['time'].value\n    let timeSelection = null;\n    if (timeType === TIME_TYPE.TIME) {\n      timeSelection = new Date(input);\n    } else if (timeType === TIME_TYPE.EPOCH) {\n      timeSelection = new Date(parseInt(input));\n    } else if (timeType === TIME_TYPE.NEW_TS) {\n      timeSelection = new Date();\n    }\n    return timeSelection;\n  }\n\n}\nContainer.registerNodeType('time/conversion-plus', TimeConvertPlusNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimezoneUtils from '../../utils/timezone-utils';\nimport * as moment from 'moment-timezone';\nexport class TimezoneConvertNode extends Node {\n  conversionFunction;\n  constructor() {\n    super();\n    this.title = 'Timezone Conversion';\n    this.description =\n      `## Description\\n ` +\n      ` The is node is used to convert two timestamps\\n `\n\n    this.addInput('input', Type.ANY);\n    this.addOutput('out-time-converted', Type.ANY);\n    this.addOutput('out-local-converted', Type.ANY);\n\n    this.settings['region'] = {\n      description: 'Select Region',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: TimezoneUtils.tsCategory,\n      },\n    };\n    this.settings['timezone'] = {\n      description: 'Select TimeZone (Hit save to refresh)',\n      value: \"Sydney/Australia\",\n      type: SettingType.DROPDOWN,\n    };\n\n  }\n  onAdded() {\n    this.onAfterSettingsChange();\n  }\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    try {\n      const m = moment.tz(input, this.settings['timezone'].value);\n      const local = moment(input);\n      this.setOutputData(0, m.format());\n      this.setOutputData(1, local.format());\n    } catch (e) {\n      this.debugWarn(`ERROR: trying to convert a timezone${e}`);\n    }\n\n  }\n\n  onAfterSettingsChange() {\n    const region = this.settings['region'].value;\n    this.settings['timezone'].config = {\n      items: TimezoneUtils.tsType(region),\n    };\n    this.broadcastSettingsToClients();\n    this.onInputUpdated()\n\n  }\n\n\n\n}\nContainer.registerNodeType('time/timezone-conversion', TimezoneConvertNode);\n","enum TIME_TYPE {\n    africaZones = 'Africa',\n    americaZones = 'America',\n    antarcticaZones = 'Antarctica',\n    asiaZones = 'Asia',\n    atlanticZones = 'Atlantic',\n    australiaZones = 'Australia',\n    europeZones = 'Europe',\n    indianZones = 'Indian',\n    pacificZones = 'Pacific',\n}\n\nexport default class TimezoneUtils {\n    static tsCategory = [TIME_TYPE.africaZones, TIME_TYPE.americaZones, TIME_TYPE.antarcticaZones, TIME_TYPE.asiaZones, TIME_TYPE.atlanticZones, TIME_TYPE.australiaZones, TIME_TYPE.europeZones, TIME_TYPE.indianZones, TIME_TYPE.pacificZones].map(\n        point => {\n            return { value: point, text: point };\n        },\n    );\n\n    static tsType(type: string) {\n        switch (type) {\n            case TIME_TYPE.africaZones:\n                return Object.values(this.africaZones);\n            case TIME_TYPE.americaZones:\n                return Object.values(this.americaZones);\n            case TIME_TYPE.antarcticaZones:\n                return Object.values(this.antarcticaZones);\n            case TIME_TYPE.asiaZones:\n                return Object.values(this.asiaZones);\n            case TIME_TYPE.atlanticZones:\n                return Object.values(this.atlanticZones);\n            case TIME_TYPE.australiaZones:\n                return Object.values(this.australiaZones);\n            case TIME_TYPE.europeZones:\n                return Object.values(this.europeZones);\n            case TIME_TYPE.indianZones:\n                return Object.values(this.indianZones);\n            case TIME_TYPE.pacificZones:\n                return Object.values(this.pacificZones);\n        }\n    }\n\n    static europeZones = [\n        'Europe/Amsterdam',\n        'Europe/Andorra',\n        'Europe/Astrakhan',\n        'Europe/Athens',\n        'Europe/Belgrade',\n        'Europe/Berlin',\n        'Europe/Brussels',\n        'Europe/Bucharest',\n        'Europe/Budapest',\n        'Europe/Chisinau',\n        'Europe/Copenhagen',\n        'Europe/Dublin',\n        'Europe/Gibraltar',\n        'Europe/Helsinki',\n        'Europe/Istanbul',\n        'Europe/Kaliningrad',\n        'Europe/Kiev',\n        'Europe/Kirov',\n        'Europe/Lisbon',\n        'Europe/London',\n        'Europe/Luxembourg',\n        'Europe/Madrid',\n        'Europe/Malta',\n        'Europe/Minsk',\n        'Europe/Monaco',\n        'Europe/Moscow',\n        'Europe/Oslo',\n        'Europe/Paris',\n        'Europe/Prague',\n        'Europe/Riga',\n        'Europe/Rome',\n        'Europe/Samara',\n        'Europe/Saratov',\n        'Europe/Simferopol',\n        'Europe/Sofia',\n        'Europe/Stockholm',\n        'Europe/Tallinn',\n        'Europe/Tirane',\n        'Europe/Ulyanovsk',\n        'Europe/Uzhgorod',\n        'Europe/Vienna',\n        'Europe/Vilnius',\n        'Europe/Volgograd',\n        'Europe/Warsaw',\n        'Europe/Zaporozhye',\n        'Europe/Zurich',\n    ];\n\n    static africaZones = [\n        'Africa/Abidjan',\n        'Africa/Accra',\n        'Africa/Algiers',\n        'Africa/Bissau',\n        'Africa/Cairo',\n        'Africa/Casablanca',\n        'Africa/Ceuta',\n        'Africa/El_Aaiun',\n        'Africa/Johannesburg',\n        'Africa/Juba',\n        'Africa/Khartoum',\n        'Africa/Lagos',\n        'Africa/Maputo',\n        'Africa/Monrovia',\n        'Africa/Nairobi',\n        'Africa/Ndjamena',\n        'Africa/Sao_Tome',\n        'Africa/Tripoli',\n        'Africa/Tunis',\n        'Africa/Windhoek',\n    ];\n\n    static asiaZones = [\n        'Asia/Almaty',\n        'Asia/Amman',\n        'Asia/Anadyr',\n        'Asia/Aqtau',\n        'Asia/Aqtobe',\n        'Asia/Ashgabat',\n        'Asia/Atyrau',\n        'Asia/Baghdad',\n        'Asia/Baku',\n        'Asia/Bangkok',\n        'Asia/Barnaul',\n        'Asia/Beirut',\n        'Asia/Bishkek',\n        'Asia/Brunei',\n        'Asia/Chita',\n        'Asia/Choibalsan',\n        'Asia/Colombo',\n        'Asia/Damascus',\n        'Asia/Dhaka',\n        'Asia/Dili',\n        'Asia/Dubai',\n        'Asia/Dushanbe',\n        'Asia/Famagusta',\n        'Asia/Gaza',\n        'Asia/Hebron',\n        'Asia/Ho_Chi_Minh',\n        'Asia/Hong_Kong',\n        'Asia/Hovd',\n        'Asia/Irkutsk',\n        'Asia/Jakarta',\n        'Asia/Jayapura',\n        'Asia/Jerusalem',\n        'Asia/Kabul',\n        'Asia/Kamchatka',\n        'Asia/Karachi',\n        'Asia/Kathmandu',\n        'Asia/Khandyga',\n        'Asia/Kolkata',\n        'Asia/Krasnoyarsk',\n        'Asia/Kuala_Lumpur',\n        'Asia/Kuching',\n        'Asia/Macau',\n        'Asia/Magadan',\n        'Asia/Makassar',\n        'Asia/Manila',\n        'Asia/Nicosia',\n        'Asia/Novokuznetsk',\n        'Asia/Novosibirsk',\n        'Asia/Omsk',\n        'Asia/Oral',\n        'Asia/Pontianak',\n        'Asia/Pyongyang',\n        'Asia/Qatar',\n        'Asia/Qostanay',\n        'Asia/Qyzylorda',\n        'Asia/Riyadh',\n        'Asia/Sakhalin',\n        'Asia/Samarkand',\n        'Asia/Seoul',\n        'Asia/Shanghai',\n        'Asia/Singapore',\n        'Asia/Srednekolymsk',\n        'Asia/Taipei',\n        'Asia/Tashkent',\n        'Asia/Tbilisi',\n        'Asia/Tehran',\n        'Asia/Thimphu',\n        'Asia/Tokyo',\n        'Asia/Tomsk',\n        'Asia/Ulaanbaatar',\n        'Asia/Urumqi',\n        'Asia/Ust-Nera',\n        'Asia/Vladivostok',\n        'Asia/Yakutsk',\n        'Asia/Yangon',\n        'Asia/Yekaterinburg',\n        'Asia/Yerevan',\n    ];\n\n    static antarcticaZones = [\n        'Antarctica/Casey',\n        'Antarctica/Davis',\n        'Antarctica/DumontDUrville',\n        'Antarctica/Macquarie',\n        'Antarctica/Mawson',\n        'Antarctica/Palmer',\n        'Antarctica/Rothera',\n        'Antarctica/Syowa',\n        'Antarctica/Troll',\n        'Antarctica/Vostok',\n    ];\n\n    static americaZones = [\n        'America/Adak',\n        'America/Anchorage',\n        'America/Araguaina',\n        'America/Argentina/Buenos_Aires',\n        'America/Argentina/Catamarca',\n        'America/Argentina/Cordoba',\n        'America/Argentina/Jujuy',\n        'America/Argentina/La_Rioja',\n        'America/Argentina/Mendoza',\n        'America/Argentina/Rio_Gallegos',\n        'America/Argentina/Salta',\n        'America/Argentina/San_Juan',\n        'America/Argentina/San_Luis',\n        'America/Argentina/Tucuman',\n        'America/Argentina/Ushuaia',\n        'America/Asuncion',\n        'America/Atikokan',\n        'America/Bahia',\n        'America/Bahia_Banderas',\n        'America/Barbados',\n        'America/Belem',\n        'America/Belize',\n        'America/Blanc-Sablon',\n        'America/Boa_Vista',\n        'America/Bogota',\n        'America/Boise',\n        'America/Cambridge_Bay',\n        'America/Campo_Grande',\n        'America/Cancun',\n        'America/Caracas',\n        'America/Cayenne',\n        'America/Chicago',\n        'America/Chihuahua',\n        'America/Costa_Rica',\n        'America/Creston',\n        'America/Cuiaba',\n        'America/Curacao',\n        'America/Danmarkshavn',\n        'America/Dawson',\n        'America/Dawson_Creek',\n        'America/Denver',\n        'America/Detroit',\n        'America/Edmonton',\n        'America/Eirunepe',\n        'America/El_Salvador',\n        'America/Fort_Nelson',\n        'America/Fortaleza',\n        'America/Glace_Bay',\n        'America/Godthab',\n        'America/Goose_Bay',\n        'America/Grand_Turk',\n        'America/Guatemala',\n        'America/Guayaquil',\n        'America/Guyana',\n        'America/Halifax',\n        'America/Havana',\n        'America/Hermosillo',\n        'America/Indiana/Indianapolis',\n        'America/Indiana/Knox',\n        'America/Indiana/Marengo',\n        'America/Indiana/Petersburg',\n        'America/Indiana/Tell_City',\n        'America/Indiana/Vevay',\n        'America/Indiana/Vincennes',\n        'America/Indiana/Winamac',\n        'America/Inuvik',\n        'America/Iqaluit',\n        'America/Jamaica',\n        'America/Juneau',\n        'America/Kentucky/Louisville',\n        'America/Kentucky/Monticello',\n        'America/La_Paz',\n        'America/Lima',\n        'America/Los_Angeles',\n        'America/Maceio',\n        'America/Managua',\n        'America/Manaus',\n        'America/Martinique',\n        'America/Matamoros',\n        'America/Mazatlan',\n        'America/Menominee',\n        'America/Merida',\n        'America/Metlakatla',\n        'America/Mexico_City',\n        'America/Miquelon',\n        'America/Moncton',\n        'America/Monterrey',\n        'America/Montevideo',\n        'America/Nassau',\n        'America/New_York',\n        'America/Nipigon',\n        'America/Nome',\n        'America/Noronha',\n        'America/North_Dakota/Beulah',\n        'America/North_Dakota/Center',\n        'America/North_Dakota/New_Salem',\n        'America/Ojinaga',\n        'America/Panama',\n        'America/Pangnirtung',\n        'America/Paramaribo',\n        'America/Phoenix',\n        'America/Port-au-Prince',\n        'America/Port_of_Spain',\n        'America/Porto_Velho',\n        'America/Puerto_Rico',\n        'America/Punta_Arenas',\n        'America/Rainy_River',\n        'America/Rankin_Inlet',\n        'America/Recife',\n        'America/Regina',\n        'America/Resolute',\n        'America/Rio_Branco',\n        'America/Santarem',\n        'America/Santiago',\n        'America/Santo_Domingo',\n        'America/Sao_Paulo',\n        'America/Scoresbysund',\n        'America/Sitka',\n        'America/St_Johns',\n        'America/Swift_Current',\n        'America/Tegucigalpa',\n        'America/Thule',\n        'America/Thunder_Bay',\n        'America/Tijuana',\n        'America/Toronto',\n        'America/Vancouver',\n        'America/Whitehorse',\n        'America/Winnipeg',\n        'America/Yakutat',\n        'America/Yellowknife',\n    ];\n\n    static pacificZones = [\n        'Pacific/Apia',\n        'Pacific/Auckland',\n        'Pacific/Bougainville',\n        'Pacific/Chatham',\n        'Pacific/Chuuk',\n        'Pacific/Easter',\n        'Pacific/Efate',\n        'Pacific/Enderbury',\n        'Pacific/Fakaofo',\n        'Pacific/Fiji',\n        'Pacific/Funafuti',\n        'Pacific/Galapagos',\n        'Pacific/Gambier',\n        'Pacific/Guadalcanal',\n        'Pacific/Guam',\n        'Pacific/Honolulu',\n        'Pacific/Kiritimati',\n        'Pacific/Kosrae',\n        'Pacific/Kwajalein',\n        'Pacific/Majuro',\n        'Pacific/Marquesas',\n        'Pacific/Nauru',\n        'Pacific/Niue',\n        'Pacific/Norfolk',\n        'Pacific/Noumea',\n        'Pacific/Pago_Pago',\n        'Pacific/Palau',\n        'Pacific/Pitcairn',\n        'Pacific/Pohnpei',\n        'Pacific/Port_Moresby',\n        'Pacific/Rarotonga',\n        'Pacific/Tahiti',\n        'Pacific/Tarawa',\n        'Pacific/Tongatapu',\n        'Pacific/Wake',\n        'Pacific/Wallis',\n    ];\n\n    static australiaZones = [\n        'Australia/Adelaide',\n        'Australia/Brisbane',\n        'Australia/Broken_Hill',\n        'Australia/Currie',\n        'Australia/Darwin',\n        'Australia/Eucla',\n        'Australia/Hobart',\n        'Australia/Lindeman',\n        'Australia/Lord_Howe',\n        'Australia/Melbourne',\n        'Australia/Perth',\n        'Australia/Sydney',\n    ];\n\n    static atlanticZones = [\n        'Atlantic/Azores',\n        'Atlantic/Bermuda',\n        'Atlantic/Canary',\n        'Atlantic/Cape_Verde',\n        'Atlantic/Faroe',\n        'Atlantic/Madeira',\n        'Atlantic/Reykjavik',\n        'Atlantic/South_Georgia',\n        'Atlantic/Stanley',\n    ];\n\n    static indianZones = [\n        'Indian/Chagos',\n        'Indian/Christmas',\n        'Indian/Cocos',\n        'Indian/Kerguelen',\n        'Indian/Mahe',\n        'Indian/Maldives',\n        'Indian/Mauritius',\n        'Indian/Reunion',\n    ];\n\n\n}\n","import { Node, SettingType} from '../../node';\nimport { Container, Side } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nconst moment = require('moment');\n\nexport class ClockNode extends Node {\n  lastInterval = 1000;\n  timeoutFunc;\n\n  constructor() {\n    super();\n    this.title = 'Clock';\n    this.description =\n      \"Outputs the System Time in various forms. Standard outputs are: Time('timeString') Hours('hour'), Minutes('min'), and Seconds('sec'). There are also Advanced outputs which can be enabled from settings. The Advanced outputs are: Milliseconds(millis), Time String including timezone ('longString'), Timezone Offset from UTC('TZOffset'), and Unix Timestamp ('epoch'). interval is the output update frequency.   interval units can be configured from settings. Maximum interval setting is 587 hours.\";\n\n    this.addOutput('timeString', Type.STRING);\n    this.addOutput('hour', Type.NUMBER);\n    this.addOutput('min', Type.NUMBER);\n    this.addOutput('sec', Type.NUMBER);\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Interval');\n\n    this.settings['time'] = {\n      description: 'Time',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ time: {}, interval: { weight: 2 } }],\n    });\n\n    this.settings['advanced'] = {\n      description: 'Show Advanced Options',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n\n    this.properties['advancedOutputs'] = false;\n  }\n\n  init() {\n    if (this.settings['advanced'].value) {\n      this.addOutputs();\n    }\n  }\n\n  onAdded() {\n    this.inputs[0]['name'] = `[interval] (${this.settings['time'].value})`;\n    clearInterval(this.timeoutFunc);\n    let interval = this.getInputData(0);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    this.timeoutFunc = setInterval(() => {\n      this.recalculate();\n    }, interval);\n    this.lastInterval = interval;\n    this.recalculate();\n  }\n\n  onInputUpdated() {\n    let interval = this.getInputData(0);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    if (interval != this.lastInterval) {\n      this.lastInterval = interval;\n      clearInterval(this.timeoutFunc);\n      this.timeoutFunc = setInterval(() => {\n        this.recalculate();\n      }, interval);\n    }\n  }\n\n  recalculate() {\n    if (this.side !== Side.server) return;\n    const advanced = this.settings['advanced'].value;\n    const now = moment();\n    this.setOutputData(0, now.format('HH:mm:ss'), true);\n    this.setOutputData(1, now.hours(), true);\n    this.setOutputData(2, now.minutes(), true);\n    this.setOutputData(3, now.seconds(), true);\n    if (advanced) {\n      this.setOutputData(4, now.milliseconds(), true);\n      this.setOutputData(5, now.toString(), true);\n      this.setOutputData(6, now.utcOffset() / 60, true);\n      this.setOutputData(7, now.valueOf(), true);\n    }\n  }\n\n  onAfterSettingsChange() {\n    const advanced = this.settings['advanced'].value;\n    this.inputs[0]['name'] = `[interval] (${this.settings['time'].value})`;\n    if (advanced && !this.properties['advancedOutputs']) {\n      this.addOutputs();\n      this.properties['advancedOutputs'] = true;\n      this.persistProperties(false, true);\n    } else if (!advanced && this.properties['advancedOutputs']) {\n      this.removeOutput(4);\n      this.removeOutput(5);\n      this.removeOutput(6);\n      this.removeOutput(7);\n      this.properties['advancedOutputs'] = false;\n      this.persistProperties(false, true);\n    }\n    this.updateNodeOutput();\n    this.onInputUpdated();\n  }\n\n  private addOutputs() {\n    this.addOutput('millis', Type.NUMBER);\n    this.addOutput('longString', Type.STRING);\n    this.addOutput('TZOffset', Type.NUMBER);\n    this.addOutput('epoch', Type.NUMBER);\n  }\n}\nContainer.registerNodeType('time/clock', ClockNode);\n","import { Node} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nexport class DateNode extends Node {\n  interval = 5000;\n  timeoutFunc;\n  constructor() {\n    super();\n    this.title = 'Date';\n    this.description =\n      \"Outputs various date information based on the system time.  String 'dateString' is the current date.  String 'dayString' is the current day of the week. Numeric 'dayOfWeek' is an integer between 0 and 6 corresponding to Sunday(0) through Saturday(6).  Numeric 'date' is and integer of the current date.  Numeric 'month' is an integer of the current month Jan(0) - Dec(12).  Numeric 'year' is an integer of the current year.\";\n    this.addOutput('dateString', Type.STRING);\n    this.addOutput('dayString', Type.STRING);\n    this.addOutput('dayOfWeek', Type.NUMBER);\n    this.addOutput('date', Type.NUMBER);\n    this.addOutput('month', Type.NUMBER);\n    this.addOutput('year', Type.NUMBER);\n  }\n\n  onAdded() {\n    clearInterval(this.timeoutFunc);\n    this.timeoutFunc = setInterval(() => {\n      this.recalculate();\n    }, this.interval);\n    this.recalculate();\n  }\n\n  recalculate() {\n    let now = new Date();\n    const day = now.getDay();\n    let dayString: string = null;\n    switch (day) {\n      case 0:\n        dayString = 'Sunday';\n        break;\n      case 1:\n        dayString = 'Monday';\n        break;\n      case 2:\n        dayString = 'Tuesday';\n        break;\n      case 3:\n        dayString = 'Wednesday';\n        break;\n      case 4:\n        dayString = 'Thursday';\n        break;\n      case 5:\n        dayString = 'Friday';\n        break;\n      case 6:\n        dayString = 'Saturday';\n        break;\n    }\n    this.setOutputData(0, now.toLocaleDateString(), true);\n    this.setOutputData(1, dayString, true);\n    this.setOutputData(2, day, true);\n    this.setOutputData(3, now.getDate(), true);\n    this.setOutputData(4, now.getMonth() + 1, true);\n    this.setOutputData(5, now.getFullYear(), true);\n  }\n}\nContainer.registerNodeType('time/date', DateNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport * as moment from 'moment';\nimport { Type } from '../../node-io';\n\nenum TIME_TYPE {\n  TIME = 'time string as input (YY:MM:DD)',\n  EPOCH = 'time epoch as input (1597662977823)'\n}\n\nexport class TimeDiffNode extends Node {\n  conversionFunction;\n  constructor() {\n    super();\n    this.title = 'Date Difference';\n    this.description =\n      `## Description\\n ` +\n      ` The is node is used to compare the difference between two timestamps\\n `+\n      `## Inputs\\n ` +\n      ` The inputs can be sent as a unix timestamp ***epoch***. Change the settings ***Time input type*** for different input type \\n `+\n      `## Outputs (return data type is ***JSON***)\\n ` +\n      ` ***out-difference-time*** will return the time difference in for example: ***hours: 1, minutes: 30 ***\\n `+\n      ` ***out-difference-totals*** will return the time difference in for example: ***hours: 1, minutes: 90 ***\\n `\n\n    this.addInput('time-compare-1', Type.ANY);\n    this.addInput('time-compare-2', Type.ANY);\n    this.addOutput('out-difference-time', Type.ANY);\n    this.addOutput('out-difference-totals', Type.ANY);\n    this.settings['time'] = {\n      description: 'Time input type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          // { value: TIME_TYPE.TIME, text: TIME_TYPE.TIME },\n          { value: TIME_TYPE.EPOCH, text: TIME_TYPE.EPOCH },\n        ],\n      },\n      value: TIME_TYPE.TIME,\n    };\n\n\n  }\n  onAdded() {\n    this.onAfterSettingsChange();\n  }\n\n  onInputUpdated() {\n    const date1 = this.getInputData(0);\n    const date2 = this.getInputData(1);\n    const timeType = this.settings['time'].value\n    try {\n      if (timeType === TIME_TYPE.TIME) {\n        this.setOutputData(0, this.diffTime(moment(date1), date2));\n        this.setOutputData(1, this.diffTotals(moment(date1), date2));\n      } else if (timeType === TIME_TYPE.EPOCH) {\n        this.setOutputData(0, this.diffTime(moment(parseInt(date1)), moment(parseInt(date2))));\n        this.setOutputData(1, this.diffTotals(moment(parseInt(date1)), moment(parseInt(date2))));\n      }\n    } catch (e) {\n      this.debugWarn(`ERROR: trying to convert a timezone ${e}`);\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated()\n  }\n\n\n  diffTime(date1: any, date2: any) {\n    let years = date1.diff(date2, 'year');\n    date2.add(years, 'years');\n    let months = date1.diff(date2, 'months');\n    date2.add(months, 'months');\n    let days = date1.diff(date2, 'days');\n    date2.add(days, 'days');\n    let hours = date1.diff(date2, 'hours');\n    date2.add(hours, 'hours');\n    let minutes = date1.diff(date2, 'minutes');\n    date2.add(minutes, 'minutes');\n    let seconds = date1.diff(date2, 'seconds');\n    let ms = date1.diff(date2);\n    return { years, months, days, hours, minutes, seconds, ms };\n  }\n\n  diffTotals(date1: any, date2: any) {\n    let years = date1.diff(date2, 'year');\n    let months = date1.diff(date2, 'months');\n    let days = date1.diff(date2, 'days');\n    let hours = date1.diff(date2, 'hours');\n    let minutes = date1.diff(date2, 'minutes');\n    let seconds = date1.diff(date2, 'seconds');\n    let ms = date1.diff(date2);\n    return { years, months, days, hours, minutes, seconds, ms };\n  }\n\n}\n\nContainer.registerNodeType('time/date-difference', TimeDiffNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\nimport TimeUtils from '../../utils/time-utils';\n\nclass StopwatchNode extends Node {\n  lastRunVal = false;\n  lastResetVal = false;\n  lastInterval = 100;\n  runState = false;\n  startTime = null;\n  elapsed = 0;\n  units = 1;\n  digits = 3;\n  timeoutFunc;\n\n  constructor() {\n    super();\n    this.title = 'Stopwatch';\n    this.description =\n      \"This node converts between Time units Days('day'), Hours('hour'), Minutes('min'), Seconds('sec'), and Milliseconds('milli'). Input type can be selected from settings. Outputs will change based on selected input type. The number of decimal places that output values have can be set from the 'Precision' setting.  interval units can be configured from settings. Maximum interval setting is 587 hours.\";\n    this.addInputWithSettings('enable', Type.BOOLEAN, 0, 'Enable', false);\n    this.addInput('reset', Type.BOOLEAN);\n\n    this.settings['units'] = {\n      description: 'Output Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 1, text: 'Milliseconds' },\n          { value: 1000, text: 'Seconds' },\n          { value: 60000, text: 'Minutes' },\n          { value: 3.6e6, text: 'Hours' },\n          { value: 8.64e7, text: 'Days' },\n        ],\n      },\n      value: 1,\n    };\n    this.addInputWithSettings('interval', Type.NUMBER, 200, 'Count Interval', false);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'milliseconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n    this.addOutput('elapsed', Type.NUMBER);\n\n    this.setOutputData(0, null);\n    this.elapsed = 0;\n  }\n\n  onAdded() {\n    this.runState = false;\n    this.setOutputData(0, this.elapsed);\n    this.inputs[2]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.outputs[0]['name'] = '[elapsed] (milliseconds)';\n    this.onAfterSettingsChange();\n  }\n\n  onInputUpdated() {\n    let run = this.getInputData(0);\n    let reset = this.getInputData(1);\n\n    if (reset && !this.lastResetVal) {\n      this.elapsed = 0;\n      this.startTime = Date.now();\n      this.setOutputData(0, 0, true);\n    }\n    this.lastResetVal = reset;\n\n    let interval = this.getInputData(2);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    if (interval != this.lastInterval && this.runState) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, Date.now() - this.startTime + this.elapsed, true);\n      this.timeoutFunc = setInterval(() => {\n        const output = (Date.now() - this.startTime + this.elapsed) / this.units;\n        this.setOutputData(0, Utils.toFixedNumber(output, this.digits), true);\n      }, interval);\n      this.lastInterval = interval;\n    }\n\n    if (run && !this.lastRunVal) {\n      this.setOutputData(0, this.elapsed, true);\n      this.runState = true;\n      this.startTime = Date.now();\n      this.timeoutFunc = setInterval(() => {\n        const output = (Date.now() - this.startTime + this.elapsed) / this.units;\n        this.setOutputData(0, Utils.toFixedNumber(output, this.digits), true);\n      }, interval);\n      this.lastRunVal = run;\n    } else if (!run && this.lastRunVal) {\n      clearInterval(this.timeoutFunc);\n      this.elapsed = Date.now() - this.startTime + this.elapsed;\n      this.runState = false;\n      this.setOutputData(0, this.elapsed, true);\n      this.lastRunVal = run;\n    }\n\n    /*\n    if (run && run != this.lastRunVal) {\n      this.runState = true;\n      this.startTime = Date.now();\n      this.timeoutFunc = setInterval(() => {\n        const output = (Date.now() - this.startTime + this.elapsed) / this.units;\n        this.setOutputData(0, Utils.toFixedNumber(output, this.digits), true);\n      }, interval);\n      this.lastRunVal = run;\n    } else if (!run && run != this.lastRunVal) {\n      this.elapsed = Date.now() - this.startTime + this.elapsed;\n      this.runState = false;\n      clearInterval(this.timeoutFunc);\n      this.lastRunVal = run;\n    }\n\n*/\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[2]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.units = Number(this.settings['units'].value);\n    switch (this.units) {\n      case 1:\n        this.outputs[0]['name'] = '[elapsed] (milliseconds)';\n        break;\n      case 1000:\n        this.outputs[0]['name'] = '[elapsed] (seconds)';\n        break;\n      case 60000:\n        this.outputs[0]['name'] = '[elapsed] (minutes)';\n        break;\n      case 3.6e6:\n        this.outputs[0]['name'] = '[elapsed] (hours)';\n        break;\n      case 8.64e7:\n        this.outputs[0]['name'] = '[elapsed] (days)';\n        break;\n      default:\n        this.outputs[0]['name'] = '[elapsed] (milliseconds)';\n    }\n\n    const output = Number(this.outputs[0].data) / this.units;\n    this.setOutputData(0, Utils.toFixedNumber(output, this.digits), true);\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('time/stopwatch', StopwatchNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nconst CronJob = require('cron').CronJob;\n// const parser = require('cron-parser');\n//const cronTime = require('cron-time-generator');\nconst jsonata = require('jsonata');\nconst construe = require('cronstrue');\n\nexport class CronIntervalNode extends Node {\n  job = null;\n  jobCronExp = '';\n  timeoutFunc;\n  constructor() {\n    super();\n    this.title = 'Cron Interval';\n    this.description =\n      \"This node triggers 'output' to transition from 'false' to 'true' for 500 milliseconds at a selected times/intervals, configured in settings.  'info' will show information about the status of the node. 'cronExpression' represents the configured scheduled timings in Cron notation. 'cronDescription' represents the configured scheduled timings in plain english. 'nextExecution' is a String output representing the datetime that the next 'message' will be sent from 'output'. For more information on Cron Expressions see: (https://www.freeformatter.com/cron-expression-generator-quartz.html)\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, false, 'Enable', false);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('info', Type.STRING);\n    this.addOutput('cronExpression', Type.STRING);\n    this.addOutput('cronDescription', Type.STRING);\n    this.addOutput('nextExecution', Type.STRING);\n\n    this.settings['timezone'] = {\n      description: 'Enter the cron time zone',\n      value: 'Australia/Sydney',\n      type: SettingType.STRING,\n    };\n    this.settings['cron-type'] = {\n      description: 'Cron Type',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 0, text: 'Every Minutes (At every xth minute)' },\n          { value: 1, text: 'Every Hours (At minute x past every xth hour.)' },\n          { value: 2, text: 'Every Days (At x:xx every x days)' },\n          { value: 8, text: 'Every Day At Time (x:xx)' },\n          { value: 3, text: 'Every Month (Start of every month)' },\n          { value: 4, text: 'Every Month On (On x Day at x:xx)' },\n          { value: 5, text: 'Every Year (Start of every year)' },\n          { value: 6, text: 'Every Year On (On x month x day at x:xx)' },\n          { value: 7, text: 'Between Days (At x:xx between x and x day of the month)' },\n        ],\n      },\n      value: 0,\n    };\n    this.settings['min'] = {\n      description: 'Set minute',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n    this.settings['hour'] = {\n      description: 'Set hour',\n      value: 13,\n      type: SettingType.NUMBER,\n    };\n    this.settings['day'] = {\n      description: 'Set day',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n    this.settings['dayBetweenStart'] = {\n      description: 'Day Range Start',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n    this.settings['dayBetweenEnd'] = {\n      description: 'Day Range End',\n      value: 15,\n      type: SettingType.NUMBER,\n    };\n    this.settings['month'] = {\n      description: 'Set month',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n\n    this.setSettingsConfig({\n      groups: [{ dayBetweenStart: {}, dayBetweenEnd: {} }],\n      conditions: {\n        min: setting => {\n          const cronSetting = setting['cron-type'].value;\n          return (\n            cronSetting == 0 ||\n            cronSetting == 1 ||\n            cronSetting == 2 ||\n            cronSetting == 4 ||\n            cronSetting == 6 ||\n            cronSetting == 7 ||\n            cronSetting == 8\n          );\n        },\n        hour: setting => {\n          const cronSetting = setting['cron-type'].value;\n          return (\n            cronSetting == 1 ||\n            cronSetting == 2 ||\n            cronSetting == 4 ||\n            cronSetting == 6 ||\n            cronSetting == 7 ||\n            cronSetting == 8\n          );\n        },\n        day: setting => {\n          const cronSetting = setting['cron-type'].value;\n          return cronSetting == 2 || cronSetting == 4 || cronSetting == 6 || cronSetting == 7;\n        },\n        dayBetweenStart: setting => {\n          const cronSetting = setting['cron-type'].value;\n          return cronSetting == 7;\n        },\n        dayBetweenEnd: setting => {\n          const cronSetting = setting['cron-type'].value;\n          return cronSetting == 7;\n        },\n        month: setting => {\n          const cronSetting = setting['cron-type'].value;\n          return cronSetting == 6;\n        },\n      },\n    });\n  }\n\n  onAdded() {\n    clearInterval(this.timeoutFunc);\n    this.setOutputData(0, false);\n    this.onAfterSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n\n  onRemoved() {\n    //remove the job on delete of the node\n    if (this.job) this.job.stop();\n  }\n\n  jsonataQuery(nextJobs) {\n    //use jsonata to filter the next scheduled time\n    let expression = jsonata('_d');\n    return expression.evaluate(nextJobs);\n  }\n\n  onInputUpdated() {\n    const enable = this.getInputData(0);\n    const minute = parseInt(this.settings['min'].value);\n    const hour = parseInt(this.settings['hour'].value);\n    const day = parseInt(this.settings['day'].value);\n    const dayBetweenStart = parseInt(this.settings['dayBetweenStart'].value);\n    const dayBetweenEnd = parseInt(this.settings['dayBetweenEnd'].value);\n    const month = parseInt(this.settings['month'].value);\n    const timezone = this.settings['timezone'].value;\n    const cronType = this.settings['cron-type'].value;\n    let cronExp = null;\n\n    if (enable) {\n      cronExp = 'invalid';\n      //build the cronjob string\n      if (cronType == 0 && minute >= 0 && minute < 60) {\n        // 'Every Minutes (At every xth minute)'\n        // cronExp = cronTime.every(minute).minutes();\n        cronExp = '*/' + minute + ' * * * *';\n      } else if (cronType == 1 && minute >= 0 && minute < 60 && hour >= 0 && hour < 24) {\n        // 'Every Hours (At minute x past every xth hour.)'\n        //cronExp = cronTime.every(hour).hours();\n        cronExp = minute + ' */' + hour + ' * * *';\n      } else if (cronType == 2 && minute >= 0 && minute < 60 && hour >= 0 && hour < 24 && day > 0 && day <= 31) {\n        // 'Every Days (At x:xx every x days)'\n        //cronExp = cronTime.every(day).days(hour, minute);\n        cronExp = minute + ' ' + hour + ' */' + day + ' * *';\n      } else if (cronType == 3) {\n        // 'Every Month (Start of every month)'\n        //cronExp = cronTime.everyMonth();\n        cronExp = '0 0 1 * *';\n      } else if (cronType == 4 && minute >= 0 && minute < 60 && hour >= 0 && hour < 24 && day > 0 && day <= 31) {\n        // 'Every Month On (On x Day at x:xx)'\n        //cronExp = cronTime.everyMonthOn(day, hour, minute);\n        cronExp = minute + ' ' + hour + ' ' + day + ' * *';\n      } else if (cronType == 5) {\n        // 'Every Year (Start of every year)'\n        //cronExp = cronTime.everyYear();\n        cronExp = '0 0 1 1 *';\n      } else if (\n        cronType == 6 &&\n        minute >= 0 &&\n        minute < 60 &&\n        hour >= 0 &&\n        hour < 24 &&\n        day > 0 &&\n        day <= 31 &&\n        month >= 0 &&\n        month <= 12\n      ) {\n        // 'Every Year On (On x month x day at x:xx)'\n        //cronExp = cronTime.everyYearIn(month, day, hour, minute);\n        cronExp = minute + ' ' + hour + ' ' + day + ' ' + month + ' *';\n      } else if (\n        cronType == 7 &&\n        minute >= 0 &&\n        minute < 60 &&\n        hour >= 0 &&\n        hour < 24 &&\n        dayBetweenStart < dayBetweenEnd &&\n        dayBetweenStart >= 1 &&\n        dayBetweenStart <= 30 &&\n        dayBetweenEnd >= 2 &&\n        dayBetweenEnd <= 31\n      ) {\n        //'Between Days (Between  x - x th day of the month)'\n        //cronExp = cronTime.between(day, dayBetween).days();\n        cronExp = minute + ' ' + hour + ' ' + dayBetweenStart + '-' + dayBetweenEnd + ' * *';\n      } else if (cronType == 8 && minute >= 0 && minute < 60 && hour >= 0 && hour < 24) {\n        // 'Every Day At Time (x:xx)'\n        cronExp = minute + ' ' + hour + ' * * *';\n      }\n    }\n    if (!enable || cronExp == null || cronExp === 'invalid') {\n      if (cronExp === 'invalid') this.setOutputData(1, 'invalid configuration');\n      else this.setOutputData(1, 'CRON job stopped');\n      try {\n        if (this.job) this.job.stop();\n      } catch (err) {\n        this.setOutputData(1, err);\n      }\n      this.job = null;\n      this.jobCronExp = '';\n      this.setOutputData(0, false, true);\n      this.setOutputData(2, null, true);\n      this.setOutputData(3, null, true);\n      this.setOutputData(4, null, true);\n      return;\n    }\n\n    if (this.job && cronExp !== this.jobCronExp) {\n      this.setOutputData(1, 'CRON job stopped');\n      this.job.stop();\n      this.job = null;\n      this.jobCronExp = '';\n    }\n    try {\n      this.jobCronExp = cronExp;\n      this.setOutputData(2, cronExp);\n      this.setOutputData(3, construe.toString(cronExp));\n      this.job = new CronJob(\n        cronExp,\n        () => {\n          this.setOutputData(0, true);\n          this.timeoutFunc = setTimeout(() => {\n            this.setOutputData(0, false);\n          }, 500);\n          //get next job\n          let nextJobs = this.job.nextDates(1);\n          this.setOutputData(4, this.jsonataQuery(nextJobs));\n        },\n        null,\n        null,\n        timezone,\n      );\n      setTimeout(function() {}, 500);\n      this.setOutputData(1, 'CRON job started');\n      this.job.start();\n      let nextJobs = this.job.nextDates(1);\n      this.setOutputData(4, this.jsonataQuery(nextJobs));\n    } catch (err) {\n      this.setOutputData(1, err);\n    }\n  }\n}\nContainer.registerNodeType('time/cron-interval', CronIntervalNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\n\nconst CronJob = require('cron').CronJob;\n//const parser = require('cron-parser');\n//const cb = require('dx-cron-builder');\nconst jsonata = require('jsonata');\nconst construe = require('cronstrue');\n\nexport class CronWeeklyNode extends Node {\n  job = null;\n  jobCronExp = '';\n  timeoutFunc;\n  constructor() {\n    super();\n    this.title = 'Cron Weekly';\n    this.description =\n      \"This node triggers 'output' to transition from 'false' to 'true' for 500 milliseconds at a configured time on each selected day. Days and Times are set in settings. 'info' will show information about the status of the node. 'cronExpression' represents the configured scheduled timings in Cron notation. 'cronDescription' represents the configured scheduled timings in plain english. 'nextExecution' is a String output representing the datetime that the next 'message' will be sent from 'output'. For more information on Cron Expressions see: (https://www.freeformatter.com/cron-expression-generator-quartz.html)\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, false, 'Enable', false);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('info', Type.STRING);\n    this.addOutput('cronExpression', Type.STRING);\n    this.addOutput('cronDescription', Type.STRING);\n    this.addOutput('nextExecution', Type.STRING);\n    this.settings['timezone'] = {\n      description: 'Enter the cron time zone',\n      value: 'Australia/Sydney',\n      type: SettingType.STRING,\n    };\n\n    this.settings['min'] = {\n      description: 'Set minute',\n      value: 0,\n      type: SettingType.NUMBER,\n    };\n    this.settings['hour'] = {\n      description: 'Set hour',\n      value: 6,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['sunday'] = {\n      description: 'sunday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['monday'] = {\n      description: 'monday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['tuesday'] = {\n      description: 'tuesday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['wednesday'] = {\n      description: 'wednesday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['thursday'] = {\n      description: 'thursday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['friday'] = {\n      description: 'friday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n    this.settings['saturday'] = {\n      description: 'saturday',\n      value: false,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  onAdded() {\n    clearInterval(this.timeoutFunc);\n    this.setOutputData(0, false);\n    this.onAfterSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n\n  onRemoved() {\n    //remove the job on delete of the node\n    if (this.job) this.job.stop();\n  }\n\n  jsonataQuery(nextJobs) {\n    //use jsonata to filter the next scheduled time\n    let expression = jsonata('_d');\n    return expression.evaluate(nextJobs);\n  }\n\n  onInputUpdated() {\n    const enable = this.getInputData(0);\n    let cronExp = null;\n    //make sure the times are correct\n    if (enable) {\n      cronExp = 'invalid';\n      const minute = this.settings['min'].value;\n      const hour = this.settings['hour'].value;\n      if (minute >= 0 && minute <= 59 && hour >= 0 && hour < 24) {\n        cronExp = minute + ' ' + hour + ' * * ';\n        let daysArray = [];\n        if (this.settings['sunday'].value) daysArray.push('0');\n        if (this.settings['monday'].value) daysArray.push('1');\n        if (this.settings['tuesday'].value) daysArray.push('2');\n        if (this.settings['wednesday'].value) daysArray.push('3');\n        if (this.settings['thursday'].value) daysArray.push('4');\n        if (this.settings['friday'].value) daysArray.push('5');\n        if (this.settings['saturday'].value) daysArray.push('6');\n        cronExp += daysArray.join(',');\n      }\n    }\n    if (!enable || cronExp == null || cronExp === 'invalid') {\n      if (cronExp === 'invalid') this.setOutputData(1, 'invalid configuration');\n      else this.setOutputData(1, 'CRON job stopped');\n      try {\n        if (this.job) this.job.stop();\n      } catch (err) {\n        this.setOutputData(1, err);\n      }\n      this.job = null;\n      this.jobCronExp = '';\n      this.setOutputData(0, false, true);\n      this.setOutputData(2, null, true);\n      this.setOutputData(3, null, true);\n      this.setOutputData(4, null, true);\n      return;\n    }\n    const timezone = this.settings['timezone'].value;\n    if (this.job && cronExp !== this.jobCronExp) {\n      this.setOutputData(1, 'CRON job stopped');\n      this.job.stop();\n      this.job = null;\n      this.jobCronExp = '';\n    }\n    try {\n      this.jobCronExp = cronExp;\n      this.setOutputData(2, cronExp);\n      this.setOutputData(3, construe.toString(cronExp));\n      this.job = new CronJob(\n        cronExp,\n        () => {\n          this.setOutputData(0, true);\n          this.timeoutFunc = setTimeout(() => {\n            this.setOutputData(0, false);\n          }, 500);\n          //get next job\n          let nextJobs = this.job.nextDates(1);\n          this.setOutputData(4, this.jsonataQuery(nextJobs));\n        },\n        null,\n        null,\n        timezone,\n      );\n      setTimeout(function() {}, 500);\n      this.setOutputData(1, 'CRON job started');\n      this.job.start();\n      let nextJobs = this.job.nextDates(1);\n      this.setOutputData(4, this.jsonataQuery(nextJobs));\n    } catch (err) {\n      this.setOutputData(1, err);\n    }\n  }\n}\nContainer.registerNodeType('time/cron-weekly', CronWeeklyNode);\n","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport { isNull } from '../../../utils/helper';\nconst CronJob = require('cron').CronJob;\nconst jsonata = require('jsonata');\nconst construe = require('cronstrue');\nconst cronValidator = require('cron-validator');\n\nexport class CronExpressionNode extends Node {\n  job = null;\n  jobCronExp = '';\n  timeoutFunc;\n  constructor() {\n    super();\n    this.title = 'Cron Expression';\n    this.description =\n      \"This node triggers 'output' to transition from 'false' to 'true' for 500 milliseconds at times triggered by the 'input' CRON expression. 'info' will show information about the status of the node. 'cronDescription' represents the configured scheduled timings in plain english. 'nextExecution' is a String output representing the datetime that the next 'message' will be sent from 'output'. For more information on Cron Expressions see: (https://www.freeformatter.com/cron-expression-generator-quartz.html)\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable', false);\n    this.addInputWithSettings('cronExpression', Type.STRING, '', 'Cron Expression');\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('info', Type.STRING);\n    this.addOutput('cronDescription', Type.STRING);\n    this.addOutput('nextExecution', Type.STRING);\n    this.settings['timezone'] = {\n      description: 'Enter the cron time zone',\n      value: 'Australia/Sydney',\n      type: SettingType.STRING,\n    };\n  }\n\n  onAdded() {\n    clearInterval(this.timeoutFunc);\n    this.setOutputData(0, false);\n    this.onAfterSettingsChange();\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n\n  onRemoved() {\n    //remove the job on delete of the node\n    if (this.job) this.job.stop();\n  }\n\n  jsonataQuery(nextJobs) {\n    //use jsonata to filter the next scheduled time\n    let expression = jsonata('_d');\n    return expression.evaluate(nextJobs);\n  }\n\n  onInputUpdated() {\n    const enable = this.getInputData(0);\n    const cronExp = this.getInputData(1);\n    const valid = cronValidator.isValidCron(cronExp);\n    // console.log('valid?', valid)\n    if (!enable || !valid) {\n      if (!valid) {\n        this.setOutputData(1, 'invalid CRON Expression');\n        // console.log('I set the info')\n      }\n      else this.setOutputData(1, 'CRON job stopped');\n      try {\n        if (this.job) this.job.stop();\n      } catch (err) {\n        // console.log('err', err)\n        this.setOutputData(1, err);\n      }\n      this.job = null;\n      this.jobCronExp = '';\n      this.setOutputData(0, false, true);\n      this.setOutputData(2, null, true);\n      this.setOutputData(3, null, true);\n      return;\n    }\n\n    const timezone = this.settings['timezone'].value;\n    if (this.job && cronExp !== this.jobCronExp) {\n      this.setOutputData(1, 'CRON job stopped');\n      this.job.stop();\n      this.job = null;\n      this.jobCronExp = '';\n    }\n    try {\n      this.jobCronExp = cronExp;\n      this.setOutputData(2, construe.toString(cronExp));\n      this.job = new CronJob(\n        cronExp,\n        () => {\n          this.setOutputData(0, true);\n          this.timeoutFunc = setTimeout(() => {\n            this.setOutputData(0, false);\n          }, 500);\n          //get next job\n          if (isNull(this.job)) return\n          let nextJobs = this.job.nextDates(1);\n          this.setOutputData(3, this.jsonataQuery(nextJobs));\n        },\n        null,\n        null,\n        timezone,\n      );\n      setTimeout(function () { }, 500);\n      this.setOutputData(1, 'CRON job started');\n      this.job.start();\n      let nextJobs = this.job.nextDates(1);\n      this.setOutputData(3, this.jsonataQuery(nextJobs));\n    } catch (err) {\n      this.setOutputData(1, err);\n    }\n  }\n}\nContainer.registerNodeType('time/cron-expression', CronExpressionNode);\n","module.exports = require(\"cron-validator\");","import { Node, SettingType } from '../../node';\nimport { Container } from '../../container';\nimport * as moment from 'moment';\nimport { Type } from '../../node-io';\nexport class TimestampGeneratorNode extends Node {\n\n  constructor() {\n    super();\n    this.title = 'Timestamp Generator';\n    this.description =\n    `## Description\\n ` +\n    ` The is node is used to generate a timestamps\\n `+\n    `## Inputs\\n ` +\n    ` The an active input a timestamp will be generated based of the device time \\n `+\n    `## Outputs (return data type is ***JSON***)\\n ` +\n    ` ***date-string*** will return the timestamp: **\"2019-08-31T11:54:27+10:00\" ***\\n `+\n    ` ***date-unix*** will return the timestamp: **1598838867***\\n `+\n    ` ***date-format*** will return the time that is formatted as per moment js format options https://momentjs.com/docs/#/displaying/format/*\\n `+\n    `### Formatting options examples\\n ` +\n    `-ENTER in settings\t***LT*** with return 8:30 PM\\n ` +\n    `-ENTER in settings\t***LTS*** with return 8:30:25 PM\\n ` +\n    `-ENTER in settings\t***LLLL*** with return \tThursday, September 4, 1986 8:30 PM\\n `\n    this.addInput('input', Type.ANY);\n    this.addOutput('date-string', Type.STRING);\n    this.addOutput('date-unix', Type.STRING);\n    this.addOutput('date-format', Type.STRING);\n    this.settings['format'] = {\n      description: 'Formatting options',\n      value: \"x\",\n      type: SettingType.STRING,\n    };\n  }\n\n  onAfterSettingsChange() {\n    // this.onInputUpdated()\n  }\n\n  onInputUpdated() {\n    const format = this.settings['format'].value\n    let date = moment()\n    this.setOutputData(0, date.format());\n    this.setOutputData(1, date.unix());\n    this.setOutputData(2, date.format(format));\n  }\n\n\n\n}\nContainer.registerNodeType('time/timestamp-generator', TimestampGeneratorNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass COVNode extends Node {\n  lastValue;\n  timeoutFunc;\n\n  constructor() {\n    super();\n\n    this.title = 'Change Of Value';\n    this.description =\n      \"when 'input' changes value, output becomes 'true' for 'interval' duration, then 'output' changes back to 'false'.  For Numeric 'input' values, the change of value must be greater than the 'threshold' value to trigger the output.\";\n\n    this.addInput('input', Type.ANY);\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Interval');\n    this.addInputWithSettings('threshold', Type.NUMBER, 0, 'COV Threshold');\n    this.addOutput('output', Type.BOOLEAN);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n  }\n\n  onAdded() {\n \n    this.setOutputData(0, false);\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n  }\n  \n  onExecute(){\n    //this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const input = this.getInputData(0);\n    const isNumber = typeof input === 'number';\n    if (this.inputs[0].updated && input !== this.lastValue) {\n      if (\n        typeof this.lastValue !== 'number' ||\n        !isNumber ||\n        (isNumber && Math.abs(input - this.lastValue) >= this.getInputData(2))\n      ) {\n        this.lastValue = input;\n        this.setOutputData(0, true);\n        const interval = TimeUtils.timeConvert(this.getInputData(1), this.settings['time'].value);\n        if (this.timeoutFunc) clearTimeout(this.timeoutFunc);\n        this.timeoutFunc = setTimeout(() => {\n          this.setOutputData(0, false);\n        }, interval);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[1]['name'] = `[interval] (${this.settings['time'].value})`;\n  }\n}\nContainer.registerNodeType('trigger/change-of-value', COVNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport Utils from '../../utils';\n\nclass RandomNode extends Node {\n  state = false;\n  lastVal;\n\n  constructor() {\n    super();\n    this.title = 'Random';\n    this.description =\n      \"When 'trigger' transitions from 'false' to 'true', a random number between 'min' and 'max' values is produced at 'output'.  The number of decimal places that 'output' values have can be set from settings.\";\n\n    this.settings['digits'] = {\n      description: 'Number of decimal places',\n      value: 3,\n      type: SettingType.NUMBER,\n    };\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addInputWithSettings('max', Type.NUMBER, 1, 'Maximum Value');\n    this.addInputWithSettings('min', Type.NUMBER, 0, 'Minimum Value');\n    this.addOutput('output', Type.NUMBER);\n    this.setOutputData(0, null);\n  }\n\n  onAdded() {\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    let trigger = this.getInputData(0);\n    if (trigger == null) {\n      this.lastVal = false;\n      this.setOutputData(0, null);\n      this.state = false;\n    } else if (trigger == this.lastVal) return;\n    if (trigger == true) {\n      const max = this.getInputData(1);\n      const min = this.getInputData(2);\n      this.settings['digits'].value;\n      let digits = this.settings['digits'].value;\n      let result = Math.random() * (max - min) + min;\n      result = Utils.toFixedNumber(result, digits);\n      this.setOutputData(0, result);\n    }\n    this.lastVal = trigger;\n  }\n}\nContainer.registerNodeType('trigger/random', RandomNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nexport class TriggeredInjectNode extends Node {\n  lastTrigger;\n\n  constructor() {\n    super();\n    this.title = 'Inject';\n    this.description =\n      \"While 'enable' is 'true', output will send 'message' value when 'trigger' transitions from 'false' to 'true\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addInputWithSettings('message', Type.STRING, 'true', 'Message');\n    this.addInput('trigger', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n  }\n\n  onCreated() {\n    this.lastTrigger = false;\n  }\n\n  onAdded() {\n    const enable = this.getInputData(0);\n    if (!enable) {\n      this.setOutputData(0, null);\n      return;\n    }\n  }\n\n  onInputUpdated() {\n    const enable = this.getInputData(0);\n    if (!enable) {\n      this.setOutputData(0, null, true);\n      return;\n    }\n    let trigger = this.getInputData(2);\n    if (trigger && !this.lastTrigger) {\n      const message = this.getInputData(1);\n      this.setOutputData(0, message, false);\n    }\n    this.lastTrigger = trigger;\n  }\n\n  onAfterSettingsChange() {}\n}\nContainer.registerNodeType('trigger/inject', TriggeredInjectNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nexport class InjectNode extends Node {\n  lastInterval = 1000;\n  runState: boolean = true;\n  timeoutFunc;\n\n  constructor() {\n    super();\n    this.title = 'Interval Inject';\n    this.description =\n      \"While 'enable' is 'true', output will send 'message' value at every 'interval' period. When 'enable' is 'false', output will be 'null'.  interval units can be configured from settings. Maximum interval setting is 587 hours.\";\n\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addInputWithSettings('message', Type.ANY, 'true', 'Message');\n    this.addInputWithSettings('interval', Type.NUMBER, 1, 'Interval');\n    this.addOutput('output', Type.BOOLEAN);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n  }\n\n  onAdded() {\n    clearInterval(this.timeoutFunc);\n    this.inputs[2]['name'] = `[interval] (${this.settings['time'].value})`;\n    const enable = this.getInputData(0);\n    if (!enable) {\n      this.setOutputData(0, null);\n      this.runState = false;\n      return;\n    }\n    let interval = this.getInputData(2);\n    interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n    this.timeoutFunc = setInterval(() => {\n      const message = this.getInputData(1);\n      this.setOutputData(0, message);\n    }, interval);\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const enable = this.getInputData(0);\n    if (!enable && this.runState) {\n      clearInterval(this.timeoutFunc);\n      this.setOutputData(0, null, true);\n      this.runState = false;\n      return;\n    } else if (!enable && !this.runState) {\n      this.setOutputData(0, null, true);\n      this.runState = false;\n      return;\n    } else if (enable) {\n      let interval = this.getInputData(2);\n      interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n      if (this.runState) {\n        if (interval != this.lastInterval) {\n          this.lastInterval = interval;\n          clearInterval(this.timeoutFunc);\n          this.timeoutFunc = setInterval(() => {\n            const message = this.getInputData(1);\n            this.setOutputData(0, message);\n          }, interval);\n        }\n        return;\n      } else if (!this.runState) {\n        this.runState = true;\n        this.timeoutFunc = setInterval(() => {\n          const message = this.getInputData(1);\n          this.setOutputData(0, message);\n        }, interval);\n      }\n    }\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[2]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('trigger/interval-inject', InjectNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nexport class TimeIteratorNode extends Node {\n  state: boolean = false;\n  runState: boolean = true;\n  complete: boolean = false;\n  lastStart: boolean = false;\n  lastStop: boolean = false;\n  timeoutFunc;\n  count = 0;\n  reqInterval = null;\n  reqIterations = null;\n\n  constructor() {\n    super();\n    this.title = 'Iterator';\n    this.description =\n      \"This node generates a sequence of 'true' messages at 'output'. If the 'Generate False' setting is ticked (default), then a 'false' message will be sent between each 'true' at 'output'. The number of 'true' messages sent will be equal to 'iterations' value; these values are sent over the 'interval' duration (unless interrupted by stop inputs). For example, if 'interval' is set to 5 (seconds) and 'iterations' is set to 5, a 'true' message will be sent from 'output' every 1000 millis. If 'stop input is true then the next true value will not be sent from output until stop is false again. interval units can be configured from settings. Maximum interval setting is 587 hours.\";\n\n    this.addInputWithSettings('interval', Type.NUMBER, 10, 'Interval', false);\n    this.addInputWithSettings('iterations', Type.NUMBER, 5, 'Iterations', false);\n    this.addInput('start', Type.BOOLEAN);\n    this.addInput('stop', Type.BOOLEAN);\n    this.addOutput('output', Type.BOOLEAN);\n    this.addOutput('complete', Type.BOOLEAN);\n    this.addOutput('count', Type.NUMBER);\n    this.settings['time'] = {\n      description: 'Units',\n      type: SettingType.DROPDOWN,\n      config: {\n        items: [\n          { value: 'milliseconds', text: 'Milliseconds' },\n          { value: 'seconds', text: 'Seconds' },\n          { value: 'minutes', text: 'Minutes' },\n          { value: 'hours', text: 'Hours' },\n        ],\n      },\n      value: 'seconds',\n    };\n    this.setSettingsConfig({\n      groups: [{ interval: { weight: 2 }, time: {} }],\n    });\n    this.settings['false'] = {\n      description: 'Generate False',\n      value: true,\n      type: SettingType.BOOLEAN,\n    };\n  }\n\n  onAdded() {\n    clearInterval(this.timeoutFunc);\n    this.setOutputData(0, false);\n    this.setOutputData(1, false);\n    this.inputs[0]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.lastStart = false;\n    this.lastStop = false;\n    this.complete = true;\n    this.count = 0;\n    this.onInputUpdated();\n  }\n\n  start() {\n    this.runState = true;\n    if (this.settings['false'].value) {\n      this.timeoutFunc = setInterval(() => {\n        if (this.state == true) {\n          this.state = false;\n          this.setOutputData(0, false);\n          if (this.count >= this.reqIterations) {\n            clearInterval(this.timeoutFunc);\n            this.setOutputData(1, false);\n            this.complete = true;\n            this.runState = false;\n          }\n        } else {\n          this.state = true;\n          this.setOutputData(0, true);\n          this.count++;\n          this.setOutputData(2, this.count);\n        }\n      }, this.reqInterval / (this.reqIterations * 2 - 1));\n    } else {\n      this.timeoutFunc = setInterval(() => {\n        this.state = true;\n        this.setOutputData(0, true);\n        this.count++;\n        this.setOutputData(2, this.count);\n        if (this.count >= this.reqIterations) {\n          clearInterval(this.timeoutFunc);\n          this.complete = true;\n          this.runState = false;\n        }\n      }, this.reqInterval / (this.reqIterations - 1));\n    }\n  }\n\n  onInputUpdated() {\n    let stop = this.getInputData(3);\n    if (stop && !this.lastStop && !this.complete) {\n      this.lastStop = stop;\n      if (this.settings['false'].value) {\n        this.state = false;\n        this.setOutputData(0, false);\n      }\n      clearInterval(this.timeoutFunc);\n      this.runState = false;\n      return;\n    }\n\n    if (!stop && this.lastStop && !this.complete) {\n      this.lastStop = stop;\n      this.start();\n      return;\n    }\n    this.lastStop = stop;\n\n    let start = this.getInputData(2);\n    if (start && !this.lastStart) {\n      this.lastStart = start;\n      clearInterval(this.timeoutFunc);\n      this.count = 0;\n      if (this.settings['false'].value) {\n        this.state = false;\n        this.setOutputData(0, false);\n      }\n      let interval = this.getInputData(0);\n      interval = TimeUtils.timeConvert(interval, this.settings['time'].value);\n      const iterations = this.getInputData(1);\n      if (iterations <= 0 || interval <= 0) {\n        this.runState = false;\n        return;\n      }\n      this.reqInterval = interval;\n      this.reqIterations = iterations;\n      this.setOutputData(0, true);\n      this.state = true;\n      this.complete = false;\n      this.count++;\n      this.setOutputData(2, this.count);\n      if (stop) {\n        if (this.settings['false'].value) {\n          setTimeout(() => {\n            this.runState = false;\n            this.state = false;\n            this.setOutputData(0, false);\n          }, interval / (iterations * 2 - 1));\n          return;\n        }\n        this.runState = false;\n        return;\n      } else this.start();\n    }\n    this.lastStart = start;\n  }\n\n  onAfterSettingsChange() {\n    this.inputs[0]['name'] = `[interval] (${this.settings['time'].value})`;\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('trigger/iterator', TimeIteratorNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass ScheduleAfterhoursOffWidgetNode extends Node {\n  currentMode: string = 'SCHEDULE';\n  remainingRuntime: number = 0;\n  AHRuntime: number;\n  timeoutFunc;\n  updateInterval: number = 5000;\n\n  constructor() {\n    super();\n    this.title = 'Schedule-Afterhours-Off Widget';\n    this.description =\n      \"This node works with a multi-select cloud dashboard widget to perform the logic to output 'enable' and 'remaining runtime'.  Widget Example:  \" +\n      `{\"new\":false,\"widgetType\":\"MultiSwitch\",\"dataSource\":\"Ditto\",\"tableSelectionMode\":\"Tabular\",\"cellWidthAuto\":true,\"numCharts\":1,\"timeSeriesData\":true,\"valuePrecision\":3,\"trimTableHeaders\":0,\"enableTooltip\":true,\"enableLegend\":true,\"enableZoomSlider\":true,\"syncTime\":60,\"chartSettings\":[{\"xAxisSplits\":3,\"yAxisSplits\":5}],\"graphType\":\"LineChart\",\"fontSize\":35,\"statusImageName\":\"Light\",\"trueStatus\":1,\"falseStatus\":0,\"priority\":16,\"sliderMin\":10,\"sliderMax\":30,\"sliderStep\":0.1,\"min\":0,\"max\":100,\"gaugeSplits\":6,\"maximum\":0,\"unit\":\"C\",\"steps\":0,\"reverseGradient\":true,\"lowerBound\":0,\"upperBound\":100,\"cellWidth\":150,\"tickCount\":100,\"theme\":\"nube\",\"titleColor\":\"#333333\",\"gateway\":\"/api/ditto\",\"query\":\"/api/2/things/com.nubeio:97768707-4a17-4d36-baa5-e1f95cbd74d4/features/points/properties/CHAPEL_Mode\",\"units\":\"%\",\"title\":\"AC Control\",\"containerHeight\":150,\"icon\":\"None\",\"topicIcon\":\"None\",\"subTopicIcon\":\"None\",\"layouts\":{\"lg\":{\"w\":6,\"h\":4,\"x\":0,\"y\":7,\"moved\":false,\"static\":false},\"md\":{\"x\":0,\"y\":144,\"w\":6,\"h\":8},\"sm\":{\"x\":0,\"y\":104,\"w\":6,\"h\":8},\"xs\":{\"x\":0,\"y\":8,\"w\":4,\"h\":8},\"xxs\":{\"x\":0,\"y\":8,\"w\":2,\"h\":8}},\"numButtons\":3,\"buttonSettings\":[{\"name\":\"SCHEDULE\",\"value\":\"SCHEDULE\"},{\"name\":\"AFTERHOURS\",\"value\":\"AFTERHOURS\"},{\"name\":\"OFF\",\"value\":\"OFF\"}],\"dataType\":\"Global\",\"enableBackground\":false,\"isSelect\":false,\"fontWeight\":\"bold\",\"fontColor\":\"\",\"overriddenFields\":[],\"isTransparent\":false,\"isSelectedDitto\":true,\"showValue\":true,\"dataEditorCode\":\"\"}`;\n    this.addInput('modeInput', Type.STRING);\n    this.addInput('scheduleInput', Type.BOOLEAN);\n    this.addInput('scheduleNextStop', Type.NUMBER);\n    this.addInputWithSettings('AH duration (mins)', Type.NUMBER, 120, 'Afterhours Duration (minutes)');\n    this.addOutput('modeOutput', Type.STRING);\n    this.addOutput('enableOutput', Type.BOOLEAN);\n    this.addOutput('remainingRuntime (ms)', Type.NUMBER);\n    this.AHRuntime = TimeUtils.timeConvert(120, 'minutes');\n  }\n\n  onCreated() {\n    this.currentMode = 'OFF';\n    this.onInputUpdated();\n  }\n\n  onAdded() {\n    this.currentMode = 'OFF';\n    this.onInputUpdated();\n  }\n\n  onInputUpdated() {\n    const modeInput = this.getInputData(0);\n    if (modeInput == null) {\n      this.currentMode = null;\n      this.setOutputData(0, '');\n      this.setOutputData(1, null);\n      if (this.timeoutFunc) clearInterval(this.timeoutFunc);\n      this.remainingRuntime = 0;\n      this.setOutputData(2, null);\n      return;\n    } else if (modeInput == 'OFF') {\n      this.currentMode = 'OFF';\n      this.setOutputData(0, 'OFF');\n      this.setOutputData(1, false);\n      if (this.timeoutFunc) clearInterval(this.timeoutFunc);\n      this.remainingRuntime = 0;\n      this.setOutputData(2, 0);\n      return;\n    } else if (modeInput == 'SCHEDULE' && this.currentMode !== modeInput) {\n      this.currentMode = 'SCHEDULE';\n      this.setOutputData(0, 'SCHEDULE');\n      if (this.getInputData(1)) this.startSchedule();\n      else {\n        if (this.timeoutFunc) clearInterval(this.timeoutFunc);\n        this.setOutputData(1, false);\n        this.setOutputData(2, 0);\n      }\n    } else if (modeInput == 'AFTERHOURS' && this.currentMode !== modeInput) {\n      this.startAfterhours();\n    }\n    if (this.currentMode === 'SCHEDULE') {\n      const schedInput = this.getInputData(1);\n      if(!schedInput) this.setOutputData(2, 0);\n      if (this.inputs[1].updated) {\n        if (schedInput) {\n          this.setOutputData(1, true);\n          this.startSchedule();\n        } else {\n          this.setOutputData(1, false);\n          if (this.timeoutFunc) clearInterval(this.timeoutFunc);\n          this.setOutputData(2, 0);\n        }\n      }\n      if (this.getInputData(2) == null) this.setOutputData(2, null);\n      else if (this.inputs[2].updated) {\n        const nextStop = this.getInputData(2);\n        if (nextStop) this.setOutputData(2, nextStop - Date.now());\n      }\n    } else if (\n      TimeUtils.timeConvert(this.getInputData(3), 'minutes') !== this.AHRuntime &&\n      this.currentMode === 'AFTERHOURS'\n    ) {\n      this.startAfterhours();\n    }\n  }\n\n  startSchedule() {\n    if (this.timeoutFunc) clearInterval(this.timeoutFunc);\n    const nextStop = this.getInputData(2);\n    if (nextStop) {\n      this.remainingRuntime = nextStop - Date.now();\n      this.setOutputData(2, this.remainingRuntime);\n      this.timeoutFunc = setInterval(() => {\n        this.remainingRuntime -= this.updateInterval;\n        this.setOutputData(2, this.remainingRuntime);\n      }, this.updateInterval);\n    } else this.setOutputData(2, null);\n    this.setOutputData(1, true);\n  }\n\n  startAfterhours() {\n    this.currentMode = 'AFTERHOURS';\n    this.setOutputData(0, 'AFTERHOURS');\n    this.setOutputData(1, true);\n    clearInterval(this.timeoutFunc);\n    const AHDuration = TimeUtils.timeConvert(this.getInputData(3) || 120, 'minutes');\n    this.AHRuntime = AHDuration;\n    this.remainingRuntime = AHDuration;\n    this.setOutputData(2, AHDuration);\n    this.timeoutFunc = setInterval(() => {\n      this.remainingRuntime -= this.updateInterval;\n      if (this.remainingRuntime <= 0) {\n        this.setOutputData(1, false);\n        this.setOutputData(2, 0);\n        this.currentMode = 'SCHEDULE';\n        this.setOutputData(0, 'SCHEDULE');\n        clearInterval(this.timeoutFunc);\n        if (this.getInputData(1)) this.startSchedule();\n        return;\n      }\n      this.setOutputData(2, this.remainingRuntime);\n    }, this.updateInterval);\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n  }\n}\nContainer.registerNodeType('widget/schedule-afterhours-off', ScheduleAfterhoursOffWidgetNode);\n","import { Node, SettingType} from '../../node';\nimport { Container } from '../../container';\nimport { Type } from '../../node-io';\nimport TimeUtils from '../../utils/time-utils';\n\nclass SchedulePrestartFixedNode extends Node {\n  enabled;\n  nextStart;\n\n  constructor() {\n    super();\n    this.title = 'Schedule Prestart Fixed';\n    this.description =\n      'This node provides a pre-start function based on fixed settings.  Conditions are evaluated every 30 seconds.';\n    this.addInputWithSettings('enable', Type.BOOLEAN, true, 'Enable');\n    this.addInput('temp', Type.NUMBER);\n    this.addInput('SP', Type.NUMBER);\n    this.addInput('scheduleNextStart', Type.NUMBER);\n    this.addInput('reset', Type.NUMBER);\n    this.addOutput('output', Type.STRING);\n\n    this.settings['condition1_range1'] = {\n      description: 'temp > (SP + ?):',\n      value: 1,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition1_range2'] = {\n      description: 'temp <= (SP + ?)',\n      value: 2.5,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition1_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: 20,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['condition2_range1'] = {\n      description: 'temp > (SP + ?):',\n      value: 2.5,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition2_range2'] = {\n      description: 'temp <= (SP + ?)',\n      value: 5,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition2_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: 40,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['condition3_range1'] = {\n      description: 'temp > (SP + ?):',\n      value: 5,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition3_range2'] = {\n      description: 'temp <= (SP + ?)',\n      value: 100,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition3_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: 60,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['condition4_range1'] = {\n      description: 'temp > (SP + ?):',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition4_range2'] = {\n      description: 'temp <= (SP + ?)',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition4_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['condition5_range1'] = {\n      description: 'temp > (SP + ?):',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition5_range2'] = {\n      description: 'temp <= (SP + ?)',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition5_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['condition6_range1'] = {\n      description: 'temp < (SP + ?):',\n      value: -1,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition6_range2'] = {\n      description: 'temp >= (SP + ?)',\n      value: -2.5,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition6_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: 30,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['condition7_range1'] = {\n      description: 'temp < (SP + ?):',\n      value: -2.5,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition7_range2'] = {\n      description: 'temp >= (SP + ?)',\n      value: -5,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition7_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: 40,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['condition8_range1'] = {\n      description: 'temp < (SP + ?):',\n      value: -5,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition8_range2'] = {\n      description: 'temp >= (SP + ?)',\n      value: -100,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition8_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: 60,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['condition9_range1'] = {\n      description: 'temp < (SP + ?):',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition9_range2'] = {\n      description: 'temp >= (SP + ?)',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition9_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n\n    this.settings['condition10_range1'] = {\n      description: 'temp < (SP + ?):',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition10_range2'] = {\n      description: 'temp >= (SP + ?)',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n    this.settings['condition10_time'] = {\n      description: 'Prestart Time (Mins)',\n      value: null,\n      type: SettingType.NUMBER,\n    };\n\n    this.setSettingsConfig({\n      groups: [\n        { condition1_range1: {}, condition1_range2: {}, condition1_time: {} },\n        { condition2_range1: {}, condition2_range2: {}, condition2_time: {} },\n        { condition3_range1: {}, condition3_range2: {}, condition3_time: {} },\n        { condition4_range1: {}, condition4_range2: {}, condition4_time: {} },\n        { condition5_range1: {}, condition5_range2: {}, condition5_time: {} },\n        { condition6_range1: {}, condition6_range2: {}, condition6_time: {} },\n        { condition7_range1: {}, condition7_range2: {}, condition7_time: {} },\n        { condition8_range1: {}, condition8_range2: {}, condition8_time: {} },\n        { condition9_range1: {}, condition9_range2: {}, condition9_time: {} },\n        { condition10_range1: {}, condition10_range2: {}, condition10_time: {} },\n      ],\n    });\n  }\n\n  onCreated() {\n    this.enabled = false;\n    this.EXECUTE_INTERVAL = 30000;\n  }\n\n  onAdded() {\n    this.EXECUTE_INTERVAL = 30000;\n    this.onInputUpdated();\n  }\n\n  onAfterSettingsChange() {\n    this.onInputUpdated();\n    this.onExecute();\n  }\n\n  onExecute() {\n    const now = new Date().valueOf();\n    const enable = this.getInputData(0);\n    if (!enable || this.nextStart == null || this.nextStart - now < 0) {\n      this.setOutputData(0, false);\n      this.enabled = false;\n      return;\n    }\n    if (this.enabled) return;\n    const temp = this.getInputData(1);\n    const setpoint = this.getInputData(2);\n    if (temp == null || setpoint == null) return;\n    for (var i = 1; i <= 10; i++) {\n      var fromRange = this.settings[`condition${i}_range1`].value;\n      var toRange = this.settings[`condition${i}_range2`].value;\n      var time = this.settings[`condition${i}_time`].value;\n      if (fromRange == null || toRange == null || time == null) continue;\n      time = TimeUtils.timeConvert(time, 'minutes');\n      if (this.nextStart - now <= time) {\n        if (i <= 5 && temp > setpoint + fromRange && temp <= setpoint + toRange) {\n          this.enabled = true;\n          this.setOutputData(0, true);\n          return;\n        }\n        if (i > 5 && temp < setpoint + fromRange && temp >= setpoint + toRange) {\n          this.enabled = true;\n          this.setOutputData(0, true);\n          return;\n        }\n      }\n    }\n  }\n\n  onInputUpdated() {\n    const enable = this.getInputData(0);\n    if (!enable) {\n      this.setOutputData(0, false);\n      this.enabled = false;\n      return;\n    }\n    const reset = this.getInputData(4);\n    if (reset && this.inputs[4].updated) {\n      this.enabled = false;\n      this.setOutputData(0, false);\n    }\n    const nextStart = this.getInputData(3);\n    if (nextStart == null || nextStart !== this.nextStart) {\n      this.nextStart = nextStart;\n      this.setOutputData(0, false);\n      this.enabled = false;\n    }\n  }\n}\nContainer.registerNodeType('widget/schedule-prestart-fixed', SchedulePrestartFixedNode);\n","import { Container } from '../../container';\nimport { UNKNOWN_NODE } from '../../constants';\nimport { UnknownNode } from './unknown';\n\nContainer.registerNodeType(UNKNOWN_NODE, UnknownNode, null, false);\n","import { Node } from '../../node';\n\nexport class UnknownNode extends Node {\n  constructor() {\n    super();\n    this.title = 'Unknown';\n    this.description = 'Fallback node, this node need to be replace by another node';\n  }\n}\n","/**\n * Created by Derwish (derwish.pro@gmail.com) on 16.02.2017.\n * License: http://www.gnu.org/licenses/gpl-3.0.txt\n */\n\nimport { Node, SerializedNode } from '../nodes/node';\nimport { UiPanel } from '../server/dashboard';\nimport { Database } from './database';\n\nimport { User } from './models/user';\nimport { Schedule } from './models/schedule';\n\nimport { History } from './models/historian'; //\n\nimport AppDataSource from './datasource/AppDataSource';\nimport DashboardDataSource from './datasource/DashboardDataSource';\nimport NodeDataSource from './datasource/NodeDataSource';\nimport ScheduleDataSource from './datasource/ScheduleDataSource';\nimport HistorianDataSource from './datasource/HistorianDataSource'; //\nimport UserDataSource from './datasource/UserDataSource';\n\nimport AppDatabase from './database/AppDatabase';\nimport DashboardDatabase from './database/DashboardDatabase';\nimport NodeDatabase from './database/NodeDatabase';\nimport ScheduleDatabase from './database/ScheduleDatabase';\nimport HistorianDatabase from './database/HistorianDatabase'; //\nimport UserDatabase from './database/UserDatabase';\nimport AuthUserDatabase from './database/AuthUserDatabase';\nimport { AuthUser } from './models/AuthUser';\nimport AuthUserDataSource from './datasource/AuthUserDataSource';\n\nclass NeDbDatabase implements Database {\n  private static CLEANUP_INTERVAL = 5 * 60 * 1000;\n  private authUserDatabase: AuthUserDatabase;\n  private userDatabase: UserDatabase;\n  private nodeDatabase: NodeDatabase;\n  private dashboardDatabase: DashboardDatabase;\n  private appDatabase: AppDatabase;\n  private scheduleDatabase: ScheduleDatabase;\n  private historianDatabase: HistorianDatabase; //\n\n  constructor() {\n    this.authUserDatabase = new AuthUserDataSource();\n    this.userDatabase = new UserDataSource();\n    this.nodeDatabase = new NodeDataSource();\n    this.dashboardDatabase = new DashboardDataSource();\n    this.appDatabase = new AppDataSource();\n    this.scheduleDatabase = new ScheduleDataSource();\n    this.historianDatabase = new HistorianDataSource(); //\n  }\n\n  async asyncLoadDatabase(cleanUpInterval = NeDbDatabase.CLEANUP_INTERVAL): Promise<any> {\n    try {\n      await this.authUserDatabase.asyncLoadDatabase(cleanUpInterval);\n      await this.userDatabase.asyncLoadDatabase(cleanUpInterval);\n      await this.nodeDatabase.asyncLoadDatabase(cleanUpInterval);\n      await this.dashboardDatabase.asyncLoadDatabase(cleanUpInterval);\n      await this.appDatabase.asyncLoadDatabase(cleanUpInterval);\n      await this.scheduleDatabase.asyncLoadDatabase(cleanUpInterval);\n      await this.historianDatabase.asyncLoadDatabase(cleanUpInterval); //\n    } catch (e) {\n      throw e;\n    }\n    return null;\n  }\n\n  addUser(user: User, callback?: (err?: Error, doc?: User) => void) {\n    this.userDatabase.addUser(user, callback);\n  }\n\n  addOrUpdateUser(query: object, user: User): Promise<any> {\n    return this.userDatabase.addOrUpdateUser(query, user);\n  }\n\n  getUsers(callback?: (err?: Error, docs?: Array<User>) => void) {\n    this.userDatabase.getUsers(callback);\n  }\n\n  getUser(query: object, callback?: (err?: Error, doc?: User) => void) {\n    this.userDatabase.getUser(query, callback);\n  }\n\n  getAsyncUsers(): Promise<any> {\n    return this.userDatabase.getAsyncUsers();\n  }\n\n  updateUser(query: object, user: User, callback?: (err?: Error) => void) {\n    this.userDatabase.updateUser(query, user);\n  }\n\n  getUsersCount(callback?: (err?: Error, num?: number) => void) {\n    this.userDatabase.getUsersCount(callback);\n  }\n\n  removeUser(query: object, callback?: (err?: Error) => void) {\n    this.userDatabase.removeUser(query, callback);\n  }\n\n  dropUsers(callback?: (err?: Error) => void) {\n    this.userDatabase.dropUsers();\n  }\n\n  addNode(node: Node, callback?: (err?: Error, doc?: SerializedNode) => void) {\n    this.nodeDatabase.addNode(node, callback);\n  }\n\n  getNodes(callback?: (err?: Error, docs?: Array<SerializedNode>) => void) {\n    this.nodeDatabase.getNodes(callback);\n  }\n\n  getNodeType(type: string, callback?: (err?: Error, docs?: Array<SerializedNode>) => void) {\n    this.nodeDatabase.getNodeType(type, callback);\n  }\n\n  getNodeByQuery(query, callback?: (err?: Error, docs?: Array<any>) => void) {\n    this.nodeDatabase.getNodeByQuery(query, callback);\n  }\n\n  getNode(id: number, cid: number, callback?: (err?: Error, doc?: SerializedNode) => void) {\n    this.nodeDatabase.getNode(id, cid, callback);\n  }\n\n  updateNode(id: number, cid: number, update: any, callback?: (err?: Error) => void) {\n    this.nodeDatabase.updateNode(id, cid, update, callback);\n  }\n\n  removeNode(id: number, cid: number, callback?: (err?: Error) => void) {\n    this.nodeDatabase.removeNode(id, cid, callback);\n  }\n\n  dropNodes(callback?: (err?: Error) => void) {\n    this.nodeDatabase.dropNodes(callback);\n  }\n\n  addUiPanel(panel: UiPanel, callback?: (err?: Error, doc?: UiPanel) => void) {\n    this.dashboardDatabase.addUiPanel(panel, callback);\n  }\n\n  getUiPanels(callback?: (err?: Error, docs?: UiPanel[]) => void) {\n    this.dashboardDatabase.getUiPanels(callback);\n  }\n\n  getUiPanel(name: string, callback?: (err?: Error, doc?: UiPanel) => void) {\n    this.dashboardDatabase.getUiPanel(name, callback);\n  }\n\n  updateUiPanel(name: string, update: any, callback?: (err?: Error) => void) {\n    this.dashboardDatabase.updateUiPanel(name, update, callback);\n  }\n\n  dropUiPanels(callback?: (err?: Error) => void) {\n    this.dashboardDatabase.dropUiPanels(callback);\n  }\n\n  removeUiPanel(name: string, callback?: (err?: Error) => void) {\n    this.dashboardDatabase.removeUiPanel(name, callback);\n  }\n\n  getLastContainerId(callback?: (err?: Error, id?: number) => void) {\n    this.appDatabase.getLastContainerId(callback);\n  }\n\n  updateLastContainerId(id: number, callback?: (err?: Error) => void) {\n    this.appDatabase.updateLastContainerId(id, callback);\n  }\n\n  getLastRootNodeId(callback?: (err?: Error, id?: number) => void) {\n    this.appDatabase.getLastRootNodeId(callback);\n  }\n\n  updateLastRootNodeId(id: number, callback?: (err?: Error) => void) {\n    this.appDatabase.updateLastRootNodeId(id, callback);\n  }\n\n  dropApp(callback?: (err?: Error) => void) {\n    this.appDatabase.dropApp(callback);\n  }\n\n  addSchedule(schedule: Schedule, callback?: (err?: Error, doc?: Schedule) => void) {\n    this.scheduleDatabase.addSchedule(schedule, callback);\n  }\n\n  updateSchedule(query: object, schedule: Schedule, callback?: (err?: Error) => void) {\n    this.scheduleDatabase.updateSchedule(query, schedule, callback);\n  }\n\n  removeSchedule(query: object, callback?: (err?: Error) => void) {\n    this.scheduleDatabase.removeSchedule(query, callback);\n  }\n\n  //// HistorianDatabase historian history\n\n  addHistory(history: History, callback?: (err?: Error, doc?: History) => void) {\n    this.historianDatabase.addHistory(history, callback);\n  }\n\n  updateHistory(query: object, history: History, callback?: (err?: Error) => void) {\n    this.historianDatabase.updateHistory(query, history, callback);\n  }\n\n  removeHistory(query: object, callback?: (err?: Error) => void) {\n    this.historianDatabase.removeHistory(query, callback);\n  }\n\n  addAuthUser(authUser: AuthUser): Promise<AuthUser> {\n    return this.authUserDatabase.addAuthUser(authUser);\n  }\n\n  getAuthUser(): Promise<AuthUser> {\n    return this.authUserDatabase.getAuthUser();\n  }\n\n  deleteAuthUsers(): Promise<string> {\n    return this.authUserDatabase.deleteAuthUsers();\n  }\n\n  getAuthToken(authUser: AuthUser): Promise<string> {\n    return this.authUserDatabase.getAuthToken(authUser);\n  }\n\n  isAuthenticated(token: string): Promise<any> {\n    return this.authUserDatabase.isAuthenticated(token);\n  }\n\n\n}\n\nconst db = new NeDbDatabase();\nexport { db };\n","import * as NeDBDataStore from 'nedb';\n\nimport AppDatabase from '../database/AppDatabase';\nimport config from '../../config';\n\nconst log = require('logplease').create('database', { color: 4 });\n\nexport default class AppDataSource implements AppDatabase {\n  private app: NeDBDataStore;\n\n  async asyncLoadDatabase(cleanUpInterval: any): Promise<any> {\n    const path = config.dataDir;\n    this.app = new NeDBDataStore(`${path}/app.db`);\n    this.app.persistence.setAutocompactionInterval(cleanUpInterval);\n    return this.loadApp();\n  }\n\n  private loadApp(): Promise<any> {\n    return new Promise<any>((resolve, reject) => {\n      this.app.loadDatabase(err => {\n        if (err) {\n          log.error(err);\n          reject(err);\n        }\n        return resolve();\n      });\n    });\n  }\n\n  getLastContainerId(callback?: (err?: Error, id?: number) => void) {\n    this.app.findOne({ _id: 'lastContainerId' }, function(err, doc: any) {\n      if (err) log.error(err);\n      if (callback) {\n        if (doc) callback(err, doc.last);\n        else callback(err, null);\n      }\n    });\n  }\n\n  updateLastContainerId(id: number, callback?: (err?: Error) => void) {\n    this.app.update({ _id: 'lastContainerId' }, { $set: { last: id } }, { upsert: true }, function(\n      err,\n      updated,\n    ) {\n      if (err) log.error(err);\n      if (updated == 0) log.error(\"Cat't update. Document not found.\");\n      if (callback) callback(err);\n    });\n  }\n\n  getLastRootNodeId(callback?: (err?: Error, id?: number) => void) {\n    this.app.findOne({ _id: 'lastRootNodeId' }, function(err, doc: any) {\n      if (err) log.error(err);\n      if (callback) {\n        if (doc) callback(err, doc.last);\n        else callback(err, null);\n      }\n    });\n  }\n\n  updateLastRootNodeId(id: number, callback?: (err?: Error) => void) {\n    this.app.update({ _id: 'lastRootNodeId' }, { $set: { last: id } }, { upsert: true }, function(\n      err,\n      updated,\n    ) {\n      if (err) log.error(err);\n      if (updated == 0) log.error(\"Cat't update. Document not found.\");\n      if (callback) callback(err);\n    });\n  }\n\n  dropApp(callback?: (err?: Error) => void) {\n    this.app.remove({}, { multi: true }, function(err) {\n      if (err) log.error(err);\n      if (callback) callback(err);\n    });\n  }\n}\n","import * as NeDBDataStore from 'nedb';\n\nimport DashboardDatabase from '../database/DashboardDatabase';\nimport config from '../../config';\nimport { UiPanel } from '../../server/dashboard';\n\nconst log = require('logplease').create('database', { color: 4 });\n\nexport default class DashboardDataSource implements DashboardDatabase {\n  dashboard: NeDBDataStore;\n\n  async asyncLoadDatabase(cleanUpInterval: any): Promise<any> {\n    const path = config.dataDir;\n    this.dashboard = new NeDBDataStore(`${path}/dashboard.db`);\n    this.dashboard.persistence.setAutocompactionInterval(cleanUpInterval);\n    return this.loadDashboard();\n  }\n\n  private loadDashboard(): Promise<any> {\n    return new Promise<any>((resolve, reject) => {\n      this.dashboard.loadDatabase(err => {\n        if (err) {\n          log.error(err);\n          reject(err);\n        }\n        return resolve();\n      });\n    });\n  }\n\n  addUiPanel(panel: UiPanel, callback?: (err?: Error, doc?: UiPanel) => void) {\n    this.dashboard.insert(panel, function(err, doc) {\n      if (err) log.error(err);\n      if (callback) callback(err, doc);\n    });\n  }\n\n  getUiPanels(callback?: (err?: Error, docs?: UiPanel[]) => void) {\n    this.dashboard.find({}, function(err, docs) {\n      if (err) log.error(err);\n      if (callback) callback(err, docs);\n    });\n  }\n\n  getUiPanel(name: string, callback?: (err?: Error, doc?: UiPanel) => void) {\n    this.dashboard.findOne({ name: name }, function(err, doc: any) {\n      if (err) log.error(err);\n      if (callback) callback(err, doc);\n    });\n  }\n\n  updateUiPanel(name: string, update: any, callback?: (err?: Error) => void) {\n    this.dashboard.update({ name: name }, update, {}, function(err, updated) {\n      if (err) log.error(err);\n      if (updated == 0) log.error(`Cat't update dashboard panel [${name}]. Document not found.`);\n      if (callback) callback(err);\n    });\n  }\n\n  removeUiPanel(name: string, callback?: (err?: Error) => void) {\n    this.dashboard.remove({ name: name }, {}, function(err, removed) {\n      if (err) log.error(err);\n      if (removed == 0) log.error(\"Cat't remove. Document not found.\");\n      if (callback) callback(err);\n    });\n  }\n\n  dropUiPanels(callback?: (err?: Error) => void) {\n    this.dashboard.remove({}, { multi: true }, function(err) {\n      if (err) log.error(err);\n      if (callback) callback(err);\n    });\n  }\n}\n","import * as NeDBDataStore from 'nedb';\n\nimport NodeDatabase from '../database/NodeDatabase';\nimport config from '../../config';\nimport { Node, SerializedNode } from '../../nodes/node';\n\nconst log = require('logplease').create('database', { color: 4 });\n\nexport default class NodeDataSource implements NodeDatabase {\n  private nodes: NeDBDataStore;\n\n  async asyncLoadDatabase(cleanUpInterval: any): Promise<any> {\n    const path = config.dataDir;\n    this.nodes = new NeDBDataStore(`${path}/nodes.db`);\n    this.nodes.persistence.setAutocompactionInterval(cleanUpInterval);\n    return this.load();\n  }\n\n  private load(): Promise<any> {\n    return new Promise<any>((resolve, reject) => {\n      this.nodes.loadDatabase(err => {\n        if (err) {\n          log.error(err);\n          reject(err);\n        }\n        return resolve();\n      });\n    });\n  }\n\n  addNode(node: Node, callback?: (err?: Error, doc?: SerializedNode) => void) {\n    let ser_node = node.serialize();\n    (<any>ser_node)._id = 'c' + ser_node.cid + 'n' + ser_node.id;\n\n    this.nodes.insert(ser_node, function(err, doc) {\n      if (err) log.error(err);\n      if (callback) callback(err, doc);\n    });\n  }\n\n  getNodes(callback?: (err?: Error, docs?: Array<SerializedNode>) => void) {\n    this.nodes.find({}, function(err, docs) {\n      if (err) log.error(err);\n      if (callback) callback(err, docs);\n    });\n  }\n\n  getNode(id: number, cid: number, callback?: (err?: Error, doc?: SerializedNode) => void) {\n    let _id = 'c' + cid + 'n' + id;\n    this.nodes.findOne({ _id: _id }, function(err, doc: any) {\n      if (err) log.error(err);\n      if (callback) callback(err, doc);\n    });\n  }\n\n  getNodeType(type: string, callback?: (err?: Error, docs?: Array<SerializedNode>) => void) {\n    this.nodes.find({ type: type }, function(err, docs) {\n      if (err) log.error(err);\n      if (callback) callback(err, docs);\n    });\n  }\n\n  getNodeByQuery(query, callback?: (err?: Error, docs?: Array<any>) => void) {\n    this.nodes.find(query, function(err, docs) {\n      if (err) log.error(err);\n      if (callback) callback(err, docs);\n    });\n  }\n\n  updateNode(id: number, cid: number, update: any, callback?: (err?: Error) => void) {\n    let _id = 'c' + cid + 'n' + id;\n    this.nodes.update({ _id: _id }, update, {}, function(err, updated) {\n      if (err) log.error(err);\n      if (updated == 0) log.error(`Cat't update node [${cid}/${id}]. Document not found.`);\n      if (callback) callback(err);\n    });\n  }\n\n  removeNode(id: number, cid: number, callback?: (err?: Error) => void) {\n    let _id = 'c' + cid + 'n' + id;\n    this.nodes.remove({ _id: _id }, {}, function(err, removed) {\n      if (err) log.error(err);\n      if (removed == 0) log.error(\"Cat't remove. Document not found.\");\n      if (callback) callback(err);\n    });\n  }\n\n  dropNodes(callback?: (err?: Error) => void) {\n    this.nodes.remove({}, { multi: true }, function(err) {\n      if (err) log.error(err);\n      if (callback) callback(err);\n    });\n  }\n}\n","import * as NeDBDataStore from 'nedb';\n\nimport ScheduleDatabase from '../database/ScheduleDatabase';\nimport { Schedule } from '../models/schedule';\nimport config from '../../config';\n\nconst log = require('logplease').create('database', { color: 4 });\n\nexport default class ScheduleDataSource implements ScheduleDatabase {\n  private schedule: NeDBDataStore;\n\n  async asyncLoadDatabase(cleanUpInterval: any): Promise<any> {\n    const path = config.dataDir;\n    this.schedule = new NeDBDataStore(`${path}/schedule.db`);\n    this.schedule.persistence.setAutocompactionInterval(cleanUpInterval);\n    return this.loadSchedule();\n  }\n\n  private loadSchedule(): Promise<any> {\n    return new Promise<any>((resolve, reject) => {\n      this.schedule.loadDatabase(err => {\n        if (err) {\n          log.error(err);\n          reject(err);\n        }\n        return resolve();\n      });\n    });\n  }\n\n  addSchedule(schedule: Schedule, callback?: (err?: Error, doc?: Schedule) => void) {\n    this.schedule.insert(schedule, function(err, doc) {\n      if (err) log.error(err);\n      if (callback) callback(err, doc);\n    });\n  }\n\n  updateSchedule(\n    query: object,\n    schedule: Schedule,\n    callback?: (err?: Error) => void,\n    updatedCallback?: (updated?: number) => void,\n  ) {\n    this.schedule.update(query, schedule, {}, function(err, updated) {\n      if (err) log.error(err);\n      else {\n        updatedCallback(updated);\n      }\n      if (updated == 0) log.error(`Can't update schedule [${name}]. Document not found.`);\n      if (callback) callback(err);\n    });\n  }\n\n  //remove\n  removeSchedule(\n    query: object,\n    callback?: (err?: Error) => void,\n    removedCallback?: (removed?: number) => void,\n  ) {\n    this.schedule.remove(query, {}, function(err, removed) {\n      if (err) {\n        log.error(err);\n      } else {\n        removedCallback(removed);\n      }\n      if (removed == 0) log.debug(\"Cat't remove. Schedule Document not found.\");\n      if (callback) callback(err);\n    });\n  }\n}\n","import * as NeDBDataStore from 'nedb';\n\nimport HistorianDatabase from '../database/HistorianDatabase';\nimport { History } from '../models/historian';\nimport config from '../../config';\n\nconst log = require('logplease').create('database', { color: 4 });\n\nexport default class HistorianDataSource implements HistorianDatabase {\n  private history: NeDBDataStore;\n\n  async asyncLoadDatabase(cleanUpInterval: any): Promise<any> {\n    const path = config.dataDir;\n    this.history = new NeDBDataStore(`${path}/history.db`);\n    this.history.persistence.setAutocompactionInterval(cleanUpInterval);\n    return this.loadHistory();\n  }\n\n  private loadHistory(): Promise<any> {\n    return new Promise<any>((resolve, reject) => {\n      this.history.loadDatabase(err => {\n        if (err) {\n          log.error(err);\n          reject(err);\n        }\n        return resolve();\n      });\n    });\n  }\n\n  addHistory(history: History, callback?: (err?: Error, doc?: History) => void) {\n    this.history.insert(history, function(err, doc) {\n      if (err) log.error(err);\n      if (callback) callback(err, doc);\n    });\n  }\n\n  updateHistory(\n    query: object,\n    history: History,\n    callback?: (err?: Error) => void,\n    updatedCallback?: (updated?: number) => void,\n  ) {\n    this.history.update(query, history, {}, function(err, updated) {\n      if (err) log.error(err);\n      else {\n        updatedCallback(updated);\n      }\n      if (updated == 0) log.error(`Can't update history [${name}]. Document not found.`);\n      if (callback) callback(err);\n    });\n  }\n\n  //remove\n  removeHistory(\n    query: object,\n    callback?: (err?: Error) => void,\n    removedCallback?: (removed?: number) => void,\n  ) {\n    this.history.remove(query, {}, function(err, removed) {\n      if (err) {\n        log.error(err);\n      } else {\n        removedCallback(removed);\n      }\n      if (removed == 0) log.debug(\"Cat't remove. History Document not found.\");\n      if (callback) callback(err);\n    });\n  }\n}\n\n// async function find(id) {\n//     return new Promise((resolve, reject) => {\n//         try {\n//             let ab = { pntId: id };\n//             db.find({ ...ab }, (err, docs) => {\n//                 let output = [];\n//                 if (!err) {\n//                     console.log(docs);\n//                     resolve(docs);\n//                 } else {\n//                     reject(err);\n//                 }\n//             });\n//         } catch (error) {\n//             console.log(error);\n//         }\n//     });\n// }\n\n// async function count(id) {\n//     return new Promise((resolve, reject) => {\n//         try {\n//             let ab = { pntId: id };\n//             db.count({ ...ab }, (err, docs) => {\n//                 let output = [];\n//                 if (!err) {\n//                     console.log(docs);\n//                     resolve(docs);\n//                 } else {\n//                     reject(err);\n//                 }\n//             });\n//         } catch (error) {\n//             console.log(error);\n//         }\n//     });\n// }\n\n// async function add(id, obj) {\n//     return new Promise((resolve, reject) => {\n//         try {\n//             let ab = { pntId: id, ts: obj}\n//             db.insert({ ...ab }, (err, docs) => {\n//                 let output = [];\n//                 if (!err) {\n//                     console.log(docs);\n//                     resolve(docs);\n//                 } else {\n//                     reject(err);\n//                 }\n//             });\n//         } catch (error) {\n//             console.log(error);\n//         }\n//     });\n// }\n// //   add(123, arr)\n\n// async function deleteHis(id, hisLimit) {\n//     return new Promise((resolve, reject) => {\n//         try {\n//             let ab = { pntId: id, hisCount: { $gte: hisLimit } }\n//             db.find({ ...ab }, (err, docs) => {\n//                 let output = [];\n//                 if (!err) {\n//                     docs.forEach(element => {\n//                         db.remove({ _id: element._id }, {}, function (err, numRemoved) {\n//                             // numRemoved = 1\n//                             console.log(numRemoved + 'num rem')\n//                         });\n//                     });\n//                     resolve(docs);\n//                 } else {\n//                     reject(err);\n//                 }\n//             });\n//         } catch (error) {\n//             console.log(error);\n//         }\n//     });\n// }\n// //   deleteHis(123, 0)\n","import * as NeDBDataStore from 'nedb';\n\nimport UserDatabase from '../database/UserDatabase';\nimport { User } from '../models/user';\nimport config from '../../config';\n\nconst log = require('logplease').create('database', { color: 4 });\n\nexport default class UserDataSource implements UserDatabase {\n  private users: NeDBDataStore;\n\n  async asyncLoadDatabase(cleanUpInterval: any): Promise<any> {\n    const path = config.dataDir;\n    this.users = new NeDBDataStore(`${path}/users.db`);\n    this.users.persistence.setAutocompactionInterval(cleanUpInterval);\n    return this.loadUsers();\n  }\n\n  private loadUsers(): Promise<any> {\n    return new Promise<any>((resolve, reject) => {\n      this.users.loadDatabase(err => {\n        if (err) {\n          log.error(err);\n          reject(err);\n        }\n        return resolve();\n      });\n    });\n  }\n\n  addUser(user: User, callback?: (err?: Error, doc?: User) => void) {\n    this.users.insert(user, function(err, doc) {\n      if (err) log.error(err);\n      if (callback) callback(err, doc);\n    });\n  }\n\n  getUser(query: object, callback?: (err?: Error, doc?: User) => void) {\n    this.users.findOne(query, function(err, doc: any) {\n      if (err) log.error(err);\n      if (callback) callback(err, doc);\n    });\n  }\n\n  getUsers(callback?: (err?: Error, docs?: Array<User>) => void) {\n    this.users.find({}, function(err, docs) {\n      if (err) log.error(err);\n      if (callback) callback(err, docs);\n    });\n  }\n\n  getAsyncUsers(): Promise<any> {\n    return new Promise((resolve, reject) => {\n      this.users.find({}, function(err, doc: any) {\n        if (err) {\n          log.error(err);\n          reject(err);\n        } else resolve(doc);\n      });\n    });\n  }\n\n  updateUser(query: object, user: User, callback?: (err?: Error) => void) {\n    this.users.update(query, user, {}, function(err, updated) {\n      if (err) log.error(err);\n      if (updated == 0) log.error(`Cat't update user [${name}]. Document not found.`);\n      if (callback) callback(err);\n    });\n  }\n\n  getUsersCount(callback?: (err?: Error, num?: number) => void) {\n    this.users.count({}, function(err, num) {\n      if (err) log.error(err);\n      if (callback) callback(err, num);\n    });\n  }\n\n  addOrUpdateUser(query: object, user: User): Promise<any> {\n    return new Promise((resolve, reject) => {\n      this.getUser(query, (err, usr) => {\n        if (usr) {\n          this.updateUser(query, user, err => {\n            if (err) reject(err);\n            else resolve();\n          });\n        } else {\n          this.addUser(user, err => {\n            if (err) reject(err);\n            else resolve();\n          });\n        }\n      });\n    });\n  }\n\n  removeUser(query: object, callback?: (err?: Error) => void) {\n    this.users.remove(query, {}, function(err, removed) {\n      if (err) log.error(err);\n      if (callback) callback(err);\n    });\n  }\n\n  dropUsers(callback?: (err?: Error) => void) {\n    this.users.remove({}, { multi: true }, function(err) {\n      if (err) log.error(err);\n      if (callback) callback(err);\n    });\n  }\n}\n","import * as NeDBDataStore from 'nedb';\nimport config from '../../config';\nimport AuthUserDatabase from '../database/AuthUserDatabase';\nimport { AuthUser } from '../models/AuthUser';\nimport CryptoUtils from '../../nodes/utils/crypto-utils';\n\nconst jwt = require('jsonwebtoken');\nconst log = require('logplease').create('auth-database', { color: 4 });\n\nexport default class AuthUserDataSource implements AuthUserDatabase {\n  private auth: NeDBDataStore;\n\n  async asyncLoadDatabase(cleanUpInterval: any): Promise<any> {\n    const path = config.dataDir;\n    this.auth = new NeDBDataStore(`${path}/auth.db`);\n    this.auth.persistence.setAutocompactionInterval(cleanUpInterval);\n    return this.loadAuth();\n  }\n\n  private loadAuth(): Promise<any> {\n    return new Promise<any>((resolve, reject) => {\n      this.auth.loadDatabase(err => {\n        if (err) {\n          log.error(err);\n          reject(err);\n        }\n        return resolve();\n      });\n    });\n  }\n\n  addAuthUser(authUser: AuthUser): Promise<AuthUser> {\n    return new Promise((resolve, reject) => {\n      this.auth.find({}, (err, doc: Array<AuthUser>) => {\n        if (doc.length) {\n          log.warn('User is already inserted');\n          reject('User is already inserted');\n          return;\n        }\n        authUser.password = CryptoUtils.encrypt(authUser.password);\n        this.auth.insert(authUser, (err, doc) => {\n          if (err) {\n            reject(err);\n            log.error(err);\n          } else {\n            resolve(doc);\n          }\n        });\n      });\n    });\n  }\n\n  getAuthUser(): Promise<AuthUser> {\n    return new Promise((resolve, reject) => {\n      this.auth.findOne({}, (err, doc) => {\n        if (err) {\n          reject(err);\n          log.error(err);\n        } else {\n          resolve(doc);\n        }\n      });\n    });\n  }\n\n  deleteAuthUsers(): Promise<string> {\n    return new Promise((resolve, reject) => {\n      this.auth.remove({}, { multi: true }, err => {\n        if (err) {\n          reject(err);\n          log.error(err);\n        } else {\n          resolve('Successfully removed');\n        }\n      });\n    });\n  }\n\n  getAuthToken(authUser: AuthUser): Promise<string> {\n    return new Promise((resolve, reject) => {\n      this.auth.findOne({ username: authUser.username }, (err, doc) => {\n        if (err) {\n          reject(err);\n          log.error(err);\n        } else if (doc && CryptoUtils.decrypt(doc.password) === authUser.password) {\n          const token = jwt.sign({ username: doc.username }, config.secretKey, { expiresIn: 18000 });\n          resolve(`${token}`);\n        } else {\n          log.warn('Invalid Credentials');\n          reject('Invalid Credentials');\n        }\n      });\n    });\n  }\n\n  isAuthenticated(token: string): Promise<any> {\n    return new Promise((resolve, reject) => {\n      jwt.verify(token, config.secretKey, (err, decoded) => {\n        if (err) {\n          log.error(err);\n          reject(err);\n        } else {\n          resolve(decoded);\n        }\n      });\n    });\n  }\n}\n","module.exports = require(\"jsonwebtoken\");"],"sourceRoot":""}